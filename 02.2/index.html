<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../02.1/ rel=prev><link href=../02.3/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.6"><title>2.2 Go基础 - A golang ebook intro how to build a web with golang</title><link rel=stylesheet href=../assets/stylesheets/main.558e4712.min.css><link rel=stylesheet href=../assets/stylesheets/palette.2505c338.min.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#22-go class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=.. title="A golang ebook intro how to build a web with golang" class="md-header__button md-logo" aria-label="A golang ebook intro how to build a web with golang" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> A golang ebook intro how to build a web with golang </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 2.2 Go基础 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/itboon/golang-web-dev title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> itboon/golang-web-dev </div> </a> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> 简体中文 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="A golang ebook intro how to build a web with golang" class="md-nav__button md-logo" aria-label="A golang ebook intro how to build a web with golang" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> A golang ebook intro how to build a web with golang </label> <div class=md-nav__source> <a href=https://github.com/itboon/golang-web-dev title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> itboon/golang-web-dev </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_1 type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 tabindex=0 aria-expanded=true> 简体中文 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=简体中文 data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 简体中文 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> 目录 </a> </li> <li class=md-nav__item> <a href=../01.0/ class=md-nav__link> 1 GO环境配置 </a> </li> <li class=md-nav__item> <a href=../01.1/ class=md-nav__link> 1.1安装 Go </a> </li> <li class=md-nav__item> <a href=../01.2/ class=md-nav__link> 1.2 Go Module, GOPATH 与工作空间 </a> </li> <li class=md-nav__item> <a href=../01.3/ class=md-nav__link> 1.3 Go 命令 </a> </li> <li class=md-nav__item> <a href=../01.4/ class=md-nav__link> 1.4 Go开发工具 </a> </li> <li class=md-nav__item> <a href=../01.5/ class=md-nav__link> 1.5 总结 </a> </li> <li class=md-nav__item> <a href=../02.0/ class=md-nav__link> 2 Go语言基础 </a> </li> <li class=md-nav__item> <a href=../02.1/ class=md-nav__link> 2.1 你好 Go </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 2.2 Go基础 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 2.2 Go基础 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 定义变量 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 常量 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 内置基础类型 </a> <nav class=md-nav aria-label=内置基础类型> <ul class=md-nav__list> <li class=md-nav__item> <a href=#boolean class=md-nav__link> Boolean </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 数值类型 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 字符串 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 错误类型 </a> </li> <li class=md-nav__item> <a href=#go class=md-nav__link> Go数据底层的存储 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 一些技巧 </a> <nav class=md-nav aria-label=一些技巧> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 分组声明 </a> </li> <li class=md-nav__item> <a href=#iota class=md-nav__link> iota枚举 </a> </li> <li class=md-nav__item> <a href=#go_1 class=md-nav__link> Go程序设计的一些规则 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#arrayslicemap class=md-nav__link> array、slice、map </a> <nav class=md-nav aria-label=array、slice、map> <ul class=md-nav__list> <li class=md-nav__item> <a href=#array class=md-nav__link> array </a> </li> <li class=md-nav__item> <a href=#slice class=md-nav__link> slice </a> </li> <li class=md-nav__item> <a href=#map class=md-nav__link> map </a> </li> <li class=md-nav__item> <a href=#makenew class=md-nav__link> make、new操作 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 零值 </a> </li> <li class=md-nav__item> <a href=#links class=md-nav__link> links </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../02.3/ class=md-nav__link> 2.3 流程和函数 </a> </li> <li class=md-nav__item> <a href=../02.4/ class=md-nav__link> 2.4 struct类型 </a> </li> <li class=md-nav__item> <a href=../02.5/ class=md-nav__link> 2.5 面向对象 </a> </li> <li class=md-nav__item> <a href=../02.6/ class=md-nav__link> 2.6 interface </a> </li> <li class=md-nav__item> <a href=../02.7/ class=md-nav__link> 2.7 并发 </a> </li> <li class=md-nav__item> <a href=../02.8/ class=md-nav__link> 2.8 总结 </a> </li> <li class=md-nav__item> <a href=../03.0/ class=md-nav__link> 3 Web基础 </a> </li> <li class=md-nav__item> <a href=../03.1/ class=md-nav__link> 3.1 Web工作方式 </a> </li> <li class=md-nav__item> <a href=../03.2/ class=md-nav__link> 3.2 Go搭建一个Web服务器 </a> </li> <li class=md-nav__item> <a href=../03.3/ class=md-nav__link> 3.3 Go如何使得Web工作 </a> </li> <li class=md-nav__item> <a href=../03.4/ class=md-nav__link> 3.4 Go的http包详解 </a> </li> <li class=md-nav__item> <a href=../03.5/ class=md-nav__link> 3.5 小结 </a> </li> <li class=md-nav__item> <a href=../04.0/ class=md-nav__link> 4 表单 </a> </li> <li class=md-nav__item> <a href=../04.1/ class=md-nav__link> 4.1 处理表单的输入 </a> </li> <li class=md-nav__item> <a href=../04.2/ class=md-nav__link> 4.2 验证表单的输入 </a> </li> <li class=md-nav__item> <a href=../04.3/ class=md-nav__link> 4.3 预防跨站脚本 </a> </li> <li class=md-nav__item> <a href=../04.4/ class=md-nav__link> 4.4 防止多次递交表单 </a> </li> <li class=md-nav__item> <a href=../04.5/ class=md-nav__link> 4.5 处理文件上传 </a> </li> <li class=md-nav__item> <a href=../04.6/ class=md-nav__link> 4.6 小结 </a> </li> <li class=md-nav__item> <a href=../05.0/ class=md-nav__link> 5 访问数据库 </a> </li> <li class=md-nav__item> <a href=../05.1/ class=md-nav__link> 5.1 database/sql接口 </a> </li> <li class=md-nav__item> <a href=../05.2/ class=md-nav__link> 5.2 使用MySQL数据库 </a> </li> <li class=md-nav__item> <a href=../05.3/ class=md-nav__link> 5.3 使用SQLite数据库 </a> </li> <li class=md-nav__item> <a href=../05.4/ class=md-nav__link> 5.4 使用PostgreSQL数据库 </a> </li> <li class=md-nav__item> <a href=../05.5/ class=md-nav__link> 5.5 使用Beego orm库进行ORM开发 </a> </li> <li class=md-nav__item> <a href=../05.6/ class=md-nav__link> 5.6 NOSQL数据库操作 </a> </li> <li class=md-nav__item> <a href=../05.7/ class=md-nav__link> 5.7 小结 </a> </li> <li class=md-nav__item> <a href=../06.0/ class=md-nav__link> 6 session和数据存储 </a> </li> <li class=md-nav__item> <a href=../06.1/ class=md-nav__link> 6.1 session和cookie </a> </li> <li class=md-nav__item> <a href=../06.2/ class=md-nav__link> 6.2 Go如何使用session </a> </li> <li class=md-nav__item> <a href=../06.3/ class=md-nav__link> 6.3 session存储 </a> </li> <li class=md-nav__item> <a href=../06.4/ class=md-nav__link> 6.4 预防session劫持 </a> </li> <li class=md-nav__item> <a href=../06.5/ class=md-nav__link> 6.5 小结 </a> </li> <li class=md-nav__item> <a href=../07.0/ class=md-nav__link> 7 文本处理 </a> </li> <li class=md-nav__item> <a href=../07.1/ class=md-nav__link> 7.1 XML处理 </a> </li> <li class=md-nav__item> <a href=../07.2/ class=md-nav__link> 7.2 JSON处理 </a> </li> <li class=md-nav__item> <a href=../07.3/ class=md-nav__link> 7.3 正则处理 </a> </li> <li class=md-nav__item> <a href=../07.4/ class=md-nav__link> 7.4 模板处理 </a> </li> <li class=md-nav__item> <a href=../07.5/ class=md-nav__link> 7.5 文件操作 </a> </li> <li class=md-nav__item> <a href=../07.6/ class=md-nav__link> 7.6 字符串处理 </a> </li> <li class=md-nav__item> <a href=../07.7/ class=md-nav__link> 7.7 小结 </a> </li> <li class=md-nav__item> <a href=../08.0/ class=md-nav__link> 8 Web服务 </a> </li> <li class=md-nav__item> <a href=../08.1/ class=md-nav__link> 8.1 Socket编程 </a> </li> <li class=md-nav__item> <a href=../08.2/ class=md-nav__link> 8.2 WebSocket </a> </li> <li class=md-nav__item> <a href=../08.3/ class=md-nav__link> 8.3 REST </a> </li> <li class=md-nav__item> <a href=../08.4/ class=md-nav__link> 8.4 RPC </a> </li> <li class=md-nav__item> <a href=../08.5/ class=md-nav__link> 8.5 小结 </a> </li> <li class=md-nav__item> <a href=../09.0/ class=md-nav__link> 9 安全与加密 </a> </li> <li class=md-nav__item> <a href=../09.1/ class=md-nav__link> 9.1 预防CSRF攻击 </a> </li> <li class=md-nav__item> <a href=../09.2/ class=md-nav__link> 9.2 确保输入过滤 </a> </li> <li class=md-nav__item> <a href=../09.3/ class=md-nav__link> 9.3 避免XSS攻击 </a> </li> <li class=md-nav__item> <a href=../09.4/ class=md-nav__link> 9.4 避免SQL注入 </a> </li> <li class=md-nav__item> <a href=../09.5/ class=md-nav__link> 9.5 存储密码 </a> </li> <li class=md-nav__item> <a href=../09.6/ class=md-nav__link> 9.6 加密和解密数据 </a> </li> <li class=md-nav__item> <a href=../09.7/ class=md-nav__link> 9.7 小结 </a> </li> <li class=md-nav__item> <a href=../10.0/ class=md-nav__link> 10 国际化和本地化 </a> </li> <li class=md-nav__item> <a href=../10.1/ class=md-nav__link> 10.1 设置默认地区 </a> </li> <li class=md-nav__item> <a href=../10.2/ class=md-nav__link> 10.2 本地化资源 </a> </li> <li class=md-nav__item> <a href=../10.3/ class=md-nav__link> 10.3 国际化站点 </a> </li> <li class=md-nav__item> <a href=../10.4/ class=md-nav__link> 10.4 小结 </a> </li> <li class=md-nav__item> <a href=../11.0/ class=md-nav__link> 11 错误处理，调试和测试 </a> </li> <li class=md-nav__item> <a href=../11.1/ class=md-nav__link> 11.1 错误处理 </a> </li> <li class=md-nav__item> <a href=../11.2/ class=md-nav__link> 11.2 使用GDB调试 </a> </li> <li class=md-nav__item> <a href=../11.3/ class=md-nav__link> 11.3 Go怎么写测试用例 </a> </li> <li class=md-nav__item> <a href=../11.4/ class=md-nav__link> 11.4 小结 </a> </li> <li class=md-nav__item> <a href=../12.0/ class=md-nav__link> 12 部署与维护 </a> </li> <li class=md-nav__item> <a href=../12.1/ class=md-nav__link> 12.1 应用日志 </a> </li> <li class=md-nav__item> <a href=../12.2/ class=md-nav__link> 12.2 网站错误处理 </a> </li> <li class=md-nav__item> <a href=../12.3/ class=md-nav__link> 12.3 应用部署 </a> </li> <li class=md-nav__item> <a href=../12.4/ class=md-nav__link> 12.4 备份和恢复 </a> </li> <li class=md-nav__item> <a href=../12.5/ class=md-nav__link> 12.5 小结 </a> </li> <li class=md-nav__item> <a href=../13.0/ class=md-nav__link> 13 如何设计一个Web框架 </a> </li> <li class=md-nav__item> <a href=../13.1/ class=md-nav__link> 13.1 项目规划 </a> </li> <li class=md-nav__item> <a href=../13.2/ class=md-nav__link> 13.2 自定义路由器设计 </a> </li> <li class=md-nav__item> <a href=../13.3/ class=md-nav__link> 13.3 controller设计 </a> </li> <li class=md-nav__item> <a href=../13.4/ class=md-nav__link> 13.4 日志和配置设计 </a> </li> <li class=md-nav__item> <a href=../13.5/ class=md-nav__link> 13.5 实现博客的增删改 </a> </li> <li class=md-nav__item> <a href=../13.6/ class=md-nav__link> 13.6 小结 </a> </li> <li class=md-nav__item> <a href=../14.0/ class=md-nav__link> 14 扩展Web框架 </a> </li> <li class=md-nav__item> <a href=../14.1/ class=md-nav__link> 14.1 静态文件支持 </a> </li> <li class=md-nav__item> <a href=../14.2/ class=md-nav__link> 14.2 Session支持 </a> </li> <li class=md-nav__item> <a href=../14.3/ class=md-nav__link> 14.3 表单及验证支持 </a> </li> <li class=md-nav__item> <a href=../14.4/ class=md-nav__link> 14.4 用户认证 </a> </li> <li class=md-nav__item> <a href=../14.5/ class=md-nav__link> 14.5 多语言支持 </a> </li> <li class=md-nav__item> <a href=../14.6/ class=md-nav__link> 14.6 pprof支持 </a> </li> <li class=md-nav__item> <a href=../14.7/ class=md-nav__link> 14.7 小结 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 定义变量 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 常量 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 内置基础类型 </a> <nav class=md-nav aria-label=内置基础类型> <ul class=md-nav__list> <li class=md-nav__item> <a href=#boolean class=md-nav__link> Boolean </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 数值类型 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 字符串 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 错误类型 </a> </li> <li class=md-nav__item> <a href=#go class=md-nav__link> Go数据底层的存储 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 一些技巧 </a> <nav class=md-nav aria-label=一些技巧> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 分组声明 </a> </li> <li class=md-nav__item> <a href=#iota class=md-nav__link> iota枚举 </a> </li> <li class=md-nav__item> <a href=#go_1 class=md-nav__link> Go程序设计的一些规则 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#arrayslicemap class=md-nav__link> array、slice、map </a> <nav class=md-nav aria-label=array、slice、map> <ul class=md-nav__list> <li class=md-nav__item> <a href=#array class=md-nav__link> array </a> </li> <li class=md-nav__item> <a href=#slice class=md-nav__link> slice </a> </li> <li class=md-nav__item> <a href=#map class=md-nav__link> map </a> </li> <li class=md-nav__item> <a href=#makenew class=md-nav__link> make、new操作 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 零值 </a> </li> <li class=md-nav__item> <a href=#links class=md-nav__link> links </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=22-go>2.2 Go基础<a class=headerlink href=#22-go title="Permanent link"> ¶</a></h1> <p>这小节我们将要介绍如何定义变量、常量、Go内置类型以及Go程序设计中的一些技巧。</p> <h2 id=_1>定义变量<a class=headerlink href=#_1 title="Permanent link"> ¶</a></h2> <p>Go语言里面定义变量有多种方式。</p> <p>使用<code>var</code>关键字是Go最基本的定义变量方式，与C语言不同的是Go把变量类型放在变量名后面： <div class=highlight><pre><span></span><code><span class=c1>//定义一个名称为“variableName”，类型为&quot;type&quot;的变量</span>
<span class=kd>var</span><span class=w> </span><span class=nx>variableName</span><span class=w> </span><span class=kd>type</span>
</code></pre></div> 定义多个变量 <div class=highlight><pre><span></span><code><span class=c1>//定义三个类型都是“type”的变量</span>
<span class=kd>var</span><span class=w> </span><span class=nx>vname1</span><span class=p>,</span><span class=w> </span><span class=nx>vname2</span><span class=p>,</span><span class=w> </span><span class=nx>vname3</span><span class=w> </span><span class=kd>type</span>
</code></pre></div> 定义变量并初始化值 <div class=highlight><pre><span></span><code><span class=c1>//初始化“variableName”的变量为“value”值，类型是“type”</span>
<span class=kd>var</span><span class=w> </span><span class=nx>variableName</span><span class=w> </span><span class=kd>type</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>value</span>
</code></pre></div> 同时初始化多个变量 <div class=highlight><pre><span></span><code><span class=cm>/*</span>
<span class=cm>    定义三个类型都是&quot;type&quot;的变量,并且分别初始化为相应的值</span>
<span class=cm>    vname1为v1，vname2为v2，vname3为v3</span>
<span class=cm>*/</span>
<span class=kd>var</span><span class=w> </span><span class=nx>vname1</span><span class=p>,</span><span class=w> </span><span class=nx>vname2</span><span class=p>,</span><span class=w> </span><span class=nx>vname3</span><span class=w> </span><span class=kd>type</span><span class=p>=</span><span class=w> </span><span class=nx>v1</span><span class=p>,</span><span class=w> </span><span class=nx>v2</span><span class=p>,</span><span class=w> </span><span class=nx>v3</span>
</code></pre></div> 你是不是觉得上面这样的定义有点繁琐？没关系，因为Go语言的设计者也发现了，有一种写法可以让它变得简单一点。我们可以直接忽略类型声明，那么上面的代码变成这样了： <div class=highlight><pre><span></span><code><span class=cm>/*</span>
<span class=cm>    定义三个变量，它们分别初始化为相应的值</span>
<span class=cm>    vname1为v1，vname2为v2，vname3为v3</span>
<span class=cm>    然后Go会根据其相应值的类型来帮你初始化它们</span>
<span class=cm>*/</span>
<span class=kd>var</span><span class=w> </span><span class=nx>vname1</span><span class=p>,</span><span class=w> </span><span class=nx>vname2</span><span class=p>,</span><span class=w> </span><span class=nx>vname3</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>v1</span><span class=p>,</span><span class=w> </span><span class=nx>v2</span><span class=p>,</span><span class=w> </span><span class=nx>v3</span>
</code></pre></div> 你觉得上面的还是有些繁琐？好吧，我也觉得。让我们继续简化： <div class=highlight><pre><span></span><code><span class=cm>/*</span>
<span class=cm>    定义三个变量，它们分别初始化为相应的值</span>
<span class=cm>    vname1为v1，vname2为v2，vname3为v3</span>
<span class=cm>    编译器会根据初始化的值自动推导出相应的类型</span>
<span class=cm>*/</span>
<span class=nx>vname1</span><span class=p>,</span><span class=w> </span><span class=nx>vname2</span><span class=p>,</span><span class=w> </span><span class=nx>vname3</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>v1</span><span class=p>,</span><span class=w> </span><span class=nx>v2</span><span class=p>,</span><span class=w> </span><span class=nx>v3</span>
</code></pre></div> 现在是不是看上去非常简洁了？<code>:=</code>这个符号直接取代了<code>var</code>和<code>type</code>,这种形式叫做简短声明。不过它有一个限制，那就是它只能用在函数内部；在函数外部使用则会无法编译通过，所以一般用<code>var</code>方式来定义全局变量。</p> <p><code>_</code>（下划线）是个特殊的变量名，任何赋予它的值都会被丢弃。在这个例子中，我们将值<code>35</code>赋予<code>b</code>，并同时丢弃<code>34</code>：</p> <div class=highlight><pre><span></span><code>_, b := 34, 35
</code></pre></div> <p>Go对于已声明但未使用的变量会在编译阶段报错，比如下面的代码就会产生一个错误：声明了<code>i</code>但未使用。 <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>main</span>

<span class=kd>func</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=kt>int</span>
<span class=p>}</span>
</code></pre></div></p> <h2 id=_2>常量<a class=headerlink href=#_2 title="Permanent link"> ¶</a></h2> <p>所谓常量，也就是在程序编译阶段就确定下来的值，而程序在运行时无法改变该值。在Go程序中，常量可定义为数值、布尔值或字符串等类型。</p> <p>它的语法如下： <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>constantName</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>value</span>
<span class=c1>//如果需要，也可以明确指定常量的类型：</span>
<span class=kd>const</span><span class=w> </span><span class=nx>Pi</span><span class=w> </span><span class=kt>float32</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mf>3.1415926</span>
</code></pre></div> 下面是一些常量声明的例子： <div class=highlight><pre><span></span><code><span class=kd>const</span><span class=w> </span><span class=nx>Pi</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mf>3.1415926</span>
<span class=kd>const</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>10000</span>
<span class=kd>const</span><span class=w> </span><span class=nx>MaxThread</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>10</span>
<span class=kd>const</span><span class=w> </span><span class=nx>prefix</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;astaxie_&quot;</span>
</code></pre></div> Go 常量和一般程序语言不同的是，可以指定相当多的小数位数(例如200位)， 若指定給float32自动缩短为32bit，指定给float64自动缩短为64bit，详情参考<a href=http://golang.org/ref/spec#Constants>链接</a></p> <h2 id=_3>内置基础类型<a class=headerlink href=#_3 title="Permanent link"> ¶</a></h2> <h3 id=boolean>Boolean<a class=headerlink href=#boolean title="Permanent link"> ¶</a></h3> <p>在Go中，布尔值的类型为<code>bool</code>，值是<code>true</code>或<code>false</code>，默认为<code>false</code>。 <div class=highlight><pre><span></span><code><span class=c1>//示例代码</span>
<span class=kd>var</span><span class=w> </span><span class=nx>isActive</span><span class=w> </span><span class=kt>bool</span><span class=w>  </span><span class=c1>// 全局变量声明</span>
<span class=kd>var</span><span class=w> </span><span class=nx>enabled</span><span class=p>,</span><span class=w> </span><span class=nx>disabled</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=w>  </span><span class=c1>// 忽略类型的声明</span>
<span class=kd>func</span><span class=w> </span><span class=nx>test</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>available</span><span class=w> </span><span class=kt>bool</span><span class=w>  </span><span class=c1>// 一般声明</span>
<span class=w>    </span><span class=nx>valid</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kc>false</span><span class=w>      </span><span class=c1>// 简短声明</span>
<span class=w>    </span><span class=nx>available</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span><span class=w>    </span><span class=c1>// 赋值操作</span>
<span class=p>}</span>
</code></pre></div></p> <h3 id=_4>数值类型<a class=headerlink href=#_4 title="Permanent link"> ¶</a></h3> <p>整数类型有无符号和带符号两种。Go同时支持<code>int</code>和<code>uint</code>，这两种类型的长度相同，但具体长度取决于不同编译器的实现。Go里面也有直接定义好位数的类型：<code>rune</code>, <code>int8</code>, <code>int16</code>, <code>int32</code>, <code>int64</code>和<code>byte</code>, <code>uint8</code>, <code>uint16</code>, <code>uint32</code>, <code>uint64</code>。其中<code>rune</code>是<code>int32</code>的别称，<code>byte</code>是<code>uint8</code>的别称。</p> <blockquote> <p>需要注意的一点是，这些类型的变量之间不允许互相赋值或操作，不然会在编译时引起编译器报错。</p> <p>如下的代码会产生错误：invalid operation: a + b (mismatched types int8 and int32)</p> <blockquote> <p>var a int8</p> <p>var b int32</p> <p>c:=a + b</p> </blockquote> <p>另外，尽管int的长度是32 bit, 但int 与 int32并不可以互用。</p> </blockquote> <p>浮点数的类型有<code>float32</code>和<code>float64</code>两种（没有<code>float</code>类型），默认是<code>float64</code>。</p> <p>这就是全部吗？No！Go还支持复数。它的默认类型是<code>complex128</code>（64位实数+64位虚数）。如果需要小一些的，也有<code>complex64</code>(32位实数+32位虚数)。复数的形式为<code>RE + IMi</code>，其中<code>RE</code>是实数部分，<code>IM</code>是虚数部分，而最后的<code>i</code>是虚数单位。下面是一个使用复数的例子： <div class=highlight><pre><span></span><code><span class=kd>var</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=kt>complex64</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>5</span><span class=o>+</span><span class=m>5i</span>
<span class=c1>//output: (5+5i)</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;Value is: %v&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=p>)</span>
</code></pre></div></p> <h3 id=_5>字符串<a class=headerlink href=#_5 title="Permanent link"> ¶</a></h3> <p>我们在上一节中讲过，Go中的字符串都是采用<code>UTF-8</code>字符集编码。字符串是用一对双引号（<code>""</code>）或反引号（<code>`</code> <code>`</code>）括起来定义，它的类型是<code>string</code>。 <div class=highlight><pre><span></span><code><span class=c1>//示例代码</span>
<span class=kd>var</span><span class=w> </span><span class=nx>frenchHello</span><span class=w> </span><span class=kt>string</span><span class=w>  </span><span class=c1>// 声明变量为字符串的一般方法</span>
<span class=kd>var</span><span class=w> </span><span class=nx>emptyString</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=w>  </span><span class=c1>// 声明了一个字符串变量，初始化为空字符串</span>
<span class=kd>func</span><span class=w> </span><span class=nx>test</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>no</span><span class=p>,</span><span class=w> </span><span class=nx>yes</span><span class=p>,</span><span class=w> </span><span class=nx>maybe</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;no&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;yes&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;maybe&quot;</span><span class=w>  </span><span class=c1>// 简短声明，同时声明多个变量</span>
<span class=w>    </span><span class=nx>japaneseHello</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;Konichiwa&quot;</span><span class=w>  </span><span class=c1>// 同上</span>
<span class=w>    </span><span class=nx>frenchHello</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;Bonjour&quot;</span><span class=w>  </span><span class=c1>// 常规赋值</span>
<span class=p>}</span>
</code></pre></div> 在Go中字符串是不可变的，例如下面的代码编译时会报错：cannot assign to s[0] <div class=highlight><pre><span></span><code><span class=kd>var</span><span class=w> </span><span class=nx>s</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;hello&quot;</span>
<span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=sc>&#39;c&#39;</span>
</code></pre></div> 但如果真的想要修改怎么办呢？下面的代码可以实现： <div class=highlight><pre><span></span><code><span class=nx>s</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;hello&quot;</span>
<span class=nx>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span><span class=w>  </span><span class=c1>// 将字符串 s 转换为 []byte 类型</span>
<span class=nx>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=sc>&#39;c&#39;</span>
<span class=nx>s2</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>string</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span><span class=w>  </span><span class=c1>// 再转换回 string 类型</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;%s\n&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>s2</span><span class=p>)</span>
</code></pre></div></p> <p>Go中可以使用<code>+</code>操作符来连接两个字符串： <div class=highlight><pre><span></span><code><span class=nx>s</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;hello,&quot;</span>
<span class=nx>m</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot; world&quot;</span>
<span class=nx>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>m</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;%s\n&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>a</span><span class=p>)</span>
</code></pre></div> 修改字符串也可写为： <div class=highlight><pre><span></span><code><span class=nx>s</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;hello&quot;</span>
<span class=nx>s</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;c&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>s</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span><span class=w> </span><span class=c1>// 字符串虽不能更改，但可进行切片操作</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;%s\n&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=p>)</span>
</code></pre></div> 如果要声明一个多行的字符串怎么办？可以通过<code>`</code>来声明：</p> <div class=highlight><pre><span></span><code>m := `hello
    world`
</code></pre></div> <p><code>`</code> 括起的字符串为Raw字符串，即字符串在代码中的形式就是打印时的形式，它没有字符转义，换行也将原样输出。例如本例中会输出：</p> <div class=highlight><pre><span></span><code>hello
    world
</code></pre></div> <h3 id=_6>错误类型<a class=headerlink href=#_6 title="Permanent link"> ¶</a></h3> <p>Go内置有一个<code>error</code>类型，专门用来处理错误信息，Go的<code>package</code>里面还专门有一个包<code>errors</code>来处理错误： <div class=highlight><pre><span></span><code><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>errors</span><span class=p>.</span><span class=nx>New</span><span class=p>(</span><span class=s>&quot;emit macho dwarf: elf header corrupted&quot;</span><span class=p>)</span>
<span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Print</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></p> <h3 id=go>Go数据底层的存储<a class=headerlink href=#go title="Permanent link"> ¶</a></h3> <p>下面这张图来源于<a href=http://research.swtch.com/ >Russ Cox Blog</a>中一篇介绍<a href=http://research.swtch.com/godata>Go数据结构</a>的文章，大家可以看到这些基础类型底层都是分配了一块内存，然后存储了相应的值。</p> <p><img alt src="../images/2.2.basic.png?raw=true"></p> <p>图2.1 Go数据格式的存储</p> <h2 id=_7>一些技巧<a class=headerlink href=#_7 title="Permanent link"> ¶</a></h2> <h3 id=_8>分组声明<a class=headerlink href=#_8 title="Permanent link"> ¶</a></h3> <p>在Go语言中，同时声明多个常量、变量，或者导入多个包时，可采用分组的方式进行声明。</p> <p>例如下面的代码： <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=s>&quot;fmt&quot;</span>
<span class=kn>import</span><span class=w> </span><span class=s>&quot;os&quot;</span>

<span class=kd>const</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>100</span>
<span class=kd>const</span><span class=w> </span><span class=nx>pi</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mf>3.1415</span>
<span class=kd>const</span><span class=w> </span><span class=nx>prefix</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;Go_&quot;</span>

<span class=kd>var</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=kt>int</span>
<span class=kd>var</span><span class=w> </span><span class=nx>pi</span><span class=w> </span><span class=kt>float32</span>
<span class=kd>var</span><span class=w> </span><span class=nx>prefix</span><span class=w> </span><span class=kt>string</span>
</code></pre></div> 可以分组写成如下形式： <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;fmt&quot;</span>
<span class=w>    </span><span class=s>&quot;os&quot;</span>
<span class=p>)</span>

<span class=kd>const</span><span class=p>(</span>
<span class=w>    </span><span class=nx>i</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>100</span>
<span class=w>    </span><span class=nx>pi</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mf>3.1415</span>
<span class=w>    </span><span class=nx>prefix</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;Go_&quot;</span>
<span class=p>)</span>

<span class=kd>var</span><span class=p>(</span>
<span class=w>    </span><span class=nx>i</span><span class=w> </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>pi</span><span class=w> </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>prefix</span><span class=w> </span><span class=kt>string</span>
<span class=p>)</span>
</code></pre></div></p> <h3 id=iota>iota枚举<a class=headerlink href=#iota title="Permanent link"> ¶</a></h3> <p>Go里面有一个关键字<code>iota</code>，这个关键字用来声明<code>enum</code>的时候采用，它默认开始值是0，const中每增加一行加1： <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>main</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;fmt&quot;</span>
<span class=p>)</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>x</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>// x == 0</span>
<span class=w>    </span><span class=nx>y</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>// y == 1</span>
<span class=w>    </span><span class=nx>z</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>// z == 2</span>
<span class=w>    </span><span class=nx>w</span><span class=w>        </span><span class=c1>// 常量声明省略值时，默认和之前一个值的字面相同。这里隐式地说w = iota，因此w == 3。其实上面y和z可同样不用&quot;= iota&quot;</span>
<span class=p>)</span>

<span class=kd>const</span><span class=w> </span><span class=nx>v</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>// 每遇到一个const关键字，iota就会重置，此时v == 0</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>h</span><span class=p>,</span><span class=w> </span><span class=nx>i</span><span class=p>,</span><span class=w> </span><span class=nx>j</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=p>,</span><span class=w> </span><span class=kc>iota</span><span class=p>,</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>//h=0,i=0,j=0 iota在同一行值相同</span>
<span class=p>)</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>a</span><span class=w>       </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>//a=0</span>
<span class=w>    </span><span class=nx>b</span><span class=w>       </span><span class=p>=</span><span class=w> </span><span class=s>&quot;B&quot;</span>
<span class=w>    </span><span class=nx>c</span><span class=w>       </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w>             </span><span class=c1>//c=2</span>
<span class=w>    </span><span class=nx>d</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>,</span><span class=w> </span><span class=nx>f</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=p>,</span><span class=w> </span><span class=kc>iota</span><span class=p>,</span><span class=w> </span><span class=kc>iota</span><span class=w> </span><span class=c1>//d=3,e=3,f=3</span>
<span class=w>    </span><span class=nx>g</span><span class=w>       </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span><span class=w>             </span><span class=c1>//g = 4</span>
<span class=p>)</span>

<span class=kd>func</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=p>,</span><span class=w> </span><span class=nx>d</span><span class=p>,</span><span class=w> </span><span class=nx>e</span><span class=p>,</span><span class=w> </span><span class=nx>f</span><span class=p>,</span><span class=w> </span><span class=nx>g</span><span class=p>,</span><span class=w> </span><span class=nx>h</span><span class=p>,</span><span class=w> </span><span class=nx>i</span><span class=p>,</span><span class=w> </span><span class=nx>j</span><span class=p>,</span><span class=w> </span><span class=nx>x</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=p>,</span><span class=w> </span><span class=nx>z</span><span class=p>,</span><span class=w> </span><span class=nx>w</span><span class=p>,</span><span class=w> </span><span class=nx>v</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></p> <blockquote> <p>除非被显式设置为其它值或<code>iota</code>，每个<code>const</code>分组的第一个常量被默认设置为它的0值，第二及后续的常量被默认设置为它前面那个常量的值，如果前面那个常量的值是<code>iota</code>，则它也被设置为<code>iota</code>。</p> </blockquote> <h3 id=go_1>Go程序设计的一些规则<a class=headerlink href=#go_1 title="Permanent link"> ¶</a></h3> <p>Go之所以会那么简洁，是因为它有一些默认的行为： - 大写字母开头的变量是可导出的，也就是其它包可以读取的，是公有变量；小写字母开头的就是不可导出的，是私有变量。 - 大写字母开头的函数也是一样，相当于<code>class</code>中的带<code>public</code>关键词的公有函数；小写字母开头的就是有<code>private</code>关键词的私有函数。</p> <h2 id=arrayslicemap>array、slice、map<a class=headerlink href=#arrayslicemap title="Permanent link"> ¶</a></h2> <h3 id=array>array<a class=headerlink href=#array title="Permanent link"> ¶</a></h3> <p><code>array</code>就是数组，它的定义方式如下： <div class=highlight><pre><span></span><code><span class=kd>var</span><span class=w> </span><span class=nx>arr</span><span class=w> </span><span class=p>[</span><span class=nx>n</span><span class=p>]</span><span class=kd>type</span>
</code></pre></div> 在<code>[n]type</code>中，<code>n</code>表示数组的长度，<code>type</code>表示存储元素的类型。对数组的操作和其它语言类似，都是通过<code>[]</code>来进行读取或赋值： <div class=highlight><pre><span></span><code><span class=kd>var</span><span class=w> </span><span class=nx>arr</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=w>  </span><span class=c1>// 声明了一个int类型的数组</span>
<span class=nx>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>42</span><span class=w>      </span><span class=c1>// 数组下标是从0开始的</span>
<span class=nx>arr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>13</span><span class=w>      </span><span class=c1>// 赋值操作</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;The first element is %d\n&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w>  </span><span class=c1>// 获取数据，返回42</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nx>Printf</span><span class=p>(</span><span class=s>&quot;The last element is %d\n&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>arr</span><span class=p>[</span><span class=mi>9</span><span class=p>])</span><span class=w> </span><span class=c1>//返回未赋值的最后一个元素，默认返回0</span>
</code></pre></div> 由于长度也是数组类型的一部分，因此<code>[3]int</code>与<code>[4]int</code>是不同的类型，数组也就不能改变长度。数组之间的赋值是值的赋值，即当把一个数组作为参数传入函数的时候，传入的其实是该数组的副本，而不是它的指针。如果要使用指针，那么就需要用到后面介绍的<code>slice</code>类型了。</p> <p>数组可以使用另一种<code>:=</code>来声明 <div class=highlight><pre><span></span><code><span class=nx>a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>}</span><span class=w> </span><span class=c1>// 声明了一个长度为3的int数组</span>

<span class=nx>b</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>}</span><span class=w> </span><span class=c1>// 声明了一个长度为10的int数组，其中前三个元素初始化为1、2、3，其它默认为0</span>

<span class=nx>c</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>}</span><span class=w> </span><span class=c1>// 可以省略长度而采用`...`的方式，Go会自动根据元素个数来计算长度</span>
</code></pre></div> 也许你会说，我想数组里面的值还是数组，能实现吗？当然咯，Go支持嵌套数组，即多维数组。比如下面的代码就声明了一个二维数组： <div class=highlight><pre><span></span><code><span class=c1>// 声明了一个二维数组，该数组以两个数组作为元素，其中每个数组中又有4个int类型的元素</span>
<span class=nx>doubleArray</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>4</span><span class=p>]</span><span class=kt>int</span><span class=p>{[</span><span class=mi>4</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>}}</span>

<span class=c1>// 上面的声明可以简化，直接忽略内部的类型</span>
<span class=nx>easyArray</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>4</span><span class=p>]</span><span class=kt>int</span><span class=p>{{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>}}</span>
</code></pre></div> 数组的分配如下所示：</p> <p><img alt src="../images/2.2.array.png?raw=true"></p> <p>图2.2 多维数组的映射关系</p> <h3 id=slice>slice<a class=headerlink href=#slice title="Permanent link"> ¶</a></h3> <p>在很多应用场景中，数组并不能满足我们的需求。在初始定义数组时，我们并不知道需要多大的数组，因此我们就需要“动态数组”。在Go里面这种数据结构叫<code>slice</code></p> <p><code>slice</code>并不是真正意义上的动态数组，而是一个引用类型。<code>slice</code>总是指向一个底层<code>array</code>，<code>slice</code>的声明也可以像<code>array</code>一样，只是不需要长度。 <div class=highlight><pre><span></span><code><span class=c1>// 和声明array一样，只是少了长度</span>
<span class=kd>var</span><span class=w> </span><span class=nx>fslice</span><span class=w> </span><span class=p>[]</span><span class=kt>int</span>
</code></pre></div> 接下来我们可以声明一个<code>slice</code>，并初始化数据，如下所示： <div class=highlight><pre><span></span><code><span class=nx>slice</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;d&#39;</span><span class=p>}</span>
</code></pre></div> <code>slice</code>可以从一个数组或一个已经存在的<code>slice</code>中再次声明。<code>slice</code>通过<code>array[i:j]</code>来获取，其中<code>i</code>是数组的开始位置，<code>j</code>是结束位置，但不包含<code>array[j]</code>，它的长度是<code>j-i</code>。 <div class=highlight><pre><span></span><code><span class=c1>// 声明一个含有10个元素元素类型为byte的数组</span>
<span class=kd>var</span><span class=w> </span><span class=nx>ar</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>byte</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;d&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;e&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;f&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;g&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;h&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;i&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;j&#39;</span><span class=p>}</span>

<span class=c1>// 声明两个含有byte的slice</span>
<span class=kd>var</span><span class=w> </span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span>

<span class=c1>// a指向数组的第3个元素开始，并到第五个元素结束，</span>
<span class=nx>a</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>ar</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
<span class=c1>//现在a含有的元素: ar[2]、ar[3]和ar[4]</span>

<span class=c1>// b是数组ar的另一个slice</span>
<span class=nx>b</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>ar</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
<span class=c1>// b的元素是：ar[3]和ar[4]</span>
</code></pre></div></p> <blockquote> <p>注意<code>slice</code>和数组在声明时的区别：声明数组时，方括号内写明了数组的长度或使用<code>...</code>自动计算长度，而声明<code>slice</code>时，方括号内没有任何字符。</p> </blockquote> <p>它们的数据结构如下所示</p> <p><img alt src="../images/2.2.slice.png?raw=true"></p> <p>图2.3 slice和array的对应关系图</p> <p>slice有一些简便的操作</p> <ul> <li><code>slice</code>的默认开始位置是0，<code>ar[:n]</code>等价于<code>ar[0:n]</code></li> <li><code>slice</code>的第二个序列默认是数组的长度，<code>ar[n:]</code>等价于<code>ar[n:len(ar)]</code></li> <li>如果从一个数组里面直接获取<code>slice</code>，可以这样<code>ar[:]</code>，因为默认第一个序列是0，第二个是数组的长度，即等价于<code>ar[0:len(ar)]</code></li> </ul> <p>下面这个例子展示了更多关于<code>slice</code>的操作： <div class=highlight><pre><span></span><code><span class=c1>// 声明一个数组</span>
<span class=kd>var</span><span class=w> </span><span class=nx>array</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>byte</span><span class=p>{</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;d&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;e&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;f&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;g&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;h&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;i&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;j&#39;</span><span class=p>}</span>
<span class=c1>// 声明两个slice</span>
<span class=kd>var</span><span class=w> </span><span class=nx>aSlice</span><span class=p>,</span><span class=w> </span><span class=nx>bSlice</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span>

<span class=c1>// 演示一些简便操作</span>
<span class=nx>aSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>array</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=c1>// 等价于aSlice = array[0:3] aSlice包含元素: a,b,c</span>
<span class=nx>aSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>array</span><span class=p>[</span><span class=mi>5</span><span class=p>:]</span><span class=w> </span><span class=c1>// 等价于aSlice = array[5:10] aSlice包含元素: f,g,h,i,j</span>
<span class=nx>aSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>array</span><span class=p>[:]</span><span class=w>  </span><span class=c1>// 等价于aSlice = array[0:10] 这样aSlice包含了全部的元素</span>

<span class=c1>// 从slice中获取slice</span>
<span class=nx>aSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>array</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span><span class=w>  </span><span class=c1>// aSlice包含元素: d,e,f,g，len=4，cap=7</span>
<span class=nx>bSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>aSlice</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=c1>// bSlice 包含aSlice[1], aSlice[2] 也就是含有: e,f</span>
<span class=nx>bSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>aSlice</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span><span class=w>  </span><span class=c1>// bSlice 包含 aSlice[0], aSlice[1], aSlice[2] 也就是含有: d,e,f</span>
<span class=nx>bSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>aSlice</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=c1>// 对slice的slice可以在cap范围内扩展，此时bSlice包含：d,e,f,g,h</span>
<span class=nx>bSlice</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>aSlice</span><span class=p>[:]</span><span class=w>   </span><span class=c1>// bSlice包含所有aSlice的元素: d,e,f,g</span>
</code></pre></div> <code>slice</code>是引用类型，所以当引用改变其中元素的值时，其它的所有引用都会改变该值，例如上面的<code>aSlice</code>和<code>bSlice</code>，如果修改了<code>aSlice</code>中元素的值，那么<code>bSlice</code>相对应的值也会改变。</p> <p>从概念上面来说<code>slice</code>像一个结构体，这个结构体包含了三个元素： - 一个指针，指向数组中<code>slice</code>指定的开始位置 - 长度，即<code>slice</code>的长度 - 最大长度，也就是<code>slice</code>开始位置到数组的最后位置的长度 <div class=highlight><pre><span></span><code><span class=w>    </span><span class=nx>Array_a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>byte</span><span class=p>{</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;d&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;e&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;f&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;g&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;h&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;i&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;j&#39;</span><span class=p>}</span>
<span class=w>    </span><span class=nx>Slice_a</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>Array_a</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span>
</code></pre></div> 上面代码的真正存储结构如下图所示</p> <p><img alt src="../images/2.2.slice2.png?raw=true"></p> <p>图2.4 slice对应数组的信息</p> <p>对于<code>slice</code>有几个有用的内置函数：</p> <ul> <li><code>len</code> 获取<code>slice</code>的长度</li> <li><code>cap</code> 获取<code>slice</code>的最大容量</li> <li><code>append</code> 向<code>slice</code>里面追加一个或者多个元素，然后返回一个和<code>slice</code>一样类型的<code>slice</code></li> <li><code>copy</code> 函数<code>copy</code>从源<code>slice</code>的<code>src</code>中复制元素到目标<code>dst</code>，并且返回复制的元素的个数</li> </ul> <p>注：<code>append</code>函数会改变<code>slice</code>所引用的数组的内容，从而影响到引用同一数组的其它<code>slice</code>。 但当<code>slice</code>中没有剩余空间（即<code>(cap-len) == 0</code>）时，此时将动态分配新的数组空间。返回的<code>slice</code>数组指针将指向这个空间，而原数组的内容将保持不变；其它引用此数组的<code>slice</code>则不受影响。</p> <p>从Go1.2开始slice支持了三个参数的slice，之前我们一直采用这种方式在slice或者array基础上来获取一个slice <div class=highlight><pre><span></span><code><span class=kd>var</span><span class=w> </span><span class=nx>array</span><span class=w> </span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=kt>int</span>
<span class=nx>slice</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>array</span><span class=p>[</span><span class=mi>2</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span>
</code></pre></div> 这个例子里面slice的容量是8，新版本里面可以指定这个容量</p> <div class=highlight><pre><span></span><code>slice = array[2:4:7]
</code></pre></div> <p>上面这个的容量就是<code>7-2</code>，即5。这样这个产生的新的slice就没办法访问最后的三个元素。</p> <p>如果slice是这样的形式<code>array[:i:j]</code>，即第一个参数为空，默认值就是0。</p> <h3 id=map>map<a class=headerlink href=#map title="Permanent link"> ¶</a></h3> <p><code>map</code>也就是Python中字典的概念，它的格式为<code>map[keyType]valueType</code></p> <p>我们看下面的代码，<code>map</code>的读取和设置也类似<code>slice</code>一样，通过<code>key</code>来操作，只是<code>slice</code>的<code>index</code>只能是｀int｀类型，而<code>map</code>多了很多类型，可以是<code>int</code>，可以是<code>string</code>及所有完全定义了<code>==</code>与<code>!=</code>操作的类型。 <div class=highlight><pre><span></span><code><span class=c1>// 声明一个key是字符串，值为int的字典,这种方式的声明需要在使用之前使用make初始化</span>
<span class=kd>var</span><span class=w> </span><span class=nx>numbers</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span>
<span class=c1>// 另一种map的声明方式</span>
<span class=nx>numbers</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>)</span>
<span class=nx>numbers</span><span class=p>[</span><span class=s>&quot;one&quot;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=c1>//赋值</span>
<span class=nx>numbers</span><span class=p>[</span><span class=s>&quot;ten&quot;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=c1>//赋值</span>
<span class=nx>numbers</span><span class=p>[</span><span class=s>&quot;three&quot;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=mi>3</span>

<span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;第三个数字是: &quot;</span><span class=p>,</span><span class=w> </span><span class=nx>numbers</span><span class=p>[</span><span class=s>&quot;three&quot;</span><span class=p>])</span><span class=w> </span><span class=c1>// 读取数据</span>
<span class=c1>// 打印出来如:第三个数字是: 3</span>
</code></pre></div></p> <p>这个<code>map</code>就像我们平常看到的表格一样，左边列是<code>key</code>，右边列是值</p> <p>使用map过程中需要注意的几点： - <code>map</code>是无序的，每次打印出来的<code>map</code>都会不一样，它不能通过<code>index</code>获取，而必须通过<code>key</code>获取 - <code>map</code>的长度是不固定的，也就是和<code>slice</code>一样，也是一种引用类型 - 内置的<code>len</code>函数同样适用于<code>map</code>，返回<code>map</code>拥有的<code>key</code>的数量 - <code>map</code>的值可以很方便的修改，通过<code>numbers["one"]=11</code>可以很容易的把key为<code>one</code>的字典值改为<code>11</code> - <code>map</code>和其他基本型别不同，它不是thread-safe，在多个go-routine存取时，必须使用mutex lock机制</p> <p><code>map</code>的初始化可以通过<code>key:val</code>的方式初始化值，同时<code>map</code>内置有判断是否存在<code>key</code>的方式</p> <p>通过<code>delete</code>删除<code>map</code>的元素：</p> <p><div class=highlight><pre><span></span><code><span class=c1>// 初始化一个字典</span>
<span class=nx>rating</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>float32</span><span class=p>{</span><span class=s>&quot;C&quot;</span><span class=p>:</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Go&quot;</span><span class=p>:</span><span class=mf>4.5</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Python&quot;</span><span class=p>:</span><span class=mf>4.5</span><span class=p>,</span><span class=w> </span><span class=s>&quot;C++&quot;</span><span class=p>:</span><span class=mi>2</span><span class=w> </span><span class=p>}</span>
<span class=c1>// map有两个返回值，第二个返回值，如果不存在key，那么ok为false，如果存在ok为true</span>
<span class=nx>csharpRating</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>rating</span><span class=p>[</span><span class=s>&quot;C#&quot;</span><span class=p>]</span>
<span class=k>if</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;C# is in the map and its rating is &quot;</span><span class=p>,</span><span class=w> </span><span class=nx>csharpRating</span><span class=p>)</span>
<span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Println</span><span class=p>(</span><span class=s>&quot;We have no rating associated with C# in the map&quot;</span><span class=p>)</span>
<span class=p>}</span>

<span class=nb>delete</span><span class=p>(</span><span class=nx>rating</span><span class=p>,</span><span class=w> </span><span class=s>&quot;C&quot;</span><span class=p>)</span><span class=w>  </span><span class=c1>// 删除key为C的元素</span>
</code></pre></div> 上面说过了，<code>map</code>也是一种引用类型，如果两个<code>map</code>同时指向一个底层，那么一个改变，另一个也相应的改变： <div class=highlight><pre><span></span><code><span class=nx>m</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
<span class=nx>m</span><span class=p>[</span><span class=s>&quot;Hello&quot;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;Bonjour&quot;</span>
<span class=nx>m1</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>m</span>
<span class=nx>m1</span><span class=p>[</span><span class=s>&quot;Hello&quot;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;Salut&quot;</span><span class=w>  </span><span class=c1>// 现在m[&quot;hello&quot;]的值已经是Salut了</span>
</code></pre></div></p> <h3 id=makenew>make、new操作<a class=headerlink href=#makenew title="Permanent link"> ¶</a></h3> <p><code>make</code>用于内建类型（<code>map</code>、<code>slice</code> 和<code>channel</code>）的内存分配。<code>new</code>用于各种类型的内存分配。</p> <p>内建函数<code>new</code>本质上说跟其它语言中的同名函数功能一样：<code>new(T)</code>分配了零值填充的<code>T</code>类型的内存空间，并且返回其地址，即一个<code>*T</code>类型的值。用Go的术语说，它返回了一个指针，指向新分配的类型<code>T</code>的零值。有一点非常重要：</p> <blockquote> <p><code>new</code>返回指针。</p> </blockquote> <p>内建函数<code>make(T, args)</code>与<code>new(T)</code>有着不同的功能，make只能创建<code>slice</code>、<code>map</code>和<code>channel</code>，并且返回一个有初始值(非零)的<code>T</code>类型，而不是<code>*T</code>。本质来讲，导致这三个类型有所不同的原因是指向数据结构的引用在使用前必须被初始化。例如，一个<code>slice</code>，是一个包含指向数据（内部<code>array</code>）的指针、长度和容量的三项描述符；在这些项目被初始化之前，<code>slice</code>为<code>nil</code>。对于<code>slice</code>、<code>map</code>和<code>channel</code>来说，<code>make</code>初始化了内部的数据结构，填充适当的值。</p> <blockquote> <p><code>make</code>返回初始化后的（非零）值。</p> </blockquote> <p>下面这个图详细的解释了<code>new</code>和<code>make</code>之间的区别。</p> <p><img alt src="../images/2.2.makenew.png?raw=true"></p> <p>图2.5 make和new对应底层的内存分配</p> <h2 id=_9>零值<a class=headerlink href=#_9 title="Permanent link"> ¶</a></h2> <p>关于“零值”，所指并非是空值，而是一种“变量未填充前”的默认值，通常为0。 此处罗列 部分类型 的 “零值” <div class=highlight><pre><span></span><code><span class=kt>int</span><span class=w>     </span><span class=mi>0</span>
<span class=kt>int8</span><span class=w>    </span><span class=mi>0</span>
<span class=kt>int32</span><span class=w>   </span><span class=mi>0</span>
<span class=kt>int64</span><span class=w>   </span><span class=mi>0</span>
<span class=kt>uint</span><span class=w>    </span><span class=mh>0x0</span>
<span class=kt>rune</span><span class=w>    </span><span class=mi>0</span><span class=w> </span><span class=c1>//rune的实际类型是 int32</span>
<span class=kt>byte</span><span class=w>    </span><span class=mh>0x0</span><span class=w> </span><span class=c1>// byte的实际类型是 uint8</span>
<span class=kt>float32</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=c1>//长度为 4 byte</span>
<span class=kt>float64</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=c1>//长度为 8 byte</span>
<span class=kt>bool</span><span class=w>    </span><span class=kc>false</span>
<span class=kt>string</span><span class=w>  </span><span class=s>&quot;&quot;</span>
</code></pre></div></p> <h2 id=links>links<a class=headerlink href=#links title="Permanent link"> ¶</a></h2> <ul> <li><a href=../preface/ >目录</a></li> <li>上一章: <a href=../02.1/ >你好,Go</a></li> <li>下一节: <a href=../02.3/ >流程和函数</a></li> </ul> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.code.copy", "navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.sections"], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../assets/javascripts/bundle.51d95adb.min.js></script> </body> </html>